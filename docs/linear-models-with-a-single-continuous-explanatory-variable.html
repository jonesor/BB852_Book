<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Linear models with a single continuous explanatory variable | BB852 - Data handling, visualisation and statistics</title>
  <meta name="description" content="This is the course book for BB852." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Linear models with a single continuous explanatory variable | BB852 - Data handling, visualisation and statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the course book for BB852." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Linear models with a single continuous explanatory variable | BB852 - Data handling, visualisation and statistics" />
  
  <meta name="twitter:description" content="This is the course book for BB852." />
  

<meta name="author" content="Owen Jones" />


<meta name="date" content="2020-08-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-models-with-a-several-categorical-explanatory-variables.html"/>
<link rel="next" href="linear-models-with-categorical-and-continuous-explanatory-variables.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BB852</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data-wrangling"><i class="fa fa-check"></i><b>1.1</b> Data wrangling</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-visualisation"><i class="fa fa-check"></i><b>1.2</b> Data visualisation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#statistics"><i class="fa fa-check"></i><b>1.3</b> Statistics</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#general-approach"><i class="fa fa-check"></i><b>1.4</b> General approach</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#data-sources"><i class="fa fa-check"></i><b>1.5</b> Data sources</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.6</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#error-reporting"><i class="fa fa-check"></i><b>1.7</b> Error reporting</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html"><i class="fa fa-check"></i><b>2</b> Getting acquainted with R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#getting-started-with-r"><i class="fa fa-check"></i><b>2.2</b> Getting started with R</a></li>
<li class="chapter" data-level="2.3" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#getting-help"><i class="fa fa-check"></i><b>2.3</b> Getting help</a></li>
<li class="chapter" data-level="2.4" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#r-as-a-fancy-calculator"><i class="fa fa-check"></i><b>2.4</b> R as a fancy calculator</a></li>
<li class="chapter" data-level="2.5" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#objects-in-r"><i class="fa fa-check"></i><b>2.5</b> Objects in R</a></li>
<li class="chapter" data-level="2.6" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#missing-values-infinity-and-non-numbers"><i class="fa fa-check"></i><b>2.6</b> Missing values, infinity and “non-numbers”</a></li>
<li class="chapter" data-level="2.7" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#basic-information-about-objects"><i class="fa fa-check"></i><b>2.7</b> Basic information about objects</a></li>
<li class="chapter" data-level="2.8" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#data-frames"><i class="fa fa-check"></i><b>2.8</b> Data frames</a></li>
<li class="chapter" data-level="2.9" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#classes-in-r"><i class="fa fa-check"></i><b>2.9</b> Classes in R</a></li>
<li class="chapter" data-level="2.10" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#tables-and-summary-statistics"><i class="fa fa-check"></i><b>2.10</b> Tables and summary statistics</a></li>
<li class="chapter" data-level="2.11" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#plotting-data"><i class="fa fa-check"></i><b>2.11</b> Plotting data</a></li>
<li class="chapter" data-level="2.12" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#exercises---getting-acquainted-with-r"><i class="fa fa-check"></i><b>2.12</b> Exercises - Getting acquainted with R</a>
<ul>
<li class="chapter" data-level="2.12.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#background"><i class="fa fa-check"></i><b>2.12.1</b> Background</a></li>
<li class="chapter" data-level="2.12.2" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#the-data"><i class="fa fa-check"></i><b>2.12.2</b> The data</a></li>
<li class="chapter" data-level="2.12.3" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#try-the-following"><i class="fa fa-check"></i><b>2.12.3</b> Try the following</a></li>
<li class="chapter" data-level="2.12.4" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#references"><i class="fa fa-check"></i><b>2.12.4</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html"><i class="fa fa-check"></i><b>3</b> Data wrangling with dplyr</a>
<ul>
<li class="chapter" data-level="3.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#select"><i class="fa fa-check"></i><b>3.2</b> select</a></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#filter"><i class="fa fa-check"></i><b>3.3</b> filter</a></li>
<li class="chapter" data-level="3.4" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#arrange"><i class="fa fa-check"></i><b>3.4</b> arrange</a></li>
<li class="chapter" data-level="3.5" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#summarise-and-group_by"><i class="fa fa-check"></i><b>3.5</b> summarise and group_by</a></li>
<li class="chapter" data-level="3.6" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#using-pipes-saving-data."><i class="fa fa-check"></i><b>3.6</b> Using pipes, saving data.</a></li>
<li class="chapter" data-level="3.7" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#exercises---data-wrangling"><i class="fa fa-check"></i><b>3.7</b> Exercises - data wrangling</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#exploring-the-amniote-life-history-database"><i class="fa fa-check"></i><b>3.7.1</b> Exploring the Amniote Life History Database</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="combining-data-sets.html"><a href="combining-data-sets.html"><i class="fa fa-check"></i><b>4</b> Combining data sets</a>
<ul>
<li class="chapter" data-level="4.1" data-path="combining-data-sets.html"><a href="combining-data-sets.html#exercise---joining-datasets"><i class="fa fa-check"></i><b>4.1</b> Exercise - joining datasets</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#the-data"><i class="fa fa-check"></i><b>4.1.1</b> The data</a></li>
<li class="chapter" data-level="4.1.2" data-path="combining-data-sets.html"><a href="combining-data-sets.html#the-bird-data"><i class="fa fa-check"></i><b>4.1.2</b> The bird data</a></li>
<li class="chapter" data-level="4.1.3" data-path="combining-data-sets.html"><a href="combining-data-sets.html#the-weather-data"><i class="fa fa-check"></i><b>4.1.3</b> The weather data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html"><i class="fa fa-check"></i><b>5</b> Visualising data with ggplot2</a>
<ul>
<li class="chapter" data-level="5.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html#histograms"><i class="fa fa-check"></i><b>5.2</b> Histograms</a></li>
<li class="chapter" data-level="5.3" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html#facets---splitting-data-across-panels"><i class="fa fa-check"></i><b>5.3</b> “Facets” - splitting data across panels</a></li>
<li class="chapter" data-level="5.4" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html#box-plots"><i class="fa fa-check"></i><b>5.4</b> box plots</a></li>
<li class="chapter" data-level="5.5" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html#lines-and-points"><i class="fa fa-check"></i><b>5.5</b> lines and points</a></li>
<li class="chapter" data-level="5.6" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html#scatter-plot"><i class="fa fa-check"></i><b>5.6</b> scatter plot</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html"><i class="fa fa-check"></i><b>6</b> Distributions and summarising data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#distributions"><i class="fa fa-check"></i><b>6.2</b> Distributions</a></li>
<li class="chapter" data-level="6.3" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#normal-distribution"><i class="fa fa-check"></i><b>6.3</b> Normal distribution</a></li>
<li class="chapter" data-level="6.4" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#compare-normal-distributions"><i class="fa fa-check"></i><b>6.4</b> Compare normal distributions</a></li>
<li class="chapter" data-level="6.5" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#the-poisson-distribution"><i class="fa fa-check"></i><b>6.5</b> The Poisson distribution</a></li>
<li class="chapter" data-level="6.6" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#comparing-normal-and-poisson-distributions"><i class="fa fa-check"></i><b>6.6</b> Comparing normal and Poisson distributions</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="customising-your-plots.html"><a href="customising-your-plots.html"><i class="fa fa-check"></i><b>7</b> Customising your plots</a>
<ul>
<li class="chapter" data-level="7.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="customising-your-plots.html"><a href="customising-your-plots.html#a-basic-plot"><i class="fa fa-check"></i><b>7.2</b> A basic plot</a></li>
<li class="chapter" data-level="7.3" data-path="customising-your-plots.html"><a href="customising-your-plots.html#axis-limits"><i class="fa fa-check"></i><b>7.3</b> Axis limits</a></li>
<li class="chapter" data-level="7.4" data-path="customising-your-plots.html"><a href="customising-your-plots.html#transforming-the-axis-log-scale"><i class="fa fa-check"></i><b>7.4</b> Transforming the axis (log scale)</a></li>
<li class="chapter" data-level="7.5" data-path="customising-your-plots.html"><a href="customising-your-plots.html#changing-the-axis-tick-marks"><i class="fa fa-check"></i><b>7.5</b> Changing the axis tick marks</a></li>
<li class="chapter" data-level="7.6" data-path="customising-your-plots.html"><a href="customising-your-plots.html#axis-labels"><i class="fa fa-check"></i><b>7.6</b> Axis labels</a></li>
<li class="chapter" data-level="7.7" data-path="customising-your-plots.html"><a href="customising-your-plots.html#colours"><i class="fa fa-check"></i><b>7.7</b> Colours</a></li>
<li class="chapter" data-level="7.8" data-path="customising-your-plots.html"><a href="customising-your-plots.html#themes"><i class="fa fa-check"></i><b>7.8</b> Themes</a></li>
<li class="chapter" data-level="7.9" data-path="customising-your-plots.html"><a href="customising-your-plots.html#moving-the-legend"><i class="fa fa-check"></i><b>7.9</b> Moving the legend</a></li>
<li class="chapter" data-level="7.10" data-path="customising-your-plots.html"><a href="customising-your-plots.html#combining-multiple-plots"><i class="fa fa-check"></i><b>7.10</b> Combining multiple plots</a></li>
<li class="chapter" data-level="7.11" data-path="customising-your-plots.html"><a href="customising-your-plots.html#saving-your-plot"><i class="fa fa-check"></i><b>7.11</b> Saving your plot</a></li>
<li class="chapter" data-level="7.12" data-path="customising-your-plots.html"><a href="customising-your-plots.html#final-word-on-plots"><i class="fa fa-check"></i><b>7.12</b> Final word on plots</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="randomisation-tests.html"><a href="randomisation-tests.html"><i class="fa fa-check"></i><b>8</b> Randomisation Tests</a>
<ul>
<li class="chapter" data-level="8.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#introduction"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-example"><i class="fa fa-check"></i><b>8.2</b> The example</a></li>
<li class="chapter" data-level="8.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#setting-up"><i class="fa fa-check"></i><b>8.3</b> Setting up</a></li>
<li class="chapter" data-level="8.4" data-path="randomisation-tests.html"><a href="randomisation-tests.html#calculate-the-observed-difference"><i class="fa fa-check"></i><b>8.4</b> Calculate the observed difference</a></li>
<li class="chapter" data-level="8.5" data-path="randomisation-tests.html"><a href="randomisation-tests.html#null-distribution"><i class="fa fa-check"></i><b>8.5</b> Null distribution</a></li>
<li class="chapter" data-level="8.6" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-significance"><i class="fa fa-check"></i><b>8.6</b> Testing significance</a></li>
<li class="chapter" data-level="8.7" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-the-hypothesis"><i class="fa fa-check"></i><b>8.7</b> Testing the hypothesis</a></li>
<li class="chapter" data-level="8.8" data-path="randomisation-tests.html"><a href="randomisation-tests.html#writing-it-up"><i class="fa fa-check"></i><b>8.8</b> Writing it up</a></li>
<li class="chapter" data-level="8.9" data-path="randomisation-tests.html"><a href="randomisation-tests.html#paired-randomisation-tests"><i class="fa fa-check"></i><b>8.9</b> Paired Randomisation Tests</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#plot-the-data"><i class="fa fa-check"></i><b>8.9.1</b> Plot the data</a></li>
<li class="chapter" data-level="8.9.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-paired-randomisation-test"><i class="fa fa-check"></i><b>8.9.2</b> The paired randomisation test</a></li>
<li class="chapter" data-level="8.9.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#plot-the-null-distribution"><i class="fa fa-check"></i><b>8.9.3</b> Plot the null distribution</a></li>
<li class="chapter" data-level="8.9.4" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-formal-hypothesis-test"><i class="fa fa-check"></i><b>8.9.4</b> The formal hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="randomisation-tests.html"><a href="randomisation-tests.html#exercises---randomisation-tests"><i class="fa fa-check"></i><b>8.10</b> Exercises - Randomisation tests</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#introduction-1"><i class="fa fa-check"></i><b>8.10.1</b> Introduction</a></li>
<li class="chapter" data-level="8.10.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#your-task"><i class="fa fa-check"></i><b>8.10.2</b> Your task</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html"><i class="fa fa-check"></i><b>9</b> Comparing two means with a t-test</a>
<ul>
<li class="chapter" data-level="9.1" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#some-theory."><i class="fa fa-check"></i><b>9.1</b> Some theory.</a></li>
<li class="chapter" data-level="9.2" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#one-sample-t-test"><i class="fa fa-check"></i><b>9.2</b> One sample t-test</a></li>
<li class="chapter" data-level="9.3" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#doing-it-by-hand---where-does-the-t-statistic-come-from"><i class="fa fa-check"></i><b>9.3</b> Doing it “by hand” - where does the t-statistic come from?</a></li>
<li class="chapter" data-level="9.4" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#paired-t-test"><i class="fa fa-check"></i><b>9.4</b> Paired t-test</a></li>
<li class="chapter" data-level="9.5" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#a-paired-t-test-is-a-one-sample-test."><i class="fa fa-check"></i><b>9.5</b> A paired t-test is a one-sample test.</a></li>
<li class="chapter" data-level="9.6" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#two-sample-t-test"><i class="fa fa-check"></i><b>9.6</b> Two sample t-test</a></li>
<li class="chapter" data-level="9.7" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#t-tests-are-linear-models"><i class="fa fa-check"></i><b>9.7</b> t-tests are linear models</a></li>
<li class="chapter" data-level="9.8" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercises---two-sample-t-test"><i class="fa fa-check"></i><b>9.8</b> Exercises - Two-sample t-test</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#paired-t-test-1"><i class="fa fa-check"></i><b>9.8.1</b> Paired t-test</a></li>
<li class="chapter" data-level="9.8.2" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#optional-extra."><i class="fa fa-check"></i><b>9.8.2</b> Optional extra.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html"><i class="fa fa-check"></i><b>10</b> Linear models with a single categorical explanatory variable</a>
<ul>
<li class="chapter" data-level="10.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#introduction"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#one-way-anova"><i class="fa fa-check"></i><b>10.2</b> One-way ANOVA</a></li>
<li class="chapter" data-level="10.3" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#fitting-an-anova-in-r"><i class="fa fa-check"></i><b>10.3</b> Fitting an ANOVA in R</a></li>
<li class="chapter" data-level="10.4" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#where-are-the-differences"><i class="fa fa-check"></i><b>10.4</b> Where are the differences?</a></li>
<li class="chapter" data-level="10.5" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#tukeys-honestly-significant-difference-hsd"><i class="fa fa-check"></i><b>10.5</b> Tukey’s Honestly Significant Difference (HSD)</a></li>
<li class="chapter" data-level="10.6" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#anova-calculation-by-hand-optional"><i class="fa fa-check"></i><b>10.6</b> ANOVA calculation “by hand” (optional)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-models-with-a-several-categorical-explanatory-variables.html"><a href="linear-models-with-a-several-categorical-explanatory-variables.html"><i class="fa fa-check"></i><b>11</b> Linear models with a several categorical explanatory variables</a>
<ul>
<li class="chapter" data-level="11.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#background"><i class="fa fa-check"></i><b>11.1</b> Background</a></li>
<li class="chapter" data-level="11.2" data-path="linear-models-with-a-several-categorical-explanatory-variables.html"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#fitting-a-two-way-anova-model"><i class="fa fa-check"></i><b>11.2</b> Fitting a two-way ANOVA model</a></li>
<li class="chapter" data-level="11.3" data-path="linear-models-with-a-several-categorical-explanatory-variables.html"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#summarising-the-model-anova"><i class="fa fa-check"></i><b>11.3</b> Summarising the model (<code>anova</code>)</a></li>
<li class="chapter" data-level="11.4" data-path="linear-models-with-a-several-categorical-explanatory-variables.html"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#summarising-the-model-summary"><i class="fa fa-check"></i><b>11.4</b> Summarising the model (<code>summary</code>)</a></li>
<li class="chapter" data-level="11.5" data-path="linear-models-with-a-several-categorical-explanatory-variables.html"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#a-2-way-anova-on-a-fish-behaviour-study"><i class="fa fa-check"></i><b>11.5</b> A 2-way ANOVA on a fish behaviour study</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="linear-models-with-a-several-categorical-explanatory-variables.html"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#background-1"><i class="fa fa-check"></i><b>11.5.1</b> Background</a></li>
<li class="chapter" data-level="11.5.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#your-task"><i class="fa fa-check"></i><b>11.5.2</b> Your task</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html"><i class="fa fa-check"></i><b>12</b> Linear models with a single continuous explanatory variable</a>
<ul>
<li class="chapter" data-level="12.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#background"><i class="fa fa-check"></i><b>12.1</b> Background</a></li>
<li class="chapter" data-level="12.2" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#some-theory"><i class="fa fa-check"></i><b>12.2</b> Some theory</a></li>
<li class="chapter" data-level="12.3" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#evaluating-a-hypothesis-with-a-linear-regression-model"><i class="fa fa-check"></i><b>12.3</b> Evaluating a hypothesis with a linear regression model</a></li>
<li class="chapter" data-level="12.4" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#assumptions"><i class="fa fa-check"></i><b>12.4</b> Assumptions</a></li>
<li class="chapter" data-level="12.5" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#an-example-using-r"><i class="fa fa-check"></i><b>12.5</b> An example using R</a></li>
<li class="chapter" data-level="12.6" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#exercises---linear-regression"><i class="fa fa-check"></i><b>12.6</b> Exercises - Linear Regression</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="linear-models-with-a-several-categorical-explanatory-variables.html"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#background-1"><i class="fa fa-check"></i><b>12.6.1</b> Background</a></li>
<li class="chapter" data-level="12.6.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#your-task"><i class="fa fa-check"></i><b>12.6.2</b> Your task</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html"><i class="fa fa-check"></i><b>13</b> Linear models with categorical and continuous explanatory variables</a>
<ul>
<li class="chapter" data-level="13.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#background"><i class="fa fa-check"></i><b>13.1</b> Background</a></li>
<li class="chapter" data-level="13.2" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#the-height-hand-width-example."><i class="fa fa-check"></i><b>13.2</b> The height ~ hand width example.</a></li>
<li class="chapter" data-level="13.3" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#summarising-with-anova"><i class="fa fa-check"></i><b>13.3</b> Summarising with <code>anova</code></a></li>
<li class="chapter" data-level="13.4" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#the-summary-of-coefficients-summary"><i class="fa fa-check"></i><b>13.4</b> The summary of coefficients (<code>summary</code>)</a></li>
<li class="chapter" data-level="13.5" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#simplifying-the-model"><i class="fa fa-check"></i><b>13.5</b> Simplifying the model</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html"><i class="fa fa-check"></i><b>14</b> Generalised linear models</a>
<ul>
<li class="chapter" data-level="14.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#count-data-with-poisson-errors."><i class="fa fa-check"></i><b>14.1</b> Count data with Poisson errors.</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-number-of-offspring-in-foxes."><i class="fa fa-check"></i><b>14.1.1</b> Example: Number of offspring in foxes.</a></li>
<li class="chapter" data-level="14.1.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-cancer-clusters"><i class="fa fa-check"></i><b>14.1.2</b> Example: Cancer clusters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html"><i class="fa fa-check"></i><b>15</b> Extending use cases of GLM</a>
<ul>
<li class="chapter" data-level="15.1" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#logistic-regression-with-binary-01-data"><i class="fa fa-check"></i><b>15.1</b> Logistic regression with binary (0/1) data</a></li>
<li class="chapter" data-level="15.2" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-species-presenceabsence-data"><i class="fa fa-check"></i><b>15.2</b> Example: species presence/absence data</a></li>
<li class="chapter" data-level="15.3" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#binomial-regression-with-proportionratio-data"><i class="fa fa-check"></i><b>15.3</b> Binomial regression with proportion/ratio data</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-sex-ratios"><i class="fa fa-check"></i><b>15.3.1</b> Example: sex ratios</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="power-and-study-design.html"><a href="power-and-study-design.html"><i class="fa fa-check"></i><b>16</b> Power and study design</a>
<ul>
<li class="chapter" data-level="16.1" data-path="power-and-study-design.html"><a href="power-and-study-design.html#power-analysis-by-simulation"><i class="fa fa-check"></i><b>16.1</b> Power analysis by simulation</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html"><i class="fa fa-check"></i><b>17</b> Coming soon (maybe)!</a>
<ul>
<li class="chapter" data-level="17.1" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#multivariate-statistics"><i class="fa fa-check"></i><b>17.1</b> Multivariate statistics</a></li>
<li class="chapter" data-level="17.2" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#transforming-variables"><i class="fa fa-check"></i><b>17.2</b> Transforming variables</a></li>
<li class="chapter" data-level="17.3" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#non-linear-regression"><i class="fa fa-check"></i><b>17.3</b> Non-linear regression</a></li>
<li class="chapter" data-level="17.4" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#nested-or-blocked-study-designs"><i class="fa fa-check"></i><b>17.4</b> Nested or blocked study designs</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BB852 - Data handling, visualisation and statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-models-with-a-single-continuous-explanatory-variable" class="section level1" number="12">
<h1><span class="header-section-number">Chapter 12</span> Linear models with a single continuous explanatory variable</h1>
<div id="background" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> Background</h2>
<p>Linear regression models, at their simplest, are a method of estimating the linear (straight line) relationships between two continuous variables. As an example, picture the relationship between two variables height and hand width (Figure ). In this figure there is a clear relationship between the two variables, and the straight line running through the cloud of data points is the fitted linear regression model.</p>
<p>The aim of linear regression is to (1) determine if there is a meaningful statistical relationship between the explanatory variable(s) and the response variable, and (2) to quantify those relationships by estimating the characteristics of those relationships. These characteristics include the slope and intercepts of fitted models, and the amount of variation explained by variables in the model.</p>
<div class="figure" style="text-align: center"><span id="fig:exampleRegression"></span>
<img src="BB852_files/figure-html/exampleRegression-1.png" alt="A linear regression model fitted through data points." width="288" />
<p class="caption">
Figure 12.1: A linear regression model fitted through data points.
</p>
</div>
</div>
<div id="some-theory" class="section level2" number="12.2">
<h2><span class="header-section-number">12.2</span> Some theory</h2>
<p>To understand linear regression models it is important to know that the equation of a straight line is <span class="math inline">\(y = ax+b\)</span>. In this equation, <span class="math inline">\(y\)</span> is the response variable and <span class="math inline">\(x\)</span> is the explanatory variable, and <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are the slope and intercept of the line with the vertical axis (y-axis). These (<span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>) are called <strong>coefficients</strong>. These are illustrated in Figure .</p>
<div class="figure" style="text-align: center"><span id="fig:lineEquation"></span>
<img src="BB852_files/figure-html/lineEquation-1.png" alt="The equation of straight lines." width="672" />
<p class="caption">
Figure 12.2: The equation of straight lines.
</p>
</div>
<p>When looking at data points on a graph, unless all of the data points are arranged perfectly along a straight line, there will be some distance between the points and the line. These distances, measured parallel to the vertical axis, are called residuals (you have encountered them before in this course). These residuals represent the variation left after fitting the line (a linear model) through the data. Because we want to fit a model that explains as much variation as possible, it is intuitive that we should wish to minimise this residual variation.</p>
<p>One way of doing this is by minimising the sum of squares of the residuals (again, you have come across this concept a few times before). In other words, we add up the squares of each of the residuals. We square the values, rather than simply adding up the residuals themselves because we want to ensure that the positive and negative values don’t cancel each other out (a square of a negative number is positive). This method is called <strong>least squares</strong> regression and is illustrated in Figure : Which is the best fitting line?</p>
<div class="figure" style="text-align: center"><span id="fig:leastSquares"></span>
<img src="BB852_files/figure-html/leastSquares-1.png" alt="Residuals and least squares: which is the best fitting line?" width="460.8" />
<p class="caption">
Figure 12.3: Residuals and least squares: which is the best fitting line?
</p>
</div>
<p>In fact, these residuals represent “error” caused by factors including measurement error, random variation, variation caused by unmeasured factors etc. This error term is given the label, <span class="math inline">\(\epsilon\)</span>. Thus we can write the model equation as:</p>
<p><span class="math display">\[y = ax+b+\epsilon\]</span></p>
<p>Sometimes, this equation is written with using the beta symbol (<span class="math inline">\(\beta\)</span>) for the coefficients, so that the slope is <span class="math inline">\(\beta_0\)</span> and the intercept is <span class="math inline">\(\beta_1\)</span> for example.</p>
<p><span class="math display">\[y = \beta_0 x+\beta_1+\epsilon\]</span></p>
<p>The idea is that this equation, and its coefficients and error estimates, describe the relationship we are interested in (including the error or uncertainty).</p>
<p>Together this information allows us to not only determine if there <strong>is</strong> a statistically significant relationship, but also what the nature of the relationship is, and the uncertainty in our estimates.</p>
</div>
<div id="evaluating-a-hypothesis-with-a-linear-regression-model" class="section level2" number="12.3">
<h2><span class="header-section-number">12.3</span> Evaluating a hypothesis with a linear regression model</h2>
<p>Usually, the most important hypothesis test involved with a linear regression model relates to the slope: <strong>is the slope coefficient significantly different from 0?</strong>, or should we accept the null hypothesis that the slope is no different from 0.</p>
<p>Sometimes hypotheses like this are a bit boring, because we already know the answer before collecting and analysing the data. What we usually <strong>don’t</strong> know is the nature of the relationship (the slope, intercept, their errors, and amount of variation explained). Usually it is more interesting and meaningful to focus on those details.</p>
<p>The following example, where we focus on the relationship between hand width and height, is one of these “boring” cases: we already know there is a relationship. Nevertheless, we’ll use this example because it helps us understand how this hypothesis test works.</p>
<p>The aim of this section is to give you some intuition on how the hypothesis test works.</p>
<p>We can address the slope hypothesis by calculating an F-value in a similar way to how we used them in ANOVA. Recall that F-values are ratios of variances. To understand how these work in the context of a linear regression we need to think clearly about the slope hypothesis: The <strong>null hypothesis</strong> is that the slope is <strong>not</strong> significantly different to 0 (that the data can be explained by random variation). The <strong>alternative hypothesis</strong> is that the slope is significantly different from 0.</p>
<p>The first step in evaluating these hypotheses is to calculate what the <strong>total sum of squares</strong><a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> is when the null hypothesis is true (Figure A) - this value is the total variation that the model is trying to explain.</p>
<p>Then we fit our model using least squares and figure out what the <strong>residual sum of squares</strong> is from this model (Figure B). This is the amount of variation left after the model has explained <em>some</em> of the total variation - it is sometimes called <em>residual error</em>, or simply <em>error</em>.</p>
<p>The difference between these two values is the <strong>explained sum of squares</strong>, which measures the amount of variation in <span class="math inline">\(y\)</span> explained by variation in <span class="math inline">\(x\)</span>. The rationale for this is that the model is trying to explain total variation. After fitting the model there will always be some unexplained variation (“<em>residual error</em>”) left. If we can estimate total variation and unexplained variation, then the amount of variation explained can be calculated with a simple subtraction:</p>
<p><span class="math display">\[Total = Explained + Residual\]</span>
… and, therefore …
<span class="math display">\[Explained = Total - Residual\]</span></p>
<p>Before using these values we need to standardise them to control for sample size. This is necessary because sum of squares will <em>always</em> increase with sample size. We make this correction by dividing our sum of squares measures by the degrees of freedom. The d.f. for the <strong>explained sum of squares</strong> is 1, and the d.f. for the <strong>residual sum of squares</strong> is the number of observations minus 2. The result of these calculations is the <strong>mean explained sum of squares</strong> (mESS) and the <strong>mean residual sum of squares</strong> (mRSS). These “mean” quantities are <strong>variances</strong>, and the ratio between them gives us the <strong>F-value</strong>. Notice that this is very similar to the variance ratio used in the ANOVA.</p>
<p><span class="math display">\[F = \frac{mESS}{mRSS}\]</span></p>
<p>If the <em>explained variance</em> (mESS) is large compared to the <em>residual error variance</em> (mRSS), then F will be large. The size of F tells us how likely or unlikely it is that the null hypothesis is true. When F is large, the probability that the slope is significantly different from 0 is high. To obtain the actual probabilities, the F-value must be compared to a theoretical distribution which depends on the two degrees of freedom (explained and residual d.f.). Once upon a time you would have looked this up in a printed table, but now R makes this very straightforward.</p>
<div class="figure" style="text-align: center"><span id="fig:slopeHypo"></span>
<img src="BB852_files/figure-html/slopeHypo-1.png" alt="(A) the total variation around the overall mean Height value (B) the residual error of the model." width="768" />
<p class="caption">
Figure 12.4: (A) the total variation around the overall mean Height value (B) the residual error of the model.
</p>
</div>
</div>
<div id="assumptions" class="section level2" number="12.4">
<h2><span class="header-section-number">12.4</span> Assumptions</h2>
<p>These models have similar assumptions to the other linear models<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>. These are (1) that the relationship between the variables is linear (hence the name); (2) that the data are continuous variables; (3) that the observations are randomly sampled; (4) that the errors in the model (the “residuals”) can be described by a normal distribution; and (5) and that the errors are “homoscedastic” (that they are constant through the range of the data). You can evaluate these things by looking at diagnostic plots after you have fitted the model. See page 112-113 in GSWR for a nice explanation.</p>
</div>
<div id="an-example-using-r" class="section level2" number="12.5">
<h2><span class="header-section-number">12.5</span> An example using R</h2>
<p>Let’s now use R to fit a linear regression model to estimate the relationship between hand width and height. One application for such a model could be to predict height from a hand print, for example left at a crime scene.</p>
<p>First, load the data:</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#cb374-1" aria-hidden="true"></a>classData &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;CourseData/classData.csv&quot;</span>)</span></code></pre></div>
<p>We should then plot the data to make sure it looks OK.</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#cb375-1" aria-hidden="true"></a><span class="kw">ggplot</span>(classData,<span class="kw">aes</span>(<span class="dt">x=</span>HandWidth,<span class="dt">y=</span>Height)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb375-2"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#cb375-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-211-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>This looks OK, and the relationship looks fairly linear. Now we can fit a model using the <code>lm</code> function (same as for ANOVA!).<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a></p>
<p>The response variable is always the one we would like to predict, in this case <code>Height</code>. The explanatory variable (sometimes called the predictor) is <code>HandWidth</code>. These are added to the model using a formula where they are separated with the <code>~</code> (“tilde”) symbol: <code>Height ~ HandWidth</code>. In the model expression, we also need to tell R where the data are using the <code>data =</code> argument. We can save the model as an R object by naming it e.g. <code>mod_A &lt;-</code>.</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#cb376-1" aria-hidden="true"></a>mod_A &lt;-<span class="st"> </span><span class="kw">lm</span>(Height <span class="op">~</span><span class="st"> </span>HandWidth, <span class="dt">data =</span> classData)</span></code></pre></div>
<p>Before proceeding further we should evaluate the model using a diagnostic plot. We can do this using the <code>autoplot</code> function in the <code>ggfortify</code> package (you may need to install and/or load the package).</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#cb377-1" aria-hidden="true"></a><span class="kw">library</span>(ggfortify)</span>
<span id="cb377-2"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#cb377-2" aria-hidden="true"></a><span class="kw">autoplot</span>(mod_A)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-213-1.png" width="480" style="display: block; margin: auto;" />
These diagnostic plots allow you to check that the assumptions of the model are not violated. On the left are two plots which (more or less) show the same thing. They show how the residuals (the errors in the model) vary with the predicted value (height). Looking at the plots allows a visual test for constant variance (homoscedasticity) along the range of the data. In an ideal case, there should be no pattern (e.g. humps) in these points. On the top right is the QQ-plot which shows how well the residuals match up to a theoretical normal distribution. In an ideal case, these points should line up on the diagonal line running across the plot. The bottom right plot shows “leverage” which is a measure of how much influence individual data points have on the model. Outliers will have large leverage and can mess up your model. Ideally, the points here should be in a cloud, with no points standing out from the others. Please read the pages 112-113 in the textbook GSWR for more on these. In this case, the model looks pretty good.</p>
<p>Now that we are satisfied that the model doesn’t violate the assumptions we can dig into the model to see what it is telling us.</p>
<p>To test the (slightly boring) slope hypothesis we use the <code>anova</code> function (again, this is the same as with the ANOVA).</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#cb378-1" aria-hidden="true"></a><span class="kw">anova</span>(mod_A)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Height
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## HandWidth  1 1038.5 1038.46  28.397 1.017e-05 ***
## Residuals 29 1060.5   36.57                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>When you run this function, you get a summary table that looks exactly like the one you got with an ANOVA. There are degrees of freedom (<code>Df</code>), Sums of Squares (<code>Sum Sq</code>), Mean Sums of Squares (<code>Mean Sq</code>) and the <code>F value</code> and p-value (<code>Pr(&gt;F)</code>).
The most important parts of this table are the F value (28.3968) and the p-value (0.00001017): as described above, large F values lead to small p-values. This tells us that it is VERY unlikely that the null hypothesis is true and we should accept the alternative hypothesis (that height is associated with hand width)</p>
<p>We could report the results of this hypothesis test like this:
<em>There was a statistically significant association between hand width and height (F = 28.3968, d.f. = 1,29, p &lt; 0.001)</em></p>
<p>Now we can dig deeper by asking for a <code>summary</code> of the model.</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#cb380-1" aria-hidden="true"></a><span class="kw">summary</span>(mod_A)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Height ~ HandWidth, data = classData)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.498  -3.748  -0.188   5.502   8.812 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 133.9464     7.7862  17.203  &lt; 2e-16 ***
## HandWidth     4.6552     0.8736   5.329 1.02e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.047 on 29 degrees of freedom
## Multiple R-squared:  0.4947,	Adjusted R-squared:  0.4773 
## F-statistic:  28.4 on 1 and 29 DF,  p-value: 1.017e-05</code></pre>
<p>This summary has a lot of information. First we see <code>Call</code> which reminds us what the formula we have used to fit the model. Then there is some summary information about the residuals. Ideally these should be fairly balanced around 0 (i.e. the <code>Min</code> value should be negative but with the same magnitude as <code>Max</code>). If they are <strong>wildly</strong> different, then you might want to check the data or model. In this case they look OK.</p>
<p>Then we get to the important part of the table - the <code>Coefficients</code>. This lists the coefficients of the model and shows first the <code>Intercept</code> and then the slope, which is given by the name of the explanatory variable (<code>HandWidth</code> here). For each coefficient we get the <code>Estimate</code> of its value, and the uncertainty in that estimate (the standard error (`Std. Error)).</p>
<p>These estimates and errors are each followed by a <code>t value</code> and a p-value (<code>Pr(&gt;|t|</code>)). These values provide a test of whether the slope/intercept is different from zero. In this case they both are. The t-tests are indeed doing t-tests of these estimates, in the same way that a regular t-test works, so that the significance depends on the ratio between signal (the estimate) and the noise (the standard error). This is illustrated for the coefficient estimates for our model in Figure .</p>
<div class="figure" style="text-align: center"><span id="fig:coefPlot"></span>
<img src="BB852_files/figure-html/coefPlot-1.png" alt="Illustration of the coefficient estimates for our model. The peak of the distribution is at the coefficient estimate, and the spread of the distribution indicates the standard error of the mean for the estimate. The statistical significance of the coefficient is determined by the degree of overlap with 0." width="576" />
<p class="caption">
Figure 12.5: Illustration of the coefficient estimates for our model. The peak of the distribution is at the coefficient estimate, and the spread of the distribution indicates the standard error of the mean for the estimate. The statistical significance of the coefficient is determined by the degree of overlap with 0.
</p>
</div>
<p>The summary then gives some information about the amount of residual variation left after the model has been fitted (this is the <span class="math inline">\(\epsilon\)</span> term in the equations at the start of this worksheet). Then we are told what the <span class="math inline">\(R^2\)</span> value is 0.4947. The adjusted <span class="math inline">\(R^2\)</span> is for use in multiple regression models, where there are many explanatory variables and should not be used for this simple regression model. So what does <span class="math inline">\(R^2\)</span> actually mean?</p>
<p><span class="math inline">\(R^2\)</span> is the square of the correlation coefficient <span class="math inline">\(r\)</span> and is a measure of the amount of variation in the response variable (Height) that is explained by the model. If all the points were sitting on the regression line, the <span class="math inline">\(R^2\)</span> value would be 1. This idea is illustrated in Figure .</p>
<p>We could describe the model like this:</p>
<p><em>There is a statistically significant association between hand width and height (F = 28.3968, d.f. = 1,29, p &lt; 0.001) The equation of the fitted model is: Height = 4.66(<span class="math inline">\(\pm\)</span> 0.87) <span class="math inline">\(\times\)</span> HandWidth + 133.95(<span class="math inline">\(\pm\)</span> 7.79). The model explains 49% of the variation in height (<span class="math inline">\(R^2\)</span> = 0.495).</em></p>
<p>… or maybe, <em>The model, which explained 49% of the variation in height, showed that the slope of the relationship between hand width and height is 4.66 <span class="math inline">\(\pm\)</span> 0.87 which is significantly greater than 0 (t = 17.20, p &lt; 0.01)</em></p>
<div class="figure" style="text-align: center"><span id="fig:rSquared"></span>
<img src="BB852_files/figure-html/rSquared-1.png" alt="An illustration of different R-squared values." width="384" />
<p class="caption">
Figure 12.6: An illustration of different R-squared values.
</p>
</div>
<p>A plot is usually a good idea because it is easier for the reader to interpret than an equation, or coefficients. The <code>ggplot2</code> package has a neat and simple function called <code>geom_smooth</code> which will add the fitted regression line to simple models like this. For linear regression models you simply need to tell it to use <code>method = "lm"</code>. This will plot the fitted regression model, and will add, by default" a shaded “ribbon” which represents the so called “95% confidence interval” for the fitted values. These are 2 time the standard error.</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#cb382-1" aria-hidden="true"></a><span class="kw">ggplot</span>(classData,<span class="kw">aes</span>(<span class="dt">x =</span> HandWidth,<span class="dt">y =</span> Height)) <span class="op">+</span></span>
<span id="cb382-2"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#cb382-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb382-3"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#cb382-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-216-1.png" width="432" style="display: block; margin: auto;" /></p>
<p><strong>Question:</strong> If police find the 9.8cm wide hand print at a crime scene, what is your best guess of the height of the person involved?</p>
<!--
predict(mod_A,list(HandWidth = 9.8))
-->
</div>
<div id="exercises---linear-regression" class="section level2" number="12.6">
<h2><span class="header-section-number">12.6</span> Exercises - Linear Regression</h2>
<div id="background-1" class="section level3" number="12.6.1">
<h3><span class="header-section-number">12.6.1</span> Background</h3>
<p>Male crickets produce a “chirping” sound by rubbing the edges of their wings together: the male cricket rubs a sharp ridge on his wing against a series ridges on the other wing. In a 1948 study on striped ground cricket (<em>Allonemobius fasciatus</em>), the biologist George W. Pierce recorded the frequency of chirps (vibrations per second) in different temperature conditions.</p>
<p>Crickets are ectotherms so their physiology and metabolism is influenced by temperature. We therefore believe that temperature might have an effect on their chirp frequency.</p>
</div>
<div id="your-task" class="section level3" number="12.6.2">
<h3><span class="header-section-number">12.6.2</span> Your task</h3>
<p>The data file <code>chirps.csv</code> contains data from Pierce’s experiments. Your task is to analyse the data and find (1) whether there is a statistically significant relationship between temperature and chirp frequency and (2) what that relationship is.</p>
<p>The data has two columns - <code>chirps</code> (the frequency in Hertz) and <code>temperature</code> (the temperature in Fahrenheit). You should express the relationship in Celsius.</p>
<ol style="list-style-type: decimal">
<li><p>Import the data</p></li>
<li><p>Use <code>mutate</code> to convert Fahrenheit to Celsius (Google it)</p></li>
<li><p>Plot the data</p></li>
<li><p>Fit a linear regression model with <code>lm</code></p></li>
<li><p>Look at diagnostic plots to evaluate the model</p></li>
<li><p>Use <code>anova</code> to figure out if the effect of temperature is statistically significant.</p></li>
<li><p>Use <code>summary</code> to obtain information about the coefficients and <span class="math inline">\(R^2\)</span>-value.</p></li>
<li><p>Summarise the model in words.</p></li>
<li><p>Add model fit line to the plot.</p></li>
<li><p>Can I use cricket chirp frequency as a kind of thermometer?</p></li>
</ol>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p>sum of squares is simply a way to estimate variation.<a href="linear-models-with-a-single-continuous-explanatory-variable.html#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>t-tests, ANOVA and linear regression are all types of linear model, mathematically<a href="linear-models-with-a-single-continuous-explanatory-variable.html#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>R knows that this is a linear regression rather than an ANOVA because the explanatory variable is numeric rather than categorical - smart!.<a href="linear-models-with-a-single-continuous-explanatory-variable.html#fnref7" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-models-with-a-several-categorical-explanatory-variables.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linear-models-with-categorical-and-continuous-explanatory-variables.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jonesor/BB852_Course_Book/edit/master/11-linearRegression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"split_by": "section"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
