<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Visualising data with ggplot | BB852 - Data handling, visualisation and statistics</title>
  <meta name="description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Visualising data with ggplot | BB852 - Data handling, visualisation and statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Visualising data with ggplot | BB852 - Data handling, visualisation and statistics" />
  
  <meta name="twitter:description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  

<meta name="author" content="Owen R. Jones" />


<meta name="date" content="2020-11-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exercise-temperature-effects-on-egg-laying-dates.html"/>
<link rel="next" href="distributions-and-summarising-data.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.0.0/tabwid.js"></script>
<style type="text/css">

.warning-box {
  border: 3px solid #e60000;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

.advanced-box {
  border: 3px solid #268bd2;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

.do-something {
  border: 3px solid #803e00;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

</style>





<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BB852</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data-wrangling"><i class="fa fa-check"></i><b>1.1</b> Data wrangling</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-visualisation"><i class="fa fa-check"></i><b>1.2</b> Data visualisation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#statistics"><i class="fa fa-check"></i><b>1.3</b> Statistics</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#data-sources"><i class="fa fa-check"></i><b>1.4</b> Data sources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#your-instructors"><i class="fa fa-check"></i><b>1.5</b> Your instructors</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.6</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i><b>2</b> Schedule</a>
<ul>
<li class="chapter" data-level="2.1" data-path="schedule.html"><a href="schedule.html#additional-recommended-reading"><i class="fa fa-check"></i><b>2.1</b> Additional recommended reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="an-r-refresher.html"><a href="an-r-refresher.html"><i class="fa fa-check"></i><b>3</b> An R refresher</a>
<ul>
<li class="chapter" data-level="3.1" data-path="an-r-refresher.html"><a href="an-r-refresher.html#getting-started-with-r"><i class="fa fa-check"></i><b>3.1</b> Getting started with R</a></li>
<li class="chapter" data-level="3.2" data-path="an-r-refresher.html"><a href="an-r-refresher.html#getting-help"><i class="fa fa-check"></i><b>3.2</b> Getting help</a></li>
<li class="chapter" data-level="3.3" data-path="an-r-refresher.html"><a href="an-r-refresher.html#r-as-a-fancy-calculator"><i class="fa fa-check"></i><b>3.3</b> R as a fancy calculator</a></li>
<li class="chapter" data-level="3.4" data-path="an-r-refresher.html"><a href="an-r-refresher.html#objects-in-r"><i class="fa fa-check"></i><b>3.4</b> Objects in R</a></li>
<li class="chapter" data-level="3.5" data-path="an-r-refresher.html"><a href="an-r-refresher.html#missing-values-infinity-and-non-numbers"><i class="fa fa-check"></i><b>3.5</b> Missing values, infinity and “non-numbers”</a></li>
<li class="chapter" data-level="3.6" data-path="an-r-refresher.html"><a href="an-r-refresher.html#basic-information-about-objects"><i class="fa fa-check"></i><b>3.6</b> Basic information about objects</a></li>
<li class="chapter" data-level="3.7" data-path="an-r-refresher.html"><a href="an-r-refresher.html#data-frames"><i class="fa fa-check"></i><b>3.7</b> Data frames</a></li>
<li class="chapter" data-level="3.8" data-path="an-r-refresher.html"><a href="an-r-refresher.html#organising-your-work"><i class="fa fa-check"></i><b>3.8</b> Organising your work</a></li>
<li class="chapter" data-level="3.9" data-path="an-r-refresher.html"><a href="an-r-refresher.html#inspecting-the-data"><i class="fa fa-check"></i><b>3.9</b> Inspecting the data</a></li>
<li class="chapter" data-level="3.10" data-path="an-r-refresher.html"><a href="an-r-refresher.html#classes-in-r"><i class="fa fa-check"></i><b>3.10</b> “Classes” in R</a></li>
<li class="chapter" data-level="3.11" data-path="an-r-refresher.html"><a href="an-r-refresher.html#tables-and-summary-statistics"><i class="fa fa-check"></i><b>3.11</b> Tables and summary statistics</a></li>
<li class="chapter" data-level="3.12" data-path="an-r-refresher.html"><a href="an-r-refresher.html#plotting-data"><i class="fa fa-check"></i><b>3.12</b> Plotting data</a></li>
<li class="chapter" data-level="3.13" data-path="an-r-refresher.html"><a href="an-r-refresher.html#r-packages"><i class="fa fa-check"></i><b>3.13</b> R Packages</a></li>
<li class="chapter" data-level="3.14" data-path="an-r-refresher.html"><a href="an-r-refresher.html#exercise-californian-bird-diversity"><i class="fa fa-check"></i><b>3.14</b> Exercise: Californian bird diversity</a>
<ul>
<li class="chapter" data-level="3.14.1" data-path="an-r-refresher.html"><a href="an-r-refresher.html#the-data"><i class="fa fa-check"></i><b>3.14.1</b> The data</a></li>
<li class="chapter" data-level="3.14.2" data-path="an-r-refresher.html"><a href="an-r-refresher.html#try-the-following"><i class="fa fa-check"></i><b>3.14.2</b> Try the following</a></li>
</ul></li>
<li class="chapter" data-level="3.15" data-path="an-r-refresher.html"><a href="an-r-refresher.html#exercise-solutions-californian-bird-diversity"><i class="fa fa-check"></i><b>3.15</b> Exercise Solutions: Californian bird diversity</a></li>
</ul></li>
<li class="part"><span><b>I Data Wrangling</b></span></li>
<li class="chapter" data-level="4" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html"><i class="fa fa-check"></i><b>4</b> Data wrangling with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#select"><i class="fa fa-check"></i><b>4.1</b> <code>select</code></a></li>
<li class="chapter" data-level="4.2" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#filter"><i class="fa fa-check"></i><b>4.2</b> <code>filter</code></a></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#arrange"><i class="fa fa-check"></i><b>4.3</b> <code>arrange</code></a></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#summarise-and-group_by"><i class="fa fa-check"></i><b>4.4</b> <code>summarise</code> and <code>group_by</code></a></li>
<li class="chapter" data-level="4.5" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#using-pipes-saving-data."><i class="fa fa-check"></i><b>4.5</b> Using pipes, saving data.</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="exercise-wrangling-the-amniote-life-history-database.html"><a href="exercise-wrangling-the-amniote-life-history-database.html"><i class="fa fa-check"></i><b>5</b> Exercise: Wrangling the Amniote Life History Database</a>
<ul>
<li class="chapter" data-level="5.1" data-path="exercise-wrangling-the-amniote-life-history-database.html"><a href="exercise-wrangling-the-amniote-life-history-database.html#exercise-solutions-wrangling-the-amniote-life-history-database"><i class="fa fa-check"></i><b>5.1</b> Exercise Solutions: Wrangling the Amniote Life History Database</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="combining-data-sets.html"><a href="combining-data-sets.html"><i class="fa fa-check"></i><b>6</b> Combining data sets</a>
<ul>
<li class="chapter" data-level="6.1" data-path="combining-data-sets.html"><a href="combining-data-sets.html#using-join"><i class="fa fa-check"></i><b>6.1</b> Using <code>join</code></a></li>
<li class="chapter" data-level="6.2" data-path="combining-data-sets.html"><a href="combining-data-sets.html#using-pivot_longer"><i class="fa fa-check"></i><b>6.2</b> Using <code>pivot_longer</code></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exercise-temperature-effects-on-egg-laying-dates.html"><a href="exercise-temperature-effects-on-egg-laying-dates.html"><i class="fa fa-check"></i><b>7</b> Exercise: Temperature effects on egg laying dates</a>
<ul>
<li class="chapter" data-level="7.1" data-path="exercise-temperature-effects-on-egg-laying-dates.html"><a href="exercise-temperature-effects-on-egg-laying-dates.html#exercise-solutions-temperature-effects-on-egg-laying-dates"><i class="fa fa-check"></i><b>7.1</b> Exercise Solutions: Temperature effects on egg laying dates</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="exercise-temperature-effects-on-egg-laying-dates.html"><a href="exercise-temperature-effects-on-egg-laying-dates.html#preparing-the-bird-data"><i class="fa fa-check"></i><b>7.1.1</b> Preparing the bird data</a></li>
<li class="chapter" data-level="7.1.2" data-path="exercise-temperature-effects-on-egg-laying-dates.html"><a href="exercise-temperature-effects-on-egg-laying-dates.html#preparing-the-weather-data"><i class="fa fa-check"></i><b>7.1.2</b> Preparing the weather data</a></li>
<li class="chapter" data-level="7.1.3" data-path="exercise-temperature-effects-on-egg-laying-dates.html"><a href="exercise-temperature-effects-on-egg-laying-dates.html#joining-the-two-datasets"><i class="fa fa-check"></i><b>7.1.3</b> Joining the two datasets</a></li>
<li class="chapter" data-level="7.1.4" data-path="exercise-temperature-effects-on-egg-laying-dates.html"><a href="exercise-temperature-effects-on-egg-laying-dates.html#plot-the-data"><i class="fa fa-check"></i><b>7.1.4</b> Plot the data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Data visualisation</b></span></li>
<li class="chapter" data-level="8" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html"><i class="fa fa-check"></i><b>8</b> Visualising data with <code>ggplot</code></a>
<ul>
<li class="chapter" data-level="8.1" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#histograms"><i class="fa fa-check"></i><b>8.1</b> Histograms</a></li>
<li class="chapter" data-level="8.2" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#facets---splitting-data-across-panels"><i class="fa fa-check"></i><b>8.2</b> “Facets” - splitting data across panels</a></li>
<li class="chapter" data-level="8.3" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#box-plots"><i class="fa fa-check"></i><b>8.3</b> Box plots</a></li>
<li class="chapter" data-level="8.4" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#lines-and-points"><i class="fa fa-check"></i><b>8.4</b> Lines and points</a></li>
<li class="chapter" data-level="8.5" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#scatter-plots"><i class="fa fa-check"></i><b>8.5</b> Scatter plots</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html"><i class="fa fa-check"></i><b>9</b> Distributions and summarising data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#distributions"><i class="fa fa-check"></i><b>9.1</b> Distributions</a></li>
<li class="chapter" data-level="9.2" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#normal-distribution"><i class="fa fa-check"></i><b>9.2</b> Normal distribution</a></li>
<li class="chapter" data-level="9.3" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#comparing-normal-distributions"><i class="fa fa-check"></i><b>9.3</b> Comparing normal distributions</a></li>
<li class="chapter" data-level="9.4" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#poisson-distribution"><i class="fa fa-check"></i><b>9.4</b> Poisson distribution</a></li>
<li class="chapter" data-level="9.5" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#comparing-normal-and-poisson-distributions"><i class="fa fa-check"></i><b>9.5</b> Comparing normal and Poisson distributions</a></li>
<li class="chapter" data-level="9.6" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#the-law-of-large-numbers"><i class="fa fa-check"></i><b>9.6</b> The law of large numbers</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#coin-flipping"><i class="fa fa-check"></i><b>9.6.1</b> Coin flipping</a></li>
<li class="chapter" data-level="9.6.2" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#virtual-dice"><i class="fa fa-check"></i><b>9.6.2</b> Virtual dice</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html"><i class="fa fa-check"></i><b>10</b> Pimping your plots</a>
<ul>
<li class="chapter" data-level="10.1" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#a-basic-plot"><i class="fa fa-check"></i><b>10.1</b> A basic plot</a></li>
<li class="chapter" data-level="10.2" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#axis-limits"><i class="fa fa-check"></i><b>10.2</b> Axis limits</a></li>
<li class="chapter" data-level="10.3" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#transforming-the-axis-log-scale"><i class="fa fa-check"></i><b>10.3</b> Transforming the axis (log scale)</a></li>
<li class="chapter" data-level="10.4" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#changing-the-axis-tick-marks"><i class="fa fa-check"></i><b>10.4</b> Changing the axis tick marks</a></li>
<li class="chapter" data-level="10.5" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#axis-labels"><i class="fa fa-check"></i><b>10.5</b> Axis labels</a></li>
<li class="chapter" data-level="10.6" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#colours"><i class="fa fa-check"></i><b>10.6</b> Colours</a></li>
<li class="chapter" data-level="10.7" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#themes"><i class="fa fa-check"></i><b>10.7</b> Themes</a></li>
<li class="chapter" data-level="10.8" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#moving-the-legend"><i class="fa fa-check"></i><b>10.8</b> Moving the legend</a></li>
<li class="chapter" data-level="10.9" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#combining-multiple-plots"><i class="fa fa-check"></i><b>10.9</b> Combining multiple plots</a></li>
<li class="chapter" data-level="10.10" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#saving-your-plot"><i class="fa fa-check"></i><b>10.10</b> Saving your plot</a></li>
<li class="chapter" data-level="10.11" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#final-word-on-plots"><i class="fa fa-check"></i><b>10.11</b> Final word on plots</a></li>
</ul></li>
<li class="part"><span><b>III Statistics</b></span></li>
<li class="chapter" data-level="11" data-path="randomisation-tests.html"><a href="randomisation-tests.html"><i class="fa fa-check"></i><b>11</b> Randomisation Tests</a>
<ul>
<li class="chapter" data-level="11.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#randomisation-test-in-r"><i class="fa fa-check"></i><b>11.1</b> Randomisation test in R</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#calculate-the-observed-difference"><i class="fa fa-check"></i><b>11.1.1</b> Calculate the observed difference</a></li>
<li class="chapter" data-level="11.1.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#null-distribution"><i class="fa fa-check"></i><b>11.1.2</b> Null distribution</a></li>
<li class="chapter" data-level="11.1.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-significance"><i class="fa fa-check"></i><b>11.1.3</b> Testing significance</a></li>
<li class="chapter" data-level="11.1.4" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-the-hypothesis"><i class="fa fa-check"></i><b>11.1.4</b> Testing the hypothesis</a></li>
<li class="chapter" data-level="11.1.5" data-path="randomisation-tests.html"><a href="randomisation-tests.html#writing-it-up"><i class="fa fa-check"></i><b>11.1.5</b> Writing it up</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#paired-randomisation-tests"><i class="fa fa-check"></i><b>11.2</b> Paired Randomisation Tests</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-randomisation-test"><i class="fa fa-check"></i><b>11.2.1</b> The randomisation test</a></li>
<li class="chapter" data-level="11.2.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#null-distribution-1"><i class="fa fa-check"></i><b>11.2.2</b> Null distribution</a></li>
<li class="chapter" data-level="11.2.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-formal-hypothesis-test"><i class="fa fa-check"></i><b>11.2.3</b> The formal hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#exercise-sexual-selection-in-hercules-beetles"><i class="fa fa-check"></i><b>11.3</b> Exercise: Sexual selection in Hercules beetles</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html"><i class="fa fa-check"></i><b>12</b> Comparing two means with a t-test</a>
<ul>
<li class="chapter" data-level="12.1" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#some-theory"><i class="fa fa-check"></i><b>12.1</b> Some theory</a></li>
<li class="chapter" data-level="12.2" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#one-sample-t-test"><i class="fa fa-check"></i><b>12.2</b> One sample t-test</a></li>
<li class="chapter" data-level="12.3" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#doing-it-by-hand---where-does-the-t-statistic-come-from"><i class="fa fa-check"></i><b>12.3</b> Doing it “by hand” - where does the t-statistic come from?</a></li>
<li class="chapter" data-level="12.4" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#paired-t-test"><i class="fa fa-check"></i><b>12.4</b> Paired t-test</a></li>
<li class="chapter" data-level="12.5" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#a-paired-t-test-is-a-one-sample-test."><i class="fa fa-check"></i><b>12.5</b> A paired t-test is a one-sample test.</a></li>
<li class="chapter" data-level="12.6" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#two-sample-t-test"><i class="fa fa-check"></i><b>12.6</b> Two sample t-test</a></li>
<li class="chapter" data-level="12.7" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#t-tests-are-linear-models"><i class="fa fa-check"></i><b>12.7</b> t-tests are linear models</a></li>
<li class="chapter" data-level="12.8" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-sex-differences-in-fine-motor-skills"><i class="fa fa-check"></i><b>12.8</b> Exercise: Sex differences in fine motor skills</a></li>
<li class="chapter" data-level="12.9" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-therapy-for-anorexia"><i class="fa fa-check"></i><b>12.9</b> Exercise: Therapy for anorexia</a></li>
<li class="chapter" data-level="12.10" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-compare-t-tests-with-randomisation-tests"><i class="fa fa-check"></i><b>12.10</b> Exercise: Compare t-tests with randomisation tests</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html"><i class="fa fa-check"></i><b>13</b> Linear models with a single categorical explanatory variable</a>
<ul>
<li class="chapter" data-level="13.1" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#one-way-anova"><i class="fa fa-check"></i><b>13.1</b> One-way ANOVA</a></li>
<li class="chapter" data-level="13.2" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#fitting-an-anova-in-r"><i class="fa fa-check"></i><b>13.2</b> Fitting an ANOVA in R</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#where-are-the-differences"><i class="fa fa-check"></i><b>13.2.1</b> Where are the differences?</a></li>
<li class="chapter" data-level="13.2.2" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#tukeys-honestly-significant-difference-hsd"><i class="fa fa-check"></i><b>13.2.2</b> Tukey’s Honestly Significant Difference (HSD)</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#anova-calculation-by-hand."><i class="fa fa-check"></i><b>13.3</b> ANOVA calculation “by hand”.</a></li>
<li class="chapter" data-level="13.4" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#exercise-apple-tree-crop-yield"><i class="fa fa-check"></i><b>13.4</b> Exercise: Apple tree crop yield</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html"><i class="fa fa-check"></i><b>14</b> Linear models with a single continuous explanatory variable</a>
<ul>
<li class="chapter" data-level="14.1" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#some-theory"><i class="fa fa-check"></i><b>14.1</b> Some theory</a></li>
<li class="chapter" data-level="14.2" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#evaluating-a-hypothesis-with-a-linear-regression-model"><i class="fa fa-check"></i><b>14.2</b> Evaluating a hypothesis with a linear regression model</a></li>
<li class="chapter" data-level="14.3" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#assumptions"><i class="fa fa-check"></i><b>14.3</b> Assumptions</a></li>
<li class="chapter" data-level="14.4" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#worked-example-height-hand-width-relationship"><i class="fa fa-check"></i><b>14.4</b> Worked example: height-hand width relationship</a></li>
<li class="chapter" data-level="14.5" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#exercise-chirping-crickets"><i class="fa fa-check"></i><b>14.5</b> Exercise: Chirping crickets</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html"><i class="fa fa-check"></i><b>15</b> Linear models with categorical and continuous explanatory variables</a>
<ul>
<li class="chapter" data-level="15.1" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#the-height-hand-width-example."><i class="fa fa-check"></i><b>15.1</b> The height ~ hand width example.</a></li>
<li class="chapter" data-level="15.2" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#summarising-with-anova"><i class="fa fa-check"></i><b>15.2</b> Summarising with <code>anova</code></a></li>
<li class="chapter" data-level="15.3" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#the-summary-of-coefficients-summary"><i class="fa fa-check"></i><b>15.3</b> The summary of coefficients (<code>summary</code>)</a></li>
<li class="chapter" data-level="15.4" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#simplifying-the-model"><i class="fa fa-check"></i><b>15.4</b> Simplifying the model</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html"><i class="fa fa-check"></i><b>16</b> Linear models with &gt;1 categorical explanatory variables</a>
<ul>
<li class="chapter" data-level="16.1" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#fitting-a-two-way-anova-model"><i class="fa fa-check"></i><b>16.1</b> Fitting a two-way ANOVA model</a></li>
<li class="chapter" data-level="16.2" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#summarising-the-model-anova"><i class="fa fa-check"></i><b>16.2</b> Summarising the model (<code>anova</code>)</a></li>
<li class="chapter" data-level="16.3" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#summarising-the-model-summary"><i class="fa fa-check"></i><b>16.3</b> Summarising the model (<code>summary</code>)</a></li>
<li class="chapter" data-level="16.4" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#exercise-fish-behaviour"><i class="fa fa-check"></i><b>16.4</b> Exercise: Fish behaviour</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html"><i class="fa fa-check"></i><b>17</b> Generalised linear models</a>
<ul>
<li class="chapter" data-level="17.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#count-data-with-poisson-errors."><i class="fa fa-check"></i><b>17.1</b> Count data with Poisson errors.</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-number-of-offspring-in-foxes."><i class="fa fa-check"></i><b>17.1.1</b> Example: Number of offspring in foxes.</a></li>
<li class="chapter" data-level="17.1.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-cancer-clusters"><i class="fa fa-check"></i><b>17.1.2</b> Example: Cancer clusters</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#exercise-maze-runner"><i class="fa fa-check"></i><b>17.2</b> Exercise: Maze runner</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html"><i class="fa fa-check"></i><b>18</b> Extending use cases of GLM</a>
<ul>
<li class="chapter" data-level="18.1" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#binomial-response-data"><i class="fa fa-check"></i><b>18.1</b> Binomial response data</a></li>
<li class="chapter" data-level="18.2" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-nfl-field-goals"><i class="fa fa-check"></i><b>18.2</b> Example: NFL field goals</a></li>
<li class="chapter" data-level="18.3" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-sex-ratio-in-turtles"><i class="fa fa-check"></i><b>18.3</b> Example: Sex ratio in turtles</a></li>
<li class="chapter" data-level="18.4" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-smoking"><i class="fa fa-check"></i><b>18.4</b> Example: Smoking</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html"><i class="fa fa-check"></i><b>19</b> Power analysis by simulation</a>
<ul>
<li class="chapter" data-level="19.1" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#type-i-and-ii-errors-and-statistical-power"><i class="fa fa-check"></i><b>19.1</b> Type I and II errors and statistical power</a></li>
<li class="chapter" data-level="19.2" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#what-determines-statistical-power"><i class="fa fa-check"></i><b>19.2</b> What determines statistical power?</a></li>
<li class="chapter" data-level="19.3" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#an-example-of-calculating-statistical-power."><i class="fa fa-check"></i><b>19.3</b> An example of calculating statistical power.</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#the-simulation"><i class="fa fa-check"></i><b>19.3.1</b> The simulation</a></li>
<li class="chapter" data-level="19.3.2" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#some-questions-for-you-to-address"><i class="fa fa-check"></i><b>19.3.2</b> Some questions for you to address:</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#summary"><i class="fa fa-check"></i><b>19.4</b> Summary</a></li>
<li class="chapter" data-level="19.5" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#extending-the-simulation-optional-advanced"><i class="fa fa-check"></i><b>19.5</b> Extending the simulation (optional, advanced)</a></li>
<li class="chapter" data-level="19.6" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#exercise-1-snails-on-the-move"><i class="fa fa-check"></i><b>19.6</b> Exercise 1: Snails on the move</a></li>
<li class="chapter" data-level="19.7" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#exercise-2-mouse-lemur-strength"><i class="fa fa-check"></i><b>19.7</b> Exercise 2: Mouse lemur strength</a></li>
</ul></li>
<li class="part"><span><b>IV Coming soon(ish)</b></span></li>
<li class="chapter" data-level="20" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html"><i class="fa fa-check"></i><b>20</b> Coming soon (maybe)!</a>
<ul>
<li class="chapter" data-level="20.1" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#multivariate-statistics"><i class="fa fa-check"></i><b>20.1</b> Multivariate statistics</a></li>
<li class="chapter" data-level="20.2" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#transforming-variables"><i class="fa fa-check"></i><b>20.2</b> Transforming variables</a></li>
<li class="chapter" data-level="20.3" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#non-linear-regression"><i class="fa fa-check"></i><b>20.3</b> Non-linear regression</a></li>
<li class="chapter" data-level="20.4" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#nested-or-blocked-study-designs"><i class="fa fa-check"></i><b>20.4</b> Nested or blocked study designs</a></li>
</ul></li>
<li class="part"><span><b>V Exam</b></span></li>
<li class="chapter" data-level="21" data-path="exam-2020.html"><a href="exam-2020.html"><i class="fa fa-check"></i><b>21</b> Exam 2020</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BB852 - Data handling, visualisation and statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualising-data-with-ggplot" class="section level1" number="8">
<h1><span class="header-section-number">Chapter 8</span> Visualising data with <code>ggplot</code></h1>
<p>In this chapter you will be guided through using the <code>ggplot2</code> package to make some pretty plots. You will therefore need the <code>ggplot2</code> package to make this work. Remember, you can load packages like this:</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="visualising-data-with-ggplot.html#cb230-1" aria-hidden="true"></a><span class="kw">library</span>(ggplot2)</span></code></pre></div>
<p>We will use the SDU birds clutch size data that we produced at the end of the “[Data wrangling with dplyr]” chapter for these examples. You can find the data set via the Course Data Dropbox link.</p>
<div class="do-something">
<p>
Remember to set your working directory, and start a new script. I am assuming that you have saved your data in a folder called “CourseData” inside your working directory.
</p>
</div>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="visualising-data-with-ggplot.html#cb231-1" aria-hidden="true"></a>df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;CourseData/SDUClutchSize.csv&quot;</span>)</span></code></pre></div>
<div id="histograms" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Histograms</h2>
<p>The <code>ggplot</code> function expects two main arguments (1) the data and (2) the <strong>aesthetics</strong>. The aesthetics are the variables you want to plot, and associated characteristics like colours, groupings etc. The first argument is for the data, then the aesthetics are specified within the <code>aes(...)</code> argument. These usually include an argument for <code>x</code> which is normally the variable that appears on the horizontal axis, and (often) <code>y</code> which is usually the variable on the vertical axis. The details of this depend on the type of plot you are making.</p>
<p>After setting up the plot the graphics are added as <strong>geometric layers</strong> or <strong>geoms</strong>. There are many of these available including <code>geom_histogram</code>, <code>geom_line</code>, <code>geom_point</code> etc.</p>
<p>I will illustrate the construction of a simple plot by making a histogram of the clutch size of all the nests in the dataset.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="visualising-data-with-ggplot.html#cb232-1" aria-hidden="true"></a><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> clutchSize))</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-126-1.png" width="672" /></p>
<p>This produces an empty plot because we have not yet specified what kind of plot we want. We want a histogram, so we can add this as follows. I have set <code>binwidth</code> to be 1 because we know we are dealing with counts between just 1 and 14. Try altering the <code>binwidth</code>.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="visualising-data-with-ggplot.html#cb233-1" aria-hidden="true"></a><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> clutchSize)) <span class="op">+</span></span>
<span id="cb233-2"><a href="visualising-data-with-ggplot.html#cb233-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-127-1.png" width="672" />
We know that we have two species here and we would like to compare them. This is done within the aesthetic argument. The default is that the bars for different categories are stacked on top of each other. This is good in some cases, but probably not here.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="visualising-data-with-ggplot.html#cb234-1" aria-hidden="true"></a><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> clutchSize,<span class="dt">fill =</span> species)) <span class="op">+</span></span>
<span id="cb234-2"><a href="visualising-data-with-ggplot.html#cb234-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>,<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-128-1.png" width="672" /></p>
<p>You can immediately see that there are far fewer blue tit nests than great tit ones. But you can also see that the center of mass for blue tits is further to the right than great tits.</p>
<p>To make it easier to compare distributions with very different counts, we can put density on the y-axis instead of the default count using the argument <code>stat(density)</code>.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="visualising-data-with-ggplot.html#cb235-1" aria-hidden="true"></a><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> clutchSize, <span class="dt">fill =</span> species, <span class="kw">stat</span>(density))) <span class="op">+</span></span>
<span id="cb235-2"><a href="visualising-data-with-ggplot.html#cb235-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>,<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-129-1.png" width="672" /></p>
<p>An alternative approach would be to overlay the two sets of bars (using <code>position = "identity"</code>) and set the colours to be slightly transparent (using <code>alpha = 0.7</code>) so that you can see the overlapping region clearly.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="visualising-data-with-ggplot.html#cb236-1" aria-hidden="true"></a><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> clutchSize, <span class="dt">fill =</span> species, <span class="kw">stat</span>(density))) <span class="op">+</span></span>
<span id="cb236-2"><a href="visualising-data-with-ggplot.html#cb236-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>,<span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>,<span class="dt">alpha=</span><span class="fl">0.7</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-130-1.png" width="672" /></p>
<p>It is very clear from this plot that blue tits tend to have bigger clutch sizes than great tits. Is this difference <em>statistically significant</em>? We will look at testing this in a future class - for now we will be satisfied with our visualisation.</p>
</div>
<div id="facets---splitting-data-across-panels" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> “Facets” - splitting data across panels</h2>
<p>You should recall that there were several years of data represented here.
<code>ggplot</code> has a very clever way of splitting up the plot to examine this.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="visualising-data-with-ggplot.html#cb237-1" aria-hidden="true"></a><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> clutchSize, <span class="dt">fill =</span> species, <span class="kw">stat</span>(density))) <span class="op">+</span></span>
<span id="cb237-2"><a href="visualising-data-with-ggplot.html#cb237-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>,<span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>,<span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb237-3"><a href="visualising-data-with-ggplot.html#cb237-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">facet_grid</span>(.<span class="op">~</span>Year)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-131-1.png" width="672" /></p>
<p>You could split the data up by species in a similar way, as yet another way of visualising the difference between species:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="visualising-data-with-ggplot.html#cb238-1" aria-hidden="true"></a><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> clutchSize)) <span class="op">+</span></span>
<span id="cb238-2"><a href="visualising-data-with-ggplot.html#cb238-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb238-3"><a href="visualising-data-with-ggplot.html#cb238-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">facet_grid</span>(species<span class="op">~</span>.)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-132-1.png" width="672" /></p>
<div class="do-something">
<p>
You can change whether the separate graphs are presented in a rows or columns by changing the order of the argument: <code>facet_grid(species~.)</code> or <code>facet_grid(.~species)</code>. Try it.
</p>
</div>
</div>
<div id="box-plots" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Box plots</h2>
<p>Box plots are suitable for cases where one variable is categorical with 2+ levels, and the other is continuous. Therefore, another way to look at these distributions is to use a box plot.</p>
<p>In a box plot the box shows the quartiles (i.e. the 25% and 75% quantiles) within which 50% of the data are found. The horizontal line in the box is the <em>median</em>, Then the whiskers extend from the smallest to largest value <em>unless they are further than 1.5 times the interquartile range (the length of the box)</em> away from the edge of the box, in which case they are individually shown as outlier points.</p>
<p>To plot them using <code>ggplot</code> you must use a <code>geom_boxplot</code> layer.
The categorical variable is normally placed on the x-axis so is placed as <code>x</code> in the <code>aes</code> argument, while the continuous variable is on the <code>y</code> axis.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="visualising-data-with-ggplot.html#cb239-1" aria-hidden="true"></a><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> species, <span class="dt">y =</span> clutchSize)) <span class="op">+</span></span>
<span id="cb239-2"><a href="visualising-data-with-ggplot.html#cb239-2" aria-hidden="true"></a><span class="st">         </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-134-1.png" width="672" /></p>
<p>Some researchers argue that it is a good idea to add the data as points to these plots as “full disclosure” of what the underlying data look like. These can be added with a <code>geom_jitter</code> layer (jitter is random noise added in this case to the horizontal axis). You should set <code>width</code> and <code>alpha</code> arguments to make it look nice.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="visualising-data-with-ggplot.html#cb240-1" aria-hidden="true"></a><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> species, <span class="dt">y =</span> clutchSize)) <span class="op">+</span></span>
<span id="cb240-2"><a href="visualising-data-with-ggplot.html#cb240-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb240-3"><a href="visualising-data-with-ggplot.html#cb240-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.2</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>,<span class="dt">fill=</span><span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-135-1.png" width="672" /></p>
<div class="do-something">
<p>
Try splitting the data into different years using <code>facet_grid</code> with the box plot.
</p>
</div>
</div>
<div id="lines-and-points" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Lines and points</h2>
<p>Perhaps not surprisingly lines and points can be added with the geoms, <code>geom_line</code> and <code>geom_point</code> respectively.
To illustrate this we will make a plot showing how clutch size changes among years.
First we will use <code>summarise</code> to create a dataset with the mean clutch size. We’ll start simply, by looking at only great tits.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="visualising-data-with-ggplot.html#cb241-1" aria-hidden="true"></a>GTclutch &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb241-2"><a href="visualising-data-with-ggplot.html#cb241-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(species <span class="op">==</span><span class="st"> &quot;GT&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb241-3"><a href="visualising-data-with-ggplot.html#cb241-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(Year) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb241-4"><a href="visualising-data-with-ggplot.html#cb241-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">meanClutchSize =</span> <span class="kw">mean</span>(clutchSize))</span></code></pre></div>
<p>Then you can plot this like this.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="visualising-data-with-ggplot.html#cb242-1" aria-hidden="true"></a><span class="kw">ggplot</span>(GTclutch, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> meanClutchSize)) <span class="op">+</span></span>
<span id="cb242-2"><a href="visualising-data-with-ggplot.html#cb242-2" aria-hidden="true"></a><span class="st">         </span><span class="kw">geom_line</span>()</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-138-1.png" width="672" /></p>
<p>I think this looks OK, but we should add both species. I’ll first need to produce a mean clutch size dataset that includes both species.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="visualising-data-with-ggplot.html#cb243-1" aria-hidden="true"></a>meanClutch &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb243-2"><a href="visualising-data-with-ggplot.html#cb243-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(species,Year) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb243-3"><a href="visualising-data-with-ggplot.html#cb243-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">meanClutchSize =</span> <span class="kw">mean</span>(clutchSize))</span></code></pre></div>
<p>Now I can do the plot again. The only difference to the command is that I need to tell R that I want to colour the lines by species (<code>colour = species</code>).</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="visualising-data-with-ggplot.html#cb244-1" aria-hidden="true"></a><span class="kw">ggplot</span>(meanClutch, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> meanClutchSize, <span class="dt">colour =</span> species)) <span class="op">+</span></span>
<span id="cb244-2"><a href="visualising-data-with-ggplot.html#cb244-2" aria-hidden="true"></a><span class="st">         </span><span class="kw">geom_line</span>()</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
<p>I can improve on this by (1) changing the y axis limits (using <code>ylim</code>) so that it goes through the full range of my data (0 - 14); (2) adding points (using a <code>geom_point</code> layer) where my actual data values are; (3) adding a nicely formatted axis label (using <code>ylab</code>); adding a title (<code>ggtitle</code>)</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="visualising-data-with-ggplot.html#cb245-1" aria-hidden="true"></a><span class="kw">ggplot</span>(meanClutch, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> meanClutchSize, <span class="dt">colour =</span> species)) <span class="op">+</span></span>
<span id="cb245-2"><a href="visualising-data-with-ggplot.html#cb245-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb245-3"><a href="visualising-data-with-ggplot.html#cb245-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb245-4"><a href="visualising-data-with-ggplot.html#cb245-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">14</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb245-5"><a href="visualising-data-with-ggplot.html#cb245-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Mean clutch size&quot;</span>) <span class="op">+</span></span>
<span id="cb245-6"><a href="visualising-data-with-ggplot.html#cb245-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Clutch size data from SDU Campus&quot;</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-141-1.png" width="672" /></p>
</div>
<div id="scatter-plots" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Scatter plots</h2>
<p>Finally, lets make a scatter plot.
The SDU bird data are not suitable for this type of plot so we’ll use the data from a few days ago on suburban bird diversity.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="visualising-data-with-ggplot.html#cb246-1" aria-hidden="true"></a>df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;CourseData/suburbanBirds.csv&quot;</span>)</span></code></pre></div>
<p>Take a look at the data to remind ourselves what it looks like</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="visualising-data-with-ggplot.html#cb247-1" aria-hidden="true"></a><span class="kw">head</span>(df)</span></code></pre></div>
<pre><code>##          Name Year HabitatIndex nIndividuals nSpecies
## 1    Alamotos 1946         10.0           48       12
## 2      Ramona 1946          9.5           30       13
## 3      Verona 1947          9.5           38       15
## 4 Valle Vista 1950          9.5           42       11
## 5    La Gonda 1955         11.0           44       13
## 6     Belgian 1956          9.0           27       14</code></pre>
<p>These data show the result of standardised bird surveys at housing developments of different ages in California. The surveys were carried out in 1975, and the data includes the <code>Year</code> and number of individual birds seen <code>nIndividuals</code> and number of species seen <code>nSpecies</code>. The question being addressed is “How does the age of the housing development affect the number of species?”</p>
<p>To investigate this we should first add a new variable for <code>Age</code> to the data set. We can do this using the <code>mutate</code> function from <code>dplyr</code>. This function creates new variables, for example by manipulating existing ones.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="visualising-data-with-ggplot.html#cb249-1" aria-hidden="true"></a>df &lt;-<span class="st"> </span><span class="kw">mutate</span>(df,<span class="dt">Age =</span> <span class="dv">1975</span> <span class="op">-</span><span class="st"> </span>Year)</span></code></pre></div>
<p>When we have created this variable we can plot the data. For aesthetic reasons I also would like to set the limits on the y-axis to go extend to zero, and I would like to include proper labels on the axes.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="visualising-data-with-ggplot.html#cb250-1" aria-hidden="true"></a><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> Age,<span class="dt">y =</span> nSpecies)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb250-2"><a href="visualising-data-with-ggplot.html#cb250-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb250-3"><a href="visualising-data-with-ggplot.html#cb250-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb250-4"><a href="visualising-data-with-ggplot.html#cb250-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Age of development&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Bird species richness&quot;</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-145-1.png" width="672" /></p>
<p>This shows very clearly that older developments have more species, but it also appears to show that there is an asymptote around 13 species.</p>
<p>Compare this plot to the one you made with base graphics in a previous class.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exercise-temperature-effects-on-egg-laying-dates.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="distributions-and-summarising-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jonesor/BB852_Book/edit/master/2_01-visualisingData.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["BB852.pdf"],
"toc": {
"collapse": "section"
},
"split_by": "section"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
