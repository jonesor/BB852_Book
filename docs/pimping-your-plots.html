<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Pimping your plots | BB852 - Data handling, visualisation and statistics</title>
  <meta name="description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Pimping your plots | BB852 - Data handling, visualisation and statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Pimping your plots | BB852 - Data handling, visualisation and statistics" />
  
  <meta name="twitter:description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  

<meta name="author" content="Owen R. Jones" />


<meta name="date" content="2020-12-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="distributions-and-summarising-data.html"/>
<link rel="next" href="randomisation-tests.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.0.0/tabwid.js"></script>
<style type="text/css">

.warning-box {
  border: 3px solid #e60000;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

.advanced-box {
  border: 3px solid #268bd2;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

.do-something {
  border: 3px solid #803e00;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

</style>





<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BB852</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data-wrangling"><i class="fa fa-check"></i><b>1.1</b> Data wrangling</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-visualisation"><i class="fa fa-check"></i><b>1.2</b> Data visualisation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#statistics"><i class="fa fa-check"></i><b>1.3</b> Statistics</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#data-sources"><i class="fa fa-check"></i><b>1.4</b> Data sources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#your-instructors"><i class="fa fa-check"></i><b>1.5</b> Your instructors</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.6</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i><b>2</b> Schedule</a>
<ul>
<li class="chapter" data-level="2.1" data-path="schedule.html"><a href="schedule.html#additional-recommended-reading"><i class="fa fa-check"></i><b>2.1</b> Additional recommended reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="an-r-refresher.html"><a href="an-r-refresher.html"><i class="fa fa-check"></i><b>3</b> An R refresher</a>
<ul>
<li class="chapter" data-level="3.1" data-path="an-r-refresher.html"><a href="an-r-refresher.html#getting-started-with-r"><i class="fa fa-check"></i><b>3.1</b> Getting started with R</a></li>
<li class="chapter" data-level="3.2" data-path="an-r-refresher.html"><a href="an-r-refresher.html#getting-help"><i class="fa fa-check"></i><b>3.2</b> Getting help</a></li>
<li class="chapter" data-level="3.3" data-path="an-r-refresher.html"><a href="an-r-refresher.html#r-as-a-fancy-calculator"><i class="fa fa-check"></i><b>3.3</b> R as a fancy calculator</a></li>
<li class="chapter" data-level="3.4" data-path="an-r-refresher.html"><a href="an-r-refresher.html#objects-in-r"><i class="fa fa-check"></i><b>3.4</b> Objects in R</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="manipulating-objects.html"><a href="manipulating-objects.html"><i class="fa fa-check"></i><b>4</b> Manipulating objects</a>
<ul>
<li class="chapter" data-level="4.1" data-path="manipulating-objects.html"><a href="manipulating-objects.html#missing-values-infinity-and-non-numbers"><i class="fa fa-check"></i><b>4.1</b> Missing values, infinity and “non-numbers”</a></li>
<li class="chapter" data-level="4.2" data-path="manipulating-objects.html"><a href="manipulating-objects.html#basic-information-about-objects"><i class="fa fa-check"></i><b>4.2</b> Basic information about objects</a></li>
<li class="chapter" data-level="4.3" data-path="manipulating-objects.html"><a href="manipulating-objects.html#data-frames"><i class="fa fa-check"></i><b>4.3</b> Data frames</a></li>
<li class="chapter" data-level="4.4" data-path="manipulating-objects.html"><a href="manipulating-objects.html#organising-your-work"><i class="fa fa-check"></i><b>4.4</b> Organising your work</a></li>
<li class="chapter" data-level="4.5" data-path="manipulating-objects.html"><a href="manipulating-objects.html#inspecting-the-data"><i class="fa fa-check"></i><b>4.5</b> Inspecting the data</a></li>
<li class="chapter" data-level="4.6" data-path="manipulating-objects.html"><a href="manipulating-objects.html#classes-in-r"><i class="fa fa-check"></i><b>4.6</b> “Classes” in R</a></li>
<li class="chapter" data-level="4.7" data-path="manipulating-objects.html"><a href="manipulating-objects.html#tables-and-summary-statistics"><i class="fa fa-check"></i><b>4.7</b> Tables and summary statistics</a></li>
<li class="chapter" data-level="4.8" data-path="manipulating-objects.html"><a href="manipulating-objects.html#plotting-data"><i class="fa fa-check"></i><b>4.8</b> Plotting data</a></li>
<li class="chapter" data-level="4.9" data-path="manipulating-objects.html"><a href="manipulating-objects.html#r-packages"><i class="fa fa-check"></i><b>4.9</b> R Packages</a></li>
<li class="chapter" data-level="4.10" data-path="manipulating-objects.html"><a href="manipulating-objects.html#exercise-californian-bird-diversity"><i class="fa fa-check"></i><b>4.10</b> Exercise: Californian bird diversity</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="manipulating-objects.html"><a href="manipulating-objects.html#the-data"><i class="fa fa-check"></i><b>4.10.1</b> The data</a></li>
<li class="chapter" data-level="4.10.2" data-path="manipulating-objects.html"><a href="manipulating-objects.html#try-the-following"><i class="fa fa-check"></i><b>4.10.2</b> Try the following</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Wrangling</b></span></li>
<li class="chapter" data-level="5" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html"><i class="fa fa-check"></i><b>5</b> Data wrangling with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#select"><i class="fa fa-check"></i><b>5.1</b> <code>select</code></a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#filter"><i class="fa fa-check"></i><b>5.2</b> <code>filter</code></a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#arrange"><i class="fa fa-check"></i><b>5.3</b> <code>arrange</code></a></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#summarise-and-group_by"><i class="fa fa-check"></i><b>5.4</b> <code>summarise</code> and <code>group_by</code></a></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#using-pipes-saving-data."><i class="fa fa-check"></i><b>5.5</b> Using pipes, saving data.</a></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#exercise-wrangling-the-amniote-life-history-database"><i class="fa fa-check"></i><b>5.6</b> Exercise: Wrangling the Amniote Life History Database</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="combining-data-sets.html"><a href="combining-data-sets.html"><i class="fa fa-check"></i><b>6</b> Combining data sets</a>
<ul>
<li class="chapter" data-level="6.1" data-path="combining-data-sets.html"><a href="combining-data-sets.html#using-join"><i class="fa fa-check"></i><b>6.1</b> Using <code>join</code></a></li>
<li class="chapter" data-level="6.2" data-path="combining-data-sets.html"><a href="combining-data-sets.html#using-pivot_longer"><i class="fa fa-check"></i><b>6.2</b> Using <code>pivot_longer</code></a></li>
<li class="chapter" data-level="6.3" data-path="combining-data-sets.html"><a href="combining-data-sets.html#exercise-temperature-effects-on-egg-laying-dates"><i class="fa fa-check"></i><b>6.3</b> Exercise: Temperature effects on egg laying dates</a></li>
</ul></li>
<li class="part"><span><b>II Data visualisation</b></span></li>
<li class="chapter" data-level="7" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html"><i class="fa fa-check"></i><b>7</b> Visualising data with <code>ggplot</code></a>
<ul>
<li class="chapter" data-level="7.1" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#histograms"><i class="fa fa-check"></i><b>7.1</b> Histograms</a></li>
<li class="chapter" data-level="7.2" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#facets---splitting-data-across-panels"><i class="fa fa-check"></i><b>7.2</b> “Facets” - splitting data across panels</a></li>
<li class="chapter" data-level="7.3" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#box-plots"><i class="fa fa-check"></i><b>7.3</b> Box plots</a></li>
<li class="chapter" data-level="7.4" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#lines-and-points"><i class="fa fa-check"></i><b>7.4</b> Lines and points</a></li>
<li class="chapter" data-level="7.5" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#scatter-plots"><i class="fa fa-check"></i><b>7.5</b> Scatter plots</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html"><i class="fa fa-check"></i><b>8</b> Distributions and summarising data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#distributions"><i class="fa fa-check"></i><b>8.1</b> Distributions</a></li>
<li class="chapter" data-level="8.2" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#normal-distribution"><i class="fa fa-check"></i><b>8.2</b> Normal distribution</a></li>
<li class="chapter" data-level="8.3" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#comparing-normal-distributions"><i class="fa fa-check"></i><b>8.3</b> Comparing normal distributions</a></li>
<li class="chapter" data-level="8.4" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#poisson-distribution"><i class="fa fa-check"></i><b>8.4</b> Poisson distribution</a></li>
<li class="chapter" data-level="8.5" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#comparing-normal-and-poisson-distributions"><i class="fa fa-check"></i><b>8.5</b> Comparing normal and Poisson distributions</a></li>
<li class="chapter" data-level="8.6" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#the-law-of-large-numbers"><i class="fa fa-check"></i><b>8.6</b> The law of large numbers</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#coin-flipping"><i class="fa fa-check"></i><b>8.6.1</b> Coin flipping</a></li>
<li class="chapter" data-level="8.6.2" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#virtual-dice"><i class="fa fa-check"></i><b>8.6.2</b> Virtual dice</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html"><i class="fa fa-check"></i><b>9</b> Pimping your plots</a>
<ul>
<li class="chapter" data-level="9.1" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#a-basic-plot"><i class="fa fa-check"></i><b>9.1</b> A basic plot</a></li>
<li class="chapter" data-level="9.2" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#axis-limits"><i class="fa fa-check"></i><b>9.2</b> Axis limits</a></li>
<li class="chapter" data-level="9.3" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#transforming-the-axis-log-scale"><i class="fa fa-check"></i><b>9.3</b> Transforming the axis (log scale)</a></li>
<li class="chapter" data-level="9.4" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#changing-the-axis-tick-marks"><i class="fa fa-check"></i><b>9.4</b> Changing the axis tick marks</a></li>
<li class="chapter" data-level="9.5" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#axis-labels"><i class="fa fa-check"></i><b>9.5</b> Axis labels</a></li>
<li class="chapter" data-level="9.6" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#colours"><i class="fa fa-check"></i><b>9.6</b> Colours</a></li>
<li class="chapter" data-level="9.7" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#themes"><i class="fa fa-check"></i><b>9.7</b> Themes</a></li>
<li class="chapter" data-level="9.8" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#moving-the-legend"><i class="fa fa-check"></i><b>9.8</b> Moving the legend</a></li>
<li class="chapter" data-level="9.9" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#combining-multiple-plots"><i class="fa fa-check"></i><b>9.9</b> Combining multiple plots</a></li>
<li class="chapter" data-level="9.10" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#saving-your-plot"><i class="fa fa-check"></i><b>9.10</b> Saving your plot</a></li>
<li class="chapter" data-level="9.11" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#final-word-on-plots"><i class="fa fa-check"></i><b>9.11</b> Final word on plots</a></li>
</ul></li>
<li class="part"><span><b>III Statistics</b></span></li>
<li class="chapter" data-level="10" data-path="randomisation-tests.html"><a href="randomisation-tests.html"><i class="fa fa-check"></i><b>10</b> Randomisation Tests</a>
<ul>
<li class="chapter" data-level="10.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#randomisation-test-in-r"><i class="fa fa-check"></i><b>10.1</b> Randomisation test in R</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#calculate-the-observed-difference"><i class="fa fa-check"></i><b>10.1.1</b> Calculate the observed difference</a></li>
<li class="chapter" data-level="10.1.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#null-distribution"><i class="fa fa-check"></i><b>10.1.2</b> Null distribution</a></li>
<li class="chapter" data-level="10.1.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-significance"><i class="fa fa-check"></i><b>10.1.3</b> Testing significance</a></li>
<li class="chapter" data-level="10.1.4" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-the-hypothesis"><i class="fa fa-check"></i><b>10.1.4</b> Testing the hypothesis</a></li>
<li class="chapter" data-level="10.1.5" data-path="randomisation-tests.html"><a href="randomisation-tests.html#writing-it-up"><i class="fa fa-check"></i><b>10.1.5</b> Writing it up</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#paired-randomisation-tests"><i class="fa fa-check"></i><b>10.2</b> Paired Randomisation Tests</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-randomisation-test"><i class="fa fa-check"></i><b>10.2.1</b> The randomisation test</a></li>
<li class="chapter" data-level="10.2.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#null-distribution-1"><i class="fa fa-check"></i><b>10.2.2</b> Null distribution</a></li>
<li class="chapter" data-level="10.2.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-formal-hypothesis-test"><i class="fa fa-check"></i><b>10.2.3</b> The formal hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#exercise-sexual-selection-in-hercules-beetles"><i class="fa fa-check"></i><b>10.3</b> Exercise: Sexual selection in Hercules beetles</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html"><i class="fa fa-check"></i><b>11</b> Comparing two means with a t-test</a>
<ul>
<li class="chapter" data-level="11.1" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#some-theory"><i class="fa fa-check"></i><b>11.1</b> Some theory</a></li>
<li class="chapter" data-level="11.2" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#one-sample-t-test"><i class="fa fa-check"></i><b>11.2</b> One sample t-test</a></li>
<li class="chapter" data-level="11.3" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#doing-it-by-hand---where-does-the-t-statistic-come-from"><i class="fa fa-check"></i><b>11.3</b> Doing it “by hand” - where does the t-statistic come from?</a></li>
<li class="chapter" data-level="11.4" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#paired-t-test"><i class="fa fa-check"></i><b>11.4</b> Paired t-test</a></li>
<li class="chapter" data-level="11.5" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#a-paired-t-test-is-a-one-sample-test."><i class="fa fa-check"></i><b>11.5</b> A paired t-test is a one-sample test.</a></li>
<li class="chapter" data-level="11.6" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#two-sample-t-test"><i class="fa fa-check"></i><b>11.6</b> Two sample t-test</a></li>
<li class="chapter" data-level="11.7" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#t-tests-are-linear-models"><i class="fa fa-check"></i><b>11.7</b> t-tests are linear models</a></li>
<li class="chapter" data-level="11.8" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-sex-differences-in-fine-motor-skills"><i class="fa fa-check"></i><b>11.8</b> Exercise: Sex differences in fine motor skills</a></li>
<li class="chapter" data-level="11.9" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-therapy-for-anorexia"><i class="fa fa-check"></i><b>11.9</b> Exercise: Therapy for anorexia</a></li>
<li class="chapter" data-level="11.10" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-compare-t-tests-with-randomisation-tests"><i class="fa fa-check"></i><b>11.10</b> Exercise: Compare t-tests with randomisation tests</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html"><i class="fa fa-check"></i><b>12</b> Linear models with a single categorical explanatory variable</a>
<ul>
<li class="chapter" data-level="12.1" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#one-way-anova"><i class="fa fa-check"></i><b>12.1</b> One-way ANOVA</a></li>
<li class="chapter" data-level="12.2" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#fitting-an-anova-in-r"><i class="fa fa-check"></i><b>12.2</b> Fitting an ANOVA in R</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#where-are-the-differences"><i class="fa fa-check"></i><b>12.2.1</b> Where are the differences?</a></li>
<li class="chapter" data-level="12.2.2" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#tukeys-honestly-significant-difference-hsd"><i class="fa fa-check"></i><b>12.2.2</b> Tukey’s Honestly Significant Difference (HSD)</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#anova-calculation-by-hand."><i class="fa fa-check"></i><b>12.3</b> ANOVA calculation “by hand”.</a></li>
<li class="chapter" data-level="12.4" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#exercise-apple-tree-crop-yield"><i class="fa fa-check"></i><b>12.4</b> Exercise: Apple tree crop yield</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html"><i class="fa fa-check"></i><b>13</b> Linear models with a single continuous explanatory variable</a>
<ul>
<li class="chapter" data-level="13.1" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#some-theory"><i class="fa fa-check"></i><b>13.1</b> Some theory</a></li>
<li class="chapter" data-level="13.2" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#evaluating-a-hypothesis-with-a-linear-regression-model"><i class="fa fa-check"></i><b>13.2</b> Evaluating a hypothesis with a linear regression model</a></li>
<li class="chapter" data-level="13.3" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#assumptions"><i class="fa fa-check"></i><b>13.3</b> Assumptions</a></li>
<li class="chapter" data-level="13.4" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#worked-example-height-hand-width-relationship"><i class="fa fa-check"></i><b>13.4</b> Worked example: height-hand width relationship</a></li>
<li class="chapter" data-level="13.5" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#exercise-chirping-crickets"><i class="fa fa-check"></i><b>13.5</b> Exercise: Chirping crickets</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html"><i class="fa fa-check"></i><b>14</b> Linear models with categorical and continuous explanatory variables</a>
<ul>
<li class="chapter" data-level="14.1" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#the-height-hand-width-example."><i class="fa fa-check"></i><b>14.1</b> The height ~ hand width example.</a></li>
<li class="chapter" data-level="14.2" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#summarising-with-anova"><i class="fa fa-check"></i><b>14.2</b> Summarising with <code>anova</code></a></li>
<li class="chapter" data-level="14.3" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#the-summary-of-coefficients-summary"><i class="fa fa-check"></i><b>14.3</b> The summary of coefficients (<code>summary</code>)</a></li>
<li class="chapter" data-level="14.4" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#simplifying-the-model"><i class="fa fa-check"></i><b>14.4</b> Simplifying the model</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html"><i class="fa fa-check"></i><b>15</b> Linear models with &gt;1 categorical explanatory variables</a>
<ul>
<li class="chapter" data-level="15.1" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#fitting-a-two-way-anova-model"><i class="fa fa-check"></i><b>15.1</b> Fitting a two-way ANOVA model</a></li>
<li class="chapter" data-level="15.2" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#summarising-the-model-anova"><i class="fa fa-check"></i><b>15.2</b> Summarising the model (<code>anova</code>)</a></li>
<li class="chapter" data-level="15.3" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#summarising-the-model-summary"><i class="fa fa-check"></i><b>15.3</b> Summarising the model (<code>summary</code>)</a></li>
<li class="chapter" data-level="15.4" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#exercise-fish-behaviour"><i class="fa fa-check"></i><b>15.4</b> Exercise: Fish behaviour</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html"><i class="fa fa-check"></i><b>16</b> Generalised linear models</a>
<ul>
<li class="chapter" data-level="16.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#count-data-with-poisson-errors."><i class="fa fa-check"></i><b>16.1</b> Count data with Poisson errors.</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-number-of-offspring-in-foxes."><i class="fa fa-check"></i><b>16.1.1</b> Example: Number of offspring in foxes.</a></li>
<li class="chapter" data-level="16.1.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-cancer-clusters"><i class="fa fa-check"></i><b>16.1.2</b> Example: Cancer clusters</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#exercise-maze-runner"><i class="fa fa-check"></i><b>16.2</b> Exercise: Maze runner</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html"><i class="fa fa-check"></i><b>17</b> Extending use cases of GLM</a>
<ul>
<li class="chapter" data-level="17.1" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#binomial-response-data"><i class="fa fa-check"></i><b>17.1</b> Binomial response data</a></li>
<li class="chapter" data-level="17.2" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-nfl-field-goals"><i class="fa fa-check"></i><b>17.2</b> Example: NFL field goals</a></li>
<li class="chapter" data-level="17.3" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-sex-ratio-in-turtles"><i class="fa fa-check"></i><b>17.3</b> Example: Sex ratio in turtles</a></li>
<li class="chapter" data-level="17.4" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-smoking"><i class="fa fa-check"></i><b>17.4</b> Example: Smoking</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html"><i class="fa fa-check"></i><b>18</b> Power analysis by simulation</a>
<ul>
<li class="chapter" data-level="18.1" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#type-i-and-ii-errors-and-statistical-power"><i class="fa fa-check"></i><b>18.1</b> Type I and II errors and statistical power</a></li>
<li class="chapter" data-level="18.2" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#what-determines-statistical-power"><i class="fa fa-check"></i><b>18.2</b> What determines statistical power?</a></li>
<li class="chapter" data-level="18.3" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#an-example-of-calculating-statistical-power."><i class="fa fa-check"></i><b>18.3</b> An example of calculating statistical power.</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#the-simulation"><i class="fa fa-check"></i><b>18.3.1</b> The simulation</a></li>
<li class="chapter" data-level="18.3.2" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#some-questions-for-you-to-address"><i class="fa fa-check"></i><b>18.3.2</b> Some questions for you to address:</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#summary"><i class="fa fa-check"></i><b>18.4</b> Summary</a></li>
<li class="chapter" data-level="18.5" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#extending-the-simulation-optional-advanced"><i class="fa fa-check"></i><b>18.5</b> Extending the simulation (optional, advanced)</a></li>
<li class="chapter" data-level="18.6" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#exercise-1-snails-on-the-move"><i class="fa fa-check"></i><b>18.6</b> Exercise 1: Snails on the move</a></li>
<li class="chapter" data-level="18.7" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#exercise-2-mouse-lemur-strength"><i class="fa fa-check"></i><b>18.7</b> Exercise 2: Mouse lemur strength</a></li>
</ul></li>
<li class="part"><span><b>IV Coming soon(ish)</b></span></li>
<li class="chapter" data-level="19" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html"><i class="fa fa-check"></i><b>19</b> Coming soon (maybe)!</a>
<ul>
<li class="chapter" data-level="19.1" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#multivariate-statistics"><i class="fa fa-check"></i><b>19.1</b> Multivariate statistics</a></li>
<li class="chapter" data-level="19.2" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#transforming-variables"><i class="fa fa-check"></i><b>19.2</b> Transforming variables</a></li>
<li class="chapter" data-level="19.3" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#non-linear-regression"><i class="fa fa-check"></i><b>19.3</b> Non-linear regression</a></li>
<li class="chapter" data-level="19.4" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#nested-or-blocked-study-designs"><i class="fa fa-check"></i><b>19.4</b> Nested or blocked study designs</a></li>
</ul></li>
<li class="part"><span><b>V Exam</b></span></li>
<li class="chapter" data-level="20" data-path="exam-2020.html"><a href="exam-2020.html"><i class="fa fa-check"></i><b>20</b> Exam 2020</a></li>
<li class="part"><span><b>VI Solutions</b></span></li>
<li class="chapter" data-level="21" data-path="exercise-solutions.html"><a href="exercise-solutions.html"><i class="fa fa-check"></i><b>21</b> Exercise Solutions</a>
<ul>
<li class="chapter" data-level="21.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-californian-bird-diversity"><i class="fa fa-check"></i><b>21.1</b> Exercise Solutions: Californian bird diversity</a></li>
<li class="chapter" data-level="21.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-wrangling-the-amniote-life-history-database"><i class="fa fa-check"></i><b>21.2</b> Exercise Solutions: Wrangling the Amniote Life History Database</a></li>
<li class="chapter" data-level="21.3" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-temperature-effects-on-egg-laying-dates"><i class="fa fa-check"></i><b>21.3</b> Exercise Solutions: Temperature effects on egg laying dates</a></li>
<li class="chapter" data-level="21.4" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-sexual-selection-in-hercules-beetles"><i class="fa fa-check"></i><b>21.4</b> Exercise Solutions: Sexual selection in Hercules beetles</a></li>
<li class="chapter" data-level="21.5" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-sex-differences-in-fine-motor-skills"><i class="fa fa-check"></i><b>21.5</b> Exercise: Sex differences in fine motor skills</a></li>
<li class="chapter" data-level="21.6" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-therapy-for-anorexia"><i class="fa fa-check"></i><b>21.6</b> Exercise: Therapy for anorexia</a></li>
<li class="chapter" data-level="21.7" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-compare-t-tests-with-randomisation-tests"><i class="fa fa-check"></i><b>21.7</b> Exercise: Compare t-tests with randomisation tests</a></li>
<li class="chapter" data-level="21.8" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-apple-tree-crop-yield"><i class="fa fa-check"></i><b>21.8</b> Exercise Solutions: Apple tree crop yield</a></li>
<li class="chapter" data-level="21.9" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-chirping-crickets"><i class="fa fa-check"></i><b>21.9</b> Exercise Solutions: Chirping crickets</a></li>
<li class="chapter" data-level="21.10" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-fish-behaviour"><i class="fa fa-check"></i><b>21.10</b> Exercise Solutions: Fish behaviour</a></li>
<li class="chapter" data-level="21.11" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-maze-runner"><i class="fa fa-check"></i><b>21.11</b> Exercise Solutions: Maze runner</a></li>
<li class="chapter" data-level="21.12" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-snails-on-the-move"><i class="fa fa-check"></i><b>21.12</b> Exercise Solutions: Snails on the move</a></li>
<li class="chapter" data-level="21.13" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-mouse-lemur-strength"><i class="fa fa-check"></i><b>21.13</b> Exercise Solutions: Mouse lemur strength</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BB852 - Data handling, visualisation and statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pimping-your-plots" class="section level1" number="9">
<h1><span class="header-section-number">Chapter 9</span> Pimping your plots</h1>
<p>In this chapter you will learn, by following examples, how to customise plots made with <code>ggplot</code> to improve “readability”, or just for aesthetic reasons.</p>
<p>We will cover the following:</p>
<ol style="list-style-type: decimal">
<li>Modifying axes (log transform, different tick marks/ranges etc.).</li>
<li>Colour schemes.</li>
<li><em>Themes</em> - built-in sets of styles.</li>
<li>Multiple sub-plots in a plot.</li>
<li>Saving your plots.</li>
</ol>
<p>For these examples I will use the dataset on animal life history, <code>Anage</code>.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="pimping-your-plots.html#cb233-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;CourseData/anage_data.csv&quot;</span>)</span></code></pre></div>
<p>You can remind yourself what this data looks like using commands like <code>summary</code>, <code>str</code> and <code>names</code>.</p>
<p>I will process the data a bit to make it easier to work with. One of the commands might be new to you - <code>rename</code>. This is simply a way of renaming columns, in this case to make them more “user friendly” (e.g. I want to rename the column “Metabolic.rate..W.” to “BMR” (for basal metabolic rate)).</p>
<p>I will also use <code>mutate</code> to (1) convert the Mass from grams to kilograms and (2) to make a new variable called “BMRperKg” which standardises metabolic rate by expressing it as rate per kilogram.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="pimping-your-plots.html#cb234-1" aria-hidden="true"></a>anage &lt;-<span class="st"> </span>x <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb234-2"><a href="pimping-your-plots.html#cb234-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Species =</span> <span class="kw">paste</span>(Genus,Species)) <span class="op">%&gt;%</span></span>
<span id="cb234-3"><a href="pimping-your-plots.html#cb234-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">Longevity =</span> <span class="st">&quot;Maximum.longevity..yrs.&quot;</span>,</span>
<span id="cb234-4"><a href="pimping-your-plots.html#cb234-4" aria-hidden="true"></a>         <span class="dt">Mass =</span> <span class="st">&quot;Body.mass..g.&quot;</span> ,</span>
<span id="cb234-5"><a href="pimping-your-plots.html#cb234-5" aria-hidden="true"></a>         <span class="dt">BMR =</span> <span class="st">&quot;Metabolic.rate..W.&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb234-6"><a href="pimping-your-plots.html#cb234-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(Class, Order, Species,Mass,Longevity,BMR) <span class="op">%&gt;%</span></span>
<span id="cb234-7"><a href="pimping-your-plots.html#cb234-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(Class <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Aves&quot;</span>,<span class="st">&quot;Amphibia&quot;</span>,<span class="st">&quot;Mammalia&quot;</span>,<span class="st">&quot;Reptilia&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb234-8"><a href="pimping-your-plots.html#cb234-8" aria-hidden="true"></a><span class="st">  </span><span class="kw">droplevels</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#this removes unused &quot;factor levels&quot; e.g. &quot;Insecta&quot;</span></span>
<span id="cb234-9"><a href="pimping-your-plots.html#cb234-9" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Mass =</span> Mass<span class="op">/</span><span class="dv">1000</span>,</span>
<span id="cb234-10"><a href="pimping-your-plots.html#cb234-10" aria-hidden="true"></a>         <span class="dt">BMRperKg =</span> BMR<span class="op">/</span>Mass) </span>
<span id="cb234-11"><a href="pimping-your-plots.html#cb234-11" aria-hidden="true"></a></span>
<span id="cb234-12"><a href="pimping-your-plots.html#cb234-12" aria-hidden="true"></a><span class="kw">summary</span>(anage)  </span></code></pre></div>
<pre><code>##     Class              Order          
##  Length:3231        Length:3231       
##  Class :character   Class :character  
##  Mode  :character   Mode  :character  
##                                       
##                                       
##                                       
##                                       
##    Species               Mass         
##  Length:3231        Min.   :   0.001  
##  Class :character   1st Qu.:   0.026  
##  Mode  :character   Median :   0.131  
##                     Mean   :  13.188  
##                     3rd Qu.:   1.111  
##                     Max.   :3672.000  
##                     NA&#39;s   :2604      
##    Longevity           BMR           
##  Min.   :  0.40   Min.   :   0.0001  
##  1st Qu.: 10.20   1st Qu.:   0.2655  
##  Median : 16.20   Median :   0.7050  
##  Mean   : 19.37   Mean   :  11.8309  
##  3rd Qu.: 24.45   3rd Qu.:   3.1370  
##  Max.   :211.00   Max.   :2336.5000  
##  NA&#39;s   :432      NA&#39;s   :2604       
##     BMRperKg      
##  Min.   : 0.0454  
##  1st Qu.: 2.2191  
##  Median : 4.5745  
##  Mean   : 7.0439  
##  3rd Qu.: 9.8686  
##  Max.   :45.7692  
##  NA&#39;s   :2604</code></pre>
<p><img src="BB852_files/figure-html/unnamed-chunk-148-1.png" width="480" style="display: block; margin: auto;" /></p>
<div id="a-basic-plot" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> A basic plot</h2>
<p>Now lets start with a basic plot. You will see a warning about removing rows with missing values. This is just a warning to let you know that there are missing (<code>NA</code>) values in the data you are plotting.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="pimping-your-plots.html#cb236-1" aria-hidden="true"></a>(p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(anage,<span class="kw">aes</span>(<span class="dt">x =</span> Mass, <span class="dt">y =</span> BMR, <span class="dt">colour =</span> Class)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb236-2"><a href="pimping-your-plots.html#cb236-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.3</span>)) <span class="co">#use alpha argument to make points transparent</span></span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-149-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="axis-limits" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Axis limits</h2>
<p>These points are really spread out. One option to deal with this might be to set the range over which the axes are allowed to go using <code>xlim</code> and <code>ylim</code>.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="pimping-your-plots.html#cb237-1" aria-hidden="true"></a>p1 <span class="op">+</span><span class="st"> </span></span>
<span id="cb237-2"><a href="pimping-your-plots.html#cb237-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>,<span class="dv">500</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb237-3"><a href="pimping-your-plots.html#cb237-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">300</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-150-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="transforming-the-axis-log-scale" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Transforming the axis (log scale)</h2>
<p>In this particular case though use of a log scale would be best because even after focusing on a smaller part of the range of values you can see that the points are still concentrated at smaller values. In a moment, you will also see that log-transforming the data makes the cloud of points pleasingly linear.</p>
<p>You can set a log scale by using the commands <code>scale_x_continuous(trans = "log")</code> and <code>scale_y_continuous(trans = "log")</code>.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="pimping-your-plots.html#cb238-1" aria-hidden="true"></a>(p2 &lt;-<span class="st"> </span>p1 <span class="op">+</span><span class="st"> </span></span>
<span id="cb238-2"><a href="pimping-your-plots.html#cb238-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log&quot;</span>) <span class="op">+</span></span>
<span id="cb238-3"><a href="pimping-your-plots.html#cb238-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log&quot;</span>))</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-151-1.png" width="480" style="display: block; margin: auto;" /></p>
<p><img src="BB852_files/figure-html/unnamed-chunk-152-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="changing-the-axis-tick-marks" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> Changing the axis tick marks</h2>
<p>This looks nice. But the numbers on the axis are not very nice. Using <code>summary(anage$BMR)</code> tells us that the range of data is from 0.0001 to 2336.5. We could place tick marks anywhere on this axis, but let’s try 0.0001, 0.001,0.1, 1,10, 100, 1000.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="pimping-your-plots.html#cb239-1" aria-hidden="true"></a>(p2 &lt;-<span class="st"> </span>p1 <span class="op">+</span><span class="st"> </span></span>
<span id="cb239-2"><a href="pimping-your-plots.html#cb239-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log&quot;</span>) <span class="op">+</span></span>
<span id="cb239-3"><a href="pimping-your-plots.html#cb239-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="fl">0.0001</span>,<span class="fl">0.001</span>,<span class="fl">0.01</span>,<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>)))</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-153-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Using <code>summary(anage$Mass)</code> tells us that the range of data is from 0.001 to 3672. We could place tick marks anywhere on this axis, but let’s try 0.001,0.1, 1,10, 100, 1000.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="pimping-your-plots.html#cb240-1" aria-hidden="true"></a>(p2 &lt;-<span class="st"> </span>p1 <span class="op">+</span><span class="st"> </span></span>
<span id="cb240-2"><a href="pimping-your-plots.html#cb240-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log&quot;</span>, </span>
<span id="cb240-3"><a href="pimping-your-plots.html#cb240-3" aria-hidden="true"></a>                     <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="fl">0.001</span>,<span class="fl">0.01</span>,<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>)) <span class="op">+</span></span>
<span id="cb240-4"><a href="pimping-your-plots.html#cb240-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log&quot;</span>, </span>
<span id="cb240-5"><a href="pimping-your-plots.html#cb240-5" aria-hidden="true"></a>                     <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="fl">0.0001</span>,<span class="fl">0.001</span>,<span class="fl">0.01</span>,<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>))</span>
<span id="cb240-6"><a href="pimping-your-plots.html#cb240-6" aria-hidden="true"></a> )</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-154-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="axis-labels" class="section level2" number="9.5">
<h2><span class="header-section-number">9.5</span> Axis labels</h2>
<p>Now, let’s think about the axis labels. The labels in the plots so far have no units indicated, and might not be easy to interpret for the reader. Let’s add units, and also spell out more fully what “BMR” and “Mass” means (the axes is basal metabolic rate in Watts and adult body mass in kg).</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="pimping-your-plots.html#cb241-1" aria-hidden="true"></a>(p3 &lt;-<span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span></span>
<span id="cb241-2"><a href="pimping-your-plots.html#cb241-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Adult body mass (kg)&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb241-3"><a href="pimping-your-plots.html#cb241-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Basal metabolic rate (W)&quot;</span>)</span>
<span id="cb241-4"><a href="pimping-your-plots.html#cb241-4" aria-hidden="true"></a>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-155-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="colours" class="section level2" number="9.6">
<h2><span class="header-section-number">9.6</span> Colours</h2>
<p>What about those colours? The <code>ggplot</code> package uses some default colours that are OK, but sometimes you will want to make a change.</p>
<p>You can “manually” adjust colours using the <code>scale_colour_manual</code> function. You can either name individual colours (e.g. “red”,“green”,“orange”,“black”)<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>, or you can find their so-called “hex-codes” from a site like <a href="http://colorbrewer2.org/" class="uri">http://colorbrewer2.org/</a> or <a href="https://htmlcolorcodes.com/color-picker/" class="uri">https://htmlcolorcodes.com/color-picker/</a>. You can add a two digit number after the hex code to set the “opaqueness” of the colour. For example “#FF000075” is red, with 75% opacity.</p>
<p>With colour names…</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="pimping-your-plots.html#cb242-1" aria-hidden="true"></a>p3 <span class="op">+</span><span class="st"> </span></span>
<span id="cb242-2"><a href="pimping-your-plots.html#cb242-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;orange&quot;</span>,<span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-156-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>And with some hex codes…</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="pimping-your-plots.html#cb243-1" aria-hidden="true"></a>p3 <span class="op">+</span><span class="st"> </span></span>
<span id="cb243-2"><a href="pimping-your-plots.html#cb243-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#33FF6475&quot;</span>,<span class="st">&quot;#3368FF75&quot;</span>,<span class="st">&quot;#FF33CE75&quot;</span>,<span class="st">&quot;#FFCA3375&quot;</span>))</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-157-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Another alternative is to use some of <code>ggplot</code>’s built in “palettes” of colour combinations. For example, there are several palettes called “<code>viridis</code>”.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="pimping-your-plots.html#cb244-1" aria-hidden="true"></a>p3 <span class="op">+</span><span class="st"> </span></span>
<span id="cb244-2"><a href="pimping-your-plots.html#cb244-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-158-1.png" width="480" style="display: block; margin: auto;" /></p>
<div class="do-something">
<p>
Try using other <code>option</code> arguments <code>A</code>, <code>B</code>, <code>C</code> and <code>E</code>. Try also adding an argument for transparency <code>alpha = 0.5</code>.
</p>
</div>
<p>Here’s a couple more palettes. There’s one for shades of grey…</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="pimping-your-plots.html#cb245-1" aria-hidden="true"></a>p3 <span class="op">+</span><span class="st"> </span></span>
<span id="cb245-2"><a href="pimping-your-plots.html#cb245-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_colour_grey</span>()</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-160-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>There’s another one for various colour schemes, called “colour brewer”. Try using “RdGy”, “RdYlBu” and “Spectral” see <code>?scale_colour_brewer</code> for more options.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="pimping-your-plots.html#cb246-1" aria-hidden="true"></a>p3 <span class="op">+</span><span class="st"> </span></span>
<span id="cb246-2"><a href="pimping-your-plots.html#cb246-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;BrBG&quot;</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-161-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="themes" class="section level2" number="9.7">
<h2><span class="header-section-number">9.7</span> Themes</h2>
<p>Finally, <code>ggplot</code> includes the option to set a <strong>theme</strong> for the plots. “Themes”" make adjustments to the “look” of the plot. It is possible to write your own themes, but I recommend to use some ready-made ones. You can implement them by adding them as you would any other addition to the <code>ggplot</code> command (e.g. <code>+ theme_light()</code>.</p>
<p>There are several themes included with <code>ggplot</code>. Try my favourite, <code>theme_minimal()</code>. Then try <code>theme_classic()</code> and <code>theme_dark()</code>.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="pimping-your-plots.html#cb247-1" aria-hidden="true"></a>(p4 &lt;-<span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span></span>
<span id="cb247-2"><a href="pimping-your-plots.html#cb247-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">theme_minimal</span>()</span>
<span id="cb247-3"><a href="pimping-your-plots.html#cb247-3" aria-hidden="true"></a>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-162-1.png" width="480" style="display: block; margin: auto;" />
For more theme fun, you can install packages that include more themes. The best one is called <code>ggthemes</code> (remember that you only need to install the package once). Try <code>theme_economist()</code>, <code>theme_tufte()</code> and (ugh!) <code>theme_excel()</code>. You can see what other themes there in this package at <a href="https://jrnold.github.io/ggthemes/reference/index.html" class="uri">https://jrnold.github.io/ggthemes/reference/index.html</a> (some of them are really ugly in my opinion!).</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="pimping-your-plots.html#cb248-1" aria-hidden="true"></a><span class="kw">install.packages</span>(<span class="st">&quot;ggthemes&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="pimping-your-plots.html#cb249-1" aria-hidden="true"></a><span class="kw">library</span>(ggthemes)</span>
<span id="cb249-2"><a href="pimping-your-plots.html#cb249-2" aria-hidden="true"></a>p3 <span class="op">+</span><span class="st"> </span></span>
<span id="cb249-3"><a href="pimping-your-plots.html#cb249-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">theme_economist</span>()</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-164-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>This package also includes some useful colour scales, including some for colour blind people.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="pimping-your-plots.html#cb250-1" aria-hidden="true"></a>p3 <span class="op">+</span><span class="st"> </span></span>
<span id="cb250-2"><a href="pimping-your-plots.html#cb250-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_color_colorblind</span>()</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-165-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="moving-the-legend" class="section level2" number="9.8">
<h2><span class="header-section-number">9.8</span> Moving the legend</h2>
<p>By default, the legend is placed on the right. You can move it around by adding a <code>theme</code> argument to your plot commands. It can also be placed on the “<code>top</code>”, “<code>bottom</code>”, or “<code>left</code>”. You can also remove the legend altogether by using <code>legend.position = "none"</code>. You might also want to remove the legend title using the theme argument <code>legend.title = element_blank()</code>.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="pimping-your-plots.html#cb251-1" aria-hidden="true"></a>p3 <span class="op">+</span><span class="st"> </span></span>
<span id="cb251-2"><a href="pimping-your-plots.html#cb251-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position  =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-166-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="combining-multiple-plots" class="section level2" number="9.9">
<h2><span class="header-section-number">9.9</span> Combining multiple plots</h2>
<p>It is often useful to combine two or more plots into a single figure. For example, many journals have strict limits on the number of plots so it is useful to combine plots into “Figure 1A and B” etc.</p>
<p>There are several R packages that can do this and my favourite is called <code>patchwork</code>.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="pimping-your-plots.html#cb252-1" aria-hidden="true"></a><span class="kw">install.packages</span>(<span class="st">&quot;patchwork&quot;</span>) <span class="co">#only need to do this once</span></span></code></pre></div>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="pimping-your-plots.html#cb253-1" aria-hidden="true"></a><span class="kw">library</span>(patchwork)</span></code></pre></div>
<p>I will illustrate it by first making another plot, this time showing the relationship between body mass and <em>standardised</em> BMR (BMR per kg). Because I am combining the plots into a smaller space I have decided to remove the figure legend (I could put it in the figure caption instead).</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="pimping-your-plots.html#cb254-1" aria-hidden="true"></a><span class="co">#PlotA (this is what you have already created above)</span></span>
<span id="cb254-2"><a href="pimping-your-plots.html#cb254-2" aria-hidden="true"></a>plotA &lt;-<span class="st"> </span><span class="kw">ggplot</span>(anage,<span class="kw">aes</span>(<span class="dt">x =</span> Mass, <span class="dt">y =</span> BMR, <span class="dt">colour =</span> Class)) <span class="op">+</span></span>
<span id="cb254-3"><a href="pimping-your-plots.html#cb254-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb254-4"><a href="pimping-your-plots.html#cb254-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log&quot;</span>,<span class="dt">breaks =</span><span class="kw">c</span>(<span class="fl">0.001</span>,<span class="fl">0.01</span>,<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb254-5"><a href="pimping-your-plots.html#cb254-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log&quot;</span>,<span class="dt">breaks =</span><span class="kw">c</span>(<span class="fl">0.0001</span>,<span class="fl">0.001</span>,<span class="fl">0.01</span>,<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>)) <span class="op">+</span></span>
<span id="cb254-6"><a href="pimping-your-plots.html#cb254-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Adult body mass (kg)&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb254-7"><a href="pimping-your-plots.html#cb254-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Basal metabolic rate (W)&quot;</span>) <span class="op">+</span></span>
<span id="cb254-8"><a href="pimping-your-plots.html#cb254-8" aria-hidden="true"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb254-9"><a href="pimping-your-plots.html#cb254-9" aria-hidden="true"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position  =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb254-10"><a href="pimping-your-plots.html#cb254-10" aria-hidden="true"></a>        <span class="dt">legend.title =</span> <span class="kw">element_blank</span>())</span>
<span id="cb254-11"><a href="pimping-your-plots.html#cb254-11" aria-hidden="true"></a></span>
<span id="cb254-12"><a href="pimping-your-plots.html#cb254-12" aria-hidden="true"></a>(plotB &lt;-<span class="st"> </span><span class="kw">ggplot</span>(anage,<span class="kw">aes</span>(<span class="dt">x =</span> Mass, <span class="dt">y =</span> BMRperKg, <span class="dt">colour =</span> Class)) <span class="op">+</span></span>
<span id="cb254-13"><a href="pimping-your-plots.html#cb254-13" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb254-14"><a href="pimping-your-plots.html#cb254-14" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log&quot;</span>,<span class="dt">breaks =</span><span class="kw">c</span>(<span class="fl">0.001</span>,<span class="fl">0.01</span>,<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>)) <span class="op">+</span></span>
<span id="cb254-15"><a href="pimping-your-plots.html#cb254-15" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log&quot;</span>,<span class="dt">breaks =</span><span class="kw">c</span>(<span class="fl">0.0001</span>,<span class="fl">0.001</span>,<span class="fl">0.01</span>,<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb254-16"><a href="pimping-your-plots.html#cb254-16" aria-hidden="true"></a><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Adult body mass (kg)&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb254-17"><a href="pimping-your-plots.html#cb254-17" aria-hidden="true"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Basal metabolic rate (W/kg)&quot;</span>) <span class="op">+</span></span>
<span id="cb254-18"><a href="pimping-your-plots.html#cb254-18" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb254-19"><a href="pimping-your-plots.html#cb254-19" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position  =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb254-20"><a href="pimping-your-plots.html#cb254-20" aria-hidden="true"></a>) <span class="co">#This one is wrapped in brackets so that R shows it</span></span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-169-1.png" width="672" /></p>
<p>Now I can combine these using the very simple syntax like this:</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="pimping-your-plots.html#cb255-1" aria-hidden="true"></a>plotA <span class="op">+</span><span class="st"> </span>plotB</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-170-1.png" width="672" /></p>
<p>I can add titles using the <code>ggtitle</code> command like this.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="pimping-your-plots.html#cb256-1" aria-hidden="true"></a>plotA <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st">  </span>plotB <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;B&quot;</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-171-1.png" width="672" /></p>
<p>You could place the sub-plots on top of each other like this.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="pimping-your-plots.html#cb257-1" aria-hidden="true"></a>(plotA <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;A&quot;</span>)) <span class="op">/</span><span class="st"> </span>(plotB <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;B&quot;</span>))</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-172-1.png" width="384" /></p>
</div>
<div id="saving-your-plot" class="section level2" number="9.10">
<h2><span class="header-section-number">9.10</span> Saving your plot</h2>
<p>You should, I think, already know about using the “Export” button in RStudio to save out your plot. This is useful and easy, but you should know that you can also save the plots using a typed command (<code>ggsave</code>) in your script. This command is handy because it allows you to automatically set the size, and file name of your plot.</p>
<p>The default setting for <code>ggsave</code> is that it will save the last plot that was printed to your computer screen to a file name that you specify. Therefore easiest way to use the command is to simply place the <code>ggsave</code> command immediately after your <code>ggplot</code> command. You should set the width and height of the plot and the units (the default is inches). It usually takes a few attempts and a bit of trial-and-error to choose the dimensions so that the plot looks nice.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="pimping-your-plots.html#cb258-1" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;MySavedPlot1.png&quot;</span>, <span class="dt">width =</span> <span class="dv">18</span>, <span class="dt">height=</span><span class="dv">10</span>, <span class="dt">units =</span> <span class="st">&quot;cm&quot;</span>)</span></code></pre></div>
<p>The command can save to various file types including <code>png</code>, <code>jpeg</code>, <code>pdf</code> (see the <code>ggplot</code> help file for more). R knows what file file type is chosen by checking the file extension in the file name (e.g. <code>.png</code>). I advise to use <code>png</code>.</p>
</div>
<div id="final-word-on-plots" class="section level2" number="9.11">
<h2><span class="header-section-number">9.11</span> Final word on plots</h2>
<p>We have covered a lot of ground here. There is a lot to learn, but don’t feel like you have to remember all of these commands (I don’t). Mostly it is simply a case of remembering that it is <em>possible</em> to do these things, and knowing where to look up the commands. Obvious starting points are this course book, and the text book (including the online version!). You can also usually find help by Googling “ggplot” followed by what you are trying to do (e.g. “ggplot change axis ticks”). One of my frequently used web sites is this one <a href="http://www.sthda.com/english/" class="uri">http://www.sthda.com/english/</a> which has an extensive section on <code>ggplot</code> (<a href="http://www.sthda.com/english/wiki/ggplot2-essentials" class="uri">http://www.sthda.com/english/wiki/ggplot2-essentials</a>).</p>
<p>Even though we have covered a lot of ground we have still only gotten a taster of what <code>ggplot</code> is capable of. I encourage you to learn more. A useful resource for learning is the online R graph gallery" at <a href="https://www.r-graph-gallery.com/" class="uri">https://www.r-graph-gallery.com/</a>, which shows you how to make and modify many types of plot.</p>
<!-- ## A note about the order of point layers -->
<!-- Sometimes the points end up obscuring each other. For example, here the points for birds (Aves) are mostly hidden by the points for mammals. This happens because `ggplot` places the points in the order that they appear in the data frame. Therefore, one way to deal with that would be to change the order of the rows (e.g. so Aves appears last) or to randomise the rows using a new command called `slice` in concert with the `sample` function. -->
<!-- ```{r} -->
<!-- anage <- anage %>% -->
<!--   slice(sample(1:n())) -->
<!-- ggplot(anage,aes(x = Mass, y = BMR, colour = Class)) + -->
<!--   geom_point(alpha=0.5) +  -->
<!--   scale_x_continuous(trans = "log",breaks =c(0.001,0.01,0.1,1,10,100,1000)) +  -->
<!--   scale_y_continuous(trans = "log",breaks =c(0.0001,0.001,0.01,0.1,1,10,100,1000)) -->
<!-- ``` -->
<!-- Another way would be to create a "helper" variable (e.g. `plotOrder`) and then arrange the data by this variable. This is a bit fiddly, but it gets the job done. -->
<!-- ```{r} -->
<!-- anage <- anage %>% -->
<!--   mutate(plotOrder = as.numeric(Class)) %>% -->
<!--   arrange(-plotOrder) -->
<!-- ggplot(anage,aes(x = Mass, y = BMR, colour = Class)) + -->
<!--   geom_point(alpha=0.5) +  -->
<!--   scale_x_continuous(trans = "log",breaks =c(0.001,0.01,0.1,1,10,100,1000)) +  -->
<!--   scale_y_continuous(trans = "log",breaks =c(0.0001,0.001,0.01,0.1,1,10,100,1000)) -->
<!-- ``` -->

</div>
</div>



</div>
<div class="footnotes">
<hr />
<ol start="6">
<li id="fn6"><p>See <a href="https://www.r-graph-gallery.com/42-colors-names.html" class="uri">https://www.r-graph-gallery.com/42-colors-names.html</a><a href="pimping-your-plots.html#fnref6" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="distributions-and-summarising-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="randomisation-tests.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jonesor/BB852_Book/edit/master/2_03-pimpYourPlots.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["BB852.pdf"],
"toc": {
"collapse": "section"
},
"split_by": "section"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
