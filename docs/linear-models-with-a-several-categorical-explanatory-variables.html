<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Linear models with a several categorical explanatory variables | BB852 - Data handling, visualisation and statistics</title>
  <meta name="description" content="This is the course book for BB852." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Linear models with a several categorical explanatory variables | BB852 - Data handling, visualisation and statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the course book for BB852." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Linear models with a several categorical explanatory variables | BB852 - Data handling, visualisation and statistics" />
  
  <meta name="twitter:description" content="This is the course book for BB852." />
  

<meta name="author" content="Owen Jones" />


<meta name="date" content="2020-08-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-models-with-a-single-categorical-explanatory-variable.html"/>
<link rel="next" href="linear-models-with-a-single-continuous-explanatory-variable.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BB852</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data-wrangling"><i class="fa fa-check"></i><b>1.1</b> Data wrangling</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-visualisation"><i class="fa fa-check"></i><b>1.2</b> Data visualisation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#statistics"><i class="fa fa-check"></i><b>1.3</b> Statistics</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#general-approach"><i class="fa fa-check"></i><b>1.4</b> General approach</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#data-sources"><i class="fa fa-check"></i><b>1.5</b> Data sources</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.6</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#error-reporting"><i class="fa fa-check"></i><b>1.7</b> Error reporting</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html"><i class="fa fa-check"></i><b>2</b> Getting acquainted with R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#getting-started-with-r"><i class="fa fa-check"></i><b>2.2</b> Getting started with R</a></li>
<li class="chapter" data-level="2.3" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#getting-help"><i class="fa fa-check"></i><b>2.3</b> Getting help</a></li>
<li class="chapter" data-level="2.4" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#r-as-a-fancy-calculator"><i class="fa fa-check"></i><b>2.4</b> R as a fancy calculator</a></li>
<li class="chapter" data-level="2.5" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#objects-in-r"><i class="fa fa-check"></i><b>2.5</b> Objects in R</a></li>
<li class="chapter" data-level="2.6" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#missing-values-infinity-and-non-numbers"><i class="fa fa-check"></i><b>2.6</b> Missing values, infinity and “non-numbers”</a></li>
<li class="chapter" data-level="2.7" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#basic-information-about-objects"><i class="fa fa-check"></i><b>2.7</b> Basic information about objects</a></li>
<li class="chapter" data-level="2.8" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#data-frames"><i class="fa fa-check"></i><b>2.8</b> Data frames</a></li>
<li class="chapter" data-level="2.9" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#classes-in-r"><i class="fa fa-check"></i><b>2.9</b> Classes in R</a></li>
<li class="chapter" data-level="2.10" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#tables-and-summary-statistics"><i class="fa fa-check"></i><b>2.10</b> Tables and summary statistics</a></li>
<li class="chapter" data-level="2.11" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#plotting-data"><i class="fa fa-check"></i><b>2.11</b> Plotting data</a></li>
<li class="chapter" data-level="2.12" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#exercises---getting-acquainted-with-r"><i class="fa fa-check"></i><b>2.12</b> Exercises - Getting acquainted with R</a>
<ul>
<li class="chapter" data-level="2.12.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#background"><i class="fa fa-check"></i><b>2.12.1</b> Background</a></li>
<li class="chapter" data-level="2.12.2" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#the-data"><i class="fa fa-check"></i><b>2.12.2</b> The data</a></li>
<li class="chapter" data-level="2.12.3" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#try-the-following"><i class="fa fa-check"></i><b>2.12.3</b> Try the following</a></li>
<li class="chapter" data-level="2.12.4" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#references"><i class="fa fa-check"></i><b>2.12.4</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html"><i class="fa fa-check"></i><b>3</b> Data wrangling with dplyr</a>
<ul>
<li class="chapter" data-level="3.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#select"><i class="fa fa-check"></i><b>3.2</b> select</a></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#filter"><i class="fa fa-check"></i><b>3.3</b> filter</a></li>
<li class="chapter" data-level="3.4" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#arrange"><i class="fa fa-check"></i><b>3.4</b> arrange</a></li>
<li class="chapter" data-level="3.5" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#summarise-and-group_by"><i class="fa fa-check"></i><b>3.5</b> summarise and group_by</a></li>
<li class="chapter" data-level="3.6" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#using-pipes-saving-data."><i class="fa fa-check"></i><b>3.6</b> Using pipes, saving data.</a></li>
<li class="chapter" data-level="3.7" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#exercises---data-wrangling"><i class="fa fa-check"></i><b>3.7</b> Exercises - data wrangling</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#exploring-the-amniote-life-history-database"><i class="fa fa-check"></i><b>3.7.1</b> Exploring the Amniote Life History Database</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="combining-data-sets.html"><a href="combining-data-sets.html"><i class="fa fa-check"></i><b>4</b> Combining data sets</a>
<ul>
<li class="chapter" data-level="4.1" data-path="combining-data-sets.html"><a href="combining-data-sets.html#exercise---joining-datasets"><i class="fa fa-check"></i><b>4.1</b> Exercise - joining datasets</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#the-data"><i class="fa fa-check"></i><b>4.1.1</b> The data</a></li>
<li class="chapter" data-level="4.1.2" data-path="combining-data-sets.html"><a href="combining-data-sets.html#the-bird-data"><i class="fa fa-check"></i><b>4.1.2</b> The bird data</a></li>
<li class="chapter" data-level="4.1.3" data-path="combining-data-sets.html"><a href="combining-data-sets.html#the-weather-data"><i class="fa fa-check"></i><b>4.1.3</b> The weather data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html"><i class="fa fa-check"></i><b>5</b> Visualising data with ggplot2</a>
<ul>
<li class="chapter" data-level="5.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html#histograms"><i class="fa fa-check"></i><b>5.2</b> Histograms</a></li>
<li class="chapter" data-level="5.3" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html#facets---splitting-data-across-panels"><i class="fa fa-check"></i><b>5.3</b> “Facets” - splitting data across panels</a></li>
<li class="chapter" data-level="5.4" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html#box-plots"><i class="fa fa-check"></i><b>5.4</b> box plots</a></li>
<li class="chapter" data-level="5.5" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html#lines-and-points"><i class="fa fa-check"></i><b>5.5</b> lines and points</a></li>
<li class="chapter" data-level="5.6" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html#scatter-plot"><i class="fa fa-check"></i><b>5.6</b> scatter plot</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html"><i class="fa fa-check"></i><b>6</b> Distributions and summarising data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#distributions"><i class="fa fa-check"></i><b>6.2</b> Distributions</a></li>
<li class="chapter" data-level="6.3" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#normal-distribution"><i class="fa fa-check"></i><b>6.3</b> Normal distribution</a></li>
<li class="chapter" data-level="6.4" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#compare-normal-distributions"><i class="fa fa-check"></i><b>6.4</b> Compare normal distributions</a></li>
<li class="chapter" data-level="6.5" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#the-poisson-distribution"><i class="fa fa-check"></i><b>6.5</b> The Poisson distribution</a></li>
<li class="chapter" data-level="6.6" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#comparing-normal-and-poisson-distributions"><i class="fa fa-check"></i><b>6.6</b> Comparing normal and Poisson distributions</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="customising-your-plots.html"><a href="customising-your-plots.html"><i class="fa fa-check"></i><b>7</b> Customising your plots</a>
<ul>
<li class="chapter" data-level="7.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="customising-your-plots.html"><a href="customising-your-plots.html#a-basic-plot"><i class="fa fa-check"></i><b>7.2</b> A basic plot</a></li>
<li class="chapter" data-level="7.3" data-path="customising-your-plots.html"><a href="customising-your-plots.html#axis-limits"><i class="fa fa-check"></i><b>7.3</b> Axis limits</a></li>
<li class="chapter" data-level="7.4" data-path="customising-your-plots.html"><a href="customising-your-plots.html#transforming-the-axis-log-scale"><i class="fa fa-check"></i><b>7.4</b> Transforming the axis (log scale)</a></li>
<li class="chapter" data-level="7.5" data-path="customising-your-plots.html"><a href="customising-your-plots.html#changing-the-axis-tick-marks"><i class="fa fa-check"></i><b>7.5</b> Changing the axis tick marks</a></li>
<li class="chapter" data-level="7.6" data-path="customising-your-plots.html"><a href="customising-your-plots.html#axis-labels"><i class="fa fa-check"></i><b>7.6</b> Axis labels</a></li>
<li class="chapter" data-level="7.7" data-path="customising-your-plots.html"><a href="customising-your-plots.html#colours"><i class="fa fa-check"></i><b>7.7</b> Colours</a></li>
<li class="chapter" data-level="7.8" data-path="customising-your-plots.html"><a href="customising-your-plots.html#themes"><i class="fa fa-check"></i><b>7.8</b> Themes</a></li>
<li class="chapter" data-level="7.9" data-path="customising-your-plots.html"><a href="customising-your-plots.html#moving-the-legend"><i class="fa fa-check"></i><b>7.9</b> Moving the legend</a></li>
<li class="chapter" data-level="7.10" data-path="customising-your-plots.html"><a href="customising-your-plots.html#combining-multiple-plots"><i class="fa fa-check"></i><b>7.10</b> Combining multiple plots</a></li>
<li class="chapter" data-level="7.11" data-path="customising-your-plots.html"><a href="customising-your-plots.html#saving-your-plot"><i class="fa fa-check"></i><b>7.11</b> Saving your plot</a></li>
<li class="chapter" data-level="7.12" data-path="customising-your-plots.html"><a href="customising-your-plots.html#final-word-on-plots"><i class="fa fa-check"></i><b>7.12</b> Final word on plots</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="randomisation-tests.html"><a href="randomisation-tests.html"><i class="fa fa-check"></i><b>8</b> Randomisation Tests</a>
<ul>
<li class="chapter" data-level="8.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#introduction"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-example"><i class="fa fa-check"></i><b>8.2</b> The example</a></li>
<li class="chapter" data-level="8.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#setting-up"><i class="fa fa-check"></i><b>8.3</b> Setting up</a></li>
<li class="chapter" data-level="8.4" data-path="randomisation-tests.html"><a href="randomisation-tests.html#calculate-the-observed-difference"><i class="fa fa-check"></i><b>8.4</b> Calculate the observed difference</a></li>
<li class="chapter" data-level="8.5" data-path="randomisation-tests.html"><a href="randomisation-tests.html#null-distribution"><i class="fa fa-check"></i><b>8.5</b> Null distribution</a></li>
<li class="chapter" data-level="8.6" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-significance"><i class="fa fa-check"></i><b>8.6</b> Testing significance</a></li>
<li class="chapter" data-level="8.7" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-the-hypothesis"><i class="fa fa-check"></i><b>8.7</b> Testing the hypothesis</a></li>
<li class="chapter" data-level="8.8" data-path="randomisation-tests.html"><a href="randomisation-tests.html#writing-it-up"><i class="fa fa-check"></i><b>8.8</b> Writing it up</a></li>
<li class="chapter" data-level="8.9" data-path="randomisation-tests.html"><a href="randomisation-tests.html#paired-randomisation-tests"><i class="fa fa-check"></i><b>8.9</b> Paired Randomisation Tests</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#plot-the-data"><i class="fa fa-check"></i><b>8.9.1</b> Plot the data</a></li>
<li class="chapter" data-level="8.9.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-paired-randomisation-test"><i class="fa fa-check"></i><b>8.9.2</b> The paired randomisation test</a></li>
<li class="chapter" data-level="8.9.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#plot-the-null-distribution"><i class="fa fa-check"></i><b>8.9.3</b> Plot the null distribution</a></li>
<li class="chapter" data-level="8.9.4" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-formal-hypothesis-test"><i class="fa fa-check"></i><b>8.9.4</b> The formal hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="randomisation-tests.html"><a href="randomisation-tests.html#exercises---randomisation-tests"><i class="fa fa-check"></i><b>8.10</b> Exercises - Randomisation tests</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#introduction-1"><i class="fa fa-check"></i><b>8.10.1</b> Introduction</a></li>
<li class="chapter" data-level="8.10.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#your-task"><i class="fa fa-check"></i><b>8.10.2</b> Your task</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html"><i class="fa fa-check"></i><b>9</b> Comparing two means with a t-test</a>
<ul>
<li class="chapter" data-level="9.1" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#some-theory."><i class="fa fa-check"></i><b>9.1</b> Some theory.</a></li>
<li class="chapter" data-level="9.2" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#one-sample-t-test"><i class="fa fa-check"></i><b>9.2</b> One sample t-test</a></li>
<li class="chapter" data-level="9.3" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#doing-it-by-hand---where-does-the-t-statistic-come-from"><i class="fa fa-check"></i><b>9.3</b> Doing it “by hand” - where does the t-statistic come from?</a></li>
<li class="chapter" data-level="9.4" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#paired-t-test"><i class="fa fa-check"></i><b>9.4</b> Paired t-test</a></li>
<li class="chapter" data-level="9.5" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#a-paired-t-test-is-a-one-sample-test."><i class="fa fa-check"></i><b>9.5</b> A paired t-test is a one-sample test.</a></li>
<li class="chapter" data-level="9.6" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#two-sample-t-test"><i class="fa fa-check"></i><b>9.6</b> Two sample t-test</a></li>
<li class="chapter" data-level="9.7" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#t-tests-are-linear-models"><i class="fa fa-check"></i><b>9.7</b> t-tests are linear models</a></li>
<li class="chapter" data-level="9.8" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercises---two-sample-t-test"><i class="fa fa-check"></i><b>9.8</b> Exercises - Two-sample t-test</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#paired-t-test-1"><i class="fa fa-check"></i><b>9.8.1</b> Paired t-test</a></li>
<li class="chapter" data-level="9.8.2" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#optional-extra."><i class="fa fa-check"></i><b>9.8.2</b> Optional extra.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html"><i class="fa fa-check"></i><b>10</b> Linear models with a single categorical explanatory variable</a>
<ul>
<li class="chapter" data-level="10.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#introduction"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#one-way-anova"><i class="fa fa-check"></i><b>10.2</b> One-way ANOVA</a></li>
<li class="chapter" data-level="10.3" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#fitting-an-anova-in-r"><i class="fa fa-check"></i><b>10.3</b> Fitting an ANOVA in R</a></li>
<li class="chapter" data-level="10.4" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#where-are-the-differences"><i class="fa fa-check"></i><b>10.4</b> Where are the differences?</a></li>
<li class="chapter" data-level="10.5" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#tukeys-honestly-significant-difference-hsd"><i class="fa fa-check"></i><b>10.5</b> Tukey’s Honestly Significant Difference (HSD)</a></li>
<li class="chapter" data-level="10.6" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#anova-calculation-by-hand-optional"><i class="fa fa-check"></i><b>10.6</b> ANOVA calculation “by hand” (optional)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-models-with-a-several-categorical-explanatory-variables.html"><a href="linear-models-with-a-several-categorical-explanatory-variables.html"><i class="fa fa-check"></i><b>11</b> Linear models with a several categorical explanatory variables</a>
<ul>
<li class="chapter" data-level="11.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#background"><i class="fa fa-check"></i><b>11.1</b> Background</a></li>
<li class="chapter" data-level="11.2" data-path="linear-models-with-a-several-categorical-explanatory-variables.html"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#fitting-a-two-way-anova-model"><i class="fa fa-check"></i><b>11.2</b> Fitting a two-way ANOVA model</a></li>
<li class="chapter" data-level="11.3" data-path="linear-models-with-a-several-categorical-explanatory-variables.html"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#summarising-the-model-anova"><i class="fa fa-check"></i><b>11.3</b> Summarising the model (<code>anova</code>)</a></li>
<li class="chapter" data-level="11.4" data-path="linear-models-with-a-several-categorical-explanatory-variables.html"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#summarising-the-model-summary"><i class="fa fa-check"></i><b>11.4</b> Summarising the model (<code>summary</code>)</a></li>
<li class="chapter" data-level="11.5" data-path="linear-models-with-a-several-categorical-explanatory-variables.html"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#a-2-way-anova-on-a-fish-behaviour-study"><i class="fa fa-check"></i><b>11.5</b> A 2-way ANOVA on a fish behaviour study</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="linear-models-with-a-several-categorical-explanatory-variables.html"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#background-1"><i class="fa fa-check"></i><b>11.5.1</b> Background</a></li>
<li class="chapter" data-level="11.5.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#your-task"><i class="fa fa-check"></i><b>11.5.2</b> Your task</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html"><i class="fa fa-check"></i><b>12</b> Linear models with a single continuous explanatory variable</a>
<ul>
<li class="chapter" data-level="12.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#background"><i class="fa fa-check"></i><b>12.1</b> Background</a></li>
<li class="chapter" data-level="12.2" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#some-theory"><i class="fa fa-check"></i><b>12.2</b> Some theory</a></li>
<li class="chapter" data-level="12.3" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#evaluating-a-hypothesis-with-a-linear-regression-model"><i class="fa fa-check"></i><b>12.3</b> Evaluating a hypothesis with a linear regression model</a></li>
<li class="chapter" data-level="12.4" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#assumptions"><i class="fa fa-check"></i><b>12.4</b> Assumptions</a></li>
<li class="chapter" data-level="12.5" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#an-example-using-r"><i class="fa fa-check"></i><b>12.5</b> An example using R</a></li>
<li class="chapter" data-level="12.6" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#exercises---linear-regression"><i class="fa fa-check"></i><b>12.6</b> Exercises - Linear Regression</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="linear-models-with-a-several-categorical-explanatory-variables.html"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#background-1"><i class="fa fa-check"></i><b>12.6.1</b> Background</a></li>
<li class="chapter" data-level="12.6.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#your-task"><i class="fa fa-check"></i><b>12.6.2</b> Your task</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html"><i class="fa fa-check"></i><b>13</b> Linear models with categorical and continuous explanatory variables</a>
<ul>
<li class="chapter" data-level="13.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#background"><i class="fa fa-check"></i><b>13.1</b> Background</a></li>
<li class="chapter" data-level="13.2" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#the-height-hand-width-example."><i class="fa fa-check"></i><b>13.2</b> The height ~ hand width example.</a></li>
<li class="chapter" data-level="13.3" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#summarising-with-anova"><i class="fa fa-check"></i><b>13.3</b> Summarising with <code>anova</code></a></li>
<li class="chapter" data-level="13.4" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#the-summary-of-coefficients-summary"><i class="fa fa-check"></i><b>13.4</b> The summary of coefficients (<code>summary</code>)</a></li>
<li class="chapter" data-level="13.5" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#simplifying-the-model"><i class="fa fa-check"></i><b>13.5</b> Simplifying the model</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html"><i class="fa fa-check"></i><b>14</b> Generalised linear models</a>
<ul>
<li class="chapter" data-level="14.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#count-data-with-poisson-errors."><i class="fa fa-check"></i><b>14.1</b> Count data with Poisson errors.</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-number-of-offspring-in-foxes."><i class="fa fa-check"></i><b>14.1.1</b> Example: Number of offspring in foxes.</a></li>
<li class="chapter" data-level="14.1.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-cancer-clusters"><i class="fa fa-check"></i><b>14.1.2</b> Example: Cancer clusters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html"><i class="fa fa-check"></i><b>15</b> Extending use cases of GLM</a>
<ul>
<li class="chapter" data-level="15.1" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#logistic-regression-with-binary-01-data"><i class="fa fa-check"></i><b>15.1</b> Logistic regression with binary (0/1) data</a></li>
<li class="chapter" data-level="15.2" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-species-presenceabsence-data"><i class="fa fa-check"></i><b>15.2</b> Example: species presence/absence data</a></li>
<li class="chapter" data-level="15.3" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#binomial-regression-with-proportionratio-data"><i class="fa fa-check"></i><b>15.3</b> Binomial regression with proportion/ratio data</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-sex-ratios"><i class="fa fa-check"></i><b>15.3.1</b> Example: sex ratios</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="power-and-study-design.html"><a href="power-and-study-design.html"><i class="fa fa-check"></i><b>16</b> Power and study design</a>
<ul>
<li class="chapter" data-level="16.1" data-path="power-and-study-design.html"><a href="power-and-study-design.html#power-analysis-by-simulation"><i class="fa fa-check"></i><b>16.1</b> Power analysis by simulation</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html"><i class="fa fa-check"></i><b>17</b> Coming soon (maybe)!</a>
<ul>
<li class="chapter" data-level="17.1" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#multivariate-statistics"><i class="fa fa-check"></i><b>17.1</b> Multivariate statistics</a></li>
<li class="chapter" data-level="17.2" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#transforming-variables"><i class="fa fa-check"></i><b>17.2</b> Transforming variables</a></li>
<li class="chapter" data-level="17.3" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#non-linear-regression"><i class="fa fa-check"></i><b>17.3</b> Non-linear regression</a></li>
<li class="chapter" data-level="17.4" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#nested-or-blocked-study-designs"><i class="fa fa-check"></i><b>17.4</b> Nested or blocked study designs</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BB852 - Data handling, visualisation and statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-models-with-a-several-categorical-explanatory-variables" class="section level1" number="11">
<h1><span class="header-section-number">Chapter 11</span> Linear models with a several categorical explanatory variables</h1>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb360-1" aria-hidden="true"></a><span class="kw">require</span>(tidyverse)</span>
<span id="cb360-2"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb360-2" aria-hidden="true"></a><span class="kw">require</span>(ggpubr)</span></code></pre></div>
<div id="background" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> Background</h2>
<p>In the one-way ANOVA we covered in the previous worksheet we were interested in understanding the effect of a single categorical explanatory variable with two or more levels on a continuous response variable. Although the explanatory variable must be categorical (i.e. with discrete levels), it could represent a continuous variable. For example, the explanatory variable could be a two-level soil nutrient level (high or low), even though nutrient level is a continuous variable and one could measure the actual quantitative value of nutrients in mg/g.</p>
<p>The two-way ANOVA is an extension of one-way ANOVA that allows you to investigate the effect of <strong>two</strong> categorical variables. This can be useful in an experimental context.</p>
<p>For example, one might have run an experiment investigating in the effect of two types of diet (<em>lowProtein</em> and <em>highProtein</em>), and genotype (<em>gt1</em> and <em>gt2</em>), on adult size of a pest species. It is worth thinking about what potential outcomes there are for this experiment. There may be no effect of diet, and no effect of genotype. There may be an effect of one of these variables but not the other. The effect of the diet might be the same for the different genotypes, or it might be different. Some of these different possibile outcomes are illustrated in Figure . the titles indicate with Y (yes) or N (no) whether the figure shows a significant diet, genotype (gt) or interaction (int) effect. The dotted lines joining the estimates for the two genotypes are a kind of <strong>interaction plot</strong>: where they are parallel, there is no interaction.</p>
<div class="figure" style="text-align: center"><span id="fig:possibilities"></span>
<img src="BB852_files/figure-html/possibilities-1.png" alt="Some potential results of the experiment. There may be a significant effect (or not) of both of the main effects (diet and genotype) and there may be a significant interaction effect (or not)." width="960" />
<p class="caption">
Figure 11.1: Some potential results of the experiment. There may be a significant effect (or not) of both of the main effects (diet and genotype) and there may be a significant interaction effect (or not).
</p>
</div>
<p>In the model we aim to quantify these effects, and ask if they are statistically significant (i.e. if the effect sizes are &gt;0). We divide the effects of the explanatory variables into two types: <strong>main effects</strong> and <strong>interaction effects</strong>. The main effects are the overall effect of the explanatory variables (genotype and diet in this case) while the interaction effect allows us to ask whether one main effect <em>depends on another</em>. In this case we are asking whether <em>the effect of diet depends on genotype (and vice versa)</em>. Make sure that you understand this important concept.</p>
</div>
<div id="fitting-a-two-way-anova-model" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> Fitting a two-way ANOVA model</h2>
<p>Let’s use R to fit a two-way ANOVA model using data from the example I just described. As with one-way ANOVA, you can fit a two-way ANOVA model in R using <code>lm</code>.</p>
<p>First, import the <code>insectDiet.csv</code> data and plot it, to produce a plot like in Figure . From looking at the graph in Figure  you can see (a) genotype 1 tends to be larger than genotype 2; (b) insects raised on a high protein diet tend to be larger than those on a low protein diet; and (c) the effect of the diet (i.e. the <em>difference</em> in size between the insects raised on the different diets) is larger for genotype 1 than it is for genotype 2. But are these differences statistically meaningful?</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb361-1" aria-hidden="true"></a>insectDiet &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;CourseData/insectDiet.csv&quot;</span>)</span>
<span id="cb361-2"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb361-2" aria-hidden="true"></a></span>
<span id="cb361-3"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb361-3" aria-hidden="true"></a><span class="kw">ggplot</span>(insectDiet,<span class="kw">aes</span>(<span class="dt">x =</span> genotype,<span class="dt">y =</span> lengthMM,<span class="dt">fill=</span>diet)) <span class="op">+</span></span>
<span id="cb361-4"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb361-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb361-5"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb361-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Genotype&quot;</span>)<span class="op">+</span></span>
<span id="cb361-6"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb361-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Length (mm)&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:dietAndGenotype"></span>
<img src="BB852_files/figure-html/dietAndGenotype-1.png" alt="The effect of diet protein content and genotype on adult size of an insect species" width="480" />
<p class="caption">
Figure 11.2: The effect of diet protein content and genotype on adult size of an insect species
</p>
</div>
<p>To address this question, we will fit a linear model (the two-way ANOVA) to estimate the effects of diet and genotype.</p>
<p>The model formula is <code>lengthMM ~ genotype + diet + genotype:diet</code>.</p>
<p>Let’s try to understand this. The <code>genotype + diet</code> part represents the <strong>main effects</strong> of these two variables, and the <code>genotype:diet</code> part represents the <strong>interaction effect</strong> between them. This formula<em>can</em> be shortened to <code>lengthMM ~ genotype * diet</code> (i.e. this is exactly equivalent to the more complicated-looking formula), but I recommend to use the longer version because it is clearer.</p>
<p>So we fit the model like this - putting the formula first, then telling R which data to use:</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb362-1" aria-hidden="true"></a>mod_A &lt;-<span class="st"> </span><span class="kw">lm</span>(lengthMM <span class="op">~</span><span class="st"> </span>genotype <span class="op">+</span><span class="st"> </span>diet <span class="op">+</span><span class="st"> </span>genotype<span class="op">:</span>diet, <span class="dt">data =</span> insectDiet)</span></code></pre></div>
<p>Then we can look at diagnostic plots, as with ANOVA etc.:</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb363-1" aria-hidden="true"></a><span class="kw">library</span>(ggfortify)</span>
<span id="cb363-2"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb363-2" aria-hidden="true"></a><span class="kw">autoplot</span>(mod_A)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-204-1.png" width="672" /></p>
<p>These all look OK. The slightly odd structure in the QQ-plot is caused by the fact that the length data are rounded to the nearest millimeter. There is no evidence of heteroscedasticity (left hand plots) now any major outliers.</p>
</div>
<div id="summarising-the-model-anova" class="section level2" number="11.3">
<h2><span class="header-section-number">11.3</span> Summarising the model (<code>anova</code>)</h2>
<p>Since we are satisfied with the diagnostic plots we can proceed by summarising the model using first <code>anova</code> and then <code>summary</code>.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb364-1" aria-hidden="true"></a><span class="kw">anova</span>(mod_A)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: lengthMM
##               Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## genotype       1 426.02  426.02  99.575 7.135e-13 ***
## diet           1 111.02  111.02  25.949 7.064e-06 ***
## genotype:diet  1  54.19   54.19  12.665 0.0009073 ***
## Residuals     44 188.25    4.28                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>This summary <code>Analysis of Variance Table</code> is similar to the ones you have already seen for one-way ANOVA and linear regression. It just has some extra rows because you have extra explanatory variables. It shows you the degrees of freedom for the different terms in the model (all 1, because they have two levels), the sum of squares (<code>Sum Sq</code>) and mean sum of squares (<code>Mean Sq</code>) and the associated <code>F value</code> and p-value (<code>Pr(&gt;F)</code>). Those F values are all large, leading to highly-significant p-values.</p>
<p>This means that all of those terms in the model explain a significant proportion of the variation in insect length.</p>
<p>But as you know, this summary table doesn’t tell you the direction of the effects. The obvious way to understand your data is to simply look at the plot you have already produced. You could also make an <strong>interaction plot</strong> which is a simplified version of the plot of the raw data.</p>
<p>To do this you first need to create a summary table using <code>dplyr</code> tools <code>summarise</code> and <code>group_by</code> to get the mean and standard errors of the mean:</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb366-1" aria-hidden="true"></a>insectDiet_means &lt;-<span class="st"> </span></span>
<span id="cb366-2"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb366-2" aria-hidden="true"></a><span class="st">  </span>insectDiet <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb366-3"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb366-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(genotype, diet) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># &lt;- remember to group by *both* factors</span></span>
<span id="cb366-4"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb366-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">MeanLength =</span> <span class="kw">mean</span>(lengthMM),<span class="dt">SELength =</span> <span class="kw">sd</span>(lengthMM)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">n</span>()))</span>
<span id="cb366-5"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb366-5" aria-hidden="true"></a>insectDiet_means</span></code></pre></div>
<pre><code>## # A tibble: 4 x 4
## # Groups:   genotype [2]
##   genotype diet        MeanLength SELength
##   &lt;chr&gt;    &lt;chr&gt;            &lt;dbl&gt;    &lt;dbl&gt;
## 1 gt1      highProtein       25.8    0.672
## 2 gt1      lowProtein        20.7    0.527
## 3 gt2      highProtein       17.8    0.698
## 4 gt2      lowProtein        16.8    0.458</code></pre>
<p>Then you can make a simple plot of this information by plotting points, and lines joining them:</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb368-1" aria-hidden="true"></a>(A&lt;-<span class="kw">ggplot</span>(insectDiet_means, </span>
<span id="cb368-2"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb368-2" aria-hidden="true"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> genotype, <span class="dt">y =</span> MeanLength, <span class="dt">colour =</span> diet, <span class="dt">group =</span> diet)) <span class="op">+</span></span>
<span id="cb368-3"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb368-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb368-4"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb368-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_line</span>())</span></code></pre></div>
<p><img src="BB852_files/figure-html/interactionPlot-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>You could add error bars to the points by adding a line defining the <code>ymin</code> and <code>ymax</code> values from the data summary like this:</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb369-1" aria-hidden="true"></a><span class="kw">ggplot</span>(insectDiet_means, </span>
<span id="cb369-2"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb369-2" aria-hidden="true"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> genotype, <span class="dt">y =</span> MeanLength, <span class="dt">colour =</span> diet, <span class="dt">group =</span> diet,</span>
<span id="cb369-3"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb369-3" aria-hidden="true"></a>           <span class="dt">ymin =</span> MeanLength <span class="op">-</span><span class="st"> </span>SELength, <span class="dt">ymax =</span> MeanLength <span class="op">+</span><span class="st"> </span>SELength)) <span class="op">+</span></span>
<span id="cb369-4"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb369-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb369-5"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb369-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb369-6"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb369-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="dt">width =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/errorBars-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>But are these points statistically significantly different from each other?
To answer that question we need to use a post-hoc test</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb370-1" aria-hidden="true"></a><span class="kw">library</span>(agricolae)</span>
<span id="cb370-2"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb370-2" aria-hidden="true"></a><span class="kw">HSD.test</span>(mod_A, <span class="dt">trt =</span> <span class="kw">c</span>(<span class="st">&quot;diet&quot;</span>, <span class="st">&quot;genotype&quot;</span>), <span class="dt">console =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
## Study: mod_A ~ c(&quot;diet&quot;, &quot;genotype&quot;)
## 
## HSD Test for lengthMM 
## 
## Mean Square Error:  4.278409 
## 
## diet:genotype,  means
## 
##                 lengthMM      std  r Min Max
## highProtein:gt1 25.83333 2.329000 12  23  31
## highProtein:gt2 17.75000 2.416797 12  14  22
## lowProtein:gt1  20.66667 1.825742 12  17  24
## lowProtein:gt2  16.83333 1.585923 12  14  19
## 
## Alpha: 0.05 ; DF Error: 44 
## Critical Value of Studentized Range: 3.775958 
## 
## Minimun Significant Difference: 2.254643 
## 
## Treatments with the same letter are not significantly different.
## 
##                 lengthMM groups
## highProtein:gt1 25.83333      a
## lowProtein:gt1  20.66667      b
## highProtein:gt2 17.75000      c
## lowProtein:gt2  16.83333      c</code></pre>
<p>The important part of this output is at the bottom where it tells us <code>Treatments with the same letter are not significantly different.</code>. You can see that the mean lengths between diets for genotype 1 are significantly different (they do not share a letter). However, there is no significant difference between diets for genotype 2 (they share the same letter, <code>c</code>). The two genotypes are also significantly different from each other.</p>
</div>
<div id="summarising-the-model-summary" class="section level2" number="11.4">
<h2><span class="header-section-number">11.4</span> Summarising the model (<code>summary</code>)</h2>
<p>This (above) is generally enough information for a complete write up of results. However, you can ask R to provide the model summary that includes the <span class="math inline">\(R^2\)</span> values, coefficient estimates and standard errors using <code>summary</code>.</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="linear-models-with-a-several-categorical-explanatory-variables.html#cb372-1" aria-hidden="true"></a><span class="kw">summary</span>(mod_A)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = lengthMM ~ genotype + diet + genotype:diet, data = insectDiet)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.7500 -1.0417  0.1667  1.2500  5.1667 
## 
## Coefficients:
##                            Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                 25.8333     0.5971  43.264  &lt; 2e-16 ***
## genotypegt2                 -8.0833     0.8444  -9.572 2.53e-12 ***
## dietlowProtein              -5.1667     0.8444  -6.118 2.26e-07 ***
## genotypegt2:dietlowProtein   4.2500     1.1942   3.559 0.000907 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.068 on 44 degrees of freedom
## Multiple R-squared:  0.7585,	Adjusted R-squared:  0.742 
## F-statistic: 46.06 on 3 and 44 DF,  p-value: 1.254e-13</code></pre>
<p>The most useful thing shown here is the <span class="math inline">\(R^2\)</span> value. Because we have several terms in the model we should use the <code>Adjusted R-squared</code> value of 0.742. This indicates that our model explains 74.2% of variation in insect length.</p>
<p>The next bit is not 100% necessary most of the time…</p>
<p>We already have a good idea of the mean values and standard errors for these data look because we calculated them above directly from the data. For completeness though I will now run through the coefficient estimates part of the summary table.</p>
<p>The coefficient <code>Estimates</code> here are interpreted in a similar way to a one-way ANOVA. Again, it is important to know what the reference point is. When you understand this you can reconstruct the mean values for the various levels of the variables that are estimated by the model. You will see that the model estimates lead to precisely the same estimates as obtained from summarising the data.</p>
<p>Here you can see that:</p>
<ul>
<li><p>The <code>(Intercept)</code> is 25.8333 and must refer to the point for <em>genotype 1</em> on a <em>high protein diet</em> (look at the value of the intercept and compare to the graph/summary table, and/or the output from the Tukey test).</p></li>
<li><p>The second coefficient (<code>genotypegt2</code>) is -8.0833 which is the <strong>difference</strong> between the reference (intercept) and the value for <em>genotype 2</em> on a <em>high protein diet</em>: (25.8333 + (-8.0833) = 17.75).</p></li>
<li><p>The third coefficient (<code>dietlowProtein</code>) is -5.1667 which is the difference between the reference point and for <em>genotype 1</em> on a <em>low protein diet</em>: (25.8333 + (-5.1667) = 20.6666).</p></li>
<li><p>The final coefficient <code>dietlowProtein:genotypegt2</code> is 4.25 and is “interaction effect” of diet and genotype and represents the <em>additional</em> effect of genotype when it is on diet. In other words, in comparison to the reference point (genotype 1 &amp; high protein diet), the effect of a low protein diet is negative (-8.0833), as is the effect of being genotype 2 (-5.1667). However, having both a low protein diet <strong>and</strong> being genotype 2 leads to an additional positive effect (4.25) on length. The resulting estimate of mean length for <em>genotype 2</em> on a <em>low protein diet</em> is 25.8333 + (-8.0833) + (-5.1667) + 4.25 = 16.833.</p></li>
</ul>
<p>This is a bit complicated so my advice is generally to refer to the figures and the outputs of the <code>Tukey.HSD</code> function to obtain the estimate in the different groups.</p>
<p>The logic and methods of the two-way ANOVA can be extended to produce <span class="math inline">\(n\)</span>-way ANOVA with <span class="math inline">\(n\)</span> categorical variables.</p>
</div>
<div id="a-2-way-anova-on-a-fish-behaviour-study" class="section level2" number="11.5">
<h2><span class="header-section-number">11.5</span> A 2-way ANOVA on a fish behaviour study</h2>
<div id="background-1" class="section level3" number="11.5.1">
<h3><span class="header-section-number">11.5.1</span> Background</h3>
<p>Individual differences in animal personality and external appearance such as colouration patterns have both been extensively studied separately. A significant body of research has explored many of pertinent ecological and biological aspects that can be affected by them and their impact upon fitness. Currently little is known about how both factors interact and their effect on reproductive success.</p>
<p>Researchers carried out a study looking at differences in personality and its interaction with colour phenotype in zebrafish (<em>Danio rerio</em>). They used two colour morphs, “homogenous” which has clearly defined lateral stripes, and “heterogenous” which has more variable and less clear patterns.</p>
<p>They also assigned individuals to two personality types which they called “Proactive” (adventurous, risk taking) and “Reactive” (timid, less risk taking). They did this by recording how they explore a new environment</p>
<p>The two variables of interest are:</p>
<ul>
<li>Colour pattern (homogenous and heterogenous)</li>
<li>Personality (proactive and reactive)</li>
</ul>
<p>The research questions are:</p>
<ol style="list-style-type: decimal">
<li>What is the relative influence of colour pattern and personality? Which is more important?</li>
<li>How do the variables interact to determine fitness? e.g. do proactive individuals do better than reactive ones, and does this depend on colour pattern? Or some other pattern?</li>
</ol>
</div>
<div id="your-task" class="section level3" number="11.5.2">
<h3><span class="header-section-number">11.5.2</span> Your task</h3>
<ol style="list-style-type: decimal">
<li><p>Import the data set, <code>fishPersonality.csv</code></p></li>
<li><p>Plot the data (e.g. as a box plot)</p></li>
<li><p>Fit an ANOVA model using <code>lm</code>.</p></li>
<li><p>Look at diagnostic plots from this model (<code>autoplot</code>)</p></li>
<li><p>Use <code>anova</code> to get an Analysis of Variance summary table, and interpret the results.</p></li>
<li><p>Get the coefficient summary (<code>summary</code>) and interpret the output.</p></li>
<li><p>Do post-hoc Tukey tests (e.g. using <code>HSD.test</code> from the <code>agricolae</code> package). Interpret the results.</p></li>
<li><p>Sum up your findings with reference to the initial research questions.</p></li>
</ol>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-models-with-a-single-categorical-explanatory-variable.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linear-models-with-a-single-continuous-explanatory-variable.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jonesor/BB852_Course_Book/edit/master/10-Two-way_ANOVA.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"split_by": "section"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
