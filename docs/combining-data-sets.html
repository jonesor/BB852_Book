<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Combining data sets | BB852 - Data handling, visualisation and statistics</title>
  <meta name="description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Combining data sets | BB852 - Data handling, visualisation and statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Combining data sets | BB852 - Data handling, visualisation and statistics" />
  
  <meta name="twitter:description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  

<meta name="author" content="Owen R. Jones" />


<meta name="date" content="2020-12-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-wrangling-with-dplyr.html"/>
<link rel="next" href="visualising-data-with-ggplot.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.0.0/tabwid.js"></script>
<style type="text/css">

.warning-box {
  border: 3px solid #e60000;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

.advanced-box {
  border: 3px solid #268bd2;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

.do-something {
  border: 3px solid #803e00;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

</style>





<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BB852</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data-wrangling"><i class="fa fa-check"></i><b>1.1</b> Data wrangling</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-visualisation"><i class="fa fa-check"></i><b>1.2</b> Data visualisation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#statistics"><i class="fa fa-check"></i><b>1.3</b> Statistics</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#data-sources"><i class="fa fa-check"></i><b>1.4</b> Data sources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#your-instructors"><i class="fa fa-check"></i><b>1.5</b> Your instructors</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.6</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i><b>2</b> Schedule</a>
<ul>
<li class="chapter" data-level="2.1" data-path="schedule.html"><a href="schedule.html#additional-recommended-reading"><i class="fa fa-check"></i><b>2.1</b> Additional recommended reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="an-r-refresher.html"><a href="an-r-refresher.html"><i class="fa fa-check"></i><b>3</b> An R refresher</a>
<ul>
<li class="chapter" data-level="3.1" data-path="an-r-refresher.html"><a href="an-r-refresher.html#getting-started-with-r"><i class="fa fa-check"></i><b>3.1</b> Getting started with R</a></li>
<li class="chapter" data-level="3.2" data-path="an-r-refresher.html"><a href="an-r-refresher.html#getting-help"><i class="fa fa-check"></i><b>3.2</b> Getting help</a></li>
<li class="chapter" data-level="3.3" data-path="an-r-refresher.html"><a href="an-r-refresher.html#r-as-a-fancy-calculator"><i class="fa fa-check"></i><b>3.3</b> R as a fancy calculator</a></li>
<li class="chapter" data-level="3.4" data-path="an-r-refresher.html"><a href="an-r-refresher.html#objects-in-r"><i class="fa fa-check"></i><b>3.4</b> Objects in R</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="manipulating-objects.html"><a href="manipulating-objects.html"><i class="fa fa-check"></i><b>4</b> Manipulating objects</a>
<ul>
<li class="chapter" data-level="4.1" data-path="manipulating-objects.html"><a href="manipulating-objects.html#missing-values-infinity-and-non-numbers"><i class="fa fa-check"></i><b>4.1</b> Missing values, infinity and “non-numbers”</a></li>
<li class="chapter" data-level="4.2" data-path="manipulating-objects.html"><a href="manipulating-objects.html#basic-information-about-objects"><i class="fa fa-check"></i><b>4.2</b> Basic information about objects</a></li>
<li class="chapter" data-level="4.3" data-path="manipulating-objects.html"><a href="manipulating-objects.html#data-frames"><i class="fa fa-check"></i><b>4.3</b> Data frames</a></li>
<li class="chapter" data-level="4.4" data-path="manipulating-objects.html"><a href="manipulating-objects.html#organising-your-work"><i class="fa fa-check"></i><b>4.4</b> Organising your work</a></li>
<li class="chapter" data-level="4.5" data-path="manipulating-objects.html"><a href="manipulating-objects.html#inspecting-the-data"><i class="fa fa-check"></i><b>4.5</b> Inspecting the data</a></li>
<li class="chapter" data-level="4.6" data-path="manipulating-objects.html"><a href="manipulating-objects.html#classes-in-r"><i class="fa fa-check"></i><b>4.6</b> “Classes” in R</a></li>
<li class="chapter" data-level="4.7" data-path="manipulating-objects.html"><a href="manipulating-objects.html#tables-and-summary-statistics"><i class="fa fa-check"></i><b>4.7</b> Tables and summary statistics</a></li>
<li class="chapter" data-level="4.8" data-path="manipulating-objects.html"><a href="manipulating-objects.html#plotting-data"><i class="fa fa-check"></i><b>4.8</b> Plotting data</a></li>
<li class="chapter" data-level="4.9" data-path="manipulating-objects.html"><a href="manipulating-objects.html#r-packages"><i class="fa fa-check"></i><b>4.9</b> R Packages</a></li>
<li class="chapter" data-level="4.10" data-path="manipulating-objects.html"><a href="manipulating-objects.html#exercise-californian-bird-diversity"><i class="fa fa-check"></i><b>4.10</b> Exercise: Californian bird diversity</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="manipulating-objects.html"><a href="manipulating-objects.html#the-data"><i class="fa fa-check"></i><b>4.10.1</b> The data</a></li>
<li class="chapter" data-level="4.10.2" data-path="manipulating-objects.html"><a href="manipulating-objects.html#try-the-following"><i class="fa fa-check"></i><b>4.10.2</b> Try the following</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Wrangling</b></span></li>
<li class="chapter" data-level="5" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html"><i class="fa fa-check"></i><b>5</b> Data wrangling with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#select"><i class="fa fa-check"></i><b>5.1</b> <code>select</code></a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#filter"><i class="fa fa-check"></i><b>5.2</b> <code>filter</code></a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#arrange"><i class="fa fa-check"></i><b>5.3</b> <code>arrange</code></a></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#summarise-and-group_by"><i class="fa fa-check"></i><b>5.4</b> <code>summarise</code> and <code>group_by</code></a></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#using-pipes-saving-data."><i class="fa fa-check"></i><b>5.5</b> Using pipes, saving data.</a></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#exercise-wrangling-the-amniote-life-history-database"><i class="fa fa-check"></i><b>5.6</b> Exercise: Wrangling the Amniote Life History Database</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="combining-data-sets.html"><a href="combining-data-sets.html"><i class="fa fa-check"></i><b>6</b> Combining data sets</a>
<ul>
<li class="chapter" data-level="6.1" data-path="combining-data-sets.html"><a href="combining-data-sets.html#using-join"><i class="fa fa-check"></i><b>6.1</b> Using <code>join</code></a></li>
<li class="chapter" data-level="6.2" data-path="combining-data-sets.html"><a href="combining-data-sets.html#using-pivot_longer"><i class="fa fa-check"></i><b>6.2</b> Using <code>pivot_longer</code></a></li>
<li class="chapter" data-level="6.3" data-path="combining-data-sets.html"><a href="combining-data-sets.html#exercise-temperature-effects-on-egg-laying-dates"><i class="fa fa-check"></i><b>6.3</b> Exercise: Temperature effects on egg laying dates</a></li>
</ul></li>
<li class="part"><span><b>II Data visualisation</b></span></li>
<li class="chapter" data-level="7" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html"><i class="fa fa-check"></i><b>7</b> Visualising data with <code>ggplot</code></a>
<ul>
<li class="chapter" data-level="7.1" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#histograms"><i class="fa fa-check"></i><b>7.1</b> Histograms</a></li>
<li class="chapter" data-level="7.2" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#facets---splitting-data-across-panels"><i class="fa fa-check"></i><b>7.2</b> “Facets” - splitting data across panels</a></li>
<li class="chapter" data-level="7.3" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#box-plots"><i class="fa fa-check"></i><b>7.3</b> Box plots</a></li>
<li class="chapter" data-level="7.4" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#lines-and-points"><i class="fa fa-check"></i><b>7.4</b> Lines and points</a></li>
<li class="chapter" data-level="7.5" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#scatter-plots"><i class="fa fa-check"></i><b>7.5</b> Scatter plots</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html"><i class="fa fa-check"></i><b>8</b> Distributions and summarising data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#distributions"><i class="fa fa-check"></i><b>8.1</b> Distributions</a></li>
<li class="chapter" data-level="8.2" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#normal-distribution"><i class="fa fa-check"></i><b>8.2</b> Normal distribution</a></li>
<li class="chapter" data-level="8.3" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#comparing-normal-distributions"><i class="fa fa-check"></i><b>8.3</b> Comparing normal distributions</a></li>
<li class="chapter" data-level="8.4" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#poisson-distribution"><i class="fa fa-check"></i><b>8.4</b> Poisson distribution</a></li>
<li class="chapter" data-level="8.5" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#comparing-normal-and-poisson-distributions"><i class="fa fa-check"></i><b>8.5</b> Comparing normal and Poisson distributions</a></li>
<li class="chapter" data-level="8.6" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#the-law-of-large-numbers"><i class="fa fa-check"></i><b>8.6</b> The law of large numbers</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#coin-flipping"><i class="fa fa-check"></i><b>8.6.1</b> Coin flipping</a></li>
<li class="chapter" data-level="8.6.2" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#virtual-dice"><i class="fa fa-check"></i><b>8.6.2</b> Virtual dice</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html"><i class="fa fa-check"></i><b>9</b> Pimping your plots</a>
<ul>
<li class="chapter" data-level="9.1" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#a-basic-plot"><i class="fa fa-check"></i><b>9.1</b> A basic plot</a></li>
<li class="chapter" data-level="9.2" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#axis-limits"><i class="fa fa-check"></i><b>9.2</b> Axis limits</a></li>
<li class="chapter" data-level="9.3" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#transforming-the-axis-log-scale"><i class="fa fa-check"></i><b>9.3</b> Transforming the axis (log scale)</a></li>
<li class="chapter" data-level="9.4" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#changing-the-axis-tick-marks"><i class="fa fa-check"></i><b>9.4</b> Changing the axis tick marks</a></li>
<li class="chapter" data-level="9.5" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#axis-labels"><i class="fa fa-check"></i><b>9.5</b> Axis labels</a></li>
<li class="chapter" data-level="9.6" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#colours"><i class="fa fa-check"></i><b>9.6</b> Colours</a></li>
<li class="chapter" data-level="9.7" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#themes"><i class="fa fa-check"></i><b>9.7</b> Themes</a></li>
<li class="chapter" data-level="9.8" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#moving-the-legend"><i class="fa fa-check"></i><b>9.8</b> Moving the legend</a></li>
<li class="chapter" data-level="9.9" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#combining-multiple-plots"><i class="fa fa-check"></i><b>9.9</b> Combining multiple plots</a></li>
<li class="chapter" data-level="9.10" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#saving-your-plot"><i class="fa fa-check"></i><b>9.10</b> Saving your plot</a></li>
<li class="chapter" data-level="9.11" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#final-word-on-plots"><i class="fa fa-check"></i><b>9.11</b> Final word on plots</a></li>
</ul></li>
<li class="part"><span><b>III Statistics</b></span></li>
<li class="chapter" data-level="10" data-path="randomisation-tests.html"><a href="randomisation-tests.html"><i class="fa fa-check"></i><b>10</b> Randomisation Tests</a>
<ul>
<li class="chapter" data-level="10.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#randomisation-test-in-r"><i class="fa fa-check"></i><b>10.1</b> Randomisation test in R</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#calculate-the-observed-difference"><i class="fa fa-check"></i><b>10.1.1</b> Calculate the observed difference</a></li>
<li class="chapter" data-level="10.1.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#null-distribution"><i class="fa fa-check"></i><b>10.1.2</b> Null distribution</a></li>
<li class="chapter" data-level="10.1.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-significance"><i class="fa fa-check"></i><b>10.1.3</b> Testing significance</a></li>
<li class="chapter" data-level="10.1.4" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-the-hypothesis"><i class="fa fa-check"></i><b>10.1.4</b> Testing the hypothesis</a></li>
<li class="chapter" data-level="10.1.5" data-path="randomisation-tests.html"><a href="randomisation-tests.html#writing-it-up"><i class="fa fa-check"></i><b>10.1.5</b> Writing it up</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#paired-randomisation-tests"><i class="fa fa-check"></i><b>10.2</b> Paired Randomisation Tests</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-randomisation-test"><i class="fa fa-check"></i><b>10.2.1</b> The randomisation test</a></li>
<li class="chapter" data-level="10.2.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#null-distribution-1"><i class="fa fa-check"></i><b>10.2.2</b> Null distribution</a></li>
<li class="chapter" data-level="10.2.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-formal-hypothesis-test"><i class="fa fa-check"></i><b>10.2.3</b> The formal hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#exercise-sexual-selection-in-hercules-beetles"><i class="fa fa-check"></i><b>10.3</b> Exercise: Sexual selection in Hercules beetles</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html"><i class="fa fa-check"></i><b>11</b> Comparing two means with a t-test</a>
<ul>
<li class="chapter" data-level="11.1" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#some-theory"><i class="fa fa-check"></i><b>11.1</b> Some theory</a></li>
<li class="chapter" data-level="11.2" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#one-sample-t-test"><i class="fa fa-check"></i><b>11.2</b> One sample t-test</a></li>
<li class="chapter" data-level="11.3" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#doing-it-by-hand---where-does-the-t-statistic-come-from"><i class="fa fa-check"></i><b>11.3</b> Doing it “by hand” - where does the t-statistic come from?</a></li>
<li class="chapter" data-level="11.4" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#paired-t-test"><i class="fa fa-check"></i><b>11.4</b> Paired t-test</a></li>
<li class="chapter" data-level="11.5" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#a-paired-t-test-is-a-one-sample-test."><i class="fa fa-check"></i><b>11.5</b> A paired t-test is a one-sample test.</a></li>
<li class="chapter" data-level="11.6" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#two-sample-t-test"><i class="fa fa-check"></i><b>11.6</b> Two sample t-test</a></li>
<li class="chapter" data-level="11.7" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#t-tests-are-linear-models"><i class="fa fa-check"></i><b>11.7</b> t-tests are linear models</a></li>
<li class="chapter" data-level="11.8" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-sex-differences-in-fine-motor-skills"><i class="fa fa-check"></i><b>11.8</b> Exercise: Sex differences in fine motor skills</a></li>
<li class="chapter" data-level="11.9" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-therapy-for-anorexia"><i class="fa fa-check"></i><b>11.9</b> Exercise: Therapy for anorexia</a></li>
<li class="chapter" data-level="11.10" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-compare-t-tests-with-randomisation-tests"><i class="fa fa-check"></i><b>11.10</b> Exercise: Compare t-tests with randomisation tests</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html"><i class="fa fa-check"></i><b>12</b> Linear models with a single categorical explanatory variable</a>
<ul>
<li class="chapter" data-level="12.1" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#one-way-anova"><i class="fa fa-check"></i><b>12.1</b> One-way ANOVA</a></li>
<li class="chapter" data-level="12.2" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#fitting-an-anova-in-r"><i class="fa fa-check"></i><b>12.2</b> Fitting an ANOVA in R</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#where-are-the-differences"><i class="fa fa-check"></i><b>12.2.1</b> Where are the differences?</a></li>
<li class="chapter" data-level="12.2.2" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#tukeys-honestly-significant-difference-hsd"><i class="fa fa-check"></i><b>12.2.2</b> Tukey’s Honestly Significant Difference (HSD)</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#anova-calculation-by-hand."><i class="fa fa-check"></i><b>12.3</b> ANOVA calculation “by hand”.</a></li>
<li class="chapter" data-level="12.4" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#exercise-apple-tree-crop-yield"><i class="fa fa-check"></i><b>12.4</b> Exercise: Apple tree crop yield</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html"><i class="fa fa-check"></i><b>13</b> Linear models with a single continuous explanatory variable</a>
<ul>
<li class="chapter" data-level="13.1" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#some-theory"><i class="fa fa-check"></i><b>13.1</b> Some theory</a></li>
<li class="chapter" data-level="13.2" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#evaluating-a-hypothesis-with-a-linear-regression-model"><i class="fa fa-check"></i><b>13.2</b> Evaluating a hypothesis with a linear regression model</a></li>
<li class="chapter" data-level="13.3" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#assumptions"><i class="fa fa-check"></i><b>13.3</b> Assumptions</a></li>
<li class="chapter" data-level="13.4" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#worked-example-height-hand-width-relationship"><i class="fa fa-check"></i><b>13.4</b> Worked example: height-hand width relationship</a></li>
<li class="chapter" data-level="13.5" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#exercise-chirping-crickets"><i class="fa fa-check"></i><b>13.5</b> Exercise: Chirping crickets</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html"><i class="fa fa-check"></i><b>14</b> Linear models with categorical and continuous explanatory variables</a>
<ul>
<li class="chapter" data-level="14.1" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#the-height-hand-width-example."><i class="fa fa-check"></i><b>14.1</b> The height ~ hand width example.</a></li>
<li class="chapter" data-level="14.2" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#summarising-with-anova"><i class="fa fa-check"></i><b>14.2</b> Summarising with <code>anova</code></a></li>
<li class="chapter" data-level="14.3" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#the-summary-of-coefficients-summary"><i class="fa fa-check"></i><b>14.3</b> The summary of coefficients (<code>summary</code>)</a></li>
<li class="chapter" data-level="14.4" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#simplifying-the-model"><i class="fa fa-check"></i><b>14.4</b> Simplifying the model</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html"><i class="fa fa-check"></i><b>15</b> Linear models with &gt;1 categorical explanatory variables</a>
<ul>
<li class="chapter" data-level="15.1" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#fitting-a-two-way-anova-model"><i class="fa fa-check"></i><b>15.1</b> Fitting a two-way ANOVA model</a></li>
<li class="chapter" data-level="15.2" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#summarising-the-model-anova"><i class="fa fa-check"></i><b>15.2</b> Summarising the model (<code>anova</code>)</a></li>
<li class="chapter" data-level="15.3" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#summarising-the-model-summary"><i class="fa fa-check"></i><b>15.3</b> Summarising the model (<code>summary</code>)</a></li>
<li class="chapter" data-level="15.4" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#exercise-fish-behaviour"><i class="fa fa-check"></i><b>15.4</b> Exercise: Fish behaviour</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html"><i class="fa fa-check"></i><b>16</b> Generalised linear models</a>
<ul>
<li class="chapter" data-level="16.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#count-data-with-poisson-errors."><i class="fa fa-check"></i><b>16.1</b> Count data with Poisson errors.</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-number-of-offspring-in-foxes."><i class="fa fa-check"></i><b>16.1.1</b> Example: Number of offspring in foxes.</a></li>
<li class="chapter" data-level="16.1.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-cancer-clusters"><i class="fa fa-check"></i><b>16.1.2</b> Example: Cancer clusters</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#exercise-maze-runner"><i class="fa fa-check"></i><b>16.2</b> Exercise: Maze runner</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html"><i class="fa fa-check"></i><b>17</b> Extending use cases of GLM</a>
<ul>
<li class="chapter" data-level="17.1" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#binomial-response-data"><i class="fa fa-check"></i><b>17.1</b> Binomial response data</a></li>
<li class="chapter" data-level="17.2" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-nfl-field-goals"><i class="fa fa-check"></i><b>17.2</b> Example: NFL field goals</a></li>
<li class="chapter" data-level="17.3" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-sex-ratio-in-turtles"><i class="fa fa-check"></i><b>17.3</b> Example: Sex ratio in turtles</a></li>
<li class="chapter" data-level="17.4" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-smoking"><i class="fa fa-check"></i><b>17.4</b> Example: Smoking</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html"><i class="fa fa-check"></i><b>18</b> Power analysis by simulation</a>
<ul>
<li class="chapter" data-level="18.1" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#type-i-and-ii-errors-and-statistical-power"><i class="fa fa-check"></i><b>18.1</b> Type I and II errors and statistical power</a></li>
<li class="chapter" data-level="18.2" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#what-determines-statistical-power"><i class="fa fa-check"></i><b>18.2</b> What determines statistical power?</a></li>
<li class="chapter" data-level="18.3" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#an-example-of-calculating-statistical-power."><i class="fa fa-check"></i><b>18.3</b> An example of calculating statistical power.</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#the-simulation"><i class="fa fa-check"></i><b>18.3.1</b> The simulation</a></li>
<li class="chapter" data-level="18.3.2" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#some-questions-for-you-to-address"><i class="fa fa-check"></i><b>18.3.2</b> Some questions for you to address:</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#summary"><i class="fa fa-check"></i><b>18.4</b> Summary</a></li>
<li class="chapter" data-level="18.5" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#extending-the-simulation-optional-advanced"><i class="fa fa-check"></i><b>18.5</b> Extending the simulation (optional, advanced)</a></li>
<li class="chapter" data-level="18.6" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#exercise-1-snails-on-the-move"><i class="fa fa-check"></i><b>18.6</b> Exercise 1: Snails on the move</a></li>
<li class="chapter" data-level="18.7" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#exercise-2-mouse-lemur-strength"><i class="fa fa-check"></i><b>18.7</b> Exercise 2: Mouse lemur strength</a></li>
</ul></li>
<li class="part"><span><b>IV Coming soon(ish)</b></span></li>
<li class="chapter" data-level="19" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html"><i class="fa fa-check"></i><b>19</b> Coming soon (maybe)!</a>
<ul>
<li class="chapter" data-level="19.1" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#multivariate-statistics"><i class="fa fa-check"></i><b>19.1</b> Multivariate statistics</a></li>
<li class="chapter" data-level="19.2" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#transforming-variables"><i class="fa fa-check"></i><b>19.2</b> Transforming variables</a></li>
<li class="chapter" data-level="19.3" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#non-linear-regression"><i class="fa fa-check"></i><b>19.3</b> Non-linear regression</a></li>
<li class="chapter" data-level="19.4" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#nested-or-blocked-study-designs"><i class="fa fa-check"></i><b>19.4</b> Nested or blocked study designs</a></li>
</ul></li>
<li class="part"><span><b>V Exam</b></span></li>
<li class="chapter" data-level="20" data-path="exam-2020.html"><a href="exam-2020.html"><i class="fa fa-check"></i><b>20</b> Exam 2020</a></li>
<li class="part"><span><b>VI Solutions</b></span></li>
<li class="chapter" data-level="21" data-path="exercise-solutions.html"><a href="exercise-solutions.html"><i class="fa fa-check"></i><b>21</b> Exercise Solutions</a>
<ul>
<li class="chapter" data-level="21.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-californian-bird-diversity"><i class="fa fa-check"></i><b>21.1</b> Exercise Solutions: Californian bird diversity</a></li>
<li class="chapter" data-level="21.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-wrangling-the-amniote-life-history-database"><i class="fa fa-check"></i><b>21.2</b> Exercise Solutions: Wrangling the Amniote Life History Database</a></li>
<li class="chapter" data-level="21.3" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-temperature-effects-on-egg-laying-dates"><i class="fa fa-check"></i><b>21.3</b> Exercise Solutions: Temperature effects on egg laying dates</a></li>
<li class="chapter" data-level="21.4" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-sexual-selection-in-hercules-beetles"><i class="fa fa-check"></i><b>21.4</b> Exercise Solutions: Sexual selection in Hercules beetles</a></li>
<li class="chapter" data-level="21.5" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-sex-differences-in-fine-motor-skills"><i class="fa fa-check"></i><b>21.5</b> Exercise: Sex differences in fine motor skills</a></li>
<li class="chapter" data-level="21.6" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-therapy-for-anorexia"><i class="fa fa-check"></i><b>21.6</b> Exercise: Therapy for anorexia</a></li>
<li class="chapter" data-level="21.7" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-compare-t-tests-with-randomisation-tests"><i class="fa fa-check"></i><b>21.7</b> Exercise: Compare t-tests with randomisation tests</a></li>
<li class="chapter" data-level="21.8" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-apple-tree-crop-yield"><i class="fa fa-check"></i><b>21.8</b> Exercise Solutions: Apple tree crop yield</a></li>
<li class="chapter" data-level="21.9" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-chirping-crickets"><i class="fa fa-check"></i><b>21.9</b> Exercise Solutions: Chirping crickets</a></li>
<li class="chapter" data-level="21.10" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-fish-behaviour"><i class="fa fa-check"></i><b>21.10</b> Exercise Solutions: Fish behaviour</a></li>
<li class="chapter" data-level="21.11" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-maze-runner"><i class="fa fa-check"></i><b>21.11</b> Exercise Solutions: Maze runner</a></li>
<li class="chapter" data-level="21.12" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-snails-on-the-move"><i class="fa fa-check"></i><b>21.12</b> Exercise Solutions: Snails on the move</a></li>
<li class="chapter" data-level="21.13" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-mouse-lemur-strength"><i class="fa fa-check"></i><b>21.13</b> Exercise Solutions: Mouse lemur strength</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BB852 - Data handling, visualisation and statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="combining-data-sets" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> Combining data sets</h1>
<p>Handling data is often not limited to single data sets. One common task is to combine two (or more) datasets together. For example, one dataset might include a set of observations from a field study, while another might have information about the weather throughout the study period, or site-specific information. It is therefore useful to be able to combine these datasets to add the information from the second table to the first table.</p>
<p><strong>R</strong> does this with the <code>dplyr</code> function <code>join</code>. In the next section you will first learn how <code>join</code> works by following an example that asks a research question that can only be answered by two data sets. After that, you will work on your own to do a similar analysis without explicit instructions (i.e. you will need to figure out how to apply the method to new data.</p>
<div id="using-join" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Using <code>join</code></h2>
<p>By following this example you will learn how to combine two data sets to create a new one of combined data to answer a conservation-related question: “<strong>Does threat status vary with species’ generation times?</strong>”</p>
<p>This question is crucial to conservation biologists because it helps us to generalise our ideas about what drives extinction risks. In other words, if we can say “<em>species with slow life histories tend to be more threatened</em>” then this gives useful information that can help with planning. For example, imagine we have some species that have not yet been assessed (we don’t know if they are threatened or not). Should we focus attention on the one with a short generation time, or long generation time?</p>
<p>To answer the question we will need to import two large data sets, tidy them up a bit and then combine them for analysis.</p>
<p>Let’s start with the “Amniote Life History Database,”<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> which is a good source of life history data. We have encountered this database before. Recall that the missing values (which are normally coded as <code>NA</code> in R) are coded as “<code>-999</code>”. The easiest way to take care of this is to specify this when we import the data using the <code>na.strings</code> argument of the <code>read.csv</code> function. Thus we can import the data like this:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="combining-data-sets.html#cb151-1" aria-hidden="true"></a>amniote &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;CourseData/Amniote_Database_Aug_2015.csv&quot;</span>,<span class="dt">na.strings =</span> <span class="st">&quot;-999&quot;</span>)</span></code></pre></div>
<p>We can filter on the taxonomic <code>class</code> to subset to only mammals. Then, to address our question, we want data on generation time for mammals. Generation time is often measured as the average age at which females reproduce so we can get close to that with <code>female_maturity_d</code>. We will first <code>select</code> these columns, along with <code>genus</code> and <code>species</code>. We can combine these two taxonomic variables using <code>mutate</code> and <code>paste</code> to get our Latin binomial species name.</p>
<p>We have previously learned that log transforming such variables is a good thing to do, so we can use <code>mutate</code> again to do this transformation.</p>
<p>Finally, we can use <code>na.omit</code> to get rid of entries with missing values (which we cannot use). This is not essential, but keeps things more manageable.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="combining-data-sets.html#cb152-1" aria-hidden="true"></a>mammal &lt;-<span class="st"> </span>amniote <span class="op">%&gt;%</span></span>
<span id="cb152-2"><a href="combining-data-sets.html#cb152-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(class <span class="op">==</span><span class="st"> &quot;Mammalia&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#get the mammals only</span></span>
<span id="cb152-3"><a href="combining-data-sets.html#cb152-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(genus, species, female_maturity_d) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#get useful columns </span></span>
<span id="cb152-4"><a href="combining-data-sets.html#cb152-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">species =</span> <span class="kw">paste</span>(genus, species)) <span class="op">%&gt;%</span></span>
<span id="cb152-5"><a href="combining-data-sets.html#cb152-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>genus) <span class="op">%&gt;%</span></span>
<span id="cb152-6"><a href="combining-data-sets.html#cb152-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">logMaturity =</span> <span class="kw">log</span>(female_maturity_d)) <span class="op">%&gt;%</span></span>
<span id="cb152-7"><a href="combining-data-sets.html#cb152-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">na.omit</span>()</span></code></pre></div>
<p>Let’s take a quick look at what we have:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="combining-data-sets.html#cb153-1" aria-hidden="true"></a><span class="kw">head</span>(mammal)</span></code></pre></div>
<pre><code>##                      species female_maturity_d
## 20         Echinops telfairi         278.42000
## 22    Hemicentetes nigriceps          48.57000
## 23 Hemicentetes semispinosus          46.19892
## 27         Microgale dobsoni         669.59200
## 40        Microgale talazaci         639.00000
## 47           Setifer setosus         198.00000
##    logMaturity
## 20    5.629131
## 22    3.883006
## 23    3.832956
## 27    6.506669
## 40    6.459904
## 47    5.288267</code></pre>
<p>Looks good. Now let’s import the IUCN Red List data.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="combining-data-sets.html#cb155-1" aria-hidden="true"></a>redlist &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;CourseData/MammalRedList.csv&quot;</span>)</span></code></pre></div>
<p>Let’s take a look at that.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="combining-data-sets.html#cb156-1" aria-hidden="true"></a><span class="kw">names</span>(redlist)</span></code></pre></div>
<pre><code>##  [1] &quot;Species.ID&quot;               
##  [2] &quot;Kingdom&quot;                  
##  [3] &quot;Phylum&quot;                   
##  [4] &quot;Class&quot;                    
##  [5] &quot;Order&quot;                    
##  [6] &quot;Family&quot;                   
##  [7] &quot;Genus&quot;                    
##  [8] &quot;Species&quot;                  
##  [9] &quot;Authority&quot;                
## [10] &quot;Infraspecific.rank&quot;       
## [11] &quot;Infraspecific.name&quot;       
## [12] &quot;Infraspecific.authority&quot;  
## [13] &quot;Stock.subpopulation&quot;      
## [14] &quot;Synonyms&quot;                 
## [15] &quot;Common.names..Eng.&quot;       
## [16] &quot;Common.names..Fre.&quot;       
## [17] &quot;Common.names..Spa.&quot;       
## [18] &quot;Red.List.status&quot;          
## [19] &quot;Red.List.criteria&quot;        
## [20] &quot;Red.List.criteria.version&quot;
## [21] &quot;Year.assessed&quot;            
## [22] &quot;Population.trend&quot;         
## [23] &quot;Petitioned&quot;</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="combining-data-sets.html#cb158-1" aria-hidden="true"></a><span class="kw">unique</span>(redlist<span class="op">$</span>Red.List.status)</span></code></pre></div>
<pre><code>## [1] &quot;DD&quot; &quot;LC&quot; &quot;CR&quot; &quot;NT&quot; &quot;EN&quot; &quot;VU&quot; &quot;EX&quot; &quot;EW&quot;</code></pre>
<p>There’s a lot of information there but what we really need is simply the Latin binomial (for which we need <code>genus</code> and <code>species</code>) and the threat status <code>Red.List.status</code>.</p>
<p>R treats categorical variables (<code>factor</code> variables) as alphabetical, but in this case the red list status has a meaning going from low threat (Least Concern - LC) to Critically Endangered (CR) and even Extinct in the Wild (EX) at the other end of the spectrum. We can define this ordering using <code>mutate</code> with the <code>factor</code> function.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="combining-data-sets.html#cb160-1" aria-hidden="true"></a>redlist &lt;-<span class="st"> </span>redlist <span class="op">%&gt;%</span></span>
<span id="cb160-2"><a href="combining-data-sets.html#cb160-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">species =</span> <span class="kw">paste</span>(Genus, Species))<span class="op">%&gt;%</span></span>
<span id="cb160-3"><a href="combining-data-sets.html#cb160-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(species, Red.List.status) <span class="op">%&gt;%</span></span>
<span id="cb160-4"><a href="combining-data-sets.html#cb160-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Red.List.status =</span> <span class="kw">factor</span>(Red.List.status, </span>
<span id="cb160-5"><a href="combining-data-sets.html#cb160-5" aria-hidden="true"></a>                                  <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;LC&quot;</span>,<span class="st">&quot;NT&quot;</span>,<span class="st">&quot;VU&quot;</span>,<span class="st">&quot;EN&quot;</span>,<span class="st">&quot;CR&quot;</span>,<span class="st">&quot;EW&quot;</span>,<span class="st">&quot;EX&quot;</span>)))</span>
<span id="cb160-6"><a href="combining-data-sets.html#cb160-6" aria-hidden="true"></a></span>
<span id="cb160-7"><a href="combining-data-sets.html#cb160-7" aria-hidden="true"></a><span class="kw">head</span>(redlist)</span></code></pre></div>
<pre><code>##                species Red.List.status
## 1   Abditomys latidens            &lt;NA&gt;
## 2    Abeomelomys sevia              LC
## 3 Abrawayaomys ruschii              LC
## 4   Abrocoma bennettii              LC
## 5 Abrocoma boliviensis              CR
## 6      Abrocoma budini            &lt;NA&gt;</code></pre>
<p>Now we can combine this with the life history data from above using <code>left_join</code>.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="combining-data-sets.html#cb162-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">left_join</span>(mammal,redlist,<span class="dt">by =</span> <span class="st">&quot;species&quot;</span>)</span></code></pre></div>
<p>Let’s take a look at what we have now:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="combining-data-sets.html#cb163-1" aria-hidden="true"></a><span class="kw">head</span>(x)</span></code></pre></div>
<pre><code>##                     species female_maturity_d
## 1         Echinops telfairi         278.42000
## 2    Hemicentetes nigriceps          48.57000
## 3 Hemicentetes semispinosus          46.19892
## 4         Microgale dobsoni         669.59200
## 5        Microgale talazaci         639.00000
## 6           Setifer setosus         198.00000
##   logMaturity Red.List.status
## 1    5.629131              LC
## 2    3.883006              LC
## 3    3.832956              LC
## 4    6.506669              LC
## 5    6.459904              LC
## 6    5.288267              LC</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="combining-data-sets.html#cb165-1" aria-hidden="true"></a><span class="kw">summary</span>(x)</span></code></pre></div>
<pre><code>##    species          female_maturity_d
##  Length:2000        Min.   :  23.81  
##  Class :character   1st Qu.: 121.53  
##  Mode  :character   Median : 344.12  
##                     Mean   : 574.92  
##                     3rd Qu.: 696.38  
##                     Max.   :6391.56  
##                                      
##   logMaturity    Red.List.status
##  Min.   :3.170   LC     :1219   
##  1st Qu.:4.800   VU     : 176   
##  Median :5.841   EN     : 168   
##  Mean   :5.745   NT     : 114   
##  3rd Qu.:6.546   CR     :  66   
##  Max.   :8.763   (Other):  10   
##                  NA&#39;s   : 247</code></pre>
<p>You can see that there are 247 missing values for the Red List status. These are either species that have not yet been assessed, or maybe where there are mismatches in the species names between the two databases. We will ignore this problem today.</p>
<p>Before plotting, I will also use <code>filter</code> remove species that are extinct (status = “EX” and “EW”). To do this I use the <code>%in%</code> argument to allow me to match a vector of variables. Because I want to NOT match them I negate the match using <code>!</code>.</p>
<p>I then ensure that those levels are removed from the variable using <code>droplevels</code>.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="combining-data-sets.html#cb167-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span>x <span class="op">%&gt;%</span></span>
<span id="cb167-2"><a href="combining-data-sets.html#cb167-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>Red.List.status <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;EX&quot;</span>,<span class="st">&quot;EW&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb167-3"><a href="combining-data-sets.html#cb167-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">droplevels</span>()</span></code></pre></div>
<p>Let’s now plot the data to answer the question.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="combining-data-sets.html#cb168-1" aria-hidden="true"></a><span class="kw">plot</span>(x<span class="op">$</span>Red.List.status,x<span class="op">$</span>logMaturity,<span class="dt">ylab=</span><span class="st">&quot;Maturity&quot;</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-83-1.png" width="672" /></p>
<p>What can we see? If you focus on the median values, it looks like there is a weak positive relationship between this life history trait and threat status: animals with slower life histories tend to be more threatened.</p>
</div>
<div id="using-pivot_longer" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Using <code>pivot_longer</code></h2>
<p>Sometimes data are not arranged in a way that make them easy to use in R. For example, data could be arranged so that the column headings are themselves data (e.g. treatments, sex of individuals).</p>
<p>To illustrate this I will use a data set on heights of men and women.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="combining-data-sets.html#cb169-1" aria-hidden="true"></a>heights &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;CourseData/heights.csv&quot;</span>) </span></code></pre></div>
<p>Let’s take a look:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="combining-data-sets.html#cb170-1" aria-hidden="true"></a>heights</span></code></pre></div>
<pre><code>##      place heightMale heightFemale
## 1   London        170          164
## 2   London        176          158
## 3   London        179          157
## 4   London        166          158
## 5   London        177          153
## 6   London        177          155
## 7   London        173          151
## 8   London        173          155
## 9   London        173          159
## 10  London        171          158
## 11  London        173          166
## 12  London        171          156
## 13  London        172          157
## 14  London        175          159
## 15  London        179          156
## 16 Bristol        175          156
## 17 Bristol        173          156
## 18 Bristol        171          155
## 19 Bristol        172          158
## 20 Bristol        185          158
## 21 Bristol        176          153
## 22 Bristol        173          158
## 23 Bristol        173          156
## 24 Bristol        177          156
## 25 Bristol        172          159
## 26 Bristol        169          162
## 27 Bristol        177          167
## 28 Bristol        171          157
## 29 Bristol        175          166
## 30 Bristol        171          155</code></pre>
<p>I would like to make a boxplot, but it is not possible to easily do it with the data arranged in this format. What I need to do is “unpack” or rearrange the data to add another column for sex. This will make the data frame twice as long, and less wide.</p>
<p>There is a convenient function called <code>pivot_longer</code> in the <code>tidyr</code> package that will do this for you.
You can “pipe” data into the funtion, then tell it which columns you would like to move, and then give it the name of the new column that contains data that <strong>was</strong> in the column heading, and the name of the column containing the data.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="combining-data-sets.html#cb172-1" aria-hidden="true"></a>newHeights &lt;-<span class="st"> </span>heights <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb172-2"><a href="combining-data-sets.html#cb172-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(heightMale,heightFemale),<span class="dt">names_to =</span> <span class="kw">c</span>(<span class="st">&quot;Sex&quot;</span>),<span class="dt">values_to =</span> <span class="st">&quot;Height&quot;</span>)</span>
<span id="cb172-3"><a href="combining-data-sets.html#cb172-3" aria-hidden="true"></a></span>
<span id="cb172-4"><a href="combining-data-sets.html#cb172-4" aria-hidden="true"></a>newHeights</span></code></pre></div>
<pre><code>## # A tibble: 60 x 3
##    place  Sex          Height
##    &lt;chr&gt;  &lt;chr&gt;         &lt;int&gt;
##  1 London heightMale      170
##  2 London heightFemale    164
##  3 London heightMale      176
##  4 London heightFemale    158
##  5 London heightMale      179
##  6 London heightFemale    157
##  7 London heightMale      166
##  8 London heightFemale    158
##  9 London heightMale      177
## 10 London heightFemale    153
## # … with 50 more rows</code></pre>
<p>We are nearly done. But this is not perfect because the names in the <code>Sex</code> column are not right. We can fix this in a couple ways. Here’s one easy way using the function <code>gsub</code>. The <code>gsub</code> function (“<strong>g</strong>eneral <strong>sub</strong>stution) finds text and replaces it with other text. In this case we want to find”height" and replace it with nothing ("").</p>
<p>So we can now complete the job with a <code>mutate</code> command, and make sure it is recognised as a categorical variable (a <code>factor</code>, like this:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="combining-data-sets.html#cb174-1" aria-hidden="true"></a>newHeights &lt;-<span class="st"> </span>heights <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb174-2"><a href="combining-data-sets.html#cb174-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(heightMale,heightFemale),<span class="dt">names_to =</span> <span class="kw">c</span>(<span class="st">&quot;Sex&quot;</span>),<span class="dt">values_to =</span> <span class="st">&quot;Height&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb174-3"><a href="combining-data-sets.html#cb174-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Sex =</span> <span class="kw">gsub</span>(<span class="dt">pattern =</span> <span class="st">&quot;height&quot;</span>,<span class="dt">replacement =</span> <span class="st">&quot;&quot;</span>,<span class="dt">x =</span> Sex)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb174-4"><a href="combining-data-sets.html#cb174-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Sex =</span> <span class="kw">as.factor</span>(Sex))</span>
<span id="cb174-5"><a href="combining-data-sets.html#cb174-5" aria-hidden="true"></a></span>
<span id="cb174-6"><a href="combining-data-sets.html#cb174-6" aria-hidden="true"></a>newHeights</span></code></pre></div>
<pre><code>## # A tibble: 60 x 3
##    place  Sex    Height
##    &lt;chr&gt;  &lt;fct&gt;   &lt;int&gt;
##  1 London Male      170
##  2 London Female    164
##  3 London Male      176
##  4 London Female    158
##  5 London Male      179
##  6 London Female    157
##  7 London Male      166
##  8 London Female    158
##  9 London Male      177
## 10 London Female    153
## # … with 50 more rows</code></pre>
<p>Now we can plot those data more easily</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="combining-data-sets.html#cb176-1" aria-hidden="true"></a><span class="kw">plot</span>(newHeights<span class="op">$</span>Sex,newHeights<span class="op">$</span>Height)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
<p>This data manipulation is useful surprisingly often.</p>
</div>
<div id="exercise-temperature-effects-on-egg-laying-dates" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Exercise: Temperature effects on egg laying dates</h2>
<p>Data have been collected on great tits (musvit) at SDU for several years. Your task today is to analyse these data to answer the question: <em>is egg laying date associated with spring temperature?</em> The idea here is that warmer springs will lead to delayed egg laying which could have negative consequences to the population if their caterpillar food source doesn’t keep pace with the change.</p>
<p>You are provided with two data sets: one on the birds and another on weather. You will need to process these using tools in the <code>dplyr</code> package, and combine them (using <code>left_join</code>) for analysis.</p>
<p>The first data set, <code>eggDates.csv</code>, is data from the SDU birds project. The data are arranged in columns where each column is a year and each row is a nest. The data in each column is the day of the year that the first egg in the nest was laid.</p>
<p>These data do NOT fulfill the “tidy data” standard where each variable gets a column. In this case,a single variable (first egg date) gets many columns (one for each year), and column headers are data (the years). The data will need to be processed before you can analyse it.</p>
<p>You will need to use <code>pivot_wider</code> to fix this issue so that you produce a version of the data with three columns - <code>nestNumber</code>, <code>Year</code> and <code>dayNumber</code>.</p>
<p>The second dataset, <code>AarslevTemperature.csv</code>, is a weather dataset from Årslev near Odense. This dataset includes daily temperatures records for several years. You will need to <code>summarise</code> this data to obtain a small dataset that has the weather of interest - average temperature in the months of February to April for each year.</p>
<p>To answer the question, you will need to join these data sets together.</p>
<ol style="list-style-type: decimal">
<li><p>Import the data and take a look at it with <code>head</code> or <code>str</code>.</p></li>
<li><p>Use <code>pivot_longer</code> to reformat the data. This might take a bit of trial and error - don’t give up!</p></li>
</ol>
<p>Maybe this will help: The first argument in the <code>pivot_longer</code> command (<code>cols</code>) tells R which columns contain the data you are interested in (in this case, these are <code>y2013</code>,<code>y2014</code> etc). Then the <code>names_to</code> argument tells R what you want to name the new column from this data (in this case, <code>Year</code>). Then, the <code>values_to</code> argument tells R what the data column should be called (e.g. <code>Day</code>). In addition, there is a useful argument called <code>names_prefix</code> that will remove the part of the column name (e.g. the <code>y</code> of <code>y2013</code>)</p>
<p>You should also make sure that the <code>Year</code> column is recognised as being a numeric variable rather than a character string. You can do this by adding a command using <code>mutate</code> and <code>as.numeric</code>, like this <code>mutate(Year = as.numeric(Year))</code></p>
<p>You should end up with a dataset with three columns as described above.</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Calculate the mean egg date per year using <code>summarise</code> (remember to <code>group_by</code> the year first). Take a look at the data.</p></li>
<li><p>Import the weather data and take a look at it with <code>head</code> or <code>str</code>.</p></li>
<li><p>Use <code>filter</code> subset to the months of interest (February-April) and then <code>summarise</code> the data to calculate the mean temperature in this period (remember to <code>group_by</code> year). Look at the data. You should end up with a dataset with two columns - <code>year</code> and <code>meanSpringTemp</code>.</p></li>
<li><p>Join the two datasets together using <code>left_join</code>. You should now have a dataset with columns <code>nestNumber</code>, <code>Year</code>, <code>dayNumber</code> and <code>meanAprilTemp</code></p></li>
<li><p>plot a graph of <code>meanAprilTemp</code> on the x-axis and <code>dayNumber</code> on the y-axis.</p></li>
</ol>
<p>Now you should be able to answer the question we started with: is laying date associated with spring temperatures.</p>

</div>
</div>



</div>
<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p><a href="https://esajournals.onlinelibrary.wiley.com/doi/10.1890/15-0846R.1" class="uri">https://esajournals.onlinelibrary.wiley.com/doi/10.1890/15-0846R.1</a><a href="combining-data-sets.html#fnref5" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-wrangling-with-dplyr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="visualising-data-with-ggplot.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jonesor/BB852_Book/edit/master/1_02-combiningDatasets.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["BB852.pdf"],
"toc": {
"collapse": "section"
},
"split_by": "section"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
