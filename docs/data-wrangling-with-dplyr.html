<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Data wrangling with dplyr | BB852 - Data handling, visualisation and statistics</title>
  <meta name="description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Data wrangling with dplyr | BB852 - Data handling, visualisation and statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Data wrangling with dplyr | BB852 - Data handling, visualisation and statistics" />
  
  <meta name="twitter:description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  

<meta name="author" content="Owen R. Jones" />


<meta name="date" content="2020-12-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="manipulating-objects.html"/>
<link rel="next" href="combining-data-sets.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.0.0/tabwid.js"></script>
<style type="text/css">

.warning-box {
  border: 3px solid #e60000;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

.advanced-box {
  border: 3px solid #268bd2;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

.do-something {
  border: 3px solid #803e00;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

</style>





<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BB852</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data-wrangling"><i class="fa fa-check"></i><b>1.1</b> Data wrangling</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-visualisation"><i class="fa fa-check"></i><b>1.2</b> Data visualisation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#statistics"><i class="fa fa-check"></i><b>1.3</b> Statistics</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#data-sources"><i class="fa fa-check"></i><b>1.4</b> Data sources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#your-instructors"><i class="fa fa-check"></i><b>1.5</b> Your instructors</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.6</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i><b>2</b> Schedule</a>
<ul>
<li class="chapter" data-level="2.1" data-path="schedule.html"><a href="schedule.html#additional-recommended-reading"><i class="fa fa-check"></i><b>2.1</b> Additional recommended reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="an-r-refresher.html"><a href="an-r-refresher.html"><i class="fa fa-check"></i><b>3</b> An R refresher</a>
<ul>
<li class="chapter" data-level="3.1" data-path="an-r-refresher.html"><a href="an-r-refresher.html#getting-started-with-r"><i class="fa fa-check"></i><b>3.1</b> Getting started with R</a></li>
<li class="chapter" data-level="3.2" data-path="an-r-refresher.html"><a href="an-r-refresher.html#getting-help"><i class="fa fa-check"></i><b>3.2</b> Getting help</a></li>
<li class="chapter" data-level="3.3" data-path="an-r-refresher.html"><a href="an-r-refresher.html#r-as-a-fancy-calculator"><i class="fa fa-check"></i><b>3.3</b> R as a fancy calculator</a></li>
<li class="chapter" data-level="3.4" data-path="an-r-refresher.html"><a href="an-r-refresher.html#objects-in-r"><i class="fa fa-check"></i><b>3.4</b> Objects in R</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="manipulating-objects.html"><a href="manipulating-objects.html"><i class="fa fa-check"></i><b>4</b> Manipulating objects</a>
<ul>
<li class="chapter" data-level="4.1" data-path="manipulating-objects.html"><a href="manipulating-objects.html#missing-values-infinity-and-non-numbers"><i class="fa fa-check"></i><b>4.1</b> Missing values, infinity and “non-numbers”</a></li>
<li class="chapter" data-level="4.2" data-path="manipulating-objects.html"><a href="manipulating-objects.html#basic-information-about-objects"><i class="fa fa-check"></i><b>4.2</b> Basic information about objects</a></li>
<li class="chapter" data-level="4.3" data-path="manipulating-objects.html"><a href="manipulating-objects.html#data-frames"><i class="fa fa-check"></i><b>4.3</b> Data frames</a></li>
<li class="chapter" data-level="4.4" data-path="manipulating-objects.html"><a href="manipulating-objects.html#organising-your-work"><i class="fa fa-check"></i><b>4.4</b> Organising your work</a></li>
<li class="chapter" data-level="4.5" data-path="manipulating-objects.html"><a href="manipulating-objects.html#inspecting-the-data"><i class="fa fa-check"></i><b>4.5</b> Inspecting the data</a></li>
<li class="chapter" data-level="4.6" data-path="manipulating-objects.html"><a href="manipulating-objects.html#classes-in-r"><i class="fa fa-check"></i><b>4.6</b> “Classes” in R</a></li>
<li class="chapter" data-level="4.7" data-path="manipulating-objects.html"><a href="manipulating-objects.html#tables-and-summary-statistics"><i class="fa fa-check"></i><b>4.7</b> Tables and summary statistics</a></li>
<li class="chapter" data-level="4.8" data-path="manipulating-objects.html"><a href="manipulating-objects.html#plotting-data"><i class="fa fa-check"></i><b>4.8</b> Plotting data</a></li>
<li class="chapter" data-level="4.9" data-path="manipulating-objects.html"><a href="manipulating-objects.html#r-packages"><i class="fa fa-check"></i><b>4.9</b> R Packages</a></li>
<li class="chapter" data-level="4.10" data-path="manipulating-objects.html"><a href="manipulating-objects.html#exercise-californian-bird-diversity"><i class="fa fa-check"></i><b>4.10</b> Exercise: Californian bird diversity</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="manipulating-objects.html"><a href="manipulating-objects.html#the-data"><i class="fa fa-check"></i><b>4.10.1</b> The data</a></li>
<li class="chapter" data-level="4.10.2" data-path="manipulating-objects.html"><a href="manipulating-objects.html#try-the-following"><i class="fa fa-check"></i><b>4.10.2</b> Try the following</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Wrangling</b></span></li>
<li class="chapter" data-level="5" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html"><i class="fa fa-check"></i><b>5</b> Data wrangling with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#select"><i class="fa fa-check"></i><b>5.1</b> <code>select</code></a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#filter"><i class="fa fa-check"></i><b>5.2</b> <code>filter</code></a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#arrange"><i class="fa fa-check"></i><b>5.3</b> <code>arrange</code></a></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#summarise-and-group_by"><i class="fa fa-check"></i><b>5.4</b> <code>summarise</code> and <code>group_by</code></a></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#using-pipes-saving-data."><i class="fa fa-check"></i><b>5.5</b> Using pipes, saving data.</a></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#exercise-wrangling-the-amniote-life-history-database"><i class="fa fa-check"></i><b>5.6</b> Exercise: Wrangling the Amniote Life History Database</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="combining-data-sets.html"><a href="combining-data-sets.html"><i class="fa fa-check"></i><b>6</b> Combining data sets</a>
<ul>
<li class="chapter" data-level="6.1" data-path="combining-data-sets.html"><a href="combining-data-sets.html#using-join"><i class="fa fa-check"></i><b>6.1</b> Using <code>join</code></a></li>
<li class="chapter" data-level="6.2" data-path="combining-data-sets.html"><a href="combining-data-sets.html#using-pivot_longer"><i class="fa fa-check"></i><b>6.2</b> Using <code>pivot_longer</code></a></li>
<li class="chapter" data-level="6.3" data-path="combining-data-sets.html"><a href="combining-data-sets.html#exercise-temperature-effects-on-egg-laying-dates"><i class="fa fa-check"></i><b>6.3</b> Exercise: Temperature effects on egg laying dates</a></li>
</ul></li>
<li class="part"><span><b>II Data visualisation</b></span></li>
<li class="chapter" data-level="7" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html"><i class="fa fa-check"></i><b>7</b> Visualising data with <code>ggplot</code></a>
<ul>
<li class="chapter" data-level="7.1" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#histograms"><i class="fa fa-check"></i><b>7.1</b> Histograms</a></li>
<li class="chapter" data-level="7.2" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#facets---splitting-data-across-panels"><i class="fa fa-check"></i><b>7.2</b> “Facets” - splitting data across panels</a></li>
<li class="chapter" data-level="7.3" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#box-plots"><i class="fa fa-check"></i><b>7.3</b> Box plots</a></li>
<li class="chapter" data-level="7.4" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#lines-and-points"><i class="fa fa-check"></i><b>7.4</b> Lines and points</a></li>
<li class="chapter" data-level="7.5" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#scatter-plots"><i class="fa fa-check"></i><b>7.5</b> Scatter plots</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html"><i class="fa fa-check"></i><b>8</b> Distributions and summarising data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#distributions"><i class="fa fa-check"></i><b>8.1</b> Distributions</a></li>
<li class="chapter" data-level="8.2" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#normal-distribution"><i class="fa fa-check"></i><b>8.2</b> Normal distribution</a></li>
<li class="chapter" data-level="8.3" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#comparing-normal-distributions"><i class="fa fa-check"></i><b>8.3</b> Comparing normal distributions</a></li>
<li class="chapter" data-level="8.4" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#poisson-distribution"><i class="fa fa-check"></i><b>8.4</b> Poisson distribution</a></li>
<li class="chapter" data-level="8.5" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#comparing-normal-and-poisson-distributions"><i class="fa fa-check"></i><b>8.5</b> Comparing normal and Poisson distributions</a></li>
<li class="chapter" data-level="8.6" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#the-law-of-large-numbers"><i class="fa fa-check"></i><b>8.6</b> The law of large numbers</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#coin-flipping"><i class="fa fa-check"></i><b>8.6.1</b> Coin flipping</a></li>
<li class="chapter" data-level="8.6.2" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#virtual-dice"><i class="fa fa-check"></i><b>8.6.2</b> Virtual dice</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html"><i class="fa fa-check"></i><b>9</b> Pimping your plots</a>
<ul>
<li class="chapter" data-level="9.1" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#a-basic-plot"><i class="fa fa-check"></i><b>9.1</b> A basic plot</a></li>
<li class="chapter" data-level="9.2" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#axis-limits"><i class="fa fa-check"></i><b>9.2</b> Axis limits</a></li>
<li class="chapter" data-level="9.3" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#transforming-the-axis-log-scale"><i class="fa fa-check"></i><b>9.3</b> Transforming the axis (log scale)</a></li>
<li class="chapter" data-level="9.4" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#changing-the-axis-tick-marks"><i class="fa fa-check"></i><b>9.4</b> Changing the axis tick marks</a></li>
<li class="chapter" data-level="9.5" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#axis-labels"><i class="fa fa-check"></i><b>9.5</b> Axis labels</a></li>
<li class="chapter" data-level="9.6" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#colours"><i class="fa fa-check"></i><b>9.6</b> Colours</a></li>
<li class="chapter" data-level="9.7" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#themes"><i class="fa fa-check"></i><b>9.7</b> Themes</a></li>
<li class="chapter" data-level="9.8" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#moving-the-legend"><i class="fa fa-check"></i><b>9.8</b> Moving the legend</a></li>
<li class="chapter" data-level="9.9" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#combining-multiple-plots"><i class="fa fa-check"></i><b>9.9</b> Combining multiple plots</a></li>
<li class="chapter" data-level="9.10" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#saving-your-plot"><i class="fa fa-check"></i><b>9.10</b> Saving your plot</a></li>
<li class="chapter" data-level="9.11" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#final-word-on-plots"><i class="fa fa-check"></i><b>9.11</b> Final word on plots</a></li>
</ul></li>
<li class="part"><span><b>III Statistics</b></span></li>
<li class="chapter" data-level="10" data-path="randomisation-tests.html"><a href="randomisation-tests.html"><i class="fa fa-check"></i><b>10</b> Randomisation Tests</a>
<ul>
<li class="chapter" data-level="10.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#randomisation-test-in-r"><i class="fa fa-check"></i><b>10.1</b> Randomisation test in R</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#calculate-the-observed-difference"><i class="fa fa-check"></i><b>10.1.1</b> Calculate the observed difference</a></li>
<li class="chapter" data-level="10.1.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#null-distribution"><i class="fa fa-check"></i><b>10.1.2</b> Null distribution</a></li>
<li class="chapter" data-level="10.1.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-significance"><i class="fa fa-check"></i><b>10.1.3</b> Testing significance</a></li>
<li class="chapter" data-level="10.1.4" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-the-hypothesis"><i class="fa fa-check"></i><b>10.1.4</b> Testing the hypothesis</a></li>
<li class="chapter" data-level="10.1.5" data-path="randomisation-tests.html"><a href="randomisation-tests.html#writing-it-up"><i class="fa fa-check"></i><b>10.1.5</b> Writing it up</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#paired-randomisation-tests"><i class="fa fa-check"></i><b>10.2</b> Paired Randomisation Tests</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-randomisation-test"><i class="fa fa-check"></i><b>10.2.1</b> The randomisation test</a></li>
<li class="chapter" data-level="10.2.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#null-distribution-1"><i class="fa fa-check"></i><b>10.2.2</b> Null distribution</a></li>
<li class="chapter" data-level="10.2.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-formal-hypothesis-test"><i class="fa fa-check"></i><b>10.2.3</b> The formal hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#exercise-sexual-selection-in-hercules-beetles"><i class="fa fa-check"></i><b>10.3</b> Exercise: Sexual selection in Hercules beetles</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html"><i class="fa fa-check"></i><b>11</b> Comparing two means with a t-test</a>
<ul>
<li class="chapter" data-level="11.1" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#some-theory"><i class="fa fa-check"></i><b>11.1</b> Some theory</a></li>
<li class="chapter" data-level="11.2" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#one-sample-t-test"><i class="fa fa-check"></i><b>11.2</b> One sample t-test</a></li>
<li class="chapter" data-level="11.3" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#doing-it-by-hand---where-does-the-t-statistic-come-from"><i class="fa fa-check"></i><b>11.3</b> Doing it “by hand” - where does the t-statistic come from?</a></li>
<li class="chapter" data-level="11.4" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#paired-t-test"><i class="fa fa-check"></i><b>11.4</b> Paired t-test</a></li>
<li class="chapter" data-level="11.5" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#a-paired-t-test-is-a-one-sample-test."><i class="fa fa-check"></i><b>11.5</b> A paired t-test is a one-sample test.</a></li>
<li class="chapter" data-level="11.6" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#two-sample-t-test"><i class="fa fa-check"></i><b>11.6</b> Two sample t-test</a></li>
<li class="chapter" data-level="11.7" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#t-tests-are-linear-models"><i class="fa fa-check"></i><b>11.7</b> t-tests are linear models</a></li>
<li class="chapter" data-level="11.8" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-sex-differences-in-fine-motor-skills"><i class="fa fa-check"></i><b>11.8</b> Exercise: Sex differences in fine motor skills</a></li>
<li class="chapter" data-level="11.9" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-therapy-for-anorexia"><i class="fa fa-check"></i><b>11.9</b> Exercise: Therapy for anorexia</a></li>
<li class="chapter" data-level="11.10" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-compare-t-tests-with-randomisation-tests"><i class="fa fa-check"></i><b>11.10</b> Exercise: Compare t-tests with randomisation tests</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html"><i class="fa fa-check"></i><b>12</b> Linear models with a single categorical explanatory variable</a>
<ul>
<li class="chapter" data-level="12.1" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#one-way-anova"><i class="fa fa-check"></i><b>12.1</b> One-way ANOVA</a></li>
<li class="chapter" data-level="12.2" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#fitting-an-anova-in-r"><i class="fa fa-check"></i><b>12.2</b> Fitting an ANOVA in R</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#where-are-the-differences"><i class="fa fa-check"></i><b>12.2.1</b> Where are the differences?</a></li>
<li class="chapter" data-level="12.2.2" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#tukeys-honestly-significant-difference-hsd"><i class="fa fa-check"></i><b>12.2.2</b> Tukey’s Honestly Significant Difference (HSD)</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#anova-calculation-by-hand."><i class="fa fa-check"></i><b>12.3</b> ANOVA calculation “by hand”.</a></li>
<li class="chapter" data-level="12.4" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#exercise-apple-tree-crop-yield"><i class="fa fa-check"></i><b>12.4</b> Exercise: Apple tree crop yield</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html"><i class="fa fa-check"></i><b>13</b> Linear models with a single continuous explanatory variable</a>
<ul>
<li class="chapter" data-level="13.1" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#some-theory"><i class="fa fa-check"></i><b>13.1</b> Some theory</a></li>
<li class="chapter" data-level="13.2" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#evaluating-a-hypothesis-with-a-linear-regression-model"><i class="fa fa-check"></i><b>13.2</b> Evaluating a hypothesis with a linear regression model</a></li>
<li class="chapter" data-level="13.3" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#assumptions"><i class="fa fa-check"></i><b>13.3</b> Assumptions</a></li>
<li class="chapter" data-level="13.4" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#worked-example-height-hand-width-relationship"><i class="fa fa-check"></i><b>13.4</b> Worked example: height-hand width relationship</a></li>
<li class="chapter" data-level="13.5" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#exercise-chirping-crickets"><i class="fa fa-check"></i><b>13.5</b> Exercise: Chirping crickets</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html"><i class="fa fa-check"></i><b>14</b> Linear models with categorical and continuous explanatory variables</a>
<ul>
<li class="chapter" data-level="14.1" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#the-height-hand-width-example."><i class="fa fa-check"></i><b>14.1</b> The height ~ hand width example.</a></li>
<li class="chapter" data-level="14.2" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#summarising-with-anova"><i class="fa fa-check"></i><b>14.2</b> Summarising with <code>anova</code></a></li>
<li class="chapter" data-level="14.3" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#the-summary-of-coefficients-summary"><i class="fa fa-check"></i><b>14.3</b> The summary of coefficients (<code>summary</code>)</a></li>
<li class="chapter" data-level="14.4" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#simplifying-the-model"><i class="fa fa-check"></i><b>14.4</b> Simplifying the model</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html"><i class="fa fa-check"></i><b>15</b> Linear models with &gt;1 categorical explanatory variables</a>
<ul>
<li class="chapter" data-level="15.1" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#fitting-a-two-way-anova-model"><i class="fa fa-check"></i><b>15.1</b> Fitting a two-way ANOVA model</a></li>
<li class="chapter" data-level="15.2" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#summarising-the-model-anova"><i class="fa fa-check"></i><b>15.2</b> Summarising the model (<code>anova</code>)</a></li>
<li class="chapter" data-level="15.3" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#summarising-the-model-summary"><i class="fa fa-check"></i><b>15.3</b> Summarising the model (<code>summary</code>)</a></li>
<li class="chapter" data-level="15.4" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#exercise-fish-behaviour"><i class="fa fa-check"></i><b>15.4</b> Exercise: Fish behaviour</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html"><i class="fa fa-check"></i><b>16</b> Generalised linear models</a>
<ul>
<li class="chapter" data-level="16.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#count-data-with-poisson-errors."><i class="fa fa-check"></i><b>16.1</b> Count data with Poisson errors.</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-number-of-offspring-in-foxes."><i class="fa fa-check"></i><b>16.1.1</b> Example: Number of offspring in foxes.</a></li>
<li class="chapter" data-level="16.1.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-cancer-clusters"><i class="fa fa-check"></i><b>16.1.2</b> Example: Cancer clusters</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#exercise-maze-runner"><i class="fa fa-check"></i><b>16.2</b> Exercise: Maze runner</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html"><i class="fa fa-check"></i><b>17</b> Extending use cases of GLM</a>
<ul>
<li class="chapter" data-level="17.1" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#binomial-response-data"><i class="fa fa-check"></i><b>17.1</b> Binomial response data</a></li>
<li class="chapter" data-level="17.2" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-nfl-field-goals"><i class="fa fa-check"></i><b>17.2</b> Example: NFL field goals</a></li>
<li class="chapter" data-level="17.3" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-sex-ratio-in-turtles"><i class="fa fa-check"></i><b>17.3</b> Example: Sex ratio in turtles</a></li>
<li class="chapter" data-level="17.4" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-smoking"><i class="fa fa-check"></i><b>17.4</b> Example: Smoking</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html"><i class="fa fa-check"></i><b>18</b> Power analysis by simulation</a>
<ul>
<li class="chapter" data-level="18.1" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#type-i-and-ii-errors-and-statistical-power"><i class="fa fa-check"></i><b>18.1</b> Type I and II errors and statistical power</a></li>
<li class="chapter" data-level="18.2" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#what-determines-statistical-power"><i class="fa fa-check"></i><b>18.2</b> What determines statistical power?</a></li>
<li class="chapter" data-level="18.3" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#an-example-of-calculating-statistical-power."><i class="fa fa-check"></i><b>18.3</b> An example of calculating statistical power.</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#the-simulation"><i class="fa fa-check"></i><b>18.3.1</b> The simulation</a></li>
<li class="chapter" data-level="18.3.2" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#some-questions-for-you-to-address"><i class="fa fa-check"></i><b>18.3.2</b> Some questions for you to address:</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#summary"><i class="fa fa-check"></i><b>18.4</b> Summary</a></li>
<li class="chapter" data-level="18.5" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#extending-the-simulation-optional-advanced"><i class="fa fa-check"></i><b>18.5</b> Extending the simulation (optional, advanced)</a></li>
<li class="chapter" data-level="18.6" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#exercise-1-snails-on-the-move"><i class="fa fa-check"></i><b>18.6</b> Exercise 1: Snails on the move</a></li>
<li class="chapter" data-level="18.7" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#exercise-2-mouse-lemur-strength"><i class="fa fa-check"></i><b>18.7</b> Exercise 2: Mouse lemur strength</a></li>
</ul></li>
<li class="part"><span><b>IV Coming soon(ish)</b></span></li>
<li class="chapter" data-level="19" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html"><i class="fa fa-check"></i><b>19</b> Coming soon (maybe)!</a>
<ul>
<li class="chapter" data-level="19.1" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#multivariate-statistics"><i class="fa fa-check"></i><b>19.1</b> Multivariate statistics</a></li>
<li class="chapter" data-level="19.2" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#transforming-variables"><i class="fa fa-check"></i><b>19.2</b> Transforming variables</a></li>
<li class="chapter" data-level="19.3" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#non-linear-regression"><i class="fa fa-check"></i><b>19.3</b> Non-linear regression</a></li>
<li class="chapter" data-level="19.4" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#nested-or-blocked-study-designs"><i class="fa fa-check"></i><b>19.4</b> Nested or blocked study designs</a></li>
</ul></li>
<li class="part"><span><b>V Exam</b></span></li>
<li class="chapter" data-level="20" data-path="exam-2020.html"><a href="exam-2020.html"><i class="fa fa-check"></i><b>20</b> Exam 2020</a></li>
<li class="part"><span><b>VI Solutions</b></span></li>
<li class="chapter" data-level="21" data-path="exercise-solutions.html"><a href="exercise-solutions.html"><i class="fa fa-check"></i><b>21</b> Exercise Solutions</a>
<ul>
<li class="chapter" data-level="21.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-californian-bird-diversity"><i class="fa fa-check"></i><b>21.1</b> Exercise Solutions: Californian bird diversity</a></li>
<li class="chapter" data-level="21.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-wrangling-the-amniote-life-history-database"><i class="fa fa-check"></i><b>21.2</b> Exercise Solutions: Wrangling the Amniote Life History Database</a></li>
<li class="chapter" data-level="21.3" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-temperature-effects-on-egg-laying-dates"><i class="fa fa-check"></i><b>21.3</b> Exercise Solutions: Temperature effects on egg laying dates</a></li>
<li class="chapter" data-level="21.4" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-sexual-selection-in-hercules-beetles"><i class="fa fa-check"></i><b>21.4</b> Exercise Solutions: Sexual selection in Hercules beetles</a></li>
<li class="chapter" data-level="21.5" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-sex-differences-in-fine-motor-skills"><i class="fa fa-check"></i><b>21.5</b> Exercise: Sex differences in fine motor skills</a></li>
<li class="chapter" data-level="21.6" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-therapy-for-anorexia"><i class="fa fa-check"></i><b>21.6</b> Exercise: Therapy for anorexia</a></li>
<li class="chapter" data-level="21.7" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-compare-t-tests-with-randomisation-tests"><i class="fa fa-check"></i><b>21.7</b> Exercise: Compare t-tests with randomisation tests</a></li>
<li class="chapter" data-level="21.8" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-apple-tree-crop-yield"><i class="fa fa-check"></i><b>21.8</b> Exercise Solutions: Apple tree crop yield</a></li>
<li class="chapter" data-level="21.9" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-chirping-crickets"><i class="fa fa-check"></i><b>21.9</b> Exercise Solutions: Chirping crickets</a></li>
<li class="chapter" data-level="21.10" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-fish-behaviour"><i class="fa fa-check"></i><b>21.10</b> Exercise Solutions: Fish behaviour</a></li>
<li class="chapter" data-level="21.11" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-maze-runner"><i class="fa fa-check"></i><b>21.11</b> Exercise Solutions: Maze runner</a></li>
<li class="chapter" data-level="21.12" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-snails-on-the-move"><i class="fa fa-check"></i><b>21.12</b> Exercise Solutions: Snails on the move</a></li>
<li class="chapter" data-level="21.13" data-path="exercise-solutions.html"><a href="exercise-solutions.html#exercise-solutions-mouse-lemur-strength"><i class="fa fa-check"></i><b>21.13</b> Exercise Solutions: Mouse lemur strength</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BB852 - Data handling, visualisation and statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-wrangling-with-dplyr" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Data wrangling with <code>dplyr</code></h1>
<p>This chapter focuses on using the package <code>dplyr</code>, which is designed to make working with data in R easier.
The package has several key “workhorse” functions, sometimes called <strong>verbs</strong>. These are: <code>filter</code>, <code>select</code>, <code>mutate</code>, <code>arrange</code> and <code>summarise</code>. I covered these in the lecture, and they are also discussed in the textbook. This chapter guides you through worked examples to illustrate their use.</p>
<p>We will also be using <strong>pipes</strong> from the <code>magrittr</code> package. These are implemented using the command <code>%&gt;%</code>.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="data-wrangling-with-dplyr.html#cb119-1" aria-hidden="true"></a><span class="kw">library</span>(<span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb119-2"><a href="data-wrangling-with-dplyr.html#cb119-2" aria-hidden="true"></a><span class="kw">library</span>(<span class="st">&quot;magrittr&quot;</span>)</span></code></pre></div>
<p>To get to know <code>dplyr</code> and its functions we’ll use a data set
collected from the university campus at University of Southern Denmark (SDU) The SDU bird project follows the fate of mainly great tits (musvit) and blue tits (blåmejse) in about 100 nest boxes in the woods around the main SDU campus.</p>
<p>We will address two questions concerning clutch size (the number of eggs laid into the nest) -</p>
<ol style="list-style-type: decimal">
<li>How does clutch size differ between blue tits and great tits?</li>
<li>How does average clutch size vary among years?</li>
</ol>
<p>To answer these questions we need to calculate the average clutch size (number of eggs) for each nest in each year. The data are in a file called (<code>sduBirds.csv</code>) and are raw data collected while visiting the nests. The data will need to be processed to answer those questions.</p>
<p>Let’s import the data and take a look at it. Make sure your data looks OK before moving on.
You should first set up your working directory (e.g. a folder for the course, with a sub-folder for course data etc.), and set it (with <code>setwd</code>)).
See the earlier material for how to do this, or ask for help.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="data-wrangling-with-dplyr.html#cb120-1" aria-hidden="true"></a>df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;CourseData/sduBirds.csv&quot;</span>)</span>
<span id="cb120-2"><a href="data-wrangling-with-dplyr.html#cb120-2" aria-hidden="true"></a><span class="kw">str</span>(df)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:	9357 obs. of  15 variables:
##  $ Timestamp  : chr  &quot;2013-05-14&quot; &quot;2013-05-03&quot; &quot;2013-06-25&quot; &quot;2013-06-18&quot; ...
##  $ Year       : int  2013 2013 2013 2013 2013 2013 2013 2013 2013 2013 ...
##  $ Day        : int  134 123 176 169 112 112 116 183 143 107 ...
##  $ boxNumber  : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ species    : chr  &quot;BT&quot; &quot;BT&quot; &quot;BT&quot; &quot;BT&quot; ...
##  $ stage      : chr  &quot;NL&quot; &quot;NL&quot; &quot;NE&quot; &quot;NE&quot; ...
##  $ nEggs      : int  12 8 0 0 0 0 0 0 NA 0 ...
##  $ nLiveChicks: int  0 0 0 0 0 0 0 0 0 0 ...
##  $ nDeadChicks: int  0 0 0 0 0 0 0 0 0 0 ...
##  $ eggStatus  : chr  &quot;WA&quot; &quot;CO, CV&quot; NA NA ...
##  $ chickStatus: chr  NA NA NA NA ...
##  $ adultStatus: chr  &quot;FN&quot; &quot;FN&quot; NA NA ...
##  $ finalStatus: chr  NA NA &quot;NE&quot; &quot;NE&quot; ...
##  $ Comments   : chr  NA &quot;MA&quot; NA NA ...
##  $ observerID : chr  &quot;AMK&quot; &quot;AMK&quot; &quot;AMK&quot; &quot;AMK&quot; ...</code></pre>
<div id="select" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> <code>select</code></h2>
<p>From the <code>str</code> summary (above) you can see that there are many columns in the data set and we only need some of them. Let’s <code>select</code> only the columns that we need for our calculations to make things a bit easier to handle. We need the <code>species</code>, <code>Year</code>, <code>Day</code>, <code>boxNumber</code> and <code>nEggs</code>:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="data-wrangling-with-dplyr.html#cb122-1" aria-hidden="true"></a>df &lt;-<span class="st"> </span><span class="kw">select</span>(df, species, Year, Day, boxNumber, nEggs)</span>
<span id="cb122-2"><a href="data-wrangling-with-dplyr.html#cb122-2" aria-hidden="true"></a><span class="kw">head</span>(df)</span></code></pre></div>
<pre><code>##   species Year Day boxNumber nEggs
## 1      BT 2013 134         1    12
## 2      BT 2013 123         1     8
## 3      BT 2013 176         1     0
## 4      BT 2013 169         1     0
## 5      BT 2013 112         1     0
## 6      BT 2013 112         1     0</code></pre>
<p>The output of <code>head</code> shows you the first few rows of the data set. You can see that each row represents a visit of a researcher to a particular nest. The researcher records the bird species if it is known (GT = Great tit, BT = Blue tit, NH = Nuthatch etc.), and then records the number of eggs, number of chicks, activity of the adults and so on. We need to convert this huge dataset into one which contains clutch size for each nest, for each year of the study.</p>
<p>The information given by <code>str</code> (above) shows that there are data on species other than our target species. We are only interested in the great tits and blue tits so we can first filter the others out using the <code>species</code> variable.</p>
<p>We can check what the make up of this part of the data is using the <code>table</code> function which will count up all of the entries.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="data-wrangling-with-dplyr.html#cb124-1" aria-hidden="true"></a><span class="kw">table</span>(df<span class="op">$</span>species)</span></code></pre></div>
<pre><code>## 
##   BT   GT   MT   NH   WR 
##  992 4612   73   31    5</code></pre>
</div>
<div id="filter" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> <code>filter</code></h2>
<p>Now let’s filter this data and double check that this has worked:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="data-wrangling-with-dplyr.html#cb126-1" aria-hidden="true"></a>df &lt;-<span class="st"> </span><span class="kw">filter</span>(df,species <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;GT&quot;</span>,<span class="st">&quot;BT&quot;</span>))</span>
<span id="cb126-2"><a href="data-wrangling-with-dplyr.html#cb126-2" aria-hidden="true"></a><span class="kw">table</span>(df<span class="op">$</span>species)</span></code></pre></div>
<pre><code>## 
##   BT   GT 
##  992 4612</code></pre>
<p>You will notice that all the levels of the variable are retained. This is not a problem, and can usually be ignored. You can also tidy this up using the <code>droplevels</code> function, which removes all unused factor levels.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="data-wrangling-with-dplyr.html#cb128-1" aria-hidden="true"></a>df &lt;-<span class="st"> </span><span class="kw">droplevels</span>(df)</span>
<span id="cb128-2"><a href="data-wrangling-with-dplyr.html#cb128-2" aria-hidden="true"></a><span class="kw">table</span>(df<span class="op">$</span>species)</span></code></pre></div>
<pre><code>## 
##   BT   GT 
##  992 4612</code></pre>
</div>
<div id="arrange" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> <code>arrange</code></h2>
<p>Recall that the data are records of visits to each nest a few times per week. To ensure that the data are in time order I can first <code>arrange</code> by first <code>Year</code> and then <code>Day</code>. To illustrate this we can make a temporary data set (called <code>temp</code>) to look at a particular nest in a particular year to get a record of the progress for that particular nest, and then plot it (this is an ugly plot and we will learn how to make beautiful ones soon):</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="data-wrangling-with-dplyr.html#cb130-1" aria-hidden="true"></a>df &lt;-<span class="st"> </span><span class="kw">arrange</span>(df,Year,Day)</span>
<span id="cb130-2"><a href="data-wrangling-with-dplyr.html#cb130-2" aria-hidden="true"></a></span>
<span id="cb130-3"><a href="data-wrangling-with-dplyr.html#cb130-3" aria-hidden="true"></a>temp &lt;-<span class="st"> </span><span class="kw">filter</span>(df,boxNumber <span class="op">==</span><span class="st"> </span><span class="dv">1</span>,Year <span class="op">==</span><span class="st"> </span><span class="dv">2014</span>)</span>
<span id="cb130-4"><a href="data-wrangling-with-dplyr.html#cb130-4" aria-hidden="true"></a><span class="kw">max</span>(temp<span class="op">$</span>nEggs) <span class="co"># get the max value</span></span></code></pre></div>
<pre><code>## [1] 12</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="data-wrangling-with-dplyr.html#cb132-1" aria-hidden="true"></a><span class="kw">plot</span>(temp<span class="op">$</span>Day,temp<span class="op">$</span>nEggs,<span class="dt">type=</span><span class="st">&quot;b&quot;</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<p>Eggs are usually laid one per day, and the clutch size is the maximum number of eggs reached for each nest box. In this case, the clutch size is 12 eggs. The rapid decline in number of eggs after this peak value shows when the eggs have hatched and the researcher finds chicks instead of eggs!</p>
</div>
<div id="summarise-and-group_by" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> <code>summarise</code> and <code>group_by</code></h2>
<p>The next part is the crucial part of our investigation. We need to get the maximum number of eggs seen at each nest. Of course we could repeatedly use <code>filter</code>, followed by <code>max</code>, for each nest-year combination but this would be incredibly tedious.</p>
<p>Instead, we will use the <code>dplyr</code> function, <code>summarise</code>, to do this by asking for the maximum value of <code>nEggs</code>. To make this work we need to first use the <code>group_by</code> function tell R to group the data by the variables we are interested in. If we don’t do this we just get the overall maximum. We can ungroup the data using the <code>ungroup</code> function.</p>
<p>Because there are missing data (<code>NA</code> values) we need to specify <code>na.rm = TRUE</code> in the argument.</p>
<p>So first, let’s get the max per species, just to illustrate how this works:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="data-wrangling-with-dplyr.html#cb133-1" aria-hidden="true"></a>df &lt;-<span class="st"> </span><span class="kw">group_by</span>(df,species)</span>
<span id="cb133-2"><a href="data-wrangling-with-dplyr.html#cb133-2" aria-hidden="true"></a><span class="kw">summarise</span>(df,<span class="dt">clutchSize =</span> <span class="kw">max</span>(nEggs,<span class="dt">na.rm=</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   species clutchSize
##   &lt;chr&gt;        &lt;int&gt;
## 1 BT              14
## 2 GT              14</code></pre>
<p>We can see how the data are grouped by asking for a summary:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="data-wrangling-with-dplyr.html#cb135-1" aria-hidden="true"></a><span class="kw">summary</span>(df)</span></code></pre></div>
<pre><code>##    species               Year           Day       
##  Length:5604        Min.   :2013   Min.   : 60.0  
##  Class :character   1st Qu.:2014   1st Qu.:116.0  
##  Mode  :character   Median :2014   Median :133.0  
##                     Mean   :2015   Mean   :133.2  
##                     3rd Qu.:2017   3rd Qu.:148.0  
##                     Max.   :2019   Max.   :212.0  
##                                                   
##    boxNumber          nEggs       
##  Min.   :  1.00   Min.   : 0.000  
##  1st Qu.: 29.75   1st Qu.: 0.000  
##  Median : 57.00   Median : 0.000  
##  Mean   : 55.83   Mean   : 2.326  
##  3rd Qu.: 85.00   3rd Qu.: 4.000  
##  Max.   :101.00   Max.   :14.000  
##                   NA&#39;s   :613</code></pre>
<p>We can ungroup the data again like this:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="data-wrangling-with-dplyr.html#cb137-1" aria-hidden="true"></a>df &lt;-<span class="st"> </span><span class="kw">ungroup</span>(df)</span></code></pre></div>
<p>So both species lay the same maximum number of eggs, but maybe this is just caused by outliers for one of the species. We’ll need to dig deeper.</p>
<p>How can we calculate the average? We cannot simply ask for the <code>mean</code> because the data run through time following the development in each nest. We need to calculate the maximum <code>nEggs</code> for each nest, and then calculate the average of those. We can do this in two steps.</p>
<p>We first calculate the clutch size for each box for each species in each year:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="data-wrangling-with-dplyr.html#cb138-1" aria-hidden="true"></a>df &lt;-<span class="st"> </span><span class="kw">group_by</span>(df, species, Year, boxNumber)</span>
<span id="cb138-2"><a href="data-wrangling-with-dplyr.html#cb138-2" aria-hidden="true"></a>df &lt;-<span class="st"> </span><span class="kw">summarise</span>(df, <span class="dt">clutchSize =</span> <span class="kw">max</span>(nEggs,<span class="dt">na.rm=</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<p>Let’s first look at all the clutch size data:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="data-wrangling-with-dplyr.html#cb139-1" aria-hidden="true"></a><span class="kw">hist</span>(df<span class="op">$</span>clutchSize)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<p>You can see here that there are a lot of zero values. This is because nests were recorded even if they did not attempt to lay eggs. We should remove these from our data using <code>filter</code> again:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="data-wrangling-with-dplyr.html#cb140-1" aria-hidden="true"></a>df &lt;-<span class="st"> </span><span class="kw">filter</span>(df, clutchSize <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb140-2"><a href="data-wrangling-with-dplyr.html#cb140-2" aria-hidden="true"></a><span class="kw">hist</span>(df<span class="op">$</span>clutchSize)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
<p>That looks better.
Now we can plot them again but this time split apart the species (again - this plot is ugly and we’ll learn to plot nicer ones soon).</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="data-wrangling-with-dplyr.html#cb141-1" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">as.factor</span>(df<span class="op">$</span>species),df<span class="op">$</span>clutchSize)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
<p>From these distributions it looks like the average clutch size is greater in the blue tit. We can use <code>summarise</code> to calculate the means.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="data-wrangling-with-dplyr.html#cb142-1" aria-hidden="true"></a>df &lt;-<span class="st"> </span><span class="kw">group_by</span>(df,species)</span>
<span id="cb142-2"><a href="data-wrangling-with-dplyr.html#cb142-2" aria-hidden="true"></a><span class="kw">summarise</span>(df, <span class="dt">mean =</span> <span class="kw">mean</span>(clutchSize),<span class="dt">sd =</span> <span class="kw">sd</span>(clutchSize))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   species  mean    sd
##   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
## 1 BT       9.64  2.64
## 2 GT       7.89  2.19</code></pre>
<p>Lets now turn to the other question - how does the clutch size vary with year?</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="data-wrangling-with-dplyr.html#cb144-1" aria-hidden="true"></a>df &lt;-<span class="st"> </span><span class="kw">group_by</span>(df,species,Year)</span>
<span id="cb144-2"><a href="data-wrangling-with-dplyr.html#cb144-2" aria-hidden="true"></a>df2 &lt;-<span class="st"> </span><span class="kw">summarise</span>(df, <span class="dt">meanClutchSize =</span> <span class="kw">mean</span>(clutchSize))</span>
<span id="cb144-3"><a href="data-wrangling-with-dplyr.html#cb144-3" aria-hidden="true"></a><span class="kw">head</span>(df2)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
## # Groups:   species [1]
##   species  Year meanClutchSize
##   &lt;chr&gt;   &lt;int&gt;          &lt;dbl&gt;
## 1 BT       2013           8.33
## 2 BT       2014           8.94
## 3 BT       2016           8.86
## 4 BT       2017           9.2 
## 5 BT       2018          10.1 
## 6 BT       2019          11</code></pre>
<p>We can plot this by first making a plot for blue tits, and then adding the points for great tits. I have used the <code>pch</code> argument to use filled circles for the great tits:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="data-wrangling-with-dplyr.html#cb146-1" aria-hidden="true"></a><span class="kw">plot</span>(df2<span class="op">$</span>Year[df2<span class="op">$</span>species <span class="op">==</span><span class="st"> &quot;BT&quot;</span>],df2<span class="op">$</span>meanClutchSize[df2<span class="op">$</span>species <span class="op">==</span><span class="st"> &quot;BT&quot;</span>],<span class="dt">type=</span><span class="st">&quot;b&quot;</span>,</span>
<span id="cb146-2"><a href="data-wrangling-with-dplyr.html#cb146-2" aria-hidden="true"></a>     <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">12</span>),<span class="dt">xlab=</span><span class="st">&quot;Year&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Clutch Size&quot;</span>)</span>
<span id="cb146-3"><a href="data-wrangling-with-dplyr.html#cb146-3" aria-hidden="true"></a><span class="kw">points</span>(df2<span class="op">$</span>Year[df2<span class="op">$</span>species <span class="op">==</span><span class="st"> &quot;GT&quot;</span>],df2<span class="op">$</span>meanClutchSize[df2<span class="op">$</span>species <span class="op">==</span><span class="st"> &quot;GT&quot;</span>],</span>
<span id="cb146-4"><a href="data-wrangling-with-dplyr.html#cb146-4" aria-hidden="true"></a>       <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">type=</span><span class="st">&quot;b&quot;</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
<p>So it looks like the clutch size varies a fair amount from year to year, but that generally blue tits have large clutch sizes than great tits.</p>
</div>
<div id="using-pipes-saving-data." class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Using pipes, saving data.</h2>
<p>I have walked you through a step-by-step data manipulation. During that process you made made (and replaced) new data sets at each step. In practice this can be done more smoothly using <em>pipes</em> (<code>%&gt;%</code>) to pass the result of one function into the next, and the next, and the next…</p>
<p>You’ll get some more practice with this as we go on.
Below I show how do do this to create a clutch size data set from the raw data (note that your file path will differ from mine):</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="data-wrangling-with-dplyr.html#cb147-1" aria-hidden="true"></a><span class="co">#Import and process data using pipes</span></span>
<span id="cb147-2"><a href="data-wrangling-with-dplyr.html#cb147-2" aria-hidden="true"></a>SDUClutchSize &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;CourseData/sduBirds.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb147-3"><a href="data-wrangling-with-dplyr.html#cb147-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(species <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;GT&quot;</span>,<span class="st">&quot;BT&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#include only GT and BT</span></span>
<span id="cb147-4"><a href="data-wrangling-with-dplyr.html#cb147-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">droplevels</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#drop unwanted factor levels</span></span>
<span id="cb147-5"><a href="data-wrangling-with-dplyr.html#cb147-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(species, Year, Day, boxNumber, nEggs) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select columns needed</span></span>
<span id="cb147-6"><a href="data-wrangling-with-dplyr.html#cb147-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(species, Year, boxNumber) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#group data</span></span>
<span id="cb147-7"><a href="data-wrangling-with-dplyr.html#cb147-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">clutchSize =</span> <span class="kw">max</span>(nEggs,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#calculate clutch size (max eggs)</span></span>
<span id="cb147-8"><a href="data-wrangling-with-dplyr.html#cb147-8" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(clutchSize <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb147-9"><a href="data-wrangling-with-dplyr.html#cb147-9" aria-hidden="true"></a></span>
<span id="cb147-10"><a href="data-wrangling-with-dplyr.html#cb147-10" aria-hidden="true"></a><span class="kw">head</span>(SDUClutchSize)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
## # Groups:   species, Year [1]
##   species  Year boxNumber clutchSize
##   &lt;chr&gt;   &lt;int&gt;     &lt;int&gt;      &lt;dbl&gt;
## 1 BT       2013         1         12
## 2 BT       2013         5          8
## 3 BT       2013        27         10
## 4 BT       2013        31          6
## 5 BT       2013        35         10
## 6 BT       2013        37          8</code></pre>
<p>You can save this out using the <code>write.csv</code> function. You will need to set the argument <code>row.names = FALSE</code> to stop the data including row names.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="data-wrangling-with-dplyr.html#cb149-1" aria-hidden="true"></a><span class="kw">write.csv</span>(<span class="dt">x =</span> SDUClutchSize,<span class="dt">file =</span> <span class="st">&quot;CourseData/SDUClutchSize.csv&quot;</span>,<span class="dt">row.names =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
</div>
<div id="exercise-wrangling-the-amniote-life-history-database" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Exercise: Wrangling the Amniote Life History Database</h2>
<p>In this exercise the aim is to use the “Amniote Life History Database”<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> to investigate some questions about life history evolution.</p>
<p>The questions are:
(1) what are the records and typical life spans in different taxonomic classes? [<em>what is the longest, shortest and median life span in birds, mammals and reptiles?</em>]
(2) is there a positive relationship between body mass and life span? [<em>do big species live longer than small ones?</em>];
(3) is there a trade-off between reproductive effort and life span? [<em>do species that reproduce a lot have short lives, so there is a negative relationship between reproduction and life span?</em>];
(4) is this trade-off universal across all Classes? [<em>does the trade-off exist in birds, reptiles and amphibians?</em>]</p>
<p>The database is in a file called <code>Amniote_Database_Aug_2015.csv</code> in the course data folder. The missing values (which are normally coded as <code>NA</code> in R) are coded as “<code>-999</code>”. The easiest way to take care of this is to specify this when we import the data using the <code>na.strings</code> argument of the <code>read.csv</code> function. Thus we can import the data like this:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="data-wrangling-with-dplyr.html#cb150-1" aria-hidden="true"></a>amniote &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;CourseData/Amniote_Database_Aug_2015.csv&quot;</span>,<span class="dt">na.strings =</span> <span class="st">&quot;-999&quot;</span>)</span></code></pre></div>
<p>Let’s make a start…</p>
<ol style="list-style-type: decimal">
<li><p>When you have imported the data, use <code>dim</code> to check the dimensions of the whole data frame (you should see that there are 36 columns and 21322 rows). Use <code>names</code> to look at the names of all columns in the data in <code>amniote</code>.</p></li>
<li><p>We are interested in longevity (lifespan) and body size and reproductive effort and how this might vary depending on the taxonomy (specifically, with Class). Use <code>select</code> to pick relevant columns of the dataset and discard the others. Call the new data frame <code>x</code>.
The relevant columns are the taxonomic variables (<code>class</code>, <code>genus</code> &amp; <code>species</code>) and <code>longevity_y</code>, <code>litter_or_clutch_size_n</code>, <code>litters_or_clutches_per_y</code>, and <code>adult_body_mass_g</code>.</p></li>
<li><p>Take a look at the first few entries in the <code>species</code> column. You will see that it is only the <em>epithet</em>, the second part of the <em>Genus_species</em> name, that is given.<br />
Use <code>mutate</code> and <code>paste</code> to convert the <code>species</code> column to a <em>Genus_species</em> by pasting the data in <code>genus</code> and <code>species</code> together. To see how this works, try out the following command, <code>paste(1:3, 4:6)</code>. After you have created the new column, remove the <code>genus</code> column (using <code>select</code> and <code>-genus</code>).</p></li>
<li><p>What is the longest living species in the record? Use <code>arrange</code> to sort the data from longest to shortest longevity (<code>longevity_y</code>), and then look at the top of the file using <code>head</code> to find out. (hint: you will need to use reverse sort (<code>-</code>)). Cut and paste the species name into Google to find out more!</p></li>
<li><p>Do the same thing but this time find the shortest lived species.</p></li>
<li><p>Use <code>summarise</code> and <code>group_by</code> to make a table summarising <code>min</code>, <code>median</code> and <code>max</code> life spans (<code>longevity_y</code>) for the three taxonomic classes in the database. Remember that you need to tell R to remove the <code>NA</code> values using a <code>rm.rm = TRUE</code> argument.</p></li>
<li><p>Body size is thought to be associated with life span. Let’s treat that as a hypothesis and test it graphically. Sketch what would the graph would look like if the hypothesis were true, and if it was false. Plot <code>adult_body_mass_g</code> vs. <code>longevity_y</code> (using base R graphics). You should notice that this looks a bit messy.</p></li>
<li><p>Use <code>mutate</code> to create new <code>log</code>-transformed variables, <code>logMass</code> and <code>logLongevity</code>. Use these to make a “log-log” plot. You should see that makes the relationship more linear, and easier to “read”.</p></li>
<li><p>Is there a trade-off between reproductive effort and life span? Think about this as a hypothesis - sketch what would the graph would look like if that were true, and if it was false. Now use the data to test that hypothesis: Use <code>mutate</code> to create a variable called <code>logOffspring</code> which is the logarithm of number of litters/clutches per year multiplied by the number of babies in each litter/clutch . Then plot <code>logOffspring</code> vs. <code>logLongevity</code>.</p></li>
<li><p>To answer the final question (differences between taxonomic classes) you could now use <code>filter</code> to subset to particular classes and repeat the plot to see whether the relationships holds universally.</p></li>
</ol>
<p>Remember that if you struggle you can check back to previous work where you have used <code>dplyr</code> commands to manipulate data in a similar way. If you get truly stuck, ask for help from instructors or fellow students.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="4">
<li id="fn4"><p><a href="https://esajournals.onlinelibrary.wiley.com/doi/10.1890/15-0846R.1" class="uri">https://esajournals.onlinelibrary.wiley.com/doi/10.1890/15-0846R.1</a><a href="data-wrangling-with-dplyr.html#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="manipulating-objects.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="combining-data-sets.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jonesor/BB852_Book/edit/master/1_01-dataWrangling.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["BB852.pdf"],
"toc": {
"collapse": "section"
},
"split_by": "section"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
