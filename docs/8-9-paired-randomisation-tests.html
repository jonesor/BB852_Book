<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="8.9 Paired Randomisation Tests | BB852 - Data handling, visualisation and statistics" />
<meta property="og:type" content="book" />


<meta property="og:description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />


<meta name="author" content="Owen R. Jones" />

<meta name="date" content="2020-08-27" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>

<meta name="description" content="Course book for BB852 at the Biology Department, University of Southern Denmark">

<title>8.9 Paired Randomisation Tests | BB852 - Data handling, visualisation and statistics</title>

<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#preface"><span class="toc-section-number">1</span> Preface</a>
<ul>
<li><a href="1-1-data-wrangling.html#data-wrangling"><span class="toc-section-number">1.1</span> Data wrangling</a></li>
<li><a href="1-2-data-visualisation.html#data-visualisation"><span class="toc-section-number">1.2</span> Data visualisation</a></li>
<li><a href="1-3-statistics.html#statistics"><span class="toc-section-number">1.3</span> Statistics</a></li>
<li><a href="1-4-data-sources.html#data-sources"><span class="toc-section-number">1.4</span> Data sources</a></li>
<li><a href="1-5-acknowledgements.html#acknowledgements"><span class="toc-section-number">1.5</span> Acknowledgements</a></li>
<li><a href="1-6-error-reporting.html#error-reporting"><span class="toc-section-number">1.6</span> Error reporting</a></li>
</ul></li>
<li><a href="2-getting-acquainted-with-r.html#getting-acquainted-with-r"><span class="toc-section-number">2</span> Getting acquainted with R</a>
<ul>
<li><a href="2-1-introduction.html#introduction"><span class="toc-section-number">2.1</span> Introduction</a></li>
<li><a href="2-2-getting-started-with-r.html#getting-started-with-r"><span class="toc-section-number">2.2</span> Getting started with R</a></li>
<li><a href="2-3-getting-help.html#getting-help"><span class="toc-section-number">2.3</span> Getting help</a></li>
<li><a href="2-4-r-as-a-fancy-calculator.html#r-as-a-fancy-calculator"><span class="toc-section-number">2.4</span> R as a fancy calculator</a></li>
<li><a href="2-5-objects-in-r.html#objects-in-r"><span class="toc-section-number">2.5</span> Objects in R</a></li>
<li><a href="2-6-missing-values-infinity-and-non-numbers.html#missing-values-infinity-and-non-numbers"><span class="toc-section-number">2.6</span> Missing values, infinity and “non-numbers”</a></li>
<li><a href="2-7-basic-information-about-objects.html#basic-information-about-objects"><span class="toc-section-number">2.7</span> Basic information about objects</a></li>
<li><a href="2-8-data-frames.html#data-frames"><span class="toc-section-number">2.8</span> Data frames</a></li>
<li><a href="2-9-organising-your-work.html#organising-your-work"><span class="toc-section-number">2.9</span> Organising your work</a></li>
<li><a href="2-10-classes-in-r.html#classes-in-r"><span class="toc-section-number">2.10</span> “Classes” in R</a></li>
<li><a href="2-11-tables-and-summary-statistics.html#tables-and-summary-statistics"><span class="toc-section-number">2.11</span> Tables and summary statistics</a></li>
<li><a href="2-12-plotting-data.html#plotting-data"><span class="toc-section-number">2.12</span> Plotting data</a></li>
<li><a href="2-13-exercises-getting-acquainted-with-r.html#exercises---getting-acquainted-with-r"><span class="toc-section-number">2.13</span> Exercises - Getting acquainted with R</a>
<ul>
<li><a href="2-13-exercises-getting-acquainted-with-r.html#background"><span class="toc-section-number">2.13.1</span> Background</a></li>
<li><a href="2-13-exercises-getting-acquainted-with-r.html#the-data"><span class="toc-section-number">2.13.2</span> The data</a></li>
<li><a href="2-13-exercises-getting-acquainted-with-r.html#try-the-following"><span class="toc-section-number">2.13.3</span> Try the following</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Wrangling</b></span></li>
<li><a href="3-data-wrangling-with-dplyr.html#data-wrangling-with-dplyr"><span class="toc-section-number">3</span> Data wrangling with dplyr</a>
<ul>
<li><a href="2-1-introduction.html#introduction"><span class="toc-section-number">3.1</span> Introduction</a></li>
<li><a href="3-2-select.html#select"><span class="toc-section-number">3.2</span> select</a></li>
<li><a href="3-3-filter.html#filter"><span class="toc-section-number">3.3</span> filter</a></li>
<li><a href="3-4-arrange.html#arrange"><span class="toc-section-number">3.4</span> arrange</a></li>
<li><a href="3-5-summarise-and-group-by.html#summarise-and-group_by"><span class="toc-section-number">3.5</span> summarise and group_by</a></li>
<li><a href="3-6-using-pipes-saving-data-.html#using-pipes-saving-data."><span class="toc-section-number">3.6</span> Using pipes, saving data.</a></li>
<li><a href="3-7-exercises-data-wrangling.html#exercises---data-wrangling"><span class="toc-section-number">3.7</span> Exercises - data wrangling</a>
<ul>
<li><a href="3-7-exercises-data-wrangling.html#exploring-the-amniote-life-history-database"><span class="toc-section-number">3.7.1</span> Exploring the Amniote Life History Database</a></li>
</ul></li>
</ul></li>
<li><a href="4-combining-data-sets.html#combining-data-sets"><span class="toc-section-number">4</span> Combining data sets</a>
<ul>
<li><a href="4-1-exercise-joining-datasets.html#exercise---joining-datasets"><span class="toc-section-number">4.1</span> Exercise - joining datasets</a>
<ul>
<li><a href="2-13-exercises-getting-acquainted-with-r.html#the-data"><span class="toc-section-number">4.1.1</span> The data</a></li>
<li><a href="4-1-exercise-joining-datasets.html#the-bird-data"><span class="toc-section-number">4.1.2</span> The bird data</a></li>
<li><a href="4-1-exercise-joining-datasets.html#the-weather-data"><span class="toc-section-number">4.1.3</span> The weather data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Data visualisation</b></span></li>
<li><a href="5-visualising-data-with-ggplot2.html#visualising-data-with-ggplot2"><span class="toc-section-number">5</span> Visualising data with ggplot2</a>
<ul>
<li><a href="2-1-introduction.html#introduction"><span class="toc-section-number">5.1</span> Introduction</a></li>
<li><a href="5-2-histograms.html#histograms"><span class="toc-section-number">5.2</span> Histograms</a></li>
<li><a href="5-3-facets-splitting-data-across-panels.html#facets---splitting-data-across-panels"><span class="toc-section-number">5.3</span> “Facets” - splitting data across panels</a></li>
<li><a href="5-4-box-plots.html#box-plots"><span class="toc-section-number">5.4</span> box plots</a></li>
<li><a href="5-5-lines-and-points.html#lines-and-points"><span class="toc-section-number">5.5</span> lines and points</a></li>
<li><a href="5-6-scatter-plot.html#scatter-plot"><span class="toc-section-number">5.6</span> scatter plot</a></li>
</ul></li>
<li><a href="6-distributions-and-summarising-data.html#distributions-and-summarising-data"><span class="toc-section-number">6</span> Distributions and summarising data</a>
<ul>
<li><a href="2-1-introduction.html#introduction"><span class="toc-section-number">6.1</span> Introduction</a></li>
<li><a href="6-2-distributions.html#distributions"><span class="toc-section-number">6.2</span> Distributions</a></li>
<li><a href="6-3-normal-distribution.html#normal-distribution"><span class="toc-section-number">6.3</span> Normal distribution</a></li>
<li><a href="6-4-compare-normal-distributions.html#compare-normal-distributions"><span class="toc-section-number">6.4</span> Compare normal distributions</a></li>
<li><a href="6-5-the-poisson-distribution.html#the-poisson-distribution"><span class="toc-section-number">6.5</span> The Poisson distribution</a></li>
<li><a href="6-6-comparing-normal-and-poisson-distributions.html#comparing-normal-and-poisson-distributions"><span class="toc-section-number">6.6</span> Comparing normal and Poisson distributions</a></li>
</ul></li>
<li><a href="7-customising-your-plots.html#customising-your-plots"><span class="toc-section-number">7</span> Customising your plots</a>
<ul>
<li><a href="2-1-introduction.html#introduction"><span class="toc-section-number">7.1</span> Introduction</a></li>
<li><a href="7-2-a-basic-plot.html#a-basic-plot"><span class="toc-section-number">7.2</span> A basic plot</a></li>
<li><a href="7-3-axis-limits.html#axis-limits"><span class="toc-section-number">7.3</span> Axis limits</a></li>
<li><a href="7-4-transforming-the-axis-log-scale.html#transforming-the-axis-log-scale"><span class="toc-section-number">7.4</span> Transforming the axis (log scale)</a></li>
<li><a href="7-5-changing-the-axis-tick-marks.html#changing-the-axis-tick-marks"><span class="toc-section-number">7.5</span> Changing the axis tick marks</a></li>
<li><a href="7-6-axis-labels.html#axis-labels"><span class="toc-section-number">7.6</span> Axis labels</a></li>
<li><a href="7-7-colours.html#colours"><span class="toc-section-number">7.7</span> Colours</a></li>
<li><a href="7-8-themes.html#themes"><span class="toc-section-number">7.8</span> Themes</a></li>
<li><a href="7-9-moving-the-legend.html#moving-the-legend"><span class="toc-section-number">7.9</span> Moving the legend</a></li>
<li><a href="7-10-combining-multiple-plots.html#combining-multiple-plots"><span class="toc-section-number">7.10</span> Combining multiple plots</a></li>
<li><a href="7-11-saving-your-plot.html#saving-your-plot"><span class="toc-section-number">7.11</span> Saving your plot</a></li>
<li><a href="7-12-final-word-on-plots.html#final-word-on-plots"><span class="toc-section-number">7.12</span> Final word on plots</a></li>
</ul></li>
<li class="part"><span><b>III Statistics</b></span></li>
<li><a href="8-randomisation-tests.html#randomisation-tests"><span class="toc-section-number">8</span> Randomisation Tests</a>
<ul>
<li><a href="2-1-introduction.html#introduction"><span class="toc-section-number">8.1</span> Introduction</a></li>
<li><a href="8-2-the-example.html#the-example"><span class="toc-section-number">8.2</span> The example</a></li>
<li><a href="8-3-setting-up.html#setting-up"><span class="toc-section-number">8.3</span> Setting up</a></li>
<li><a href="8-4-calculate-the-observed-difference.html#calculate-the-observed-difference"><span class="toc-section-number">8.4</span> Calculate the observed difference</a></li>
<li><a href="8-5-null-distribution.html#null-distribution"><span class="toc-section-number">8.5</span> Null distribution</a></li>
<li><a href="8-6-testing-significance.html#testing-significance"><span class="toc-section-number">8.6</span> Testing significance</a></li>
<li><a href="8-7-testing-the-hypothesis.html#testing-the-hypothesis"><span class="toc-section-number">8.7</span> Testing the hypothesis</a></li>
<li><a href="8-8-writing-it-up.html#writing-it-up"><span class="toc-section-number">8.8</span> Writing it up</a></li>
<li><a href="8-9-paired-randomisation-tests.html#paired-randomisation-tests"><span class="toc-section-number">8.9</span> Paired Randomisation Tests</a>
<ul>
<li><a href="8-9-paired-randomisation-tests.html#plot-the-data"><span class="toc-section-number">8.9.1</span> Plot the data</a></li>
<li><a href="8-9-paired-randomisation-tests.html#the-paired-randomisation-test"><span class="toc-section-number">8.9.2</span> The paired randomisation test</a></li>
<li><a href="8-9-paired-randomisation-tests.html#plot-the-null-distribution"><span class="toc-section-number">8.9.3</span> Plot the null distribution</a></li>
<li><a href="8-9-paired-randomisation-tests.html#the-formal-hypothesis-test"><span class="toc-section-number">8.9.4</span> The formal hypothesis test</a></li>
</ul></li>
<li><a href="8-10-exercises-randomisation-tests.html#exercises---randomisation-tests"><span class="toc-section-number">8.10</span> Exercises - Randomisation tests</a>
<ul>
<li><a href="8-10-exercises-randomisation-tests.html#introduction-1"><span class="toc-section-number">8.10.1</span> Introduction</a></li>
<li><a href="8-10-exercises-randomisation-tests.html#your-task"><span class="toc-section-number">8.10.2</span> Your task</a></li>
</ul></li>
</ul></li>
<li><a href="9-comparing-two-means-with-a-t-test.html#comparing-two-means-with-a-t-test"><span class="toc-section-number">9</span> Comparing two means with a t-test</a>
<ul>
<li><a href="9-1-some-theory-.html#some-theory."><span class="toc-section-number">9.1</span> Some theory.</a></li>
<li><a href="9-2-one-sample-t-test.html#one-sample-t-test"><span class="toc-section-number">9.2</span> One sample t-test</a></li>
<li><a href="9-3-doing-it-by-hand-where-does-the-t-statistic-come-from.html#doing-it-by-hand---where-does-the-t-statistic-come-from"><span class="toc-section-number">9.3</span> Doing it “by hand” - where does the t-statistic come from?</a></li>
<li><a href="9-4-paired-t-test.html#paired-t-test"><span class="toc-section-number">9.4</span> Paired t-test</a></li>
<li><a href="9-5-a-paired-t-test-is-a-one-sample-test-.html#a-paired-t-test-is-a-one-sample-test."><span class="toc-section-number">9.5</span> A paired t-test is a one-sample test.</a></li>
<li><a href="9-6-two-sample-t-test.html#two-sample-t-test"><span class="toc-section-number">9.6</span> Two sample t-test</a></li>
<li><a href="9-7-t-tests-are-linear-models.html#t-tests-are-linear-models"><span class="toc-section-number">9.7</span> t-tests are linear models</a></li>
<li><a href="9-8-exercises-two-sample-t-test.html#exercises---two-sample-t-test"><span class="toc-section-number">9.8</span> Exercises - Two-sample t-test</a>
<ul>
<li><a href="9-8-exercises-two-sample-t-test.html#paired-t-test-1"><span class="toc-section-number">9.8.1</span> Paired t-test</a></li>
<li><a href="9-8-exercises-two-sample-t-test.html#optional-extra."><span class="toc-section-number">9.8.2</span> Optional extra.</a></li>
</ul></li>
</ul></li>
<li><a href="10-linear-models-with-a-single-categorical-explanatory-variable.html#linear-models-with-a-single-categorical-explanatory-variable"><span class="toc-section-number">10</span> Linear models with a single categorical explanatory variable</a>
<ul>
<li><a href="2-1-introduction.html#introduction"><span class="toc-section-number">10.1</span> Introduction</a></li>
<li><a href="10-2-one-way-anova.html#one-way-anova"><span class="toc-section-number">10.2</span> One-way ANOVA</a></li>
<li><a href="10-3-fitting-an-anova-in-r.html#fitting-an-anova-in-r"><span class="toc-section-number">10.3</span> Fitting an ANOVA in R</a></li>
<li><a href="10-4-where-are-the-differences.html#where-are-the-differences"><span class="toc-section-number">10.4</span> Where are the differences?</a></li>
<li><a href="10-5-tukeys-honestly-significant-difference-hsd.html#tukeys-honestly-significant-difference-hsd"><span class="toc-section-number">10.5</span> Tukey’s Honestly Significant Difference (HSD)</a></li>
<li><a href="10-6-anova-calculation-by-hand-optional.html#anova-calculation-by-hand-optional"><span class="toc-section-number">10.6</span> ANOVA calculation “by hand” (optional)</a></li>
</ul></li>
<li><a href="11-linear-models-with-a-several-categorical-explanatory-variables.html#linear-models-with-a-several-categorical-explanatory-variables"><span class="toc-section-number">11</span> Linear models with a several categorical explanatory variables</a>
<ul>
<li><a href="2-13-exercises-getting-acquainted-with-r.html#background"><span class="toc-section-number">11.1</span> Background</a></li>
<li><a href="11-2-fitting-a-two-way-anova-model.html#fitting-a-two-way-anova-model"><span class="toc-section-number">11.2</span> Fitting a two-way ANOVA model</a></li>
<li><a href="11-3-summarising-the-model-anova.html#summarising-the-model-anova"><span class="toc-section-number">11.3</span> Summarising the model (<code>anova</code>)</a></li>
<li><a href="11-4-summarising-the-model-summary.html#summarising-the-model-summary"><span class="toc-section-number">11.4</span> Summarising the model (<code>summary</code>)</a></li>
<li><a href="11-5-a-2-way-anova-on-a-fish-behaviour-study.html#a-2-way-anova-on-a-fish-behaviour-study"><span class="toc-section-number">11.5</span> A 2-way ANOVA on a fish behaviour study</a>
<ul>
<li><a href="11-5-a-2-way-anova-on-a-fish-behaviour-study.html#background-1"><span class="toc-section-number">11.5.1</span> Background</a></li>
<li><a href="8-10-exercises-randomisation-tests.html#your-task"><span class="toc-section-number">11.5.2</span> Your task</a></li>
</ul></li>
</ul></li>
<li><a href="12-linear-models-with-a-single-continuous-explanatory-variable.html#linear-models-with-a-single-continuous-explanatory-variable"><span class="toc-section-number">12</span> Linear models with a single continuous explanatory variable</a>
<ul>
<li><a href="2-13-exercises-getting-acquainted-with-r.html#background"><span class="toc-section-number">12.1</span> Background</a></li>
<li><a href="12-2-some-theory.html#some-theory"><span class="toc-section-number">12.2</span> Some theory</a></li>
<li><a href="12-3-evaluating-a-hypothesis-with-a-linear-regression-model.html#evaluating-a-hypothesis-with-a-linear-regression-model"><span class="toc-section-number">12.3</span> Evaluating a hypothesis with a linear regression model</a></li>
<li><a href="12-4-assumptions.html#assumptions"><span class="toc-section-number">12.4</span> Assumptions</a></li>
<li><a href="12-5-an-example-using-r.html#an-example-using-r"><span class="toc-section-number">12.5</span> An example using R</a></li>
<li><a href="12-6-exercises-linear-regression.html#exercises---linear-regression"><span class="toc-section-number">12.6</span> Exercises - Linear Regression</a>
<ul>
<li><a href="11-5-a-2-way-anova-on-a-fish-behaviour-study.html#background-1"><span class="toc-section-number">12.6.1</span> Background</a></li>
<li><a href="8-10-exercises-randomisation-tests.html#your-task"><span class="toc-section-number">12.6.2</span> Your task</a></li>
</ul></li>
</ul></li>
<li><a href="13-linear-models-with-categorical-and-continuous-explanatory-variables.html#linear-models-with-categorical-and-continuous-explanatory-variables"><span class="toc-section-number">13</span> Linear models with categorical and continuous explanatory variables</a>
<ul>
<li><a href="2-13-exercises-getting-acquainted-with-r.html#background"><span class="toc-section-number">13.1</span> Background</a></li>
<li><a href="13-2-the-height-hand-width-example-.html#the-height-hand-width-example."><span class="toc-section-number">13.2</span> The height ~ hand width example.</a></li>
<li><a href="13-3-summarising-with-anova.html#summarising-with-anova"><span class="toc-section-number">13.3</span> Summarising with <code>anova</code></a></li>
<li><a href="13-4-the-summary-of-coefficients-summary.html#the-summary-of-coefficients-summary"><span class="toc-section-number">13.4</span> The summary of coefficients (<code>summary</code>)</a></li>
<li><a href="13-5-simplifying-the-model.html#simplifying-the-model"><span class="toc-section-number">13.5</span> Simplifying the model</a></li>
</ul></li>
<li><a href="14-generalised-linear-models.html#generalised-linear-models"><span class="toc-section-number">14</span> Generalised linear models</a>
<ul>
<li><a href="14-1-count-data-with-poisson-errors-.html#count-data-with-poisson-errors."><span class="toc-section-number">14.1</span> Count data with Poisson errors.</a>
<ul>
<li><a href="14-1-count-data-with-poisson-errors-.html#example-number-of-offspring-in-foxes."><span class="toc-section-number">14.1.1</span> Example: Number of offspring in foxes.</a></li>
<li><a href="14-1-count-data-with-poisson-errors-.html#example-cancer-clusters"><span class="toc-section-number">14.1.2</span> Example: Cancer clusters</a></li>
</ul></li>
</ul></li>
<li><a href="15-extending-use-cases-of-glm.html#extending-use-cases-of-glm"><span class="toc-section-number">15</span> Extending use cases of GLM</a>
<ul>
<li><a href="15-1-logistic-regression-with-binary-01-data.html#logistic-regression-with-binary-01-data"><span class="toc-section-number">15.1</span> Logistic regression with binary (0/1) data</a></li>
<li><a href="15-2-example-species-presenceabsence-data.html#example-species-presenceabsence-data"><span class="toc-section-number">15.2</span> Example: species presence/absence data</a></li>
<li><a href="15-3-binomial-regression-with-proportionratio-data.html#binomial-regression-with-proportionratio-data"><span class="toc-section-number">15.3</span> Binomial regression with proportion/ratio data</a>
<ul>
<li><a href="15-3-binomial-regression-with-proportionratio-data.html#example-sex-ratios"><span class="toc-section-number">15.3.1</span> Example: sex ratios</a></li>
</ul></li>
</ul></li>
<li><a href="16-power-analysis-by-simulation.html#power-analysis-by-simulation"><span class="toc-section-number">16</span> Power analysis by simulation</a>
<ul>
<li><a href="16-1-type-i-and-ii-errors-and-statistical-power.html#type-i-and-ii-errors-and-statistical-power"><span class="toc-section-number">16.1</span> Type I and II errors and statistical power</a></li>
<li><a href="16-2-what-determines-statistical-power.html#what-determines-statistical-power"><span class="toc-section-number">16.2</span> What determines statistical power?</a></li>
<li><a href="16-3-an-example-of-calculating-statistical-power-.html#an-example-of-calculating-statistical-power."><span class="toc-section-number">16.3</span> An example of calculating statistical power.</a>
<ul>
<li><a href="16-3-an-example-of-calculating-statistical-power-.html#the-simulation"><span class="toc-section-number">16.3.1</span> The simulation</a></li>
<li><a href="16-3-an-example-of-calculating-statistical-power-.html#some-questions-for-you-to-address"><span class="toc-section-number">16.3.2</span> Some questions for you to address:</a></li>
</ul></li>
<li><a href="16-4-summary.html#summary"><span class="toc-section-number">16.4</span> Summary</a></li>
<li><a href="16-5-extending-the-simulation-optional-advanced.html#extending-the-simulation-optional-advanced"><span class="toc-section-number">16.5</span> Extending the simulation (optional, advanced)</a></li>
<li><a href="16-6-exercise-snails-on-the-move.html#exercise-snails-on-the-move"><span class="toc-section-number">16.6</span> Exercise: Snails on the move</a></li>
<li><a href="16-7-mouse-lemur-strength.html#mouse-lemur-strength"><span class="toc-section-number">16.7</span> Mouse lemur strength</a></li>
</ul></li>
<li class="part"><span><b>IV Coming soon(ish)</b></span></li>
<li><a href="17-coming-soon-maybe.html#coming-soon-maybe"><span class="toc-section-number">17</span> Coming soon (maybe)!</a>
<ul>
<li><a href="17-1-multivariate-statistics.html#multivariate-statistics"><span class="toc-section-number">17.1</span> Multivariate statistics</a></li>
<li><a href="17-2-transforming-variables.html#transforming-variables"><span class="toc-section-number">17.2</span> Transforming variables</a></li>
<li><a href="17-3-non-linear-regression.html#non-linear-regression"><span class="toc-section-number">17.3</span> Non-linear regression</a></li>
<li><a href="17-4-nested-or-blocked-study-designs.html#nested-or-blocked-study-designs"><span class="toc-section-number">17.4</span> Nested or blocked study designs</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="paired-randomisation-tests" class="section level2" number="8.9">
<h2><span class="header-section-number">8.9</span> Paired Randomisation Tests</h2>
<p>The paired randomisation test is simply a one-sample randomisation test where the distribution is tested against a value of 0 (no difference between the two). I will illustrate this with an example from Everitt (1994) who looked at using cognitive behaviour therapy as a treatment for anorexia. He collected data on weights of people before and after therapy. These data are in the file <code>anorexiaCBT.csv</code></p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="8-9-paired-randomisation-tests.html#cb264-1" aria-hidden="true"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="8-9-paired-randomisation-tests.html#cb265-1" aria-hidden="true"></a><span class="co">#Remember to set your working directory first</span></span>
<span id="cb265-2"><a href="8-9-paired-randomisation-tests.html#cb265-2" aria-hidden="true"></a>an &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;CourseData/anorexiaCBT.csv&quot;</span>)</span>
<span id="cb265-3"><a href="8-9-paired-randomisation-tests.html#cb265-3" aria-hidden="true"></a><span class="kw">head</span>(an)</span></code></pre></div>
<pre><code>##   Subject Week01 Week08
## 1       1   80.5   82.2
## 2       2   84.9   85.6
## 3       3   81.5   81.4
## 4       4   82.6   81.9
## 5       5   79.9   76.4
## 6       6   88.7  103.6</code></pre>
<p>These data are arrange in a so-called “wide” format. To make plotting and analysis data need to be rearranged into a tidy “long” format so that each observation is on a row. We can do this using the gather function:</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="8-9-paired-randomisation-tests.html#cb267-1" aria-hidden="true"></a>an &lt;-<span class="st"> </span>an <span class="op">%&gt;%</span></span>
<span id="cb267-2"><a href="8-9-paired-randomisation-tests.html#cb267-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">gather</span>(<span class="st">&quot;time&quot;</span>,<span class="st">&quot;weight&quot;</span>,<span class="op">-</span>Subject)</span>
<span id="cb267-3"><a href="8-9-paired-randomisation-tests.html#cb267-3" aria-hidden="true"></a></span>
<span id="cb267-4"><a href="8-9-paired-randomisation-tests.html#cb267-4" aria-hidden="true"></a><span class="kw">head</span>(an)</span></code></pre></div>
<pre><code>##   Subject   time weight
## 1       1 Week01   80.5
## 2       2 Week01   84.9
## 3       3 Week01   81.5
## 4       4 Week01   82.6
## 5       5 Week01   79.9
## 6       6 Week01   88.7</code></pre>
<div id="plot-the-data" class="section level3" number="8.9.1">
<h3><span class="header-section-number">8.9.1</span> Plot the data</h3>
<p>We should ALWAYS plot the data. So here goes.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="8-9-paired-randomisation-tests.html#cb269-1" aria-hidden="true"></a>(p1&lt;-<span class="kw">ggplot</span>(an,<span class="kw">aes</span>(<span class="dt">x=</span>weight,<span class="dt">fill=</span>time)) <span class="op">+</span></span>
<span id="cb269-2"><a href="8-9-paired-randomisation-tests.html#cb269-2" aria-hidden="true"></a><span class="st">   </span><span class="kw">geom_histogram</span>(<span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>,<span class="dt">alpha=</span>.<span class="dv">7</span>)</span>
<span id="cb269-3"><a href="8-9-paired-randomisation-tests.html#cb269-3" aria-hidden="true"></a> )</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-156-1.png" width="672" /></p>
<p>Another useful way to plot this data is to use an “interaction plot”. In these plots the matched pairs (grouped by <code>Subject</code>) are joined together with lines. You can plot one like this:</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="8-9-paired-randomisation-tests.html#cb270-1" aria-hidden="true"></a>(p2&lt;-<span class="kw">ggplot</span>(an,<span class="kw">aes</span>(<span class="dt">x=</span>time,<span class="dt">y=</span>weight,<span class="dt">group=</span>Subject)) <span class="op">+</span></span>
<span id="cb270-2"><a href="8-9-paired-randomisation-tests.html#cb270-2" aria-hidden="true"></a><span class="st">   </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb270-3"><a href="8-9-paired-randomisation-tests.html#cb270-3" aria-hidden="true"></a><span class="st">   </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.5</span>)</span>
<span id="cb270-4"><a href="8-9-paired-randomisation-tests.html#cb270-4" aria-hidden="true"></a> )</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-157-1.png" width="672" /></p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="8-9-paired-randomisation-tests.html#cb271-1" aria-hidden="true"></a><span class="co">#ggsave(&quot;/Users/jones/Dropbox/_SDU_Teaching/BB852 New Stats Course/PlotsintPlot.png&quot;,p2,width=6, height=8, dpi = 300, units=&quot;cm&quot;)</span></span></code></pre></div>
<p>What we are interested in is whether there has been a change in weight of the subjects after CBT. The null hypothesis is that there is zero change in weight. The alternative hypothesis is that weight has increased.</p>
<p>The starting point for the analysis is to calculate the observed change in weight.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="8-9-paired-randomisation-tests.html#cb272-1" aria-hidden="true"></a>an &lt;-<span class="st"> </span>an <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb272-2"><a href="8-9-paired-randomisation-tests.html#cb272-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(Subject) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb272-3"><a href="8-9-paired-randomisation-tests.html#cb272-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">change =</span> <span class="kw">diff</span>(weight))</span></code></pre></div>
<p>You have created a dataset that looks like this:</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="8-9-paired-randomisation-tests.html#cb273-1" aria-hidden="true"></a><span class="kw">head</span>(an)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   Subject change
##     &lt;int&gt;  &lt;dbl&gt;
## 1       1  1.7  
## 2       2  0.700
## 3       3 -0.100
## 4       4 -0.700
## 5       5 -3.5  
## 6       6 14.9</code></pre>
<p>And you can calculate the observed change like this:</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="8-9-paired-randomisation-tests.html#cb275-1" aria-hidden="true"></a>obsChange &lt;-<span class="st"> </span><span class="kw">mean</span>(an<span class="op">$</span>change)</span>
<span id="cb275-2"><a href="8-9-paired-randomisation-tests.html#cb275-2" aria-hidden="true"></a>obsChange</span></code></pre></div>
<pre><code>## [1] 3.006897</code></pre>
</div>
<div id="the-paired-randomisation-test" class="section level3" number="8.9.2">
<h3><span class="header-section-number">8.9.2</span> The paired randomisation test</h3>
<p>The logic of this test is that if the experimental treatment has no effect on weight, then the Before weight is just as likely to be larger than the After weight as it is to be smaller.
In other words, if the null hypothesis is true, a permutation within any pair of scores is as likely as the reverse.</p>
<p>Therefore to carry out this test, we can permute the SIGN of the change in weight (i.e. we randomly flip values from positive to negative and vice versa). We can do this by multiplying by 1 or -1, randomly.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="8-9-paired-randomisation-tests.html#cb277-1" aria-hidden="true"></a><span class="kw">head</span>(an)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   Subject change
##     &lt;int&gt;  &lt;dbl&gt;
## 1       1  1.7  
## 2       2  0.700
## 3       3 -0.100
## 4       4 -0.700
## 5       5 -3.5  
## 6       6 14.9</code></pre>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="8-9-paired-randomisation-tests.html#cb279-1" aria-hidden="true"></a>anShuffled &lt;-<span class="st"> </span>an <span class="op">%&gt;%</span></span>
<span id="cb279-2"><a href="8-9-paired-randomisation-tests.html#cb279-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sign =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>),<span class="dt">size =</span> <span class="kw">nrow</span>(an),<span class="dt">replace =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb279-3"><a href="8-9-paired-randomisation-tests.html#cb279-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">shuffledChange =</span> change <span class="op">*</span><span class="st"> </span>sign)</span></code></pre></div>
<p>Let’s take a look at this new shuffled dataset:</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="8-9-paired-randomisation-tests.html#cb280-1" aria-hidden="true"></a><span class="kw">head</span>(anShuffled)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Subject change  sign shuffledChange
##     &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;          &lt;dbl&gt;
## 1       1  1.7       1          1.7  
## 2       2  0.700    -1         -0.700
## 3       3 -0.100    -1          0.100
## 4       4 -0.700    -1          0.700
## 5       5 -3.5      -1          3.5  
## 6       6 14.9      -1        -14.9</code></pre>
<p>We need to calculate the mean of this shuffled vector. We can do this by <code>pull</code> to get the vector, and then <code>mean</code>.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="8-9-paired-randomisation-tests.html#cb282-1" aria-hidden="true"></a>an <span class="op">%&gt;%</span></span>
<span id="cb282-2"><a href="8-9-paired-randomisation-tests.html#cb282-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sign =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>),<span class="dt">size =</span> <span class="kw">nrow</span>(an),<span class="dt">replace =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb282-3"><a href="8-9-paired-randomisation-tests.html#cb282-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">shuffledChange =</span> change <span class="op">*</span><span class="st"> </span>sign) <span class="op">%&gt;%</span></span>
<span id="cb282-4"><a href="8-9-paired-randomisation-tests.html#cb282-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">pull</span>(shuffledChange) <span class="op">%&gt;%</span></span>
<span id="cb282-5"><a href="8-9-paired-randomisation-tests.html#cb282-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">mean</span>()</span></code></pre></div>
<pre><code>## [1] -0.462069</code></pre>
<p>Now we will build a null distribution of changes in weight by repeating this 1000 times. We can do this using the <code>replicate</code> function to “wrap” around the function, passing the result into a data frame. We can then compare this null distribution to the observed change.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="8-9-paired-randomisation-tests.html#cb284-1" aria-hidden="true"></a>nullDist =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">change =</span></span>
<span id="cb284-2"><a href="8-9-paired-randomisation-tests.html#cb284-2" aria-hidden="true"></a>                        <span class="kw">replicate</span>(<span class="dv">1000</span>,an <span class="op">%&gt;%</span></span>
<span id="cb284-3"><a href="8-9-paired-randomisation-tests.html#cb284-3" aria-hidden="true"></a><span class="st">                                    </span><span class="kw">mutate</span>(<span class="dt">sign =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>),<span class="dt">size =</span> <span class="kw">nrow</span>(an),<span class="dt">replace =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb284-4"><a href="8-9-paired-randomisation-tests.html#cb284-4" aria-hidden="true"></a><span class="st">                                    </span><span class="kw">mutate</span>(<span class="dt">shuffledChange =</span> change <span class="op">*</span><span class="st"> </span>sign) <span class="op">%&gt;%</span></span>
<span id="cb284-5"><a href="8-9-paired-randomisation-tests.html#cb284-5" aria-hidden="true"></a><span class="st">                                    </span><span class="kw">pull</span>(shuffledChange) <span class="op">%&gt;%</span></span>
<span id="cb284-6"><a href="8-9-paired-randomisation-tests.html#cb284-6" aria-hidden="true"></a><span class="st">                                    </span><span class="kw">mean</span>())) </span></code></pre></div>
</div>
<div id="plot-the-null-distribution" class="section level3" number="8.9.3">
<h3><span class="header-section-number">8.9.3</span> Plot the null distribution</h3>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="8-9-paired-randomisation-tests.html#cb285-1" aria-hidden="true"></a>(nullDistPlot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nullDist,<span class="kw">aes</span>(<span class="dt">x=</span>change)) <span class="op">+</span></span>
<span id="cb285-2"><a href="8-9-paired-randomisation-tests.html#cb285-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_histogram</span>())</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-166-1.png" width="672" /></p>
<p>We can add the observed change as a line to this:</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="8-9-paired-randomisation-tests.html#cb286-1" aria-hidden="true"></a>nullDistPlot <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> obsChange)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-167-1.png" width="672" /></p>
</div>
<div id="the-formal-hypothesis-test" class="section level3" number="8.9.4">
<h3><span class="header-section-number">8.9.4</span> The formal hypothesis test</h3>
<p>The formal test of significance then is to ask how many of the null distribution replicates are as extreme as the observed change.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="8-9-paired-randomisation-tests.html#cb287-1" aria-hidden="true"></a><span class="kw">table</span>(nullDist<span class="op">$</span>change<span class="op">&gt;=</span>obsChange)</span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##   975    25</code></pre>
<p>So we can see that 25 of 1000 replicates were greater than or equal to the observed change. This translates to a p-value of 0.025. We can therefore say that the observed change in weight after CBT was signficantly greater than what we would expect from chance.</p>
</div>
</div>
<p style="text-align: center;">
<a href="8-8-writing-it-up.html"><button class="btn btn-default">Previous</button></a>
<a href="8-10-exercises-randomisation-tests.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
