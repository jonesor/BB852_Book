<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 20 Extending use cases of GLM | BB852 - Data handling, visualisation and statistics</title>
  <meta name="description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 20 Extending use cases of GLM | BB852 - Data handling, visualisation and statistics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 20 Extending use cases of GLM | BB852 - Data handling, visualisation and statistics" />
  
  <meta name="twitter:description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  

<meta name="author" content="Owen R. Jones" />


<meta name="date" content="2023-07-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="generalised-linear-models.html"/>
<link rel="next" href="power-analysis-by-simulation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.1.3/tabwid.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BB852</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data-wrangling"><i class="fa fa-check"></i><b>1.1</b> Data wrangling</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-visualisation"><i class="fa fa-check"></i><b>1.2</b> Data visualisation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#statistics"><i class="fa fa-check"></i><b>1.3</b> Statistics</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#data-sources"><i class="fa fa-check"></i><b>1.4</b> Data sources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#your-instructors"><i class="fa fa-check"></i><b>1.5</b> Your instructors</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#expectations"><i class="fa fa-check"></i><b>1.6</b> Expectations</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#your-feedback"><i class="fa fa-check"></i><b>1.7</b> Your feedback</a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#assessment"><i class="fa fa-check"></i><b>1.8</b> Assessment</a></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.9</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i><b>2</b> Schedule</a></li>
<li class="chapter" data-level="3" data-path="additional-recommended-reading.html"><a href="additional-recommended-reading.html"><i class="fa fa-check"></i><b>3</b> Additional recommended reading</a></li>
<li class="chapter" data-level="4" data-path="an-r-refresher.html"><a href="an-r-refresher.html"><i class="fa fa-check"></i><b>4</b> An R refresher</a>
<ul>
<li class="chapter" data-level="4.1" data-path="an-r-refresher.html"><a href="an-r-refresher.html#getting-started-with-r"><i class="fa fa-check"></i><b>4.1</b> Getting started with R</a></li>
<li class="chapter" data-level="4.2" data-path="an-r-refresher.html"><a href="an-r-refresher.html#getting-help"><i class="fa fa-check"></i><b>4.2</b> Getting help</a></li>
<li class="chapter" data-level="4.3" data-path="an-r-refresher.html"><a href="an-r-refresher.html#r-as-a-fancy-calculator"><i class="fa fa-check"></i><b>4.3</b> R as a fancy calculator</a></li>
<li class="chapter" data-level="4.4" data-path="an-r-refresher.html"><a href="an-r-refresher.html#objects-in-r"><i class="fa fa-check"></i><b>4.4</b> Objects in R</a></li>
<li class="chapter" data-level="4.5" data-path="an-r-refresher.html"><a href="an-r-refresher.html#manipulating-objects"><i class="fa fa-check"></i><b>4.5</b> Manipulating objects</a></li>
<li class="chapter" data-level="4.6" data-path="an-r-refresher.html"><a href="an-r-refresher.html#missing-values-infinity-and-non-numbers"><i class="fa fa-check"></i><b>4.6</b> Missing values, infinity and “non-numbers”</a></li>
<li class="chapter" data-level="4.7" data-path="an-r-refresher.html"><a href="an-r-refresher.html#basic-information-about-objects"><i class="fa fa-check"></i><b>4.7</b> Basic information about objects</a></li>
<li class="chapter" data-level="4.8" data-path="an-r-refresher.html"><a href="an-r-refresher.html#data-frames"><i class="fa fa-check"></i><b>4.8</b> Data frames</a></li>
<li class="chapter" data-level="4.9" data-path="an-r-refresher.html"><a href="an-r-refresher.html#classes-in-r"><i class="fa fa-check"></i><b>4.9</b> Classes in R</a></li>
<li class="chapter" data-level="4.10" data-path="an-r-refresher.html"><a href="an-r-refresher.html#organising-your-work"><i class="fa fa-check"></i><b>4.10</b> Organising your work</a></li>
<li class="chapter" data-level="4.11" data-path="an-r-refresher.html"><a href="an-r-refresher.html#inspecting-the-data"><i class="fa fa-check"></i><b>4.11</b> Inspecting the data</a></li>
<li class="chapter" data-level="4.12" data-path="an-r-refresher.html"><a href="an-r-refresher.html#classes-in-r-1"><i class="fa fa-check"></i><b>4.12</b> “Classes” in R</a></li>
<li class="chapter" data-level="4.13" data-path="an-r-refresher.html"><a href="an-r-refresher.html#tables-and-summary-statistics"><i class="fa fa-check"></i><b>4.13</b> Tables and summary statistics</a></li>
<li class="chapter" data-level="4.14" data-path="an-r-refresher.html"><a href="an-r-refresher.html#plotting-data"><i class="fa fa-check"></i><b>4.14</b> Plotting data</a></li>
<li class="chapter" data-level="4.15" data-path="an-r-refresher.html"><a href="an-r-refresher.html#r-packages"><i class="fa fa-check"></i><b>4.15</b> R Packages</a></li>
<li class="chapter" data-level="4.16" data-path="an-r-refresher.html"><a href="an-r-refresher.html#exercise-californian-bird-diversity"><i class="fa fa-check"></i><b>4.16</b> Exercise: Californian bird diversity</a>
<ul>
<li class="chapter" data-level="4.16.1" data-path="an-r-refresher.html"><a href="an-r-refresher.html#the-data"><i class="fa fa-check"></i><b>4.16.1</b> The data</a></li>
<li class="chapter" data-level="4.16.2" data-path="an-r-refresher.html"><a href="an-r-refresher.html#try-the-following"><i class="fa fa-check"></i><b>4.16.2</b> Try the following</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html"><i class="fa fa-check"></i><b>5</b> Tips and tricks</a>
<ul>
<li class="chapter" data-level="5.1" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#appearance"><i class="fa fa-check"></i><b>5.1</b> Appearance</a></li>
<li class="chapter" data-level="5.2" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#shortcuts"><i class="fa fa-check"></i><b>5.2</b> Shortcuts</a></li>
<li class="chapter" data-level="5.3" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#code-style"><i class="fa fa-check"></i><b>5.3</b> Code style</a></li>
<li class="chapter" data-level="5.4" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#the-plots-pane"><i class="fa fa-check"></i><b>5.4</b> The plots pane</a></li>
<li class="chapter" data-level="5.5" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#tables"><i class="fa fa-check"></i><b>5.5</b> Tables</a></li>
<li class="chapter" data-level="5.6" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#importing-data-from-text-files"><i class="fa fa-check"></i><b>5.6</b> Importing data from text files</a></li>
<li class="chapter" data-level="5.7" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#importing-data-from-excel"><i class="fa fa-check"></i><b>5.7</b> Importing data from Excel</a></li>
<li class="chapter" data-level="5.8" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#numbers"><i class="fa fa-check"></i><b>5.8</b> Numbers</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="paths-and-projects.html"><a href="paths-and-projects.html"><i class="fa fa-check"></i><b>6</b> Paths and projects</a>
<ul>
<li class="chapter" data-level="6.1" data-path="paths-and-projects.html"><a href="paths-and-projects.html#file-structure"><i class="fa fa-check"></i><b>6.1</b> File structure</a></li>
<li class="chapter" data-level="6.2" data-path="paths-and-projects.html"><a href="paths-and-projects.html#paths-and-the-command-line"><i class="fa fa-check"></i><b>6.2</b> Paths and the command line</a></li>
<li class="chapter" data-level="6.3" data-path="paths-and-projects.html"><a href="paths-and-projects.html#r-and-file-structure"><i class="fa fa-check"></i><b>6.3</b> R and file structure</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="paths-and-projects.html"><a href="paths-and-projects.html#setting-the-working-directory"><i class="fa fa-check"></i><b>6.3.1</b> Setting the working directory</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="paths-and-projects.html"><a href="paths-and-projects.html#projects-in-r"><i class="fa fa-check"></i><b>6.4</b> Projects in R</a></li>
</ul></li>
<li class="part"><span><b>I Data Wrangling</b></span></li>
<li class="chapter" data-level="7" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html"><i class="fa fa-check"></i><b>7</b> Data wrangling with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="7.1" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#select"><i class="fa fa-check"></i><b>7.1</b> <code>select</code></a></li>
<li class="chapter" data-level="7.2" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#filter"><i class="fa fa-check"></i><b>7.2</b> <code>filter</code></a></li>
<li class="chapter" data-level="7.3" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#arrange"><i class="fa fa-check"></i><b>7.3</b> <code>arrange</code></a></li>
<li class="chapter" data-level="7.4" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#summarise-and-group_by"><i class="fa fa-check"></i><b>7.4</b> <code>summarise</code> and <code>group_by</code></a></li>
<li class="chapter" data-level="7.5" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#using-pipes-saving-data."><i class="fa fa-check"></i><b>7.5</b> Using pipes, saving data.</a></li>
<li class="chapter" data-level="7.6" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#exercise-wrangling-the-amniote-life-history-database"><i class="fa fa-check"></i><b>7.6</b> Exercise: Wrangling the Amniote Life History Database</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="combining-data-sets.html"><a href="combining-data-sets.html"><i class="fa fa-check"></i><b>8</b> Combining data sets</a>
<ul>
<li class="chapter" data-level="8.1" data-path="combining-data-sets.html"><a href="combining-data-sets.html#using-join"><i class="fa fa-check"></i><b>8.1</b> Using <code>join</code></a></li>
<li class="chapter" data-level="8.2" data-path="combining-data-sets.html"><a href="combining-data-sets.html#using-pivot_longer"><i class="fa fa-check"></i><b>8.2</b> Using <code>pivot_longer</code></a></li>
<li class="chapter" data-level="8.3" data-path="combining-data-sets.html"><a href="combining-data-sets.html#exercise-temperature-effects-on-egg-laying-dates"><i class="fa fa-check"></i><b>8.3</b> Exercise: Temperature effects on egg laying dates</a></li>
</ul></li>
<li class="part"><span><b>II Data visualisation</b></span></li>
<li class="chapter" data-level="9" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html"><i class="fa fa-check"></i><b>9</b> Visualising data with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="9.1" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html#histograms"><i class="fa fa-check"></i><b>9.1</b> Histograms</a></li>
<li class="chapter" data-level="9.2" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html#facets---splitting-data-across-panels"><i class="fa fa-check"></i><b>9.2</b> “Facets” - splitting data across panels</a></li>
<li class="chapter" data-level="9.3" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html#box-plots"><i class="fa fa-check"></i><b>9.3</b> Box plots</a></li>
<li class="chapter" data-level="9.4" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html#lines-and-points"><i class="fa fa-check"></i><b>9.4</b> Lines and points</a></li>
<li class="chapter" data-level="9.5" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html#scatter-plots"><i class="fa fa-check"></i><b>9.5</b> Scatter plots</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html"><i class="fa fa-check"></i><b>10</b> Distributions and summarising data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#distributions"><i class="fa fa-check"></i><b>10.1</b> Distributions</a></li>
<li class="chapter" data-level="10.2" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#normal-distribution"><i class="fa fa-check"></i><b>10.2</b> Normal distribution</a></li>
<li class="chapter" data-level="10.3" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#comparing-normal-distributions"><i class="fa fa-check"></i><b>10.3</b> Comparing normal distributions</a></li>
<li class="chapter" data-level="10.4" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#poisson-distribution"><i class="fa fa-check"></i><b>10.4</b> Poisson distribution</a></li>
<li class="chapter" data-level="10.5" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#comparing-normal-and-poisson-distributions"><i class="fa fa-check"></i><b>10.5</b> Comparing normal and Poisson distributions</a></li>
<li class="chapter" data-level="10.6" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#the-law-of-large-numbers"><i class="fa fa-check"></i><b>10.6</b> The law of large numbers</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#coin-flipping"><i class="fa fa-check"></i><b>10.6.1</b> Coin flipping</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#exercise-virtual-dice"><i class="fa fa-check"></i><b>10.7</b> Exercise: Virtual dice</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html"><i class="fa fa-check"></i><b>11</b> Pimping your plots</a>
<ul>
<li class="chapter" data-level="11.1" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#a-basic-plot"><i class="fa fa-check"></i><b>11.1</b> A basic plot</a></li>
<li class="chapter" data-level="11.2" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#axis-limits"><i class="fa fa-check"></i><b>11.2</b> Axis limits</a></li>
<li class="chapter" data-level="11.3" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#transforming-the-axis-log-scale"><i class="fa fa-check"></i><b>11.3</b> Transforming the axis (log scale)</a></li>
<li class="chapter" data-level="11.4" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#changing-the-axis-tick-marks"><i class="fa fa-check"></i><b>11.4</b> Changing the axis tick marks</a></li>
<li class="chapter" data-level="11.5" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#axis-labels"><i class="fa fa-check"></i><b>11.5</b> Axis labels</a></li>
<li class="chapter" data-level="11.6" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#colours"><i class="fa fa-check"></i><b>11.6</b> Colours</a></li>
<li class="chapter" data-level="11.7" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#themes"><i class="fa fa-check"></i><b>11.7</b> Themes</a></li>
<li class="chapter" data-level="11.8" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#moving-the-legend"><i class="fa fa-check"></i><b>11.8</b> Moving the legend</a></li>
<li class="chapter" data-level="11.9" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#combining-multiple-plots"><i class="fa fa-check"></i><b>11.9</b> Combining multiple plots</a></li>
<li class="chapter" data-level="11.10" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#saving-your-plot"><i class="fa fa-check"></i><b>11.10</b> Saving your plot</a></li>
<li class="chapter" data-level="11.11" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#final-word-on-plots"><i class="fa fa-check"></i><b>11.11</b> Final word on plots</a></li>
</ul></li>
<li class="part"><span><b>III Statistics</b></span></li>
<li class="chapter" data-level="12" data-path="randomisation-tests.html"><a href="randomisation-tests.html"><i class="fa fa-check"></i><b>12</b> Randomisation Tests</a>
<ul>
<li class="chapter" data-level="12.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#randomisation-test-in-r"><i class="fa fa-check"></i><b>12.1</b> Randomisation test in R</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#calculate-the-observed-difference"><i class="fa fa-check"></i><b>12.1.1</b> Calculate the observed difference</a></li>
<li class="chapter" data-level="12.1.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#null-distribution"><i class="fa fa-check"></i><b>12.1.2</b> Null distribution</a></li>
<li class="chapter" data-level="12.1.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-significance"><i class="fa fa-check"></i><b>12.1.3</b> Testing significance</a></li>
<li class="chapter" data-level="12.1.4" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-the-hypothesis"><i class="fa fa-check"></i><b>12.1.4</b> Testing the hypothesis</a></li>
<li class="chapter" data-level="12.1.5" data-path="randomisation-tests.html"><a href="randomisation-tests.html#writing-it-up"><i class="fa fa-check"></i><b>12.1.5</b> Writing it up</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#paired-randomisation-tests"><i class="fa fa-check"></i><b>12.2</b> Paired Randomisation Tests</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-randomisation-test"><i class="fa fa-check"></i><b>12.2.1</b> The randomisation test</a></li>
<li class="chapter" data-level="12.2.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#null-distribution-1"><i class="fa fa-check"></i><b>12.2.2</b> Null distribution</a></li>
<li class="chapter" data-level="12.2.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-formal-hypothesis-test"><i class="fa fa-check"></i><b>12.2.3</b> The formal hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#exercise-sexual-selection-in-hercules-beetles"><i class="fa fa-check"></i><b>12.3</b> Exercise: Sexual selection in Hercules beetles</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html"><i class="fa fa-check"></i><b>13</b> t-test: Comparing two means</a>
<ul>
<li class="chapter" data-level="13.1" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html#some-theory"><i class="fa fa-check"></i><b>13.1</b> Some theory</a></li>
<li class="chapter" data-level="13.2" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html#one-sample-t-test"><i class="fa fa-check"></i><b>13.2</b> One sample t-test</a></li>
<li class="chapter" data-level="13.3" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html#doing-it-by-hand---where-does-the-t-statistic-come-from"><i class="fa fa-check"></i><b>13.3</b> Doing it “by hand” - where does the t-statistic come from?</a></li>
<li class="chapter" data-level="13.4" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html#paired-t-test"><i class="fa fa-check"></i><b>13.4</b> Paired t-test</a></li>
<li class="chapter" data-level="13.5" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html#a-paired-t-test-is-a-one-sample-test."><i class="fa fa-check"></i><b>13.5</b> A paired t-test is a one-sample test.</a></li>
<li class="chapter" data-level="13.6" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html#two-sample-t-test"><i class="fa fa-check"></i><b>13.6</b> Two sample t-test</a></li>
<li class="chapter" data-level="13.7" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html#t-tests-are-linear-models"><i class="fa fa-check"></i><b>13.7</b> t-tests are linear models</a></li>
<li class="chapter" data-level="13.8" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html#exercise-sex-differences-in-fine-motor-skills"><i class="fa fa-check"></i><b>13.8</b> Exercise: Sex differences in fine motor skills</a></li>
<li class="chapter" data-level="13.9" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html#exercise-therapy-for-anorexia"><i class="fa fa-check"></i><b>13.9</b> Exercise: Therapy for anorexia</a></li>
<li class="chapter" data-level="13.10" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html#exercise-compare-t-tests-with-randomisation-tests-optional"><i class="fa fa-check"></i><b>13.10</b> Exercise: Compare t-tests with randomisation tests (optional)</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="anova-linear-models-with-a-single-categorical-explanatory-variable.html"><a href="anova-linear-models-with-a-single-categorical-explanatory-variable.html"><i class="fa fa-check"></i><b>14</b> ANOVA: Linear models with a single categorical explanatory variable</a>
<ul>
<li class="chapter" data-level="14.1" data-path="anova-linear-models-with-a-single-categorical-explanatory-variable.html"><a href="anova-linear-models-with-a-single-categorical-explanatory-variable.html#one-way-anova"><i class="fa fa-check"></i><b>14.1</b> One-way ANOVA</a></li>
<li class="chapter" data-level="14.2" data-path="anova-linear-models-with-a-single-categorical-explanatory-variable.html"><a href="anova-linear-models-with-a-single-categorical-explanatory-variable.html#fitting-an-anova-in-r"><i class="fa fa-check"></i><b>14.2</b> Fitting an ANOVA in R</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="anova-linear-models-with-a-single-categorical-explanatory-variable.html"><a href="anova-linear-models-with-a-single-categorical-explanatory-variable.html#where-are-the-differences"><i class="fa fa-check"></i><b>14.2.1</b> Where are the differences?</a></li>
<li class="chapter" data-level="14.2.2" data-path="anova-linear-models-with-a-single-categorical-explanatory-variable.html"><a href="anova-linear-models-with-a-single-categorical-explanatory-variable.html#tukeys-honestly-significant-difference-hsd"><i class="fa fa-check"></i><b>14.2.2</b> Tukey’s Honestly Significant Difference (HSD)</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="anova-linear-models-with-a-single-categorical-explanatory-variable.html"><a href="anova-linear-models-with-a-single-categorical-explanatory-variable.html#anova-calculation-by-hand."><i class="fa fa-check"></i><b>14.3</b> ANOVA calculation “by hand”.</a></li>
<li class="chapter" data-level="14.4" data-path="anova-linear-models-with-a-single-categorical-explanatory-variable.html"><a href="anova-linear-models-with-a-single-categorical-explanatory-variable.html#exercise-apple-tree-crop-yield"><i class="fa fa-check"></i><b>14.4</b> Exercise: Apple tree crop yield</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="linear-regression-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-regression-models-with-a-single-continuous-explanatory-variable.html"><i class="fa fa-check"></i><b>15</b> Linear regression: models with a single continuous explanatory variable</a>
<ul>
<li class="chapter" data-level="15.1" data-path="linear-regression-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-regression-models-with-a-single-continuous-explanatory-variable.html#some-theory-1"><i class="fa fa-check"></i><b>15.1</b> Some theory</a></li>
<li class="chapter" data-level="15.2" data-path="linear-regression-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-regression-models-with-a-single-continuous-explanatory-variable.html#evaluating-a-hypothesis-with-a-linear-regression-model"><i class="fa fa-check"></i><b>15.2</b> Evaluating a hypothesis with a linear regression model</a></li>
<li class="chapter" data-level="15.3" data-path="linear-regression-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-regression-models-with-a-single-continuous-explanatory-variable.html#assumptions"><i class="fa fa-check"></i><b>15.3</b> Assumptions</a></li>
<li class="chapter" data-level="15.4" data-path="linear-regression-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-regression-models-with-a-single-continuous-explanatory-variable.html#worked-example-height-hand-width-relationship"><i class="fa fa-check"></i><b>15.4</b> Worked example: height-hand width relationship</a></li>
<li class="chapter" data-level="15.5" data-path="linear-regression-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-regression-models-with-a-single-continuous-explanatory-variable.html#exercise-chirping-crickets"><i class="fa fa-check"></i><b>15.5</b> Exercise: Chirping crickets</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="ancova-linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="ancova-linear-models-with-categorical-and-continuous-explanatory-variables.html"><i class="fa fa-check"></i><b>16</b> ANCOVA: Linear models with categorical and continuous explanatory variables</a>
<ul>
<li class="chapter" data-level="16.1" data-path="ancova-linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="ancova-linear-models-with-categorical-and-continuous-explanatory-variables.html#the-height-hand-width-example."><i class="fa fa-check"></i><b>16.1</b> The height ~ hand width example.</a></li>
<li class="chapter" data-level="16.2" data-path="ancova-linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="ancova-linear-models-with-categorical-and-continuous-explanatory-variables.html#summarising-with-anova"><i class="fa fa-check"></i><b>16.2</b> Summarising with <code>anova</code></a></li>
<li class="chapter" data-level="16.3" data-path="ancova-linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="ancova-linear-models-with-categorical-and-continuous-explanatory-variables.html#the-summary-of-coefficients-summary"><i class="fa fa-check"></i><b>16.3</b> The summary of coefficients (<code>summary</code>)</a></li>
<li class="chapter" data-level="16.4" data-path="ancova-linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="ancova-linear-models-with-categorical-and-continuous-explanatory-variables.html#simplifying-the-model"><i class="fa fa-check"></i><b>16.4</b> Simplifying the model</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="n-way-anova-linear-models-with-1-categorical-explanatory-variables.html"><a href="n-way-anova-linear-models-with-1-categorical-explanatory-variables.html"><i class="fa fa-check"></i><b>17</b> n-way ANOVA: Linear models with &gt;1 categorical explanatory variables</a>
<ul>
<li class="chapter" data-level="17.1" data-path="n-way-anova-linear-models-with-1-categorical-explanatory-variables.html"><a href="n-way-anova-linear-models-with-1-categorical-explanatory-variables.html#fitting-a-two-way-anova-model"><i class="fa fa-check"></i><b>17.1</b> Fitting a two-way ANOVA model</a></li>
<li class="chapter" data-level="17.2" data-path="n-way-anova-linear-models-with-1-categorical-explanatory-variables.html"><a href="n-way-anova-linear-models-with-1-categorical-explanatory-variables.html#summarising-the-model-anova"><i class="fa fa-check"></i><b>17.2</b> Summarising the model (<code>anova</code>)</a></li>
<li class="chapter" data-level="17.3" data-path="n-way-anova-linear-models-with-1-categorical-explanatory-variables.html"><a href="n-way-anova-linear-models-with-1-categorical-explanatory-variables.html#summarising-the-model-summary"><i class="fa fa-check"></i><b>17.3</b> Summarising the model (<code>summary</code>)</a></li>
<li class="chapter" data-level="17.4" data-path="n-way-anova-linear-models-with-1-categorical-explanatory-variables.html"><a href="n-way-anova-linear-models-with-1-categorical-explanatory-variables.html#exercise-fish-behaviour"><i class="fa fa-check"></i><b>17.4</b> Exercise: Fish behaviour</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="evaluating-linear-models.html"><a href="evaluating-linear-models.html"><i class="fa fa-check"></i><b>18</b> Evaluating linear models</a>
<ul>
<li class="chapter" data-level="18.1" data-path="evaluating-linear-models.html"><a href="evaluating-linear-models.html#r-squared-value"><i class="fa fa-check"></i><b>18.1</b> R-squared value</a></li>
<li class="chapter" data-level="18.2" data-path="evaluating-linear-models.html"><a href="evaluating-linear-models.html#akaike-information-criterion-aic"><i class="fa fa-check"></i><b>18.2</b> Akaike Information Criterion (AIC)</a></li>
<li class="chapter" data-level="18.3" data-path="evaluating-linear-models.html"><a href="evaluating-linear-models.html#variance-partitioning"><i class="fa fa-check"></i><b>18.3</b> Variance partitioning</a></li>
<li class="chapter" data-level="18.4" data-path="evaluating-linear-models.html"><a href="evaluating-linear-models.html#conclusion"><i class="fa fa-check"></i><b>18.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html"><i class="fa fa-check"></i><b>19</b> Generalised linear models</a>
<ul>
<li class="chapter" data-level="19.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#count-data-with-poisson-errors."><i class="fa fa-check"></i><b>19.1</b> Count data with Poisson errors.</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-number-of-offspring-in-foxes."><i class="fa fa-check"></i><b>19.1.1</b> Example: Number of offspring in foxes.</a></li>
<li class="chapter" data-level="19.1.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-cancer-clusters"><i class="fa fa-check"></i><b>19.1.2</b> Example: Cancer clusters</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#exercise-maze-runner"><i class="fa fa-check"></i><b>19.2</b> Exercise: Maze runner</a></li>
<li class="chapter" data-level="19.3" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#overdispersion"><i class="fa fa-check"></i><b>19.3</b> Overdispersion</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html"><i class="fa fa-check"></i><b>20</b> Extending use cases of GLM</a>
<ul>
<li class="chapter" data-level="20.1" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#binomial-response-data"><i class="fa fa-check"></i><b>20.1</b> Binomial response data</a></li>
<li class="chapter" data-level="20.2" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-nfl-field-goals"><i class="fa fa-check"></i><b>20.2</b> Example: NFL field goals</a></li>
<li class="chapter" data-level="20.3" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-sex-ratio-in-turtles"><i class="fa fa-check"></i><b>20.3</b> Example: Sex ratio in turtles</a></li>
<li class="chapter" data-level="20.4" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-smoking"><i class="fa fa-check"></i><b>20.4</b> Example: Smoking</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html"><i class="fa fa-check"></i><b>21</b> Power analysis by simulation</a>
<ul>
<li class="chapter" data-level="21.1" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#type-i-and-ii-errors-and-statistical-power"><i class="fa fa-check"></i><b>21.1</b> Type I and II errors and statistical power</a></li>
<li class="chapter" data-level="21.2" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#what-determines-statistical-power"><i class="fa fa-check"></i><b>21.2</b> What determines statistical power?</a></li>
<li class="chapter" data-level="21.3" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#an-example-of-calculating-statistical-power."><i class="fa fa-check"></i><b>21.3</b> An example of calculating statistical power.</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#the-simulation"><i class="fa fa-check"></i><b>21.3.1</b> The simulation</a></li>
<li class="chapter" data-level="21.3.2" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#some-questions-for-you-to-address"><i class="fa fa-check"></i><b>21.3.2</b> Some questions for you to address:</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#summary"><i class="fa fa-check"></i><b>21.4</b> Summary</a></li>
<li class="chapter" data-level="21.5" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#extending-the-simulation-optional-advanced"><i class="fa fa-check"></i><b>21.5</b> Extending the simulation (optional, advanced)</a></li>
<li class="chapter" data-level="21.6" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#exercise-1-snails-on-the-move"><i class="fa fa-check"></i><b>21.6</b> Exercise 1: Snails on the move</a></li>
<li class="chapter" data-level="21.7" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#exercise-2-mouse-lemur-strength"><i class="fa fa-check"></i><b>21.7</b> Exercise 2: Mouse lemur strength</a></li>
</ul></li>
<li class="part"><span><b>IV Appendix</b></span></li>
<li class="chapter" data-level="22" data-path="examples-of-statistics-reporting.html"><a href="examples-of-statistics-reporting.html"><i class="fa fa-check"></i><b>22</b> Examples of statistics reporting</a>
<ul>
<li class="chapter" data-level="22.1" data-path="examples-of-statistics-reporting.html"><a href="examples-of-statistics-reporting.html#t-test"><i class="fa fa-check"></i><b>22.1</b> t-test</a></li>
<li class="chapter" data-level="22.2" data-path="examples-of-statistics-reporting.html"><a href="examples-of-statistics-reporting.html#simple-linear-regression-model"><i class="fa fa-check"></i><b>22.2</b> Simple linear regression model</a></li>
<li class="chapter" data-level="22.3" data-path="examples-of-statistics-reporting.html"><a href="examples-of-statistics-reporting.html#a-generalised-linear-model-glm"><i class="fa fa-check"></i><b>22.3</b> A Generalised linear model (GLM)</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="an-example-of-a-past-exam-2020.html"><a href="an-example-of-a-past-exam-2020.html"><i class="fa fa-check"></i><b>23</b> An example of a past Exam (2020)</a></li>
<li class="part"><span><b>V Exam</b></span></li>
<li class="chapter" data-level="24" data-path="exam-december-2023.html"><a href="exam-december-2023.html"><i class="fa fa-check"></i><b>24</b> Exam December 2023</a></li>
<li class="part"><span><b>VI Solutions</b></span></li>
<li class="chapter" data-level="25" data-path="exercise-solutions.html"><a href="exercise-solutions.html"><i class="fa fa-check"></i><b>25</b> Exercise Solutions</a>
<ul>
<li class="chapter" data-level="25.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#californian-bird-diversity"><i class="fa fa-check"></i><b>25.1</b> Californian bird diversity</a></li>
<li class="chapter" data-level="25.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#wrangling-the-amniote-life-history-database"><i class="fa fa-check"></i><b>25.2</b> Wrangling the Amniote Life History Database</a></li>
<li class="chapter" data-level="25.3" data-path="exercise-solutions.html"><a href="exercise-solutions.html#temperature-effects-on-egg-laying-dates"><i class="fa fa-check"></i><b>25.3</b> Temperature effects on egg laying dates</a></li>
<li class="chapter" data-level="25.4" data-path="exercise-solutions.html"><a href="exercise-solutions.html#virtual-dice"><i class="fa fa-check"></i><b>25.4</b> Virtual dice</a></li>
<li class="chapter" data-level="25.5" data-path="exercise-solutions.html"><a href="exercise-solutions.html#sexual-selection-in-hercules-beetles"><i class="fa fa-check"></i><b>25.5</b> Sexual selection in Hercules beetles</a></li>
<li class="chapter" data-level="25.6" data-path="exercise-solutions.html"><a href="exercise-solutions.html#sex-differences-in-fine-motor-skills"><i class="fa fa-check"></i><b>25.6</b> Sex differences in fine motor skills</a></li>
<li class="chapter" data-level="25.7" data-path="exercise-solutions.html"><a href="exercise-solutions.html#therapy-for-anorexia"><i class="fa fa-check"></i><b>25.7</b> Therapy for anorexia</a></li>
<li class="chapter" data-level="25.8" data-path="exercise-solutions.html"><a href="exercise-solutions.html#compare-t-tests-with-randomisation-tests"><i class="fa fa-check"></i><b>25.8</b> Compare t-tests with randomisation tests</a></li>
<li class="chapter" data-level="25.9" data-path="exercise-solutions.html"><a href="exercise-solutions.html#apple-tree-crop-yield"><i class="fa fa-check"></i><b>25.9</b> Apple tree crop yield</a></li>
<li class="chapter" data-level="25.10" data-path="exercise-solutions.html"><a href="exercise-solutions.html#chirping-crickets"><i class="fa fa-check"></i><b>25.10</b> Chirping crickets</a></li>
<li class="chapter" data-level="25.11" data-path="exercise-solutions.html"><a href="exercise-solutions.html#fish-behaviour"><i class="fa fa-check"></i><b>25.11</b> Fish behaviour</a></li>
<li class="chapter" data-level="25.12" data-path="exercise-solutions.html"><a href="exercise-solutions.html#maze-runner"><i class="fa fa-check"></i><b>25.12</b> Maze runner</a></li>
<li class="chapter" data-level="25.13" data-path="exercise-solutions.html"><a href="exercise-solutions.html#snails-on-the-move"><i class="fa fa-check"></i><b>25.13</b> Snails on the move</a></li>
<li class="chapter" data-level="25.14" data-path="exercise-solutions.html"><a href="exercise-solutions.html#mouse-lemur-strength"><i class="fa fa-check"></i><b>25.14</b> Mouse lemur strength</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BB852 - Data handling, visualisation and statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="extending-use-cases-of-glm" class="section level1 hasAnchor" number="20">
<h1><span class="header-section-number">Chapter 20</span> Extending use cases of GLM<a href="extending-use-cases-of-glm.html#extending-use-cases-of-glm" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In the previous chapter we used the case of modelling count data, which is bounded at 0 and takes integer values, to understand how Generalised Linear Models work. In this chapter we extend our understanding by looking at another type of data, namely <em>binomial</em> data.</p>
<div id="binomial-response-data" class="section level2 hasAnchor" number="20.1">
<h2><span class="header-section-number">20.1</span> Binomial response data<a href="extending-use-cases-of-glm.html#binomial-response-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are three types of Binomial data, but all three types have the idea of “success” and “failure” at their heart. It is up to you, the modeller, to decide what these successes and failures are, but they can be any kind of data that can be coerced into two discrete categories. Common examples include pass/fail, survived/died, presence/absence and yes/no.</p>
<p>The three data types are as follows:</p>
<ol style="list-style-type: decimal">
<li>The data can be in the form of a two-level factor - often coded as zeros and ones (0/1 data). For example, this could represent whether an died (0) or survived (1) in a study; or it could represent male (<code>M</code>) or female (<code>F</code>) in a study trying to predict sex from other variables (e.g. size or morphology).</li>
<li>The data could be expressed as a numeric vector of proportions, bounded between 0 and 1 (i.e. can take any value between 0 and 1). For example these data could be percentages expressed as proportion, such as proportion (or percent) of individuals in a group surviving. In this case, the total number of cases that contributed to the proportion can be optionally included as <code>weights</code> in the regression model <a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a>.</li>
<li>Finally, the data could be expressed as numbers in a two column matrix where the first column gives the number of “successes” and the second column gives the number of “failures”.</li>
</ol>
<p>The aim of the GLM is usually to estimate probability of “success” (e.g. survival, passing, scoring a goal…). Thus, the outcome (the predicted response, or fit, of the model) is a value between 0 and 1 on the natural scale, that can be interpreted as a probability (e.g. of survival, of success, of presence etc.)</p>
<p>The link function used for a binomial GLM is usually the <em>logit</em> transformation, and therefore another name for this type of regression is <strong>logistic regression</strong>. The logit transformation linearises an S-shaped curve and therefore allows a linear regression line to be fitted from data that follows this pattern. The function is <span class="math inline">\(y = log(\frac{p}{1-p})\)</span>, where <span class="math inline">\(p\)</span> is the probability or proportion. The inverse logit (the anti-logit) is <span class="math inline">\(p = \frac{exp(y)}{exp(y)+1}\)</span>.</p>
<p><img src="BB852_files/figure-html/unnamed-chunk-311-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We <strong>could</strong> linearise the data and then fit an ordinary linear model using <code>lm</code> but (like with the Poisson regression) the other assumption of the ordinary linear model, homoscedasticity, would cause problems. With S-shaped binomial relationships the expected variance is small at the two ends of the range and large in the middle of the range. This contrasts strongly with the constant variance assumption of ordinary linear models. Therefore it is wise to account for this using a Generalised Linear Model that explicitly accounts for this variance structure.</p>
<p>Let’s try a couple of examples.</p>
<div class="do-something">
<p>
Remember to load the <code>dplyr</code>, <code>magrittr</code> and
<code>ggplot</code> packages, and to set your working directory
correctly.
</p>
</div>
</div>
<div id="example-nfl-field-goals" class="section level2 hasAnchor" number="20.2">
<h2><span class="header-section-number">20.2</span> Example: NFL field goals<a href="extending-use-cases-of-glm.html#example-nfl-field-goals" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this example you will be dealing with binary data (0/1, failure/success) from the American National Football League (NFL). The data are a record of field goals, which are a relatively rare method of scoring where someone kicks the ball through over the crossbar and through the uprights of the goal during play.</p>
<p>Our aim is to estimate how the probability of success changes with distance from the goal. We already have a good idea that success probability will decline with increasing distance! But at what rate does the probability decline? And at what distance is there a probability of 0.5 (i.e. 50% chance of success)?</p>
<p>First, import the data and convert the distance from yards to meters.</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="extending-use-cases-of-glm.html#cb457-1" aria-hidden="true" tabindex="-1"></a>NFL <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;CourseData/NFLfieldgoal.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb457-2"><a href="extending-use-cases-of-glm.html#cb457-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Distance =</span> Distance <span class="sc">*</span> <span class="fl">0.9144</span>)</span></code></pre></div>
<p>Next, plot the data with <code>ggplot</code> (<code>geom_jitter</code> would be a good option, but you might like to adjust the <code>height</code> and <code>alpha</code> arguments. e.g. <code>geom_jitter(height = 0.05,alpha = 0.5)</code>). You can see that the data is distributed in two bands with 1 representing success and 0 representing failure.</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="extending-use-cases-of-glm.html#cb458-1" aria-hidden="true" tabindex="-1"></a>(A <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(NFL, <span class="fu">aes</span>(<span class="at">x =</span> Distance, <span class="at">y =</span> Success)) <span class="sc">+</span></span>
<span id="cb458-2"><a href="extending-use-cases-of-glm.html#cb458-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="fl">0.05</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-314-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Now we can fit a GLM using an appropriate binomial error structure.</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="extending-use-cases-of-glm.html#cb459-1" aria-hidden="true" tabindex="-1"></a>nflMod <span class="ot">&lt;-</span> <span class="fu">glm</span>(Success <span class="sc">~</span> Distance, <span class="at">data =</span> NFL, <span class="at">family =</span> binomial)</span></code></pre></div>
<p>As usual, we should look at the model diagnostics. These look pretty bad. One reason that these diagnostics (e.g. the QQ plot) can look bad is when we are missing important variables in the model. In this case, for example, the distribution could look “off” because we don’t include important information on other aspects of the game (e.g. was the team winning or losing at the time? how many minutes until the end of the game? how experienced is the player?). We can be fairly sure that <code>binomial</code> is the most appropriate variance structure because of the nature of the 0/1 data so let’s stick with it for now!</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="extending-use-cases-of-glm.html#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb460-2"><a href="extending-use-cases-of-glm.html#cb460-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(nflMod)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-316-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>We proceed in the normal way by obtaining the ANOVA table for the model. We need to specify that we want to calculated p-values using a “Chi” squared test. This shows us that indeed distance is an important variable in determining probability of success (not so surprising!)</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="extending-use-cases-of-glm.html#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(nflMod, <span class="at">test =</span> <span class="st">&quot;Chi&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model: binomial, link: logit
## 
## Response: Success
## 
## Terms added sequentially (first to last)
## 
## 
##          Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    
## NULL                       947     955.38              
## Distance  1    137.8       946     817.58 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>We get more useful information from the coefficient <code>summary</code> of the model. This gives the intercept and slope of the model <strong>on the scale of the linear predictor</strong> (see the figure above).</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="extending-use-cases-of-glm.html#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nflMod)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Success ~ Distance, family = binomial, data = NFL)
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  5.68958    0.45021   12.64   &lt;2e-16 ***
## Distance    -0.13118    0.01263  -10.38   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 955.38  on 947  degrees of freedom
## Residual deviance: 817.58  on 946  degrees of freedom
## AIC: 821.58
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>We could report this something like this:</p>
<p><em>The binomial GLM showed that distance was significantly associated with the probability of goal success (GLM: Null Deviance = 955.38, Residual Deviance = 817.58, d.f. = 1 and 946 p &lt;0.001). The slope and intercept of the relationship is -0.131 and 5.690 respectively on the logit scale. The equation of the best fit line was therefore logit(nOffspring) = 5.690 - 0.131<span class="math inline">\(\times\)</span>distance (see Figure XXX)</em></p>
<p>The equation of the model if you want to express it on the natural scale works out to be:</p>
<p><span class="math inline">\(y =\frac{1}{1+exp(-(\beta_0 + \beta_1 x))}\)</span>, or <span class="math inline">\(probability =\frac{1}{1+exp(-(5.690 - 0.131\times distance))}\)</span>.</p>
<p>Let’s make sure that works by creating a set of predicted data from this equation and plotting it onto the graph:</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="extending-use-cases-of-glm.html#cb465-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">50</span>) <span class="sc">%&gt;%</span></span>
<span id="cb465-2"><a href="extending-use-cases-of-glm.html#cb465-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>(<span class="fl">5.690</span> <span class="sc">-</span> <span class="fl">0.131</span> <span class="sc">*</span> x))))</span>
<span id="cb465-3"><a href="extending-use-cases-of-glm.html#cb465-3" aria-hidden="true" tabindex="-1"></a>A <span class="sc">+</span></span>
<span id="cb465-4"><a href="extending-use-cases-of-glm.html#cb465-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> d1, <span class="fu">aes</span>(x, y), <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-319-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Rather than using the equation, there is an easier way by using the <strong>R</strong>’s <code>predict</code> function. We will use <code>predict</code> to get the predicted probability of success across the range of distances that we provide as a new data frame that we are here calling <code>newDat</code>. We will also predict the 95% Confidence Interval (CI) for these estimates. We will use these data to add the CI ribbon and line to the plot.</p>
<p>The <code>predict</code> function returns an object that includes the <code>fit</code> and the <code>se.fit</code> which are the predicted value of the regression and the standard error of that predicted value respectively. Thus, if the output of the <code>predict</code> function is stored as <code>pv</code> we can address those parts as <code>pv$fit</code> and <code>pv$se.fit</code>, and we can save these values alongside the data in <code>newDat</code>.</p>
<div class="do-something">
<p>
Remember that the model, and the predicted values from it, are
expressed on the scale of the <em>linear predictor</em> (i.e. the
transformed data scale). It is usually desirable to “backtransform” to
the natural scale before plotting. See below.
</p>
</div>
<p>First we obtain the predictions and CI on the scale of the linear predictor (logit scale). We calculate 95% CI from the standard errors simply by multiplying by 1.96.</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="extending-use-cases-of-glm.html#cb466-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataset to predict FROM</span></span>
<span id="cb466-2"><a href="extending-use-cases-of-glm.html#cb466-2" aria-hidden="true" tabindex="-1"></a>newDat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Distance =</span> <span class="dv">14</span><span class="sc">:</span><span class="dv">52</span>)</span>
<span id="cb466-3"><a href="extending-use-cases-of-glm.html#cb466-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb466-4"><a href="extending-use-cases-of-glm.html#cb466-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get predictions from the model</span></span>
<span id="cb466-5"><a href="extending-use-cases-of-glm.html#cb466-5" aria-hidden="true" tabindex="-1"></a>pv <span class="ot">&lt;-</span> <span class="fu">predict</span>(nflMod, <span class="at">newdata =</span> newDat, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb466-6"><a href="extending-use-cases-of-glm.html#cb466-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb466-7"><a href="extending-use-cases-of-glm.html#cb466-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add those predictions to newDat</span></span>
<span id="cb466-8"><a href="extending-use-cases-of-glm.html#cb466-8" aria-hidden="true" tabindex="-1"></a>newDat <span class="ot">&lt;-</span> newDat <span class="sc">%&gt;%</span></span>
<span id="cb466-9"><a href="extending-use-cases-of-glm.html#cb466-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Success_LP =</span> pv<span class="sc">$</span>fit) <span class="sc">%&gt;%</span></span>
<span id="cb466-10"><a href="extending-use-cases-of-glm.html#cb466-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lowerCI_LP =</span> pv<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pv<span class="sc">$</span>se.fit) <span class="sc">%&gt;%</span></span>
<span id="cb466-11"><a href="extending-use-cases-of-glm.html#cb466-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">upperCI_LP =</span> pv<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pv<span class="sc">$</span>se.fit)</span></code></pre></div>
<p>Now we can first obtain the inverse link from the model object <code>family(nflMod)$linkinv</code>, and use that to backtransform the data onto the natural scale ready for plotting.</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="extending-use-cases-of-glm.html#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the inverse link function</span></span>
<span id="cb467-2"><a href="extending-use-cases-of-glm.html#cb467-2" aria-hidden="true" tabindex="-1"></a>inverseFunction <span class="ot">&lt;-</span> <span class="fu">family</span>(nflMod)<span class="sc">$</span>linkinv</span>
<span id="cb467-3"><a href="extending-use-cases-of-glm.html#cb467-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-4"><a href="extending-use-cases-of-glm.html#cb467-4" aria-hidden="true" tabindex="-1"></a><span class="co"># transform predicted data to the natural scale</span></span>
<span id="cb467-5"><a href="extending-use-cases-of-glm.html#cb467-5" aria-hidden="true" tabindex="-1"></a>newDat <span class="ot">&lt;-</span> newDat <span class="sc">%&gt;%</span></span>
<span id="cb467-6"><a href="extending-use-cases-of-glm.html#cb467-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb467-7"><a href="extending-use-cases-of-glm.html#cb467-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Success =</span> <span class="fu">inverseFunction</span>(Success_LP),</span>
<span id="cb467-8"><a href="extending-use-cases-of-glm.html#cb467-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="fu">inverseFunction</span>(lowerCI_LP),</span>
<span id="cb467-9"><a href="extending-use-cases-of-glm.html#cb467-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="fu">inverseFunction</span>(upperCI_LP)</span>
<span id="cb467-10"><a href="extending-use-cases-of-glm.html#cb467-10" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Now we can finally plot the model predictions and the 95% confidence intervals for them.</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="extending-use-cases-of-glm.html#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The plot and ribbon</span></span>
<span id="cb468-2"><a href="extending-use-cases-of-glm.html#cb468-2" aria-hidden="true" tabindex="-1"></a>(A <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(NFL, <span class="fu">aes</span>(<span class="at">x =</span> Distance, <span class="at">y =</span> Success)) <span class="sc">+</span></span>
<span id="cb468-3"><a href="extending-use-cases-of-glm.html#cb468-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb468-4"><a href="extending-use-cases-of-glm.html#cb468-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> newDat, <span class="fu">aes</span>(<span class="at">x =</span> Distance, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax),</span>
<span id="cb468-5"><a href="extending-use-cases-of-glm.html#cb468-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;grey75&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb468-6"><a href="extending-use-cases-of-glm.html#cb468-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb468-7"><a href="extending-use-cases-of-glm.html#cb468-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data =</span> newDat, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb468-8"><a href="extending-use-cases-of-glm.html#cb468-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="fl">0.05</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-323-1.png" width="480" style="display: block; margin: auto;" />
So, at what distance does the probability of success fall to just 50%? You could read this directly from the plot as “approximately 44m”. Alternatively, you could obtain the value from the <code>newDat</code> dataset you created above with predictions from the model, by filtering it. This confirms the probability of success reaches 0.5 somewhere between 43-44m.</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="extending-use-cases-of-glm.html#cb469-1" aria-hidden="true" tabindex="-1"></a>newDat <span class="sc">%&gt;%</span></span>
<span id="cb469-2"><a href="extending-use-cases-of-glm.html#cb469-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Success <span class="sc">&lt;</span> <span class="fl">0.55</span>) <span class="sc">%&gt;%</span></span>
<span id="cb469-3"><a href="extending-use-cases-of-glm.html#cb469-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Success <span class="sc">&gt;</span> <span class="fl">0.45</span>) <span class="sc">%&gt;%</span></span>
<span id="cb469-4"><a href="extending-use-cases-of-glm.html#cb469-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Distance, Success)</span></code></pre></div>
<pre><code>##   Distance   Success
## 1       42 0.5449184
## 2       43 0.5122432
## 3       44 0.4794630</code></pre>
</div>
<div id="example-sex-ratio-in-turtles" class="section level2 hasAnchor" number="20.3">
<h2><span class="header-section-number">20.3</span> Example: Sex ratio in turtles<a href="extending-use-cases-of-glm.html#example-sex-ratio-in-turtles" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this example we will look at sex ratio of hawksbill turtles (<em>Eretmochelys imbricata</em>)<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a>. The data are counts of males and females in clutches of eggs incubated at different temperatures.</p>
<p>The sex ratio in the species varies with temperature during incubation. We are interested in what the “tipping point” temperature is between male-female biased ratios.</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="extending-use-cases-of-glm.html#cb471-1" aria-hidden="true" tabindex="-1"></a>hawksbill <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;CourseData/hawksbill.csv&quot;</span>)</span></code></pre></div>
<p>This is a small dataset, you can look at the whole thing:</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="extending-use-cases-of-glm.html#cb472-1" aria-hidden="true" tabindex="-1"></a>hawksbill</span></code></pre></div>
<pre><code>##   Temperature Total Nmale Nfemale
## 1        27.9    12    12       0
## 2        28.4    29    29       0
## 3        28.9    31    26       5
## 4        29.3    20    18       2
## 5        29.5    22    14       8
## 6        29.8    10     2       8
## 7        30.4    10     0      10</code></pre>
<p>We are interested in sex ratio which we can calculate as the proportion of the population that is female (i.e. number of females divided by total number).</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="extending-use-cases-of-glm.html#cb474-1" aria-hidden="true" tabindex="-1"></a>hawksbill <span class="ot">&lt;-</span> hawksbill <span class="sc">%&gt;%</span></span>
<span id="cb474-2"><a href="extending-use-cases-of-glm.html#cb474-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">propFemale =</span> Nfemale <span class="sc">/</span> (Nmale <span class="sc">+</span> Nfemale))</span></code></pre></div>
<p>Let’s plot that data. We can use the trick of telling R to plot the points different sizes depending on the sample size (using the <code>size =</code> argument):</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="extending-use-cases-of-glm.html#cb475-1" aria-hidden="true" tabindex="-1"></a>(A <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(hawksbill, <span class="fu">aes</span>(</span>
<span id="cb475-2"><a href="extending-use-cases-of-glm.html#cb475-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> Temperature, <span class="at">y =</span> propFemale,</span>
<span id="cb475-3"><a href="extending-use-cases-of-glm.html#cb475-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> Total</span>
<span id="cb475-4"><a href="extending-use-cases-of-glm.html#cb475-4" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb475-5"><a href="extending-use-cases-of-glm.html#cb475-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>())</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-328-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>You can see that the proportion of females increases with temperature. Let’s fit a model to these data to better understand them. We could use the <code>propFemale</code> data as the response variable, but there is a big problem with that: we would be giving equal weight to each of the data points, even though the sample size for each one ranges from 10 to 31 This is not good because we would have much more faith in the very large sample sizes than the small ones.</p>
<p>Instead we can bind the data into a two column matrix using <code>cbind</code>. The first column is our “success” and the second column is our “failure”. If we put <code>females</code> in the first column the model will predict “probability of being female”, which is what we want. This two-column approach provides the model with the sample size which it can use to weight the regression appropriately.</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="extending-use-cases-of-glm.html#cb476-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">cbind</span>(hawksbill<span class="sc">$</span>Nfemale, hawksbill<span class="sc">$</span>Nmale)</span></code></pre></div>
<p>Now lets fit the model.</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="extending-use-cases-of-glm.html#cb477-1" aria-hidden="true" tabindex="-1"></a>modA <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> Temperature, <span class="at">data =</span> hawksbill, <span class="at">family =</span> binomial)</span></code></pre></div>
<p>As ever, we should take a quick look at the model diagnostic plots - these look OK.</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="extending-use-cases-of-glm.html#cb478-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb478-2"><a href="extending-use-cases-of-glm.html#cb478-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(modA)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-331-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Now we can look at the anova table. This will tell us what we already know - there is a strong effect of temperature on sex ratio.</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="extending-use-cases-of-glm.html#cb479-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modA, <span class="at">test =</span> <span class="st">&quot;Chi&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model: binomial, link: logit
## 
## Response: y
## 
## Terms added sequentially (first to last)
## 
## 
##             Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    
## NULL                            6     70.353              
## Temperature  1   61.869         5      8.484 3.671e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Now for the coefficients:</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="extending-use-cases-of-glm.html#cb481-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modA)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = y ~ Temperature, family = binomial, data = hawksbill)
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -111.7200    22.4260  -4.982 6.30e-07 ***
## Temperature    3.7754     0.7625   4.951 7.37e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 70.3528  on 6  degrees of freedom
## Residual deviance:  8.4841  on 5  degrees of freedom
## AIC: 24.184
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>This table gives us the coefficients for the formula of our relationship. We could use these to produce a formula of the form <span class="math inline">\(y =\frac{1}{1+exp(-(\beta_0 + \beta_1 x))}\)</span>.</p>
<p>It is perhaps more useful to plot the model fit onto the plot. First we need to create a data frame to predict from:</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="extending-use-cases-of-glm.html#cb483-1" aria-hidden="true" tabindex="-1"></a>newDat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Temperature =</span> <span class="fu">seq</span>(<span class="fl">27.9</span>, <span class="fl">30.4</span>, <span class="fl">0.1</span>))</span></code></pre></div>
<p>Now we can predict the values (and 95% CI) on the scale of the linear predictor (logit).</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="extending-use-cases-of-glm.html#cb484-1" aria-hidden="true" tabindex="-1"></a>pv <span class="ot">&lt;-</span> <span class="fu">predict</span>(modA, newDat, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb484-2"><a href="extending-use-cases-of-glm.html#cb484-2" aria-hidden="true" tabindex="-1"></a>newDat <span class="ot">&lt;-</span> newDat <span class="sc">%&gt;%</span></span>
<span id="cb484-3"><a href="extending-use-cases-of-glm.html#cb484-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb484-4"><a href="extending-use-cases-of-glm.html#cb484-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">propFemale_LP =</span> pv<span class="sc">$</span>fit,</span>
<span id="cb484-5"><a href="extending-use-cases-of-glm.html#cb484-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">lowerCI_LP =</span> pv<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pv<span class="sc">$</span>se.fit,</span>
<span id="cb484-6"><a href="extending-use-cases-of-glm.html#cb484-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">upperCI_LP =</span> pv<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pv<span class="sc">$</span>se.fit</span>
<span id="cb484-7"><a href="extending-use-cases-of-glm.html#cb484-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Now we can use the inverse link function to backtransform to the natural probability scale.</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="extending-use-cases-of-glm.html#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the inverse link function</span></span>
<span id="cb485-2"><a href="extending-use-cases-of-glm.html#cb485-2" aria-hidden="true" tabindex="-1"></a>inverseFunction <span class="ot">&lt;-</span> <span class="fu">family</span>(modA)<span class="sc">$</span>linkinv</span>
<span id="cb485-3"><a href="extending-use-cases-of-glm.html#cb485-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb485-4"><a href="extending-use-cases-of-glm.html#cb485-4" aria-hidden="true" tabindex="-1"></a><span class="co"># transform predicted data to the natural scale</span></span>
<span id="cb485-5"><a href="extending-use-cases-of-glm.html#cb485-5" aria-hidden="true" tabindex="-1"></a>newDat <span class="ot">&lt;-</span> newDat <span class="sc">%&gt;%</span></span>
<span id="cb485-6"><a href="extending-use-cases-of-glm.html#cb485-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb485-7"><a href="extending-use-cases-of-glm.html#cb485-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">propFemale =</span> <span class="fu">inverseFunction</span>(propFemale_LP),</span>
<span id="cb485-8"><a href="extending-use-cases-of-glm.html#cb485-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="fu">inverseFunction</span>(lowerCI_LP),</span>
<span id="cb485-9"><a href="extending-use-cases-of-glm.html#cb485-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="fu">inverseFunction</span>(upperCI_LP)</span>
<span id="cb485-10"><a href="extending-use-cases-of-glm.html#cb485-10" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>We can add these values to the plot like this:</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="extending-use-cases-of-glm.html#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The plot and ribbon</span></span>
<span id="cb486-2"><a href="extending-use-cases-of-glm.html#cb486-2" aria-hidden="true" tabindex="-1"></a>(A <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(hawksbill, <span class="fu">aes</span>(</span>
<span id="cb486-3"><a href="extending-use-cases-of-glm.html#cb486-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> Temperature, <span class="at">y =</span> propFemale,</span>
<span id="cb486-4"><a href="extending-use-cases-of-glm.html#cb486-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> Total</span>
<span id="cb486-5"><a href="extending-use-cases-of-glm.html#cb486-5" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb486-6"><a href="extending-use-cases-of-glm.html#cb486-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb486-7"><a href="extending-use-cases-of-glm.html#cb486-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> newDat, <span class="fu">aes</span>(<span class="at">x =</span> Temperature, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax),</span>
<span id="cb486-8"><a href="extending-use-cases-of-glm.html#cb486-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;grey75&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span></span>
<span id="cb486-9"><a href="extending-use-cases-of-glm.html#cb486-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb486-10"><a href="extending-use-cases-of-glm.html#cb486-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb486-11"><a href="extending-use-cases-of-glm.html#cb486-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> newDat, <span class="fu">aes</span>(<span class="at">x =</span> Temperature, <span class="at">y =</span> propFemale),</span>
<span id="cb486-12"><a href="extending-use-cases-of-glm.html#cb486-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span></span>
<span id="cb486-13"><a href="extending-use-cases-of-glm.html#cb486-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb486-14"><a href="extending-use-cases-of-glm.html#cb486-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>())</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-337-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Can you give read off the graph the approximate estimated temperature at which sex ratio is 50:50?</p>
<div class="do-something">
<p>
Try refitting the model using simply the proportion female
(<code>propFemale</code>) data rather than the two-column
(<code>cbind</code>) approach. Then try writing up the result in the
same way as shown for the NFL field goals example.
</p>
</div>
</div>
<div id="example-smoking" class="section level2 hasAnchor" number="20.4">
<h2><span class="header-section-number">20.4</span> Example: Smoking<a href="extending-use-cases-of-glm.html#example-smoking" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As I mentioned above binomial regression can be applied to anything where there data can be classified into two groups. I’ll illustrate that now with an example about smoking.</p>
<p>The data set is very small and looks like this:</p>
<table>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">Student smokes</th>
<th align="center">Student does not smoke</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Parent(s) smoke</td>
<td align="center">816</td>
<td align="center">3203</td>
</tr>
<tr class="even">
<td align="center">No parents smoke</td>
<td align="center">188</td>
<td align="center">1168</td>
</tr>
</tbody>
</table>
<p>The dataset is the number of students smoking and not smoking grouped according to whether their parents smoke.
These data are binomial/proportion data because the values in the cells of the table are constrained by the overall total and students must fall into one of the categories. We can use these data to calculate the probability of the student being a smoker.</p>
<p>Before fitting a GLM lets just work out these probabilities by hand. What is the probability that a child of smoking parents is a smoker themselves? This is simply 816/(816+3203) = 0.2030. (i.e. it is the number of smokers divided by the total number). Similarly, the probability that the child of non-smokers smokes is 188/(188+1168) = 0.1386.</p>
<p>But is this a significant difference? That is what we are trying to find out using a GLM.</p>
<p>To do this, we can turn these data into a two column matrix of success (yes - smoker) and failure (no - non-smoker).</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="extending-use-cases-of-glm.html#cb487-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">&quot;1_yes&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">816</span>, <span class="dv">188</span>), <span class="st">&quot;0_no&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3203</span>, <span class="dv">1168</span>))</span>
<span id="cb487-2"><a href="extending-use-cases-of-glm.html#cb487-2" aria-hidden="true" tabindex="-1"></a>y</span></code></pre></div>
<pre><code>##      1_yes 0_no
## [1,]   816 3203
## [2,]   188 1168</code></pre>
<p>So we can see “success” on the left and “failure” on the right”.
We now create a (tiny) <code>data.frame</code> for the parental status (smoker = “1_yes”, non-smoker = “0_no”).</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="extending-use-cases-of-glm.html#cb489-1" aria-hidden="true" tabindex="-1"></a>smoke <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">parentSmoke =</span> <span class="fu">c</span>(<span class="st">&quot;1_yes&quot;</span>, <span class="st">&quot;0_no&quot;</span>))</span></code></pre></div>
<p>Now we can fit the model. Pause now and think about what the NULL hypothesis is here. It is that parental smoking does not have any influence on whether the child smokes, and that the probability that the student smokes is unrelated to parental smoking.</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="extending-use-cases-of-glm.html#cb490-1" aria-hidden="true" tabindex="-1"></a>smokeMod <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> parentSmoke, <span class="at">data =</span> smoke, <span class="at">family =</span> binomial)</span></code></pre></div>
<p>With such a small dataset, diagnostic plots will not tell us anything useful so there’s no point in doing them for this case.</p>
<p>As usual, we first ask for the (Analysis of Deviance table using <code>anova</code>.</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="extending-use-cases-of-glm.html#cb491-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(smokeMod, <span class="at">test =</span> <span class="st">&quot;Chi&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model: binomial, link: logit
## 
## Response: y
## 
## Terms added sequentially (first to last)
## 
## 
##             Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    
## NULL                            1     29.121              
## parentSmoke  1   29.121         0      0.000 6.801e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>This tells us that the status of the parents (whether they smoke or not) is highly significant: it explains a lot of the pattern that we see in the data.</p>
<p>We can find out what this pattern is by examining the <code>summary</code> table.</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="extending-use-cases-of-glm.html#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(smokeMod)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = y ~ parentSmoke, family = binomial, data = smoke)
## 
## Coefficients:
##                  Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)      -1.82661    0.07858 -23.244  &lt; 2e-16 ***
## parentSmoke1_yes  0.45918    0.08782   5.228 1.71e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2.9121e+01  on 1  degrees of freedom
## Residual deviance: 3.5305e-13  on 0  degrees of freedom
## AIC: 19.242
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<p>This shows us the estimates on the logit scale. We can use <code>predict</code> to get a sense for these predictions on the more intuitive probability scale.
First we calculate the fitted values and 95% confidence intervals on the scale of the linear predictor (logit):</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="extending-use-cases-of-glm.html#cb495-1" aria-hidden="true" tabindex="-1"></a>pv <span class="ot">&lt;-</span> <span class="fu">predict</span>(smokeMod, smoke, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb495-2"><a href="extending-use-cases-of-glm.html#cb495-2" aria-hidden="true" tabindex="-1"></a>smoke <span class="ot">&lt;-</span> smoke <span class="sc">%&gt;%</span></span>
<span id="cb495-3"><a href="extending-use-cases-of-glm.html#cb495-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb495-4"><a href="extending-use-cases-of-glm.html#cb495-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">prob_LP =</span> pv<span class="sc">$</span>fit,</span>
<span id="cb495-5"><a href="extending-use-cases-of-glm.html#cb495-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">lowerCI_LP =</span> pv<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pv<span class="sc">$</span>se.fit,</span>
<span id="cb495-6"><a href="extending-use-cases-of-glm.html#cb495-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">upperCI_LP =</span> pv<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pv<span class="sc">$</span>se.fit</span>
<span id="cb495-7"><a href="extending-use-cases-of-glm.html#cb495-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Then we can backtransform these values to the probability scale using the inverse link function:</p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="extending-use-cases-of-glm.html#cb496-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the inverse link function</span></span>
<span id="cb496-2"><a href="extending-use-cases-of-glm.html#cb496-2" aria-hidden="true" tabindex="-1"></a>inverseFunction <span class="ot">&lt;-</span> <span class="fu">family</span>(smokeMod)<span class="sc">$</span>linkinv</span>
<span id="cb496-3"><a href="extending-use-cases-of-glm.html#cb496-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb496-4"><a href="extending-use-cases-of-glm.html#cb496-4" aria-hidden="true" tabindex="-1"></a><span class="co"># transform predicted data to the natural scale</span></span>
<span id="cb496-5"><a href="extending-use-cases-of-glm.html#cb496-5" aria-hidden="true" tabindex="-1"></a>smoke <span class="ot">&lt;-</span> smoke <span class="sc">%&gt;%</span></span>
<span id="cb496-6"><a href="extending-use-cases-of-glm.html#cb496-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb496-7"><a href="extending-use-cases-of-glm.html#cb496-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">prob =</span> <span class="fu">inverseFunction</span>(prob_LP),</span>
<span id="cb496-8"><a href="extending-use-cases-of-glm.html#cb496-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="fu">inverseFunction</span>(lowerCI_LP),</span>
<span id="cb496-9"><a href="extending-use-cases-of-glm.html#cb496-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="fu">inverseFunction</span>(upperCI_LP)</span>
<span id="cb496-10"><a href="extending-use-cases-of-glm.html#cb496-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb496-11"><a href="extending-use-cases-of-glm.html#cb496-11" aria-hidden="true" tabindex="-1"></a>smoke</span></code></pre></div>
<pre><code>##   parentSmoke   prob_LP lowerCI_LP upperCI_LP      prob      ymin      ymax
## 1       1_yes -1.367429  -1.444287  -1.290570 0.2030356 0.1908823 0.2157563
## 2        0_no -1.826606  -1.980629  -1.672583 0.1386431 0.1212518 0.1580801</code></pre>
<p>This table shows us that the probability of the students smoking is 0.2030 (95% CI = 0.191-0.216) for children of smokers, and 0.139 (95% CI = 0.121-0.158) for children of non-smokers. We can plot this using <code>ggplot</code> like this.</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="extending-use-cases-of-glm.html#cb498-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(smoke, <span class="fu">aes</span>(</span>
<span id="cb498-2"><a href="extending-use-cases-of-glm.html#cb498-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> parentSmoke, <span class="at">y =</span> prob, <span class="at">ymin =</span> ymin,</span>
<span id="cb498-3"><a href="extending-use-cases-of-glm.html#cb498-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ymax =</span> ymax</span>
<span id="cb498-4"><a href="extending-use-cases-of-glm.html#cb498-4" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb498-5"><a href="extending-use-cases-of-glm.html#cb498-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb498-6"><a href="extending-use-cases-of-glm.html#cb498-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> parentSmoke, <span class="at">y =</span> ymin, <span class="at">yend =</span> ymax))</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-346-1.png" width="672" /></p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="14">
<li id="fn14"><p>weights allow some data points to be more influential than others - for example you would want to give more importance to points that represent large sample sizes<a href="extending-use-cases-of-glm.html#fnref14" class="footnote-back">↩︎</a></p></li>
<li id="fn15"><p>data from: Godfrey et al. (1999) Can. J. Zool. 77: 1465–1473<a href="extending-use-cases-of-glm.html#fnref15" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="generalised-linear-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="power-analysis-by-simulation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jonesor/BB852_Book/edit/master/3_09-GLM-2_otherFamilies.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["BB852.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"split_by": "section"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
