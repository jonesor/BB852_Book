<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 Linear models with &gt;1 categorical explanatory variables | BB852 - Data handling, visualisation and statistics</title>
  <meta name="description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 Linear models with &gt;1 categorical explanatory variables | BB852 - Data handling, visualisation and statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 Linear models with &gt;1 categorical explanatory variables | BB852 - Data handling, visualisation and statistics" />
  
  <meta name="twitter:description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  

<meta name="author" content="Owen R. Jones" />


<meta name="date" content="2020-10-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-models-with-categorical-and-continuous-explanatory-variables.html"/>
<link rel="next" href="generalised-linear-models.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.0.0/tabwid.js"></script>
<style type="text/css">

.warning-box {
  border: 3px solid #e60000;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

.advanced-box {
  border: 3px solid #268bd2;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

.do-something {
  border: 3px solid #803e00;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

</style>





<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BB852</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data-wrangling"><i class="fa fa-check"></i><b>1.1</b> Data wrangling</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-visualisation"><i class="fa fa-check"></i><b>1.2</b> Data visualisation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#statistics"><i class="fa fa-check"></i><b>1.3</b> Statistics</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#data-sources"><i class="fa fa-check"></i><b>1.4</b> Data sources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#your-instructors"><i class="fa fa-check"></i><b>1.5</b> Your instructors</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.6</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i><b>2</b> Schedule</a>
<ul>
<li class="chapter" data-level="2.1" data-path="schedule.html"><a href="schedule.html#additional-recommended-reading"><i class="fa fa-check"></i><b>2.1</b> Additional recommended reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="an-r-refresher.html"><a href="an-r-refresher.html"><i class="fa fa-check"></i><b>3</b> An R refresher</a>
<ul>
<li class="chapter" data-level="3.1" data-path="an-r-refresher.html"><a href="an-r-refresher.html#getting-started-with-r"><i class="fa fa-check"></i><b>3.1</b> Getting started with R</a></li>
<li class="chapter" data-level="3.2" data-path="an-r-refresher.html"><a href="an-r-refresher.html#getting-help"><i class="fa fa-check"></i><b>3.2</b> Getting help</a></li>
<li class="chapter" data-level="3.3" data-path="an-r-refresher.html"><a href="an-r-refresher.html#r-as-a-fancy-calculator"><i class="fa fa-check"></i><b>3.3</b> R as a fancy calculator</a></li>
<li class="chapter" data-level="3.4" data-path="an-r-refresher.html"><a href="an-r-refresher.html#objects-in-r"><i class="fa fa-check"></i><b>3.4</b> Objects in R</a></li>
<li class="chapter" data-level="3.5" data-path="an-r-refresher.html"><a href="an-r-refresher.html#missing-values-infinity-and-non-numbers"><i class="fa fa-check"></i><b>3.5</b> Missing values, infinity and “non-numbers”</a></li>
<li class="chapter" data-level="3.6" data-path="an-r-refresher.html"><a href="an-r-refresher.html#basic-information-about-objects"><i class="fa fa-check"></i><b>3.6</b> Basic information about objects</a></li>
<li class="chapter" data-level="3.7" data-path="an-r-refresher.html"><a href="an-r-refresher.html#data-frames"><i class="fa fa-check"></i><b>3.7</b> Data frames</a></li>
<li class="chapter" data-level="3.8" data-path="an-r-refresher.html"><a href="an-r-refresher.html#organising-your-work"><i class="fa fa-check"></i><b>3.8</b> Organising your work</a></li>
<li class="chapter" data-level="3.9" data-path="an-r-refresher.html"><a href="an-r-refresher.html#inspecting-the-data"><i class="fa fa-check"></i><b>3.9</b> Inspecting the data</a></li>
<li class="chapter" data-level="3.10" data-path="an-r-refresher.html"><a href="an-r-refresher.html#classes-in-r"><i class="fa fa-check"></i><b>3.10</b> “Classes” in R</a></li>
<li class="chapter" data-level="3.11" data-path="an-r-refresher.html"><a href="an-r-refresher.html#tables-and-summary-statistics"><i class="fa fa-check"></i><b>3.11</b> Tables and summary statistics</a></li>
<li class="chapter" data-level="3.12" data-path="an-r-refresher.html"><a href="an-r-refresher.html#plotting-data"><i class="fa fa-check"></i><b>3.12</b> Plotting data</a></li>
<li class="chapter" data-level="3.13" data-path="an-r-refresher.html"><a href="an-r-refresher.html#r-packages"><i class="fa fa-check"></i><b>3.13</b> R Packages</a></li>
<li class="chapter" data-level="3.14" data-path="an-r-refresher.html"><a href="an-r-refresher.html#exercise-californian-bird-diversity"><i class="fa fa-check"></i><b>3.14</b> Exercise: Californian bird diversity</a>
<ul>
<li class="chapter" data-level="3.14.1" data-path="an-r-refresher.html"><a href="an-r-refresher.html#the-data"><i class="fa fa-check"></i><b>3.14.1</b> The data</a></li>
<li class="chapter" data-level="3.14.2" data-path="an-r-refresher.html"><a href="an-r-refresher.html#try-the-following"><i class="fa fa-check"></i><b>3.14.2</b> Try the following</a></li>
</ul></li>
<li class="chapter" data-level="3.15" data-path="an-r-refresher.html"><a href="an-r-refresher.html#exercise-solutions-californian-bird-diversity"><i class="fa fa-check"></i><b>3.15</b> Exercise Solutions: Californian bird diversity</a></li>
</ul></li>
<li class="part"><span><b>I Data Wrangling</b></span></li>
<li class="chapter" data-level="4" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html"><i class="fa fa-check"></i><b>4</b> Data wrangling with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#select"><i class="fa fa-check"></i><b>4.1</b> <code>select</code></a></li>
<li class="chapter" data-level="4.2" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#filter"><i class="fa fa-check"></i><b>4.2</b> <code>filter</code></a></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#arrange"><i class="fa fa-check"></i><b>4.3</b> <code>arrange</code></a></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#summarise-and-group_by"><i class="fa fa-check"></i><b>4.4</b> <code>summarise</code> and <code>group_by</code></a></li>
<li class="chapter" data-level="4.5" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#using-pipes-saving-data."><i class="fa fa-check"></i><b>4.5</b> Using pipes, saving data.</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="exercise-wrangling-the-amniote-life-history-database.html"><a href="exercise-wrangling-the-amniote-life-history-database.html"><i class="fa fa-check"></i><b>5</b> Exercise: Wrangling the Amniote Life History Database</a>
<ul>
<li class="chapter" data-level="5.1" data-path="exercise-wrangling-the-amniote-life-history-database.html"><a href="exercise-wrangling-the-amniote-life-history-database.html#exercise-solutions-wrangling-the-amniote-life-history-database"><i class="fa fa-check"></i><b>5.1</b> Exercise Solutions: Wrangling the Amniote Life History Database</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="combining-data-sets.html"><a href="combining-data-sets.html"><i class="fa fa-check"></i><b>6</b> Combining data sets</a>
<ul>
<li class="chapter" data-level="6.1" data-path="combining-data-sets.html"><a href="combining-data-sets.html#using-join"><i class="fa fa-check"></i><b>6.1</b> Using <code>join</code></a></li>
<li class="chapter" data-level="6.2" data-path="combining-data-sets.html"><a href="combining-data-sets.html#using-pivot_longer"><i class="fa fa-check"></i><b>6.2</b> Using <code>pivot_longer</code></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exercise-temperature-effects-on-egg-laying-dates.html"><a href="exercise-temperature-effects-on-egg-laying-dates.html"><i class="fa fa-check"></i><b>7</b> Exercise: Temperature effects on egg laying dates</a>
<ul>
<li class="chapter" data-level="7.1" data-path="exercise-temperature-effects-on-egg-laying-dates.html"><a href="exercise-temperature-effects-on-egg-laying-dates.html#exercise-solutions-temperature-effects-on-egg-laying-dates"><i class="fa fa-check"></i><b>7.1</b> Exercise Solutions: Temperature effects on egg laying dates</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="exercise-temperature-effects-on-egg-laying-dates.html"><a href="exercise-temperature-effects-on-egg-laying-dates.html#preparing-the-bird-data"><i class="fa fa-check"></i><b>7.1.1</b> Preparing the bird data</a></li>
<li class="chapter" data-level="7.1.2" data-path="exercise-temperature-effects-on-egg-laying-dates.html"><a href="exercise-temperature-effects-on-egg-laying-dates.html#preparing-the-weather-data"><i class="fa fa-check"></i><b>7.1.2</b> Preparing the weather data</a></li>
<li class="chapter" data-level="7.1.3" data-path="exercise-temperature-effects-on-egg-laying-dates.html"><a href="exercise-temperature-effects-on-egg-laying-dates.html#joining-the-two-datasets"><i class="fa fa-check"></i><b>7.1.3</b> Joining the two datasets</a></li>
<li class="chapter" data-level="7.1.4" data-path="exercise-temperature-effects-on-egg-laying-dates.html"><a href="exercise-temperature-effects-on-egg-laying-dates.html#plot-the-data"><i class="fa fa-check"></i><b>7.1.4</b> Plot the data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Data visualisation</b></span></li>
<li class="chapter" data-level="8" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html"><i class="fa fa-check"></i><b>8</b> Visualising data with <code>ggplot</code></a>
<ul>
<li class="chapter" data-level="8.1" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#histograms"><i class="fa fa-check"></i><b>8.1</b> Histograms</a></li>
<li class="chapter" data-level="8.2" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#facets---splitting-data-across-panels"><i class="fa fa-check"></i><b>8.2</b> “Facets” - splitting data across panels</a></li>
<li class="chapter" data-level="8.3" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#box-plots"><i class="fa fa-check"></i><b>8.3</b> Box plots</a></li>
<li class="chapter" data-level="8.4" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#lines-and-points"><i class="fa fa-check"></i><b>8.4</b> Lines and points</a></li>
<li class="chapter" data-level="8.5" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#scatter-plots"><i class="fa fa-check"></i><b>8.5</b> Scatter plots</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html"><i class="fa fa-check"></i><b>9</b> Distributions and summarising data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#distributions"><i class="fa fa-check"></i><b>9.1</b> Distributions</a></li>
<li class="chapter" data-level="9.2" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#normal-distribution"><i class="fa fa-check"></i><b>9.2</b> Normal distribution</a></li>
<li class="chapter" data-level="9.3" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#comparing-normal-distributions"><i class="fa fa-check"></i><b>9.3</b> Comparing normal distributions</a></li>
<li class="chapter" data-level="9.4" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#poisson-distribution"><i class="fa fa-check"></i><b>9.4</b> Poisson distribution</a></li>
<li class="chapter" data-level="9.5" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#comparing-normal-and-poisson-distributions"><i class="fa fa-check"></i><b>9.5</b> Comparing normal and Poisson distributions</a></li>
<li class="chapter" data-level="9.6" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#the-law-of-large-numbers"><i class="fa fa-check"></i><b>9.6</b> The law of large numbers</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#coin-flipping"><i class="fa fa-check"></i><b>9.6.1</b> Coin flipping</a></li>
<li class="chapter" data-level="9.6.2" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#virtual-dice"><i class="fa fa-check"></i><b>9.6.2</b> Virtual dice</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html"><i class="fa fa-check"></i><b>10</b> Pimping your plots</a>
<ul>
<li class="chapter" data-level="10.1" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#a-basic-plot"><i class="fa fa-check"></i><b>10.1</b> A basic plot</a></li>
<li class="chapter" data-level="10.2" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#axis-limits"><i class="fa fa-check"></i><b>10.2</b> Axis limits</a></li>
<li class="chapter" data-level="10.3" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#transforming-the-axis-log-scale"><i class="fa fa-check"></i><b>10.3</b> Transforming the axis (log scale)</a></li>
<li class="chapter" data-level="10.4" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#changing-the-axis-tick-marks"><i class="fa fa-check"></i><b>10.4</b> Changing the axis tick marks</a></li>
<li class="chapter" data-level="10.5" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#axis-labels"><i class="fa fa-check"></i><b>10.5</b> Axis labels</a></li>
<li class="chapter" data-level="10.6" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#colours"><i class="fa fa-check"></i><b>10.6</b> Colours</a></li>
<li class="chapter" data-level="10.7" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#themes"><i class="fa fa-check"></i><b>10.7</b> Themes</a></li>
<li class="chapter" data-level="10.8" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#moving-the-legend"><i class="fa fa-check"></i><b>10.8</b> Moving the legend</a></li>
<li class="chapter" data-level="10.9" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#combining-multiple-plots"><i class="fa fa-check"></i><b>10.9</b> Combining multiple plots</a></li>
<li class="chapter" data-level="10.10" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#saving-your-plot"><i class="fa fa-check"></i><b>10.10</b> Saving your plot</a></li>
<li class="chapter" data-level="10.11" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#final-word-on-plots"><i class="fa fa-check"></i><b>10.11</b> Final word on plots</a></li>
</ul></li>
<li class="part"><span><b>III Statistics</b></span></li>
<li class="chapter" data-level="11" data-path="randomisation-tests.html"><a href="randomisation-tests.html"><i class="fa fa-check"></i><b>11</b> Randomisation Tests</a>
<ul>
<li class="chapter" data-level="11.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#randomisation-test-in-r"><i class="fa fa-check"></i><b>11.1</b> Randomisation test in R</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#calculate-the-observed-difference"><i class="fa fa-check"></i><b>11.1.1</b> Calculate the observed difference</a></li>
<li class="chapter" data-level="11.1.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#null-distribution"><i class="fa fa-check"></i><b>11.1.2</b> Null distribution</a></li>
<li class="chapter" data-level="11.1.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-significance"><i class="fa fa-check"></i><b>11.1.3</b> Testing significance</a></li>
<li class="chapter" data-level="11.1.4" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-the-hypothesis"><i class="fa fa-check"></i><b>11.1.4</b> Testing the hypothesis</a></li>
<li class="chapter" data-level="11.1.5" data-path="randomisation-tests.html"><a href="randomisation-tests.html#writing-it-up"><i class="fa fa-check"></i><b>11.1.5</b> Writing it up</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#paired-randomisation-tests"><i class="fa fa-check"></i><b>11.2</b> Paired Randomisation Tests</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-randomisation-test"><i class="fa fa-check"></i><b>11.2.1</b> The randomisation test</a></li>
<li class="chapter" data-level="11.2.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#null-distribution-1"><i class="fa fa-check"></i><b>11.2.2</b> Null distribution</a></li>
<li class="chapter" data-level="11.2.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-formal-hypothesis-test"><i class="fa fa-check"></i><b>11.2.3</b> The formal hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#exercise-sexual-selection-in-hercules-beetles"><i class="fa fa-check"></i><b>11.3</b> Exercise: Sexual selection in Hercules beetles</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html"><i class="fa fa-check"></i><b>12</b> Comparing two means with a t-test</a>
<ul>
<li class="chapter" data-level="12.1" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#some-theory"><i class="fa fa-check"></i><b>12.1</b> Some theory</a></li>
<li class="chapter" data-level="12.2" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#one-sample-t-test"><i class="fa fa-check"></i><b>12.2</b> One sample t-test</a></li>
<li class="chapter" data-level="12.3" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#doing-it-by-hand---where-does-the-t-statistic-come-from"><i class="fa fa-check"></i><b>12.3</b> Doing it “by hand” - where does the t-statistic come from?</a></li>
<li class="chapter" data-level="12.4" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#paired-t-test"><i class="fa fa-check"></i><b>12.4</b> Paired t-test</a></li>
<li class="chapter" data-level="12.5" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#a-paired-t-test-is-a-one-sample-test."><i class="fa fa-check"></i><b>12.5</b> A paired t-test is a one-sample test.</a></li>
<li class="chapter" data-level="12.6" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#two-sample-t-test"><i class="fa fa-check"></i><b>12.6</b> Two sample t-test</a></li>
<li class="chapter" data-level="12.7" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#t-tests-are-linear-models"><i class="fa fa-check"></i><b>12.7</b> t-tests are linear models</a></li>
<li class="chapter" data-level="12.8" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-sex-differences-in-fine-motor-skills"><i class="fa fa-check"></i><b>12.8</b> Exercise: Sex differences in fine motor skills</a></li>
<li class="chapter" data-level="12.9" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-therapy-for-anorexia"><i class="fa fa-check"></i><b>12.9</b> Exercise: Therapy for anorexia</a></li>
<li class="chapter" data-level="12.10" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-compare-t-tests-with-randomisation-tests"><i class="fa fa-check"></i><b>12.10</b> Exercise: Compare t-tests with randomisation tests</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html"><i class="fa fa-check"></i><b>13</b> Linear models with a single categorical explanatory variable</a>
<ul>
<li class="chapter" data-level="13.1" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#one-way-anova"><i class="fa fa-check"></i><b>13.1</b> One-way ANOVA</a></li>
<li class="chapter" data-level="13.2" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#fitting-an-anova-in-r"><i class="fa fa-check"></i><b>13.2</b> Fitting an ANOVA in R</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#where-are-the-differences"><i class="fa fa-check"></i><b>13.2.1</b> Where are the differences?</a></li>
<li class="chapter" data-level="13.2.2" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#tukeys-honestly-significant-difference-hsd"><i class="fa fa-check"></i><b>13.2.2</b> Tukey’s Honestly Significant Difference (HSD)</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#anova-calculation-by-hand."><i class="fa fa-check"></i><b>13.3</b> ANOVA calculation “by hand”.</a></li>
<li class="chapter" data-level="13.4" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#exercise-apple-tree-crop-yield"><i class="fa fa-check"></i><b>13.4</b> Exercise: Apple tree crop yield</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html"><i class="fa fa-check"></i><b>14</b> Linear models with a single continuous explanatory variable</a>
<ul>
<li class="chapter" data-level="14.1" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#some-theory"><i class="fa fa-check"></i><b>14.1</b> Some theory</a></li>
<li class="chapter" data-level="14.2" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#evaluating-a-hypothesis-with-a-linear-regression-model"><i class="fa fa-check"></i><b>14.2</b> Evaluating a hypothesis with a linear regression model</a></li>
<li class="chapter" data-level="14.3" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#assumptions"><i class="fa fa-check"></i><b>14.3</b> Assumptions</a></li>
<li class="chapter" data-level="14.4" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#worked-example-height-hand-width-relationship"><i class="fa fa-check"></i><b>14.4</b> Worked example: height-hand width relationship</a></li>
<li class="chapter" data-level="14.5" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#exercise-chirping-crickets"><i class="fa fa-check"></i><b>14.5</b> Exercise: Chirping crickets</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html"><i class="fa fa-check"></i><b>15</b> Linear models with categorical and continuous explanatory variables</a>
<ul>
<li class="chapter" data-level="15.1" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#the-height-hand-width-example."><i class="fa fa-check"></i><b>15.1</b> The height ~ hand width example.</a></li>
<li class="chapter" data-level="15.2" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#summarising-with-anova"><i class="fa fa-check"></i><b>15.2</b> Summarising with <code>anova</code></a></li>
<li class="chapter" data-level="15.3" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#the-summary-of-coefficients-summary"><i class="fa fa-check"></i><b>15.3</b> The summary of coefficients (<code>summary</code>)</a></li>
<li class="chapter" data-level="15.4" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#simplifying-the-model"><i class="fa fa-check"></i><b>15.4</b> Simplifying the model</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html"><i class="fa fa-check"></i><b>16</b> Linear models with &gt;1 categorical explanatory variables</a>
<ul>
<li class="chapter" data-level="16.1" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#fitting-a-two-way-anova-model"><i class="fa fa-check"></i><b>16.1</b> Fitting a two-way ANOVA model</a></li>
<li class="chapter" data-level="16.2" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#summarising-the-model-anova"><i class="fa fa-check"></i><b>16.2</b> Summarising the model (<code>anova</code>)</a></li>
<li class="chapter" data-level="16.3" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#summarising-the-model-summary"><i class="fa fa-check"></i><b>16.3</b> Summarising the model (<code>summary</code>)</a></li>
<li class="chapter" data-level="16.4" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#exercise-fish-behaviour"><i class="fa fa-check"></i><b>16.4</b> Exercise: Fish behaviour</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html"><i class="fa fa-check"></i><b>17</b> Generalised linear models</a>
<ul>
<li class="chapter" data-level="17.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#count-data-with-poisson-errors."><i class="fa fa-check"></i><b>17.1</b> Count data with Poisson errors.</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-number-of-offspring-in-foxes."><i class="fa fa-check"></i><b>17.1.1</b> Example: Number of offspring in foxes.</a></li>
<li class="chapter" data-level="17.1.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-cancer-clusters"><i class="fa fa-check"></i><b>17.1.2</b> Example: Cancer clusters</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#exercise-maze-runner"><i class="fa fa-check"></i><b>17.2</b> Exercise: Maze runner</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html"><i class="fa fa-check"></i><b>18</b> Extending use cases of GLM</a>
<ul>
<li class="chapter" data-level="18.1" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#binomial-response-data"><i class="fa fa-check"></i><b>18.1</b> Binomial response data</a></li>
<li class="chapter" data-level="18.2" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-nfl-field-goals"><i class="fa fa-check"></i><b>18.2</b> Example: NFL field goals</a></li>
<li class="chapter" data-level="18.3" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-sex-ratio-in-turtles"><i class="fa fa-check"></i><b>18.3</b> Example: Sex ratio in turtles</a></li>
<li class="chapter" data-level="18.4" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-smoking"><i class="fa fa-check"></i><b>18.4</b> Example: Smoking</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html"><i class="fa fa-check"></i><b>19</b> Power analysis by simulation</a>
<ul>
<li class="chapter" data-level="19.1" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#type-i-and-ii-errors-and-statistical-power"><i class="fa fa-check"></i><b>19.1</b> Type I and II errors and statistical power</a></li>
<li class="chapter" data-level="19.2" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#what-determines-statistical-power"><i class="fa fa-check"></i><b>19.2</b> What determines statistical power?</a></li>
<li class="chapter" data-level="19.3" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#an-example-of-calculating-statistical-power."><i class="fa fa-check"></i><b>19.3</b> An example of calculating statistical power.</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#the-simulation"><i class="fa fa-check"></i><b>19.3.1</b> The simulation</a></li>
<li class="chapter" data-level="19.3.2" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#some-questions-for-you-to-address"><i class="fa fa-check"></i><b>19.3.2</b> Some questions for you to address:</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#summary"><i class="fa fa-check"></i><b>19.4</b> Summary</a></li>
<li class="chapter" data-level="19.5" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#extending-the-simulation-optional-advanced"><i class="fa fa-check"></i><b>19.5</b> Extending the simulation (optional, advanced)</a></li>
<li class="chapter" data-level="19.6" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#exercise-1-snails-on-the-move"><i class="fa fa-check"></i><b>19.6</b> Exercise 1: Snails on the move</a></li>
<li class="chapter" data-level="19.7" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#exercise-2-mouse-lemur-strength"><i class="fa fa-check"></i><b>19.7</b> Exercise 2: Mouse lemur strength</a></li>
</ul></li>
<li class="part"><span><b>IV Coming soon(ish)</b></span></li>
<li class="chapter" data-level="20" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html"><i class="fa fa-check"></i><b>20</b> Coming soon (maybe)!</a>
<ul>
<li class="chapter" data-level="20.1" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#multivariate-statistics"><i class="fa fa-check"></i><b>20.1</b> Multivariate statistics</a></li>
<li class="chapter" data-level="20.2" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#transforming-variables"><i class="fa fa-check"></i><b>20.2</b> Transforming variables</a></li>
<li class="chapter" data-level="20.3" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#non-linear-regression"><i class="fa fa-check"></i><b>20.3</b> Non-linear regression</a></li>
<li class="chapter" data-level="20.4" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#nested-or-blocked-study-designs"><i class="fa fa-check"></i><b>20.4</b> Nested or blocked study designs</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BB852 - Data handling, visualisation and statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-models-with-1-categorical-explanatory-variables" class="section level1" number="16">
<h1><span class="header-section-number">Chapter 16</span> Linear models with &gt;1 categorical explanatory variables</h1>
<p>In the one-way ANOVA we covered in the previous chapter we were interested in understanding the effect of a single categorical explanatory variable with two or more levels on a continuous response variable. Although the explanatory variable must be categorical (i.e. with discrete levels), it could represent a continuous variable. For example, the explanatory variable could be a two-level soil nutrient level (high or low), even though nutrient level is a continuous variable and one could measure the actual quantitative value of nutrients in mg/g.</p>
<p>The two-way ANOVA is an extension of one-way ANOVA that allows you to investigate the effect of <strong>two</strong> categorical variables. This can be useful in an experimental context.</p>
<p>For example, one might have run an experiment investigating in the effect of two types of diet (<em>lowProtein</em> and <em>highProtein</em>), and genotype (<em>gt1</em> and <em>gt2</em>), on adult size of a pest species. It is worth thinking about what potential outcomes there are for this experiment. There may be no effect of diet, and no effect of genotype. There may be an effect of one of these variables but not the other. The effect of the diet might be the same for the different genotypes, or it might be different. Some of these different possible outcomes are illustrated in Figure @ref{fig:possibilities}. the titles indicate with Y (yes) or N (no) whether the figure shows a significant diet, genotype (gt) or interaction (int) effect. The dotted lines joining the estimates for the two genotypes are a kind of <strong>interaction plot</strong>: where they are parallel, there is no interaction.</p>
<div class="figure" style="text-align: center"><span id="fig:possibilities"></span>
<img src="BB852_files/figure-html/possibilities-1.png" alt="Some potential results of the experiment. There may be a significant effect (or not) of both of the main effects (diet and genotype) and there may be a significant interaction effect (or not)." width="960" />
<p class="caption">
Figure 16.1: Some potential results of the experiment. There may be a significant effect (or not) of both of the main effects (diet and genotype) and there may be a significant interaction effect (or not).
</p>
</div>
<p>In the model we aim to quantify these effects, and ask if they are statistically significant (i.e. if the effect sizes are &gt;0). We divide the effects of the explanatory variables into two types: <strong>main effects</strong> and <strong>interaction effects</strong>. The main effects are the overall effect of the explanatory variables (genotype and diet in this case) while the interaction effect allows us to ask whether one main effect <em>depends on another</em>. In this case we are asking whether <em>the effect of diet depends on genotype (and vice versa)</em>. Make sure that you understand this important concept.</p>
<div id="fitting-a-two-way-anova-model" class="section level2" number="16.1">
<h2><span class="header-section-number">16.1</span> Fitting a two-way ANOVA model</h2>
<p>Let’s use R to fit a two-way ANOVA model using data from the example I just described. As with one-way ANOVA, you can fit a two-way ANOVA model in R using <code>lm</code>.</p>
<div class="do-something">
<p>
Remember to load the <code>dplyr</code>, <code>magrittr</code> and <code>ggplot</code> packages, and to set your working directory correctly.
</p>
</div>
<p>First, import the <code>insectDiet.csv</code> data and plot it, to produce a plot like in Figure @ref{fig:dietAndGenotype}. From looking at the graph in Figure @ref{fig:dietAndGenotype} you can see (a) genotype 1 tends to be larger than genotype 2; (b) insects raised on a high protein diet tend to be larger than those on a low protein diet; and (c) the effect of the diet (i.e. the <em>difference</em> in size between the insects raised on the different diets) is larger for genotype 1 than it is for genotype 2. But are these differences statistically meaningful?</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb457-1" aria-hidden="true"></a>insectDiet &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;CourseData/insectDiet.csv&quot;</span>)</span>
<span id="cb457-2"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb457-2" aria-hidden="true"></a></span>
<span id="cb457-3"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb457-3" aria-hidden="true"></a><span class="kw">ggplot</span>(insectDiet,<span class="kw">aes</span>(<span class="dt">x =</span> genotype,<span class="dt">y =</span> lengthMM,<span class="dt">fill=</span>diet)) <span class="op">+</span></span>
<span id="cb457-4"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb457-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb457-5"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb457-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Genotype&quot;</span>)<span class="op">+</span></span>
<span id="cb457-6"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb457-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Length (mm)&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:dietAndGenotype"></span>
<img src="BB852_files/figure-html/dietAndGenotype-1.png" alt="The effect of diet protein content and genotype on adult size of an insect species" width="480" />
<p class="caption">
Figure 16.2: The effect of diet protein content and genotype on adult size of an insect species
</p>
</div>
<p>To address this question, we will fit a linear model (the two-way ANOVA) to estimate the effects of diet and genotype.</p>
<p>The model formula is <code>lengthMM ~ genotype + diet + genotype:diet</code>.</p>
<p>Let’s try to understand this. The <code>genotype + diet</code> part represents the <strong>main effects</strong> of these two variables, and the <code>genotype:diet</code> part represents the <strong>interaction effect</strong> between them. This formula<em>can</em> be shortened to <code>lengthMM ~ genotype * diet</code> (i.e. this is exactly equivalent to the more complicated-looking formula), but I recommend to use the longer version because it is clearer.</p>
<p>So we fit the model like this - putting the formula first, then telling R which data to use:</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb458-1" aria-hidden="true"></a>mod_A &lt;-<span class="st"> </span><span class="kw">lm</span>(lengthMM <span class="op">~</span><span class="st"> </span>genotype <span class="op">+</span><span class="st"> </span>diet <span class="op">+</span><span class="st"> </span>genotype<span class="op">:</span>diet, <span class="dt">data =</span> insectDiet)</span></code></pre></div>
<p>Then we can look at diagnostic plots, as with ANOVA etc.:</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb459-1" aria-hidden="true"></a><span class="kw">library</span>(ggfortify)</span>
<span id="cb459-2"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb459-2" aria-hidden="true"></a><span class="kw">autoplot</span>(mod_A)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-319-1.png" width="672" /></p>
<p>These all look OK. The slightly odd structure in the QQ-plot is caused by the fact that the length data are rounded to the nearest millimeter. There is no evidence of heteroscedasticity (left hand plots) now any major outliers.</p>
</div>
<div id="summarising-the-model-anova" class="section level2" number="16.2">
<h2><span class="header-section-number">16.2</span> Summarising the model (<code>anova</code>)</h2>
<p>Since we are satisfied with the diagnostic plots we can proceed by summarising the model using first <code>anova</code> and then <code>summary</code>.</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb460-1" aria-hidden="true"></a><span class="kw">anova</span>(mod_A)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: lengthMM
##               Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## genotype       1 426.02  426.02  99.575 7.135e-13 ***
## diet           1 111.02  111.02  25.949 7.064e-06 ***
## genotype:diet  1  54.19   54.19  12.665 0.0009073 ***
## Residuals     44 188.25    4.28                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>This summary <code>Analysis of Variance Table</code> is similar to the ones you have already seen for one-way ANOVA and linear regression. It just has some extra rows because you have extra explanatory variables. It shows you the degrees of freedom for the different terms in the model (all 1, because they have two levels), the sum of squares (<code>Sum Sq</code>) and mean sum of squares (<code>Mean Sq</code>) and the associated <code>F value</code> and p-value (<code>Pr(&gt;F)</code>). Those F values are all large, leading to highly-significant p-values.</p>
<p>This means that all of those terms in the model explain a significant proportion of the variation in insect length.</p>
<p>But as you know, this summary table doesn’t tell you the direction of the effects. The obvious way to understand your data is to simply look at the plot you have already produced. You could also make an <strong>interaction plot</strong> which is a simplified version of the plot of the raw data.</p>
<p>To do this you first need to create a summary table using <code>dplyr</code> tools <code>summarise</code> and <code>group_by</code> to get the mean and standard errors of the mean:</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb462-1" aria-hidden="true"></a>insectDiet_means &lt;-<span class="st"> </span></span>
<span id="cb462-2"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb462-2" aria-hidden="true"></a><span class="st">  </span>insectDiet <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb462-3"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb462-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(genotype, diet) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># &lt;- remember to group by *both* factors</span></span>
<span id="cb462-4"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb462-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">MeanLength =</span> <span class="kw">mean</span>(lengthMM),<span class="dt">SELength =</span> <span class="kw">sd</span>(lengthMM)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">n</span>()))</span>
<span id="cb462-5"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb462-5" aria-hidden="true"></a>insectDiet_means</span></code></pre></div>
<pre><code>## # A tibble: 4 x 4
## # Groups:   genotype [2]
##   genotype diet        MeanLength SELength
##   &lt;chr&gt;    &lt;chr&gt;            &lt;dbl&gt;    &lt;dbl&gt;
## 1 gt1      highProtein       25.8    0.672
## 2 gt1      lowProtein        20.7    0.527
## 3 gt2      highProtein       17.8    0.698
## 4 gt2      lowProtein        16.8    0.458</code></pre>
<p>Then you can make a simple plot of this information by plotting points, and lines joining them:</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb464-1" aria-hidden="true"></a>(A&lt;-<span class="kw">ggplot</span>(insectDiet_means, </span>
<span id="cb464-2"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb464-2" aria-hidden="true"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> genotype, <span class="dt">y =</span> MeanLength, <span class="dt">colour =</span> diet, <span class="dt">group =</span> diet)) <span class="op">+</span></span>
<span id="cb464-3"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb464-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb464-4"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb464-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_line</span>())</span></code></pre></div>
<p><img src="BB852_files/figure-html/interactionPlot-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>You could add error bars to the points by adding a line defining the <code>ymin</code> and <code>ymax</code> values from the data summary like this:</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb465-1" aria-hidden="true"></a><span class="kw">ggplot</span>(insectDiet_means, </span>
<span id="cb465-2"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb465-2" aria-hidden="true"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> genotype, <span class="dt">y =</span> MeanLength, <span class="dt">colour =</span> diet, <span class="dt">group =</span> diet,</span>
<span id="cb465-3"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb465-3" aria-hidden="true"></a>           <span class="dt">ymin =</span> MeanLength <span class="op">-</span><span class="st"> </span>SELength, <span class="dt">ymax =</span> MeanLength <span class="op">+</span><span class="st"> </span>SELength)) <span class="op">+</span></span>
<span id="cb465-4"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb465-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb465-5"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb465-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb465-6"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb465-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="dt">width =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/errorBars-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>But are these points statistically significantly different from each other?
To answer that question we need to use a post-hoc test</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb466-1" aria-hidden="true"></a><span class="kw">library</span>(agricolae)</span>
<span id="cb466-2"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb466-2" aria-hidden="true"></a><span class="kw">HSD.test</span>(mod_A, <span class="dt">trt =</span> <span class="kw">c</span>(<span class="st">&quot;diet&quot;</span>, <span class="st">&quot;genotype&quot;</span>), <span class="dt">console =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
## Study: mod_A ~ c(&quot;diet&quot;, &quot;genotype&quot;)
## 
## HSD Test for lengthMM 
## 
## Mean Square Error:  4.278409 
## 
## diet:genotype,  means
## 
##                 lengthMM      std  r Min Max
## highProtein:gt1 25.83333 2.329000 12  23  31
## highProtein:gt2 17.75000 2.416797 12  14  22
## lowProtein:gt1  20.66667 1.825742 12  17  24
## lowProtein:gt2  16.83333 1.585923 12  14  19
## 
## Alpha: 0.05 ; DF Error: 44 
## Critical Value of Studentized Range: 3.775958 
## 
## Minimun Significant Difference: 2.254643 
## 
## Treatments with the same letter are not significantly different.
## 
##                 lengthMM groups
## highProtein:gt1 25.83333      a
## lowProtein:gt1  20.66667      b
## highProtein:gt2 17.75000      c
## lowProtein:gt2  16.83333      c</code></pre>
<p>The important part of this output is at the bottom where it tells us <code>Treatments with the same letter are not significantly different.</code>. You can see that the mean lengths between diets for genotype 1 are significantly different (they do not share a letter). However, there is no significant difference between diets for genotype 2 (they share the same letter, <code>c</code>). The two genotypes are also significantly different from each other.</p>
</div>
<div id="summarising-the-model-summary" class="section level2" number="16.3">
<h2><span class="header-section-number">16.3</span> Summarising the model (<code>summary</code>)</h2>
<p>This (above) is generally enough information for a complete write up of results. However, you can ask R to provide the model summary that includes the <span class="math inline">\(R^2\)</span> values, coefficient estimates and standard errors using <code>summary</code>.</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="linear-models-with-1-categorical-explanatory-variables.html#cb468-1" aria-hidden="true"></a><span class="kw">summary</span>(mod_A)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = lengthMM ~ genotype + diet + genotype:diet, data = insectDiet)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.7500 -1.0417  0.1667  1.2500  5.1667 
## 
## Coefficients:
##                            Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                 25.8333     0.5971  43.264  &lt; 2e-16 ***
## genotypegt2                 -8.0833     0.8444  -9.572 2.53e-12 ***
## dietlowProtein              -5.1667     0.8444  -6.118 2.26e-07 ***
## genotypegt2:dietlowProtein   4.2500     1.1942   3.559 0.000907 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.068 on 44 degrees of freedom
## Multiple R-squared:  0.7585,	Adjusted R-squared:  0.742 
## F-statistic: 46.06 on 3 and 44 DF,  p-value: 1.254e-13</code></pre>
<p>The most useful thing shown here is the <span class="math inline">\(R^2\)</span> value. Because we have several terms in the model we should use the <code>Adjusted R-squared</code> value of 0.742. This indicates that our model explains 74.2% of variation in insect length.</p>
<p>The next bit is not 100% necessary most of the time…</p>
<p>We already have a good idea of the mean values and standard errors for these data look because we calculated them above directly from the data. For completeness though I will now run through the coefficient estimates part of the summary table.</p>
<p>The coefficient <code>Estimates</code> here are interpreted in a similar way to a one-way ANOVA. Again, it is important to know what the reference point is. When you understand this you can reconstruct the mean values for the various levels of the variables that are estimated by the model. You will see that the model estimates lead to precisely the same estimates as obtained from summarising the data.</p>
<p>Here you can see that:</p>
<ul>
<li><p>The <code>(Intercept)</code> is 25.8333 and must refer to the point for <em>genotype 1</em> on a <em>high protein diet</em> (look at the value of the intercept and compare to the graph/summary table, and/or the output from the Tukey test).</p></li>
<li><p>The second coefficient (<code>genotypegt2</code>) is -8.0833 which is the <strong>difference</strong> between the reference (intercept) and the value for <em>genotype 2</em> on a <em>high protein diet</em>: (25.8333 + (-8.0833) = 17.75).</p></li>
<li><p>The third coefficient (<code>dietlowProtein</code>) is -5.1667 which is the difference between the reference point and for <em>genotype 1</em> on a <em>low protein diet</em>: (25.8333 + (-5.1667) = 20.6666).</p></li>
<li><p>The final coefficient <code>dietlowProtein:genotypegt2</code> is 4.25 and is “interaction effect” of diet and genotype and represents the <em>additional</em> effect of genotype when it is on diet. In other words, in comparison to the reference point (genotype 1 &amp; high protein diet), the effect of a low protein diet is negative (-8.0833), as is the effect of being genotype 2 (-5.1667). However, having both a low protein diet <strong>and</strong> being genotype 2 leads to an additional positive effect (4.25) on length. The resulting estimate of mean length for <em>genotype 2</em> on a <em>low protein diet</em> is 25.8333 + (-8.0833) + (-5.1667) + 4.25 = 16.833.</p></li>
</ul>
<p>This is a bit complicated so my advice is generally to refer to the figures and the outputs of the <code>Tukey.HSD</code> function to obtain the estimate in the different groups.</p>
<p>The logic and methods of the two-way ANOVA can be extended to produce <span class="math inline">\(n\)</span>-way ANOVA with <span class="math inline">\(n\)</span> categorical variables.</p>
</div>
<div id="exercise-fish-behaviour" class="section level2" number="16.4">
<h2><span class="header-section-number">16.4</span> Exercise: Fish behaviour</h2>
<p>Individual differences in animal personality and external appearance such as colouration patterns have both been extensively studied separately. A significant body of research has explored many of pertinent ecological and biological aspects that can be affected by them and their impact upon fitness. Currently little is known about how both factors interact and their effect on reproductive success.</p>
<p>Researchers carried out a study looking at differences in personality and its interaction with colour phenotype in zebra fish (<em>Danio rerio</em>). They used two colour morphs, “homogeneous” which has clearly defined lateral stripes, and “heterogeneous” which has more variable and less clear patterns.</p>
<p>They also assigned individuals to two personality types which they called “Proactive” (adventurous, risk taking) and “Reactive” (timid, less risk taking). They did this by recording how they explore a new environment</p>
<p>The two variables of interest are:</p>
<ul>
<li>Colour pattern (homogeneous and heterogeneous)</li>
<li>Personality (proactive and reactive)</li>
</ul>
<p>The research questions are: <em>What is the relative influence of colour pattern and personality? Which is more important? How do the variables interact to determine fitness? e.g. do proactive individuals do better than reactive ones, and does this depend on colour pattern? Or some other pattern?</em></p>
<ol style="list-style-type: decimal">
<li>Import the data set, <code>fishPersonality.csv</code></li>
</ol>
<!--

```r
fishPersonality <- read.csv("CourseData/fishPersonality.csv")
```
-->
<ol start="2" style="list-style-type: decimal">
<li>Plot the data (e.g. as a box plot)
<!--

```r
ggplot(fishPersonality,aes(x = colouration,y = spawning,fill=personality))+
  geom_boxplot()
```

<img src="BB852_files/figure-html/unnamed-chunk-325-1.png" width="672" />
--></li>
<li>Fit an ANOVA model using <code>lm</code>.
<!--

```r
mod_A <- lm(spawning ~ personality+colouration + personality:colouration,
            data = fishPersonality)
```
--></li>
<li>Look at diagnostic plots from this model (<code>autoplot</code>)</li>
</ol>
<!--
library(ggfortify)
autoplot(mod_A)
-->
<ol start="5" style="list-style-type: decimal">
<li>Use <code>anova</code> to get an Analysis of Variance summary table, and interpret the results.</li>
</ol>
<!--

```r
anova(mod_A)
```

```
## Analysis of Variance Table
## 
## Response: spawning
##                         Df Sum Sq Mean Sq F value    Pr(>F)    
## personality              1   7781    7781  5.5032   0.02629 *  
## colouration              1  55862   55862 39.5074 8.519e-07 ***
## personality:colouration  1   4118    4118  2.9123   0.09898 .  
## Residuals               28  39591    1414                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```
-->
<ol start="6" style="list-style-type: decimal">
<li><p>Get the coefficient summary (<code>summary</code>) and interpret the output.
<!--

```r
summary(mod_A)
```

```
## 
## Call:
## lm(formula = spawning ~ personality + colouration + personality:colouration, 
##     data = fishPersonality)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -61.625 -23.344  -5.375  26.313  60.125 
## 
## Coefficients:
##                                           Estimate Std. Error t value Pr(>|t|)    
## (Intercept)                                 218.50      13.29  16.435  6.5e-16 ***
## personalityReactive                         -53.88      18.80  -2.865  0.00781 ** 
## colourationHomogenous                        60.87      18.80   3.238  0.00309 ** 
## personalityReactive:colourationHomogenous    45.38      26.59   1.707  0.09898 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 37.6 on 28 degrees of freedom
## Multiple R-squared:  0.6312,	Adjusted R-squared:  0.5917 
## F-statistic: 15.97 on 3 and 28 DF,  p-value: 3.021e-06
```
--></p></li>
<li><p>Do post-hoc Tukey tests (e.g. using <code>HSD.test</code> from the <code>agricolae</code> package). Interpret the results.
<!--

```r
library(agricolae)
HSD.test(mod_A, c("personality","colouration"), console=TRUE)
```

```
## 
## Study: mod_A ~ c("personality", "colouration")
## 
## HSD Test for spawning 
## 
## Mean Square Error:  1413.951 
## 
## personality:colouration,  means
## 
##                        spawning      std r Min Max
## Proactive:Heterogenous  218.500 34.92850 8 161 268
## Proactive:Homogenous    279.375 40.40133 8 219 339
## Reactive:Heterogenous   164.625 39.86383 8 103 220
## Reactive:Homogenous     270.875 34.84840 8 233 331
## 
## Alpha: 0.05 ; DF Error: 28 
## Critical Value of Studentized Range: 3.861244 
## 
## Minimun Significant Difference: 51.33332 
## 
## Treatments with the same letter are not significantly different.
## 
##                        spawning groups
## Proactive:Homogenous    279.375      a
## Reactive:Homogenous     270.875      a
## Proactive:Heterogenous  218.500      b
## Reactive:Heterogenous   164.625      c
```
--></p></li>
<li><p>Sum up your findings with reference to the initial research questions.</p></li>
</ol>
<!--
* Homogenous coloured fish seem to do better than heterogenous ones overall (from the plot)
* The anova table shows that personality, colouration and the interaction between them are all important variables (p <0.05); Personality seems to be more important than colouration overall (based on p-values)
* The Tukey test table shows that -  (1) Personality is associated with spawning, but only for heterogenous coloured fish. (2) In the heterogenous coloured fish the proactive fish spawn significantly more than the reactive ones. (3) In the homogenous coloured fish there is no significant difference between the personalities.
-->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-models-with-categorical-and-continuous-explanatory-variables.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="generalised-linear-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jonesor/BB852_Book/edit/master/3_06-Two-way_ANOVA.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["BB852.pdf"],
"toc": {
"collapse": "section"
},
"split_by": "section"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
