<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="10.6 ANOVA calculation “by hand” (optional) | BB852 - Data handling, visualisation and statistics" />
<meta property="og:type" content="book" />


<meta property="og:description" content="This is the course book for BB852." />


<meta name="author" content="Owen Jones" />

<meta name="date" content="2020-08-26" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>

<meta name="description" content="This is the course book for BB852.">

<title>10.6 ANOVA calculation “by hand” (optional) | BB852 - Data handling, visualisation and statistics</title>

<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#preface"><span class="toc-section-number">1</span> Preface</a>
<ul>
<li><a href="1-1-data-wrangling.html#data-wrangling"><span class="toc-section-number">1.1</span> Data wrangling</a></li>
<li><a href="1-2-data-visualisation.html#data-visualisation"><span class="toc-section-number">1.2</span> Data visualisation</a></li>
<li><a href="1-3-statistics.html#statistics"><span class="toc-section-number">1.3</span> Statistics</a></li>
<li><a href="1-4-general-approach.html#general-approach"><span class="toc-section-number">1.4</span> General approach</a></li>
<li><a href="1-5-data-sources.html#data-sources"><span class="toc-section-number">1.5</span> Data sources</a></li>
<li><a href="1-6-acknowledgements.html#acknowledgements"><span class="toc-section-number">1.6</span> Acknowledgements</a></li>
<li><a href="1-7-error-reporting.html#error-reporting"><span class="toc-section-number">1.7</span> Error reporting</a></li>
</ul></li>
<li><a href="2-getting-acquainted-with-r.html#getting-acquainted-with-r"><span class="toc-section-number">2</span> Getting acquainted with R</a>
<ul>
<li><a href="2-1-introduction.html#introduction"><span class="toc-section-number">2.1</span> Introduction</a></li>
<li><a href="2-2-getting-started-with-r.html#getting-started-with-r"><span class="toc-section-number">2.2</span> Getting started with R</a></li>
<li><a href="2-3-getting-help.html#getting-help"><span class="toc-section-number">2.3</span> Getting help</a></li>
<li><a href="2-4-r-as-a-fancy-calculator.html#r-as-a-fancy-calculator"><span class="toc-section-number">2.4</span> R as a fancy calculator</a></li>
<li><a href="2-5-objects-in-r.html#objects-in-r"><span class="toc-section-number">2.5</span> Objects in R</a></li>
<li><a href="2-6-missing-values-infinity-and-non-numbers.html#missing-values-infinity-and-non-numbers"><span class="toc-section-number">2.6</span> Missing values, infinity and “non-numbers”</a></li>
<li><a href="2-7-basic-information-about-objects.html#basic-information-about-objects"><span class="toc-section-number">2.7</span> Basic information about objects</a></li>
<li><a href="2-8-data-frames.html#data-frames"><span class="toc-section-number">2.8</span> Data frames</a></li>
<li><a href="2-9-classes-in-r.html#classes-in-r"><span class="toc-section-number">2.9</span> Classes in R</a></li>
<li><a href="2-10-tables-and-summary-statistics.html#tables-and-summary-statistics"><span class="toc-section-number">2.10</span> Tables and summary statistics</a></li>
<li><a href="2-11-plotting-data.html#plotting-data"><span class="toc-section-number">2.11</span> Plotting data</a></li>
<li><a href="2-12-exercises-getting-acquainted-with-r.html#exercises---getting-acquainted-with-r"><span class="toc-section-number">2.12</span> Exercises - Getting acquainted with R</a>
<ul>
<li><a href="2-12-exercises-getting-acquainted-with-r.html#background"><span class="toc-section-number">2.12.1</span> Background</a></li>
<li><a href="2-12-exercises-getting-acquainted-with-r.html#the-data"><span class="toc-section-number">2.12.2</span> The data</a></li>
<li><a href="2-12-exercises-getting-acquainted-with-r.html#try-the-following"><span class="toc-section-number">2.12.3</span> Try the following</a></li>
<li><a href="2-12-exercises-getting-acquainted-with-r.html#references"><span class="toc-section-number">2.12.4</span> References</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Wrangling</b></span></li>
<li><a href="3-data-wrangling-with-dplyr.html#data-wrangling-with-dplyr"><span class="toc-section-number">3</span> Data wrangling with dplyr</a>
<ul>
<li><a href="2-1-introduction.html#introduction"><span class="toc-section-number">3.1</span> Introduction</a></li>
<li><a href="3-2-select.html#select"><span class="toc-section-number">3.2</span> select</a></li>
<li><a href="3-3-filter.html#filter"><span class="toc-section-number">3.3</span> filter</a></li>
<li><a href="3-4-arrange.html#arrange"><span class="toc-section-number">3.4</span> arrange</a></li>
<li><a href="3-5-summarise-and-group-by.html#summarise-and-group_by"><span class="toc-section-number">3.5</span> summarise and group_by</a></li>
<li><a href="3-6-using-pipes-saving-data-.html#using-pipes-saving-data."><span class="toc-section-number">3.6</span> Using pipes, saving data.</a></li>
<li><a href="3-7-exercises-data-wrangling.html#exercises---data-wrangling"><span class="toc-section-number">3.7</span> Exercises - data wrangling</a>
<ul>
<li><a href="3-7-exercises-data-wrangling.html#exploring-the-amniote-life-history-database"><span class="toc-section-number">3.7.1</span> Exploring the Amniote Life History Database</a></li>
</ul></li>
</ul></li>
<li><a href="4-combining-data-sets.html#combining-data-sets"><span class="toc-section-number">4</span> Combining data sets</a>
<ul>
<li><a href="4-1-exercise-joining-datasets.html#exercise---joining-datasets"><span class="toc-section-number">4.1</span> Exercise - joining datasets</a>
<ul>
<li><a href="2-12-exercises-getting-acquainted-with-r.html#the-data"><span class="toc-section-number">4.1.1</span> The data</a></li>
<li><a href="4-1-exercise-joining-datasets.html#the-bird-data"><span class="toc-section-number">4.1.2</span> The bird data</a></li>
<li><a href="4-1-exercise-joining-datasets.html#the-weather-data"><span class="toc-section-number">4.1.3</span> The weather data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Data visualisation</b></span></li>
<li><a href="5-visualising-data-with-ggplot2.html#visualising-data-with-ggplot2"><span class="toc-section-number">5</span> Visualising data with ggplot2</a>
<ul>
<li><a href="2-1-introduction.html#introduction"><span class="toc-section-number">5.1</span> Introduction</a></li>
<li><a href="5-2-histograms.html#histograms"><span class="toc-section-number">5.2</span> Histograms</a></li>
<li><a href="5-3-facets-splitting-data-across-panels.html#facets---splitting-data-across-panels"><span class="toc-section-number">5.3</span> “Facets” - splitting data across panels</a></li>
<li><a href="5-4-box-plots.html#box-plots"><span class="toc-section-number">5.4</span> box plots</a></li>
<li><a href="5-5-lines-and-points.html#lines-and-points"><span class="toc-section-number">5.5</span> lines and points</a></li>
<li><a href="5-6-scatter-plot.html#scatter-plot"><span class="toc-section-number">5.6</span> scatter plot</a></li>
</ul></li>
<li><a href="6-distributions-and-summarising-data.html#distributions-and-summarising-data"><span class="toc-section-number">6</span> Distributions and summarising data</a>
<ul>
<li><a href="2-1-introduction.html#introduction"><span class="toc-section-number">6.1</span> Introduction</a></li>
<li><a href="6-2-distributions.html#distributions"><span class="toc-section-number">6.2</span> Distributions</a></li>
<li><a href="6-3-normal-distribution.html#normal-distribution"><span class="toc-section-number">6.3</span> Normal distribution</a></li>
<li><a href="6-4-compare-normal-distributions.html#compare-normal-distributions"><span class="toc-section-number">6.4</span> Compare normal distributions</a></li>
<li><a href="6-5-the-poisson-distribution.html#the-poisson-distribution"><span class="toc-section-number">6.5</span> The Poisson distribution</a></li>
<li><a href="6-6-comparing-normal-and-poisson-distributions.html#comparing-normal-and-poisson-distributions"><span class="toc-section-number">6.6</span> Comparing normal and Poisson distributions</a></li>
</ul></li>
<li><a href="7-customising-your-plots.html#customising-your-plots"><span class="toc-section-number">7</span> Customising your plots</a>
<ul>
<li><a href="2-1-introduction.html#introduction"><span class="toc-section-number">7.1</span> Introduction</a></li>
<li><a href="7-2-a-basic-plot.html#a-basic-plot"><span class="toc-section-number">7.2</span> A basic plot</a></li>
<li><a href="7-3-axis-limits.html#axis-limits"><span class="toc-section-number">7.3</span> Axis limits</a></li>
<li><a href="7-4-transforming-the-axis-log-scale.html#transforming-the-axis-log-scale"><span class="toc-section-number">7.4</span> Transforming the axis (log scale)</a></li>
<li><a href="7-5-changing-the-axis-tick-marks.html#changing-the-axis-tick-marks"><span class="toc-section-number">7.5</span> Changing the axis tick marks</a></li>
<li><a href="7-6-axis-labels.html#axis-labels"><span class="toc-section-number">7.6</span> Axis labels</a></li>
<li><a href="7-7-colours.html#colours"><span class="toc-section-number">7.7</span> Colours</a></li>
<li><a href="7-8-themes.html#themes"><span class="toc-section-number">7.8</span> Themes</a></li>
<li><a href="7-9-moving-the-legend.html#moving-the-legend"><span class="toc-section-number">7.9</span> Moving the legend</a></li>
<li><a href="7-10-combining-multiple-plots.html#combining-multiple-plots"><span class="toc-section-number">7.10</span> Combining multiple plots</a></li>
<li><a href="7-11-saving-your-plot.html#saving-your-plot"><span class="toc-section-number">7.11</span> Saving your plot</a></li>
<li><a href="7-12-final-word-on-plots.html#final-word-on-plots"><span class="toc-section-number">7.12</span> Final word on plots</a></li>
</ul></li>
<li class="part"><span><b>III Statistics</b></span></li>
<li><a href="8-randomisation-tests.html#randomisation-tests"><span class="toc-section-number">8</span> Randomisation Tests</a>
<ul>
<li><a href="2-1-introduction.html#introduction"><span class="toc-section-number">8.1</span> Introduction</a></li>
<li><a href="8-2-the-example.html#the-example"><span class="toc-section-number">8.2</span> The example</a></li>
<li><a href="8-3-setting-up.html#setting-up"><span class="toc-section-number">8.3</span> Setting up</a></li>
<li><a href="8-4-calculate-the-observed-difference.html#calculate-the-observed-difference"><span class="toc-section-number">8.4</span> Calculate the observed difference</a></li>
<li><a href="8-5-null-distribution.html#null-distribution"><span class="toc-section-number">8.5</span> Null distribution</a></li>
<li><a href="8-6-testing-significance.html#testing-significance"><span class="toc-section-number">8.6</span> Testing significance</a></li>
<li><a href="8-7-testing-the-hypothesis.html#testing-the-hypothesis"><span class="toc-section-number">8.7</span> Testing the hypothesis</a></li>
<li><a href="8-8-writing-it-up.html#writing-it-up"><span class="toc-section-number">8.8</span> Writing it up</a></li>
<li><a href="8-9-paired-randomisation-tests.html#paired-randomisation-tests"><span class="toc-section-number">8.9</span> Paired Randomisation Tests</a>
<ul>
<li><a href="8-9-paired-randomisation-tests.html#plot-the-data"><span class="toc-section-number">8.9.1</span> Plot the data</a></li>
<li><a href="8-9-paired-randomisation-tests.html#the-paired-randomisation-test"><span class="toc-section-number">8.9.2</span> The paired randomisation test</a></li>
<li><a href="8-9-paired-randomisation-tests.html#plot-the-null-distribution"><span class="toc-section-number">8.9.3</span> Plot the null distribution</a></li>
<li><a href="8-9-paired-randomisation-tests.html#the-formal-hypothesis-test"><span class="toc-section-number">8.9.4</span> The formal hypothesis test</a></li>
</ul></li>
<li><a href="8-10-exercises-randomisation-tests.html#exercises---randomisation-tests"><span class="toc-section-number">8.10</span> Exercises - Randomisation tests</a>
<ul>
<li><a href="8-10-exercises-randomisation-tests.html#introduction-1"><span class="toc-section-number">8.10.1</span> Introduction</a></li>
<li><a href="8-10-exercises-randomisation-tests.html#your-task"><span class="toc-section-number">8.10.2</span> Your task</a></li>
</ul></li>
</ul></li>
<li><a href="9-comparing-two-means-with-a-t-test.html#comparing-two-means-with-a-t-test"><span class="toc-section-number">9</span> Comparing two means with a t-test</a>
<ul>
<li><a href="9-1-some-theory-.html#some-theory."><span class="toc-section-number">9.1</span> Some theory.</a></li>
<li><a href="9-2-one-sample-t-test.html#one-sample-t-test"><span class="toc-section-number">9.2</span> One sample t-test</a></li>
<li><a href="9-3-doing-it-by-hand-where-does-the-t-statistic-come-from.html#doing-it-by-hand---where-does-the-t-statistic-come-from"><span class="toc-section-number">9.3</span> Doing it “by hand” - where does the t-statistic come from?</a></li>
<li><a href="9-4-paired-t-test.html#paired-t-test"><span class="toc-section-number">9.4</span> Paired t-test</a></li>
<li><a href="9-5-a-paired-t-test-is-a-one-sample-test-.html#a-paired-t-test-is-a-one-sample-test."><span class="toc-section-number">9.5</span> A paired t-test is a one-sample test.</a></li>
<li><a href="9-6-two-sample-t-test.html#two-sample-t-test"><span class="toc-section-number">9.6</span> Two sample t-test</a></li>
<li><a href="9-7-t-tests-are-linear-models.html#t-tests-are-linear-models"><span class="toc-section-number">9.7</span> t-tests are linear models</a></li>
<li><a href="9-8-exercises-two-sample-t-test.html#exercises---two-sample-t-test"><span class="toc-section-number">9.8</span> Exercises - Two-sample t-test</a>
<ul>
<li><a href="9-8-exercises-two-sample-t-test.html#paired-t-test-1"><span class="toc-section-number">9.8.1</span> Paired t-test</a></li>
<li><a href="9-8-exercises-two-sample-t-test.html#optional-extra."><span class="toc-section-number">9.8.2</span> Optional extra.</a></li>
</ul></li>
</ul></li>
<li><a href="10-linear-models-with-a-single-categorical-explanatory-variable.html#linear-models-with-a-single-categorical-explanatory-variable"><span class="toc-section-number">10</span> Linear models with a single categorical explanatory variable</a>
<ul>
<li><a href="2-1-introduction.html#introduction"><span class="toc-section-number">10.1</span> Introduction</a></li>
<li><a href="10-2-one-way-anova.html#one-way-anova"><span class="toc-section-number">10.2</span> One-way ANOVA</a></li>
<li><a href="10-3-fitting-an-anova-in-r.html#fitting-an-anova-in-r"><span class="toc-section-number">10.3</span> Fitting an ANOVA in R</a></li>
<li><a href="10-4-where-are-the-differences.html#where-are-the-differences"><span class="toc-section-number">10.4</span> Where are the differences?</a></li>
<li><a href="10-5-tukeys-honestly-significant-difference-hsd.html#tukeys-honestly-significant-difference-hsd"><span class="toc-section-number">10.5</span> Tukey’s Honestly Significant Difference (HSD)</a></li>
<li><a href="10-6-anova-calculation-by-hand-optional.html#anova-calculation-by-hand-optional"><span class="toc-section-number">10.6</span> ANOVA calculation “by hand” (optional)</a></li>
</ul></li>
<li><a href="11-linear-models-with-a-several-categorical-explanatory-variables.html#linear-models-with-a-several-categorical-explanatory-variables"><span class="toc-section-number">11</span> Linear models with a several categorical explanatory variables</a>
<ul>
<li><a href="2-12-exercises-getting-acquainted-with-r.html#background"><span class="toc-section-number">11.1</span> Background</a></li>
<li><a href="11-2-fitting-a-two-way-anova-model.html#fitting-a-two-way-anova-model"><span class="toc-section-number">11.2</span> Fitting a two-way ANOVA model</a></li>
<li><a href="11-3-summarising-the-model-anova.html#summarising-the-model-anova"><span class="toc-section-number">11.3</span> Summarising the model (<code>anova</code>)</a></li>
<li><a href="11-4-summarising-the-model-summary.html#summarising-the-model-summary"><span class="toc-section-number">11.4</span> Summarising the model (<code>summary</code>)</a></li>
<li><a href="11-5-a-2-way-anova-on-a-fish-behaviour-study.html#a-2-way-anova-on-a-fish-behaviour-study"><span class="toc-section-number">11.5</span> A 2-way ANOVA on a fish behaviour study</a>
<ul>
<li><a href="11-5-a-2-way-anova-on-a-fish-behaviour-study.html#background-1"><span class="toc-section-number">11.5.1</span> Background</a></li>
<li><a href="8-10-exercises-randomisation-tests.html#your-task"><span class="toc-section-number">11.5.2</span> Your task</a></li>
</ul></li>
</ul></li>
<li><a href="12-linear-models-with-a-single-continuous-explanatory-variable.html#linear-models-with-a-single-continuous-explanatory-variable"><span class="toc-section-number">12</span> Linear models with a single continuous explanatory variable</a>
<ul>
<li><a href="2-12-exercises-getting-acquainted-with-r.html#background"><span class="toc-section-number">12.1</span> Background</a></li>
<li><a href="12-2-some-theory.html#some-theory"><span class="toc-section-number">12.2</span> Some theory</a></li>
<li><a href="12-3-evaluating-a-hypothesis-with-a-linear-regression-model.html#evaluating-a-hypothesis-with-a-linear-regression-model"><span class="toc-section-number">12.3</span> Evaluating a hypothesis with a linear regression model</a></li>
<li><a href="12-4-assumptions.html#assumptions"><span class="toc-section-number">12.4</span> Assumptions</a></li>
<li><a href="12-5-an-example-using-r.html#an-example-using-r"><span class="toc-section-number">12.5</span> An example using R</a></li>
<li><a href="12-6-exercises-linear-regression.html#exercises---linear-regression"><span class="toc-section-number">12.6</span> Exercises - Linear Regression</a>
<ul>
<li><a href="11-5-a-2-way-anova-on-a-fish-behaviour-study.html#background-1"><span class="toc-section-number">12.6.1</span> Background</a></li>
<li><a href="8-10-exercises-randomisation-tests.html#your-task"><span class="toc-section-number">12.6.2</span> Your task</a></li>
</ul></li>
</ul></li>
<li><a href="13-linear-models-with-categorical-and-continuous-explanatory-variables.html#linear-models-with-categorical-and-continuous-explanatory-variables"><span class="toc-section-number">13</span> Linear models with categorical and continuous explanatory variables</a>
<ul>
<li><a href="2-12-exercises-getting-acquainted-with-r.html#background"><span class="toc-section-number">13.1</span> Background</a></li>
<li><a href="13-2-the-height-hand-width-example-.html#the-height-hand-width-example."><span class="toc-section-number">13.2</span> The height ~ hand width example.</a></li>
<li><a href="13-3-summarising-with-anova.html#summarising-with-anova"><span class="toc-section-number">13.3</span> Summarising with <code>anova</code></a></li>
<li><a href="13-4-the-summary-of-coefficients-summary.html#the-summary-of-coefficients-summary"><span class="toc-section-number">13.4</span> The summary of coefficients (<code>summary</code>)</a></li>
<li><a href="13-5-simplifying-the-model.html#simplifying-the-model"><span class="toc-section-number">13.5</span> Simplifying the model</a></li>
</ul></li>
<li><a href="14-generalised-linear-models.html#generalised-linear-models"><span class="toc-section-number">14</span> Generalised linear models</a>
<ul>
<li><a href="14-1-count-data-with-poisson-errors-.html#count-data-with-poisson-errors."><span class="toc-section-number">14.1</span> Count data with Poisson errors.</a>
<ul>
<li><a href="14-1-count-data-with-poisson-errors-.html#example-number-of-offspring-in-foxes."><span class="toc-section-number">14.1.1</span> Example: Number of offspring in foxes.</a></li>
<li><a href="14-1-count-data-with-poisson-errors-.html#example-cancer-clusters"><span class="toc-section-number">14.1.2</span> Example: Cancer clusters</a></li>
</ul></li>
</ul></li>
<li><a href="15-extending-use-cases-of-glm.html#extending-use-cases-of-glm"><span class="toc-section-number">15</span> Extending use cases of GLM</a>
<ul>
<li><a href="15-1-logistic-regression-with-binary-01-data.html#logistic-regression-with-binary-01-data"><span class="toc-section-number">15.1</span> Logistic regression with binary (0/1) data</a></li>
<li><a href="15-2-example-species-presenceabsence-data.html#example-species-presenceabsence-data"><span class="toc-section-number">15.2</span> Example: species presence/absence data</a></li>
<li><a href="15-3-binomial-regression-with-proportionratio-data.html#binomial-regression-with-proportionratio-data"><span class="toc-section-number">15.3</span> Binomial regression with proportion/ratio data</a>
<ul>
<li><a href="15-3-binomial-regression-with-proportionratio-data.html#example-sex-ratios"><span class="toc-section-number">15.3.1</span> Example: sex ratios</a></li>
</ul></li>
</ul></li>
<li><a href="16-power-and-study-design.html#power-and-study-design"><span class="toc-section-number">16</span> Power and study design</a>
<ul>
<li><a href="16-1-power-analysis-by-simulation.html#power-analysis-by-simulation"><span class="toc-section-number">16.1</span> Power analysis by simulation</a></li>
</ul></li>
<li class="part"><span><b>IV Coming soon(ish)</b></span></li>
<li><a href="17-coming-soon-maybe.html#coming-soon-maybe"><span class="toc-section-number">17</span> Coming soon (maybe)!</a>
<ul>
<li><a href="17-1-multivariate-statistics.html#multivariate-statistics"><span class="toc-section-number">17.1</span> Multivariate statistics</a></li>
<li><a href="17-2-transforming-variables.html#transforming-variables"><span class="toc-section-number">17.2</span> Transforming variables</a></li>
<li><a href="17-3-non-linear-regression.html#non-linear-regression"><span class="toc-section-number">17.3</span> Non-linear regression</a></li>
<li><a href="17-4-nested-or-blocked-study-designs.html#nested-or-blocked-study-designs"><span class="toc-section-number">17.4</span> Nested or blocked study designs</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="anova-calculation-by-hand-optional" class="section level2" number="10.6">
<h2><span class="header-section-number">10.6</span> ANOVA calculation “by hand” (optional)</h2>
<p>The ANOVA calculation involves calculating something called an F-value or F-statistic (the F stands for Fisher, who invented ANOVA). This is similar to the t-statistic in that it is a ratio between two quantities, in this case variances. In ANOVA, the F-statistic is calculated as the “<strong>treatment variance</strong>” divided by the “<strong>error variance</strong>”.</p>
<p>What does that mean? Let’s consider the espresso data set again.</p>
<p>In the Figure , you can see on the left (A) the black horizontal line which is the overall mean foam index. The vertical lines are the “errors” or departures from the overall mean value, colour coded by treatment (i.e. method). These can be quantified by summing up their square values (squaring ensures that the summed values are all positive). We call this quantity the <em>Total Sum of Squares (SSTotal)</em>. If there is a lot of variation, the sum of squares will be large, if there is little variation the sum of squares will be small.</p>
<p>On the right hand side (Figure B) we see the same data points. However, this time the horizontal lines represent the treatment-specific mean values, and the vertical lines illustrate the errors from these mean values. Again we can sum up these as sum of squares, which we call the <em>Error Sum of Squares (SSError)</em>.</p>
<p>The difference between those values is called the <em>Treatment Sum of Squares (SSTreatment)</em> and is the key to ANOVA - it represents the importance of the treatment: <span class="math display">\[SSTreatment = SSTotal - SSError\]</span>.</p>
<p>If that doesn’t make sense yet, picture the case where the treatment-specific means are all very similar, and are therefore very close to the overall mean. Now the difference between the <em>Total Sum of Squares</em> and the <em>Error Sum of Squares</em> will be small. Sketch out a couple of examples with pen on paper if that helps. You should now see that you can investigate differences among means by looking at variation.</p>
<pre><code>## [1] 44.46667</code></pre>
<div class="figure" style="text-align: center"><span id="fig:ANOVAbyhand"></span>
<img src="BB852_files/figure-html/ANOVAbyhand-1.png" alt="The relative size of the squared residual errors from the overall mean (SSTotal) (A) and from the treatment-specific means (SSError) (B) tell us about the importance of the treatment variable. The difference between the two values is the &quot;treatment sum of squares&quot;." width="768" />
<p class="caption">
Figure 10.4: The relative size of the squared residual errors from the overall mean (SSTotal) (A) and from the treatment-specific means (SSError) (B) tell us about the importance of the treatment variable. The difference between the two values is the “treatment sum of squares”.
</p>
</div>
<p>In the following I will show how these calculations can be done “by hand” in R. The purpose of showing you this is to demonstrate exactly how the <code>lm</code> model that you fitted above works, and prove to yourself that it is not rocket science… you will never need to do this in real life, because you have the wonderful <code>lm</code> function.</p>
<p>Here goes…</p>
<p>First, calculate the total sum of squares:</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="10-6-anova-calculation-by-hand-optional.html#cb343-1" aria-hidden="true"></a>(<span class="dt">SSTotal =</span> <span class="kw">sum</span>((overallMean<span class="op">-</span>espresso<span class="op">$</span>foamIndx)<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 5782.099</code></pre>
<p>Now calculate the group-specific means:</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="10-6-anova-calculation-by-hand-optional.html#cb345-1" aria-hidden="true"></a>(groupMeans&lt;-espresso <span class="op">%&gt;%</span></span>
<span id="cb345-2"><a href="10-6-anova-calculation-by-hand-optional.html#cb345-2" aria-hidden="true"></a><span class="kw">group_by</span>(method) <span class="op">%&gt;%</span></span>
<span id="cb345-3"><a href="10-6-anova-calculation-by-hand-optional.html#cb345-3" aria-hidden="true"></a><span class="kw">summarise</span>(<span class="dt">groupMean =</span> <span class="kw">mean</span>(foamIndx)) <span class="op">%&gt;%</span></span>
<span id="cb345-4"><a href="10-6-anova-calculation-by-hand-optional.html#cb345-4" aria-hidden="true"></a><span class="kw">pull</span>(groupMean))</span></code></pre></div>
<pre><code>## [1] 32.4 61.3 39.7</code></pre>
<p>Now add those group-specific mean values to the dataset using <code>left_join</code> so that you can calculate the group-specific errors.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="10-6-anova-calculation-by-hand-optional.html#cb347-1" aria-hidden="true"></a>espresso &lt;-<span class="st"> </span><span class="kw">left_join</span>(espresso,espresso <span class="op">%&gt;%</span></span>
<span id="cb347-2"><a href="10-6-anova-calculation-by-hand-optional.html#cb347-2" aria-hidden="true"></a><span class="st">                        </span><span class="kw">group_by</span>(method) <span class="op">%&gt;%</span></span>
<span id="cb347-3"><a href="10-6-anova-calculation-by-hand-optional.html#cb347-3" aria-hidden="true"></a><span class="st">                        </span><span class="kw">summarise</span>(<span class="dt">groupMean =</span> <span class="kw">mean</span>(foamIndx))) <span class="op">%&gt;%</span></span>
<span id="cb347-4"><a href="10-6-anova-calculation-by-hand-optional.html#cb347-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">groupSS =</span> (foamIndx <span class="op">-</span><span class="st"> </span>groupMean)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb347-5"><a href="10-6-anova-calculation-by-hand-optional.html#cb347-5" aria-hidden="true"></a></span>
<span id="cb347-6"><a href="10-6-anova-calculation-by-hand-optional.html#cb347-6" aria-hidden="true"></a><span class="kw">head</span>(espresso)</span></code></pre></div>
<pre><code>##   foamIndx method groupMean  groupSS
## 1    36.64     BM      32.4  17.9776
## 2    39.65     BM      32.4  52.5625
## 3    37.74     BM      32.4  28.5156
## 4    35.96     BM      32.4  12.6736
## 5    38.52     BM      32.4  37.4544
## 6    21.02     BM      32.4 129.5044</code></pre>
<p>Then, to calculate the errors:</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="10-6-anova-calculation-by-hand-optional.html#cb349-1" aria-hidden="true"></a>(SSError &lt;-<span class="st"> </span>espresso <span class="op">%&gt;%</span></span>
<span id="cb349-2"><a href="10-6-anova-calculation-by-hand-optional.html#cb349-2" aria-hidden="true"></a><span class="kw">summarise</span>(<span class="kw">sum</span>(groupSS)) <span class="op">%&gt;%</span></span>
<span id="cb349-3"><a href="10-6-anova-calculation-by-hand-optional.html#cb349-3" aria-hidden="true"></a><span class="kw">pull</span>())</span></code></pre></div>
<pre><code>## [1] 1716.919</code></pre>
<p>From there, you can calculate the <strong>Treatment Sum of Squares</strong></p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="10-6-anova-calculation-by-hand-optional.html#cb351-1" aria-hidden="true"></a>(SSTreatment &lt;-<span class="st"> </span>SSTotal <span class="op">-</span><span class="st"> </span>SSError)</span></code></pre></div>
<pre><code>## [1] 4065.18</code></pre>
<p>So far, so good - but we can’t just look at the ratio of SSTreatment/SSError, because sum of square errors always increase with sample size. We can account for this by dividing</p>
<p>We need to take account of sample size (degrees of freedom) by dividing these sum of squares by the degrees of freedom to give us variances. There are 3 treatment groups and 9 samples per group. Therefore there are 2 degrees of freedom for the treatment, and 8 degrees of freedom per each of the three treatments, giving a total of 8*3 = 24 error degrees of freedom.</p>
<p>Now we need to correct for degrees of freedom, which will give us variances.</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="10-6-anova-calculation-by-hand-optional.html#cb353-1" aria-hidden="true"></a>(meanSSTreatment &lt;-<span class="st"> </span>SSTreatment<span class="op">/</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 2032.59</code></pre>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="10-6-anova-calculation-by-hand-optional.html#cb355-1" aria-hidden="true"></a>(meanSSError &lt;-<span class="st"> </span>SSError<span class="op">/</span><span class="dv">24</span>)</span></code></pre></div>
<pre><code>## [1] 71.5383</code></pre>
<p>The F-statistic is then the ratio of these values.</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="10-6-anova-calculation-by-hand-optional.html#cb357-1" aria-hidden="true"></a>(Fstat &lt;-<span class="st"> </span>meanSSTreatment<span class="op">/</span>meanSSError)</span></code></pre></div>
<pre><code>## [1] 28.41261</code></pre>
<p>We can “look up” the p-value associated with this F-statistic using the <code>pf</code> function (<code>pf</code> stands for probability of f) like this:</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="10-6-anova-calculation-by-hand-optional.html#cb359-1" aria-hidden="true"></a><span class="dv">1</span><span class="op">-</span><span class="kw">pf</span>(Fstat,<span class="dt">df1=</span><span class="dv">2</span>,<span class="dt">df2=</span><span class="dv">24</span>)</span></code></pre></div>
<pre><code>## [1] 4.698636e-07</code></pre>
<p>As you can see, the method is a bit laborious and time consuming but it is conceptually fairly straightforward - it all hinges on the ratio of variation due to treatment effect vs. overall variation. Signal and noise.</p>
<!-- the following is some code to make a plot with shuffled data as an illustration of how the ANOVA works --->

</div>
<!-- </div> -->
<p style="text-align: center;">
<a href="10-5-tukeys-honestly-significant-difference-hsd.html"><button class="btn btn-default">Previous</button></a>
<a href="11-linear-models-with-a-several-categorical-explanatory-variables.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
