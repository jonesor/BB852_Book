<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="15.3 Binomial regression with proportion/ratio data | BB852 - Data handling, visualisation and statistics" />
<meta property="og:type" content="book" />


<meta property="og:description" content="This is the course book for BB852." />


<meta name="author" content="Owen Jones" />

<meta name="date" content="2020-08-26" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>

<meta name="description" content="This is the course book for BB852.">

<title>15.3 Binomial regression with proportion/ratio data | BB852 - Data handling, visualisation and statistics</title>

<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#preface"><span class="toc-section-number">1</span> Preface</a>
<ul>
<li><a href="1-1-data-wrangling.html#data-wrangling"><span class="toc-section-number">1.1</span> Data wrangling</a></li>
<li><a href="1-2-data-visualisation.html#data-visualisation"><span class="toc-section-number">1.2</span> Data visualisation</a></li>
<li><a href="1-3-statistics.html#statistics"><span class="toc-section-number">1.3</span> Statistics</a></li>
<li><a href="1-4-general-approach.html#general-approach"><span class="toc-section-number">1.4</span> General approach</a></li>
<li><a href="1-5-data-sources.html#data-sources"><span class="toc-section-number">1.5</span> Data sources</a></li>
<li><a href="1-6-acknowledgements.html#acknowledgements"><span class="toc-section-number">1.6</span> Acknowledgements</a></li>
<li><a href="1-7-error-reporting.html#error-reporting"><span class="toc-section-number">1.7</span> Error reporting</a></li>
</ul></li>
<li><a href="2-getting-acquainted-with-r.html#getting-acquainted-with-r"><span class="toc-section-number">2</span> Getting acquainted with R</a>
<ul>
<li><a href="2-1-introduction.html#introduction"><span class="toc-section-number">2.1</span> Introduction</a></li>
<li><a href="2-2-getting-started-with-r.html#getting-started-with-r"><span class="toc-section-number">2.2</span> Getting started with R</a></li>
<li><a href="2-3-getting-help.html#getting-help"><span class="toc-section-number">2.3</span> Getting help</a></li>
<li><a href="2-4-r-as-a-fancy-calculator.html#r-as-a-fancy-calculator"><span class="toc-section-number">2.4</span> R as a fancy calculator</a></li>
<li><a href="2-5-objects-in-r.html#objects-in-r"><span class="toc-section-number">2.5</span> Objects in R</a></li>
<li><a href="2-6-missing-values-infinity-and-non-numbers.html#missing-values-infinity-and-non-numbers"><span class="toc-section-number">2.6</span> Missing values, infinity and “non-numbers”</a></li>
<li><a href="2-7-basic-information-about-objects.html#basic-information-about-objects"><span class="toc-section-number">2.7</span> Basic information about objects</a></li>
<li><a href="2-8-data-frames.html#data-frames"><span class="toc-section-number">2.8</span> Data frames</a></li>
<li><a href="2-9-classes-in-r.html#classes-in-r"><span class="toc-section-number">2.9</span> Classes in R</a></li>
<li><a href="2-10-tables-and-summary-statistics.html#tables-and-summary-statistics"><span class="toc-section-number">2.10</span> Tables and summary statistics</a></li>
<li><a href="2-11-plotting-data.html#plotting-data"><span class="toc-section-number">2.11</span> Plotting data</a></li>
<li><a href="2-12-exercises-getting-acquainted-with-r.html#exercises---getting-acquainted-with-r"><span class="toc-section-number">2.12</span> Exercises - Getting acquainted with R</a>
<ul>
<li><a href="2-12-exercises-getting-acquainted-with-r.html#background"><span class="toc-section-number">2.12.1</span> Background</a></li>
<li><a href="2-12-exercises-getting-acquainted-with-r.html#the-data"><span class="toc-section-number">2.12.2</span> The data</a></li>
<li><a href="2-12-exercises-getting-acquainted-with-r.html#try-the-following"><span class="toc-section-number">2.12.3</span> Try the following</a></li>
<li><a href="2-12-exercises-getting-acquainted-with-r.html#references"><span class="toc-section-number">2.12.4</span> References</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Wrangling</b></span></li>
<li><a href="3-data-wrangling-with-dplyr.html#data-wrangling-with-dplyr"><span class="toc-section-number">3</span> Data wrangling with dplyr</a>
<ul>
<li><a href="2-1-introduction.html#introduction"><span class="toc-section-number">3.1</span> Introduction</a></li>
<li><a href="3-2-select.html#select"><span class="toc-section-number">3.2</span> select</a></li>
<li><a href="3-3-filter.html#filter"><span class="toc-section-number">3.3</span> filter</a></li>
<li><a href="3-4-arrange.html#arrange"><span class="toc-section-number">3.4</span> arrange</a></li>
<li><a href="3-5-summarise-and-group-by.html#summarise-and-group_by"><span class="toc-section-number">3.5</span> summarise and group_by</a></li>
<li><a href="3-6-using-pipes-saving-data-.html#using-pipes-saving-data."><span class="toc-section-number">3.6</span> Using pipes, saving data.</a></li>
<li><a href="3-7-exercises-data-wrangling.html#exercises---data-wrangling"><span class="toc-section-number">3.7</span> Exercises - data wrangling</a>
<ul>
<li><a href="3-7-exercises-data-wrangling.html#exploring-the-amniote-life-history-database"><span class="toc-section-number">3.7.1</span> Exploring the Amniote Life History Database</a></li>
</ul></li>
</ul></li>
<li><a href="4-combining-data-sets.html#combining-data-sets"><span class="toc-section-number">4</span> Combining data sets</a>
<ul>
<li><a href="4-1-exercise-joining-datasets.html#exercise---joining-datasets"><span class="toc-section-number">4.1</span> Exercise - joining datasets</a>
<ul>
<li><a href="2-12-exercises-getting-acquainted-with-r.html#the-data"><span class="toc-section-number">4.1.1</span> The data</a></li>
<li><a href="4-1-exercise-joining-datasets.html#the-bird-data"><span class="toc-section-number">4.1.2</span> The bird data</a></li>
<li><a href="4-1-exercise-joining-datasets.html#the-weather-data"><span class="toc-section-number">4.1.3</span> The weather data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Data visualisation</b></span></li>
<li><a href="5-visualising-data-with-ggplot2.html#visualising-data-with-ggplot2"><span class="toc-section-number">5</span> Visualising data with ggplot2</a>
<ul>
<li><a href="2-1-introduction.html#introduction"><span class="toc-section-number">5.1</span> Introduction</a></li>
<li><a href="5-2-histograms.html#histograms"><span class="toc-section-number">5.2</span> Histograms</a></li>
<li><a href="5-3-facets-splitting-data-across-panels.html#facets---splitting-data-across-panels"><span class="toc-section-number">5.3</span> “Facets” - splitting data across panels</a></li>
<li><a href="5-4-box-plots.html#box-plots"><span class="toc-section-number">5.4</span> box plots</a></li>
<li><a href="5-5-lines-and-points.html#lines-and-points"><span class="toc-section-number">5.5</span> lines and points</a></li>
<li><a href="5-6-scatter-plot.html#scatter-plot"><span class="toc-section-number">5.6</span> scatter plot</a></li>
</ul></li>
<li><a href="6-distributions-and-summarising-data.html#distributions-and-summarising-data"><span class="toc-section-number">6</span> Distributions and summarising data</a>
<ul>
<li><a href="2-1-introduction.html#introduction"><span class="toc-section-number">6.1</span> Introduction</a></li>
<li><a href="6-2-distributions.html#distributions"><span class="toc-section-number">6.2</span> Distributions</a></li>
<li><a href="6-3-normal-distribution.html#normal-distribution"><span class="toc-section-number">6.3</span> Normal distribution</a></li>
<li><a href="6-4-compare-normal-distributions.html#compare-normal-distributions"><span class="toc-section-number">6.4</span> Compare normal distributions</a></li>
<li><a href="6-5-the-poisson-distribution.html#the-poisson-distribution"><span class="toc-section-number">6.5</span> The Poisson distribution</a></li>
<li><a href="6-6-comparing-normal-and-poisson-distributions.html#comparing-normal-and-poisson-distributions"><span class="toc-section-number">6.6</span> Comparing normal and Poisson distributions</a></li>
</ul></li>
<li><a href="7-customising-your-plots.html#customising-your-plots"><span class="toc-section-number">7</span> Customising your plots</a>
<ul>
<li><a href="2-1-introduction.html#introduction"><span class="toc-section-number">7.1</span> Introduction</a></li>
<li><a href="7-2-a-basic-plot.html#a-basic-plot"><span class="toc-section-number">7.2</span> A basic plot</a></li>
<li><a href="7-3-axis-limits.html#axis-limits"><span class="toc-section-number">7.3</span> Axis limits</a></li>
<li><a href="7-4-transforming-the-axis-log-scale.html#transforming-the-axis-log-scale"><span class="toc-section-number">7.4</span> Transforming the axis (log scale)</a></li>
<li><a href="7-5-changing-the-axis-tick-marks.html#changing-the-axis-tick-marks"><span class="toc-section-number">7.5</span> Changing the axis tick marks</a></li>
<li><a href="7-6-axis-labels.html#axis-labels"><span class="toc-section-number">7.6</span> Axis labels</a></li>
<li><a href="7-7-colours.html#colours"><span class="toc-section-number">7.7</span> Colours</a></li>
<li><a href="7-8-themes.html#themes"><span class="toc-section-number">7.8</span> Themes</a></li>
<li><a href="7-9-moving-the-legend.html#moving-the-legend"><span class="toc-section-number">7.9</span> Moving the legend</a></li>
<li><a href="7-10-combining-multiple-plots.html#combining-multiple-plots"><span class="toc-section-number">7.10</span> Combining multiple plots</a></li>
<li><a href="7-11-saving-your-plot.html#saving-your-plot"><span class="toc-section-number">7.11</span> Saving your plot</a></li>
<li><a href="7-12-final-word-on-plots.html#final-word-on-plots"><span class="toc-section-number">7.12</span> Final word on plots</a></li>
</ul></li>
<li class="part"><span><b>III Statistics</b></span></li>
<li><a href="8-randomisation-tests.html#randomisation-tests"><span class="toc-section-number">8</span> Randomisation Tests</a>
<ul>
<li><a href="2-1-introduction.html#introduction"><span class="toc-section-number">8.1</span> Introduction</a></li>
<li><a href="8-2-the-example.html#the-example"><span class="toc-section-number">8.2</span> The example</a></li>
<li><a href="8-3-setting-up.html#setting-up"><span class="toc-section-number">8.3</span> Setting up</a></li>
<li><a href="8-4-calculate-the-observed-difference.html#calculate-the-observed-difference"><span class="toc-section-number">8.4</span> Calculate the observed difference</a></li>
<li><a href="8-5-null-distribution.html#null-distribution"><span class="toc-section-number">8.5</span> Null distribution</a></li>
<li><a href="8-6-testing-significance.html#testing-significance"><span class="toc-section-number">8.6</span> Testing significance</a></li>
<li><a href="8-7-testing-the-hypothesis.html#testing-the-hypothesis"><span class="toc-section-number">8.7</span> Testing the hypothesis</a></li>
<li><a href="8-8-writing-it-up.html#writing-it-up"><span class="toc-section-number">8.8</span> Writing it up</a></li>
<li><a href="8-9-paired-randomisation-tests.html#paired-randomisation-tests"><span class="toc-section-number">8.9</span> Paired Randomisation Tests</a>
<ul>
<li><a href="8-9-paired-randomisation-tests.html#plot-the-data"><span class="toc-section-number">8.9.1</span> Plot the data</a></li>
<li><a href="8-9-paired-randomisation-tests.html#the-paired-randomisation-test"><span class="toc-section-number">8.9.2</span> The paired randomisation test</a></li>
<li><a href="8-9-paired-randomisation-tests.html#plot-the-null-distribution"><span class="toc-section-number">8.9.3</span> Plot the null distribution</a></li>
<li><a href="8-9-paired-randomisation-tests.html#the-formal-hypothesis-test"><span class="toc-section-number">8.9.4</span> The formal hypothesis test</a></li>
</ul></li>
<li><a href="8-10-exercises-randomisation-tests.html#exercises---randomisation-tests"><span class="toc-section-number">8.10</span> Exercises - Randomisation tests</a>
<ul>
<li><a href="8-10-exercises-randomisation-tests.html#introduction-1"><span class="toc-section-number">8.10.1</span> Introduction</a></li>
<li><a href="8-10-exercises-randomisation-tests.html#your-task"><span class="toc-section-number">8.10.2</span> Your task</a></li>
</ul></li>
</ul></li>
<li><a href="9-comparing-two-means-with-a-t-test.html#comparing-two-means-with-a-t-test"><span class="toc-section-number">9</span> Comparing two means with a t-test</a>
<ul>
<li><a href="9-1-some-theory-.html#some-theory."><span class="toc-section-number">9.1</span> Some theory.</a></li>
<li><a href="9-2-one-sample-t-test.html#one-sample-t-test"><span class="toc-section-number">9.2</span> One sample t-test</a></li>
<li><a href="9-3-doing-it-by-hand-where-does-the-t-statistic-come-from.html#doing-it-by-hand---where-does-the-t-statistic-come-from"><span class="toc-section-number">9.3</span> Doing it “by hand” - where does the t-statistic come from?</a></li>
<li><a href="9-4-paired-t-test.html#paired-t-test"><span class="toc-section-number">9.4</span> Paired t-test</a></li>
<li><a href="9-5-a-paired-t-test-is-a-one-sample-test-.html#a-paired-t-test-is-a-one-sample-test."><span class="toc-section-number">9.5</span> A paired t-test is a one-sample test.</a></li>
<li><a href="9-6-two-sample-t-test.html#two-sample-t-test"><span class="toc-section-number">9.6</span> Two sample t-test</a></li>
<li><a href="9-7-t-tests-are-linear-models.html#t-tests-are-linear-models"><span class="toc-section-number">9.7</span> t-tests are linear models</a></li>
<li><a href="9-8-exercises-two-sample-t-test.html#exercises---two-sample-t-test"><span class="toc-section-number">9.8</span> Exercises - Two-sample t-test</a>
<ul>
<li><a href="9-8-exercises-two-sample-t-test.html#paired-t-test-1"><span class="toc-section-number">9.8.1</span> Paired t-test</a></li>
<li><a href="9-8-exercises-two-sample-t-test.html#optional-extra."><span class="toc-section-number">9.8.2</span> Optional extra.</a></li>
</ul></li>
</ul></li>
<li><a href="10-linear-models-with-a-single-categorical-explanatory-variable.html#linear-models-with-a-single-categorical-explanatory-variable"><span class="toc-section-number">10</span> Linear models with a single categorical explanatory variable</a>
<ul>
<li><a href="2-1-introduction.html#introduction"><span class="toc-section-number">10.1</span> Introduction</a></li>
<li><a href="10-2-one-way-anova.html#one-way-anova"><span class="toc-section-number">10.2</span> One-way ANOVA</a></li>
<li><a href="10-3-fitting-an-anova-in-r.html#fitting-an-anova-in-r"><span class="toc-section-number">10.3</span> Fitting an ANOVA in R</a></li>
<li><a href="10-4-where-are-the-differences.html#where-are-the-differences"><span class="toc-section-number">10.4</span> Where are the differences?</a></li>
<li><a href="10-5-tukeys-honestly-significant-difference-hsd.html#tukeys-honestly-significant-difference-hsd"><span class="toc-section-number">10.5</span> Tukey’s Honestly Significant Difference (HSD)</a></li>
<li><a href="10-6-anova-calculation-by-hand-optional.html#anova-calculation-by-hand-optional"><span class="toc-section-number">10.6</span> ANOVA calculation “by hand” (optional)</a></li>
</ul></li>
<li><a href="11-linear-models-with-a-several-categorical-explanatory-variables.html#linear-models-with-a-several-categorical-explanatory-variables"><span class="toc-section-number">11</span> Linear models with a several categorical explanatory variables</a>
<ul>
<li><a href="2-12-exercises-getting-acquainted-with-r.html#background"><span class="toc-section-number">11.1</span> Background</a></li>
<li><a href="11-2-fitting-a-two-way-anova-model.html#fitting-a-two-way-anova-model"><span class="toc-section-number">11.2</span> Fitting a two-way ANOVA model</a></li>
<li><a href="11-3-summarising-the-model-anova.html#summarising-the-model-anova"><span class="toc-section-number">11.3</span> Summarising the model (<code>anova</code>)</a></li>
<li><a href="11-4-summarising-the-model-summary.html#summarising-the-model-summary"><span class="toc-section-number">11.4</span> Summarising the model (<code>summary</code>)</a></li>
<li><a href="11-5-a-2-way-anova-on-a-fish-behaviour-study.html#a-2-way-anova-on-a-fish-behaviour-study"><span class="toc-section-number">11.5</span> A 2-way ANOVA on a fish behaviour study</a>
<ul>
<li><a href="11-5-a-2-way-anova-on-a-fish-behaviour-study.html#background-1"><span class="toc-section-number">11.5.1</span> Background</a></li>
<li><a href="8-10-exercises-randomisation-tests.html#your-task"><span class="toc-section-number">11.5.2</span> Your task</a></li>
</ul></li>
</ul></li>
<li><a href="12-linear-models-with-a-single-continuous-explanatory-variable.html#linear-models-with-a-single-continuous-explanatory-variable"><span class="toc-section-number">12</span> Linear models with a single continuous explanatory variable</a>
<ul>
<li><a href="2-12-exercises-getting-acquainted-with-r.html#background"><span class="toc-section-number">12.1</span> Background</a></li>
<li><a href="12-2-some-theory.html#some-theory"><span class="toc-section-number">12.2</span> Some theory</a></li>
<li><a href="12-3-evaluating-a-hypothesis-with-a-linear-regression-model.html#evaluating-a-hypothesis-with-a-linear-regression-model"><span class="toc-section-number">12.3</span> Evaluating a hypothesis with a linear regression model</a></li>
<li><a href="12-4-assumptions.html#assumptions"><span class="toc-section-number">12.4</span> Assumptions</a></li>
<li><a href="12-5-an-example-using-r.html#an-example-using-r"><span class="toc-section-number">12.5</span> An example using R</a></li>
<li><a href="12-6-exercises-linear-regression.html#exercises---linear-regression"><span class="toc-section-number">12.6</span> Exercises - Linear Regression</a>
<ul>
<li><a href="11-5-a-2-way-anova-on-a-fish-behaviour-study.html#background-1"><span class="toc-section-number">12.6.1</span> Background</a></li>
<li><a href="8-10-exercises-randomisation-tests.html#your-task"><span class="toc-section-number">12.6.2</span> Your task</a></li>
</ul></li>
</ul></li>
<li><a href="13-linear-models-with-categorical-and-continuous-explanatory-variables.html#linear-models-with-categorical-and-continuous-explanatory-variables"><span class="toc-section-number">13</span> Linear models with categorical and continuous explanatory variables</a>
<ul>
<li><a href="2-12-exercises-getting-acquainted-with-r.html#background"><span class="toc-section-number">13.1</span> Background</a></li>
<li><a href="13-2-the-height-hand-width-example-.html#the-height-hand-width-example."><span class="toc-section-number">13.2</span> The height ~ hand width example.</a></li>
<li><a href="13-3-summarising-with-anova.html#summarising-with-anova"><span class="toc-section-number">13.3</span> Summarising with <code>anova</code></a></li>
<li><a href="13-4-the-summary-of-coefficients-summary.html#the-summary-of-coefficients-summary"><span class="toc-section-number">13.4</span> The summary of coefficients (<code>summary</code>)</a></li>
<li><a href="13-5-simplifying-the-model.html#simplifying-the-model"><span class="toc-section-number">13.5</span> Simplifying the model</a></li>
</ul></li>
<li><a href="14-generalised-linear-models.html#generalised-linear-models"><span class="toc-section-number">14</span> Generalised linear models</a>
<ul>
<li><a href="14-1-count-data-with-poisson-errors-.html#count-data-with-poisson-errors."><span class="toc-section-number">14.1</span> Count data with Poisson errors.</a>
<ul>
<li><a href="14-1-count-data-with-poisson-errors-.html#example-number-of-offspring-in-foxes."><span class="toc-section-number">14.1.1</span> Example: Number of offspring in foxes.</a></li>
<li><a href="14-1-count-data-with-poisson-errors-.html#example-cancer-clusters"><span class="toc-section-number">14.1.2</span> Example: Cancer clusters</a></li>
</ul></li>
</ul></li>
<li><a href="15-extending-use-cases-of-glm.html#extending-use-cases-of-glm"><span class="toc-section-number">15</span> Extending use cases of GLM</a>
<ul>
<li><a href="15-1-logistic-regression-with-binary-01-data.html#logistic-regression-with-binary-01-data"><span class="toc-section-number">15.1</span> Logistic regression with binary (0/1) data</a></li>
<li><a href="15-2-example-species-presenceabsence-data.html#example-species-presenceabsence-data"><span class="toc-section-number">15.2</span> Example: species presence/absence data</a></li>
<li><a href="15-3-binomial-regression-with-proportionratio-data.html#binomial-regression-with-proportionratio-data"><span class="toc-section-number">15.3</span> Binomial regression with proportion/ratio data</a>
<ul>
<li><a href="15-3-binomial-regression-with-proportionratio-data.html#example-sex-ratios"><span class="toc-section-number">15.3.1</span> Example: sex ratios</a></li>
</ul></li>
</ul></li>
<li><a href="16-power-and-study-design.html#power-and-study-design"><span class="toc-section-number">16</span> Power and study design</a>
<ul>
<li><a href="16-1-power-analysis-by-simulation.html#power-analysis-by-simulation"><span class="toc-section-number">16.1</span> Power analysis by simulation</a></li>
</ul></li>
<li class="part"><span><b>IV Coming soon(ish)</b></span></li>
<li><a href="17-coming-soon-maybe.html#coming-soon-maybe"><span class="toc-section-number">17</span> Coming soon (maybe)!</a>
<ul>
<li><a href="17-1-multivariate-statistics.html#multivariate-statistics"><span class="toc-section-number">17.1</span> Multivariate statistics</a></li>
<li><a href="17-2-transforming-variables.html#transforming-variables"><span class="toc-section-number">17.2</span> Transforming variables</a></li>
<li><a href="17-3-non-linear-regression.html#non-linear-regression"><span class="toc-section-number">17.3</span> Non-linear regression</a></li>
<li><a href="17-4-nested-or-blocked-study-designs.html#nested-or-blocked-study-designs"><span class="toc-section-number">17.4</span> Nested or blocked study designs</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="binomial-regression-with-proportionratio-data" class="section level2" number="15.3">
<h2><span class="header-section-number">15.3</span> Binomial regression with proportion/ratio data</h2>
<p>Another important class of binomial data is proportion or success/failure data. These data are characterised by the fact that we have information on how many times an event occurred <em>and</em> how many times it did <em>not</em> occur. These data include infection rates of diseases, sex ratios, percentage mortality etc. These data are bounded in a similar way to the data above, and are also best-analysed using binomial errors.</p>
<ul>
<li>Can you think of any other examples of this kind of data?</li>
</ul>
<div id="example-sex-ratios" class="section level3" number="15.3.1">
<h3><span class="header-section-number">15.3.1</span> Example: sex ratios</h3>
<p>In the following example we will look at data from an experiment on sex ratios in an insect species. The experimenter wanted to know whether the population density at which the insect was held had a role in determining the sex ratio. Lets take a look at the data:</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="15-3-binomial-regression-with-proportionratio-data.html#cb424-1" aria-hidden="true"></a>sexRatio &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;CourseData/sexratio.csv&quot;</span>)</span>
<span id="cb424-2"><a href="15-3-binomial-regression-with-proportionratio-data.html#cb424-2" aria-hidden="true"></a><span class="kw">str</span>(sexRatio)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:	8 obs. of  3 variables:
##  $ density: int  1 4 10 22 55 121 210 444
##  $ females: int  1 3 7 18 22 41 52 79
##  $ males  : int  0 1 3 4 33 80 158 365</code></pre>
<p>You can see that the data are integer counts of males and females. In this case, the density is simply the sum of the females and males.</p>
<p>Let’s plot the data as proportion males to see if we can see any pattern. First we can need to add a new column with that information:</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="15-3-binomial-regression-with-proportionratio-data.html#cb426-1" aria-hidden="true"></a>sexRatio<span class="op">$</span>propMale &lt;-<span class="st"> </span>sexRatio<span class="op">$</span>males<span class="op">/</span>(sexRatio<span class="op">$</span>males<span class="op">+</span>sexRatio<span class="op">$</span>females)</span></code></pre></div>
<p>Now we can plot the data. In this case I use the <code>ylim</code> argument to specify that the y-axis should go from 0 to 1 (since this is a proportion).</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="15-3-binomial-regression-with-proportionratio-data.html#cb427-1" aria-hidden="true"></a><span class="kw">plot</span>(sexRatio<span class="op">$</span>density,sexRatio<span class="op">$</span>propMale,<span class="dt">ylab =</span> <span class="st">&quot;Proportion male&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-251"></span>
<img src="BB852_files/figure-html/unnamed-chunk-251-1.png" alt="Sex ratio as a function of density" width="672" />
<p class="caption">
Figure 15.1: Sex ratio as a function of density
</p>
</div>
<p>It looks like there is a relationship, and it is definitely non-linear so we are justified in using a GLM for the regression.
This regression is different from the last <code>binomial</code> GLM because we are not dealing with a simple 0 or 1 response. Instead we have a number in two catefories (male and female). These are analysed by binding (using the <code>cbind</code> function) the two vectors of male and female counts into a single object that we will use as the response variable.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="15-3-binomial-regression-with-proportionratio-data.html#cb428-1" aria-hidden="true"></a>y =<span class="st"> </span><span class="kw">cbind</span>(sexRatio<span class="op">$</span>males, sexRatio<span class="op">$</span>females)</span></code></pre></div>
<p>Lets have a look:</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="15-3-binomial-regression-with-proportionratio-data.html#cb429-1" aria-hidden="true"></a>y</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    0    1
## [2,]    1    3
## [3,]    3    7
## [4,]    4   18
## [5,]   33   22
## [6,]   80   41
## [7,]  158   52
## [8,]  365   79</code></pre>
<p>You can see that this is simply a matrix with two columns.</p>
<p>Now lets fit the model and take a look at the summary output:</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="15-3-binomial-regression-with-proportionratio-data.html#cb431-1" aria-hidden="true"></a>model &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>density, <span class="dt">data =</span> sexRatio,<span class="dt">family=</span>binomial)</span>
<span id="cb431-2"><a href="15-3-binomial-regression-with-proportionratio-data.html#cb431-2" aria-hidden="true"></a><span class="kw">summary</span>(model)  </span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = y ~ density, family = binomial, data = sexRatio)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.4619  -1.2760  -0.9911   0.5742   1.8795  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) 0.0807368  0.1550376   0.521    0.603    
## density     0.0035101  0.0005116   6.862 6.81e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 71.159  on 7  degrees of freedom
## Residual deviance: 22.091  on 6  degrees of freedom
## AIC: 54.618
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>We can now plot the data and the model’s fitted values through it:</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="15-3-binomial-regression-with-proportionratio-data.html#cb433-1" aria-hidden="true"></a><span class="kw">plot</span>(sexRatio<span class="op">$</span>density,sexRatio<span class="op">$</span>propMale,<span class="dt">ylab =</span> <span class="st">&quot;Proportion male&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb433-2"><a href="15-3-binomial-regression-with-proportionratio-data.html#cb433-2" aria-hidden="true"></a>newData &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">density =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">450</span>,<span class="dv">1</span>))</span>
<span id="cb433-3"><a href="15-3-binomial-regression-with-proportionratio-data.html#cb433-3" aria-hidden="true"></a>newData<span class="op">$</span>fit &lt;-<span class="st"> </span><span class="kw">predict</span>(model,newData,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb433-4"><a href="15-3-binomial-regression-with-proportionratio-data.html#cb433-4" aria-hidden="true"></a><span class="kw">lines</span>(newData<span class="op">$</span>density,newData<span class="op">$</span>fit,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-255-1.png" width="672" /></p>
<p>Hmmm. This doesn’t look so great. The model doesn’t really capture the initial increase in male sex ratio. Let’s see if we can improve it by logging the density variable before fitting.</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="15-3-binomial-regression-with-proportionratio-data.html#cb434-1" aria-hidden="true"></a>model2 &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(density), <span class="dt">data =</span> sexRatio,<span class="dt">family=</span>binomial)</span>
<span id="cb434-2"><a href="15-3-binomial-regression-with-proportionratio-data.html#cb434-2" aria-hidden="true"></a><span class="kw">summary</span>(model2)  </span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = y ~ log(density), family = binomial, data = sexRatio)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.9697  -0.3411   0.1499   0.4019   1.0372  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -2.65927    0.48758  -5.454 4.92e-08 ***
## log(density)  0.69410    0.09056   7.665 1.80e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 71.1593  on 7  degrees of freedom
## Residual deviance:  5.6739  on 6  degrees of freedom
## AIC: 38.201
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>There are two ways of easily comparing two GLM models that have the same response variable. Firstly you can look at the residual deviance. Resdual deviance is simply the amount of variation in the response variable that is NOT explained by the model: models with smaller residual deviance are better. You can also look at the AIC (Akaike Information Criterion). The AIC is a summary statistic that tries to capture how well the model fits the data while accounting for how complex the model is. It is too complicated to get into right now except to say that smaller AIC values are better.</p>
<p>By both of these methods, the second model (<code>model2</code>) is better than model 1. Lets plot it to confirm that visually.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="15-3-binomial-regression-with-proportionratio-data.html#cb436-1" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">log</span>(sexRatio<span class="op">$</span>density),sexRatio<span class="op">$</span>propMale,<span class="dt">ylab =</span> <span class="st">&quot;Proportion male&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb436-2"><a href="15-3-binomial-regression-with-proportionratio-data.html#cb436-2" aria-hidden="true"></a>newData &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">density =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">400</span>,<span class="dv">1</span>))</span>
<span id="cb436-3"><a href="15-3-binomial-regression-with-proportionratio-data.html#cb436-3" aria-hidden="true"></a>newData<span class="op">$</span>fit &lt;-<span class="st"> </span><span class="kw">predict</span>(model2,newData,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb436-4"><a href="15-3-binomial-regression-with-proportionratio-data.html#cb436-4" aria-hidden="true"></a><span class="kw">lines</span>(<span class="kw">log</span>(newData<span class="op">$</span>density),newData<span class="op">$</span>fit,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-257"></span>
<img src="BB852_files/figure-html/unnamed-chunk-257-1.png" alt="Sex ratio as a function of log density" width="672" />
<p class="caption">
Figure 15.2: Sex ratio as a function of log density
</p>
</div>
<p>Yes, that looks much better. That just goes to show that one should visually inspect the models and consider other ways of fitting the data: there are often ways of improving the fit.</p>
<p>In the next session we’ll get some more practice of choosing modelling approaches and interpreting outputs…</p>

</div>
</div>
<!-- </div> -->
<p style="text-align: center;">
<a href="15-2-example-species-presenceabsence-data.html"><button class="btn btn-default">Previous</button></a>
<a href="16-power-and-study-design.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
