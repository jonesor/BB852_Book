<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Exercise: Temperature effects on egg laying dates | BB852 - Data handling, visualisation and statistics</title>
  <meta name="description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Exercise: Temperature effects on egg laying dates | BB852 - Data handling, visualisation and statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Exercise: Temperature effects on egg laying dates | BB852 - Data handling, visualisation and statistics" />
  
  <meta name="twitter:description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  

<meta name="author" content="Owen R. Jones" />


<meta name="date" content="2020-09-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="combining-data-sets.html"/>
<link rel="next" href="visualising-data-with-ggplot.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.0.0/tabwid.js"></script>
<style type="text/css">

.warning-box {
  border: 3px solid #e60000;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

.advanced-box {
  border: 3px solid #268bd2;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

.do-something {
  border: 3px solid #803e00;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

</style>





<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BB852</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data-wrangling"><i class="fa fa-check"></i><b>1.1</b> Data wrangling</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-visualisation"><i class="fa fa-check"></i><b>1.2</b> Data visualisation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#statistics"><i class="fa fa-check"></i><b>1.3</b> Statistics</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#data-sources"><i class="fa fa-check"></i><b>1.4</b> Data sources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#your-instructors"><i class="fa fa-check"></i><b>1.5</b> Your instructors</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.6</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i><b>2</b> Schedule</a>
<ul>
<li class="chapter" data-level="2.1" data-path="schedule.html"><a href="schedule.html#additional-recommended-reading"><i class="fa fa-check"></i><b>2.1</b> Additional recommended reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="an-r-refresher.html"><a href="an-r-refresher.html"><i class="fa fa-check"></i><b>3</b> An R refresher</a>
<ul>
<li class="chapter" data-level="3.1" data-path="an-r-refresher.html"><a href="an-r-refresher.html#getting-started-with-r"><i class="fa fa-check"></i><b>3.1</b> Getting started with R</a></li>
<li class="chapter" data-level="3.2" data-path="an-r-refresher.html"><a href="an-r-refresher.html#getting-help"><i class="fa fa-check"></i><b>3.2</b> Getting help</a></li>
<li class="chapter" data-level="3.3" data-path="an-r-refresher.html"><a href="an-r-refresher.html#r-as-a-fancy-calculator"><i class="fa fa-check"></i><b>3.3</b> R as a fancy calculator</a></li>
<li class="chapter" data-level="3.4" data-path="an-r-refresher.html"><a href="an-r-refresher.html#objects-in-r"><i class="fa fa-check"></i><b>3.4</b> Objects in R</a></li>
<li class="chapter" data-level="3.5" data-path="an-r-refresher.html"><a href="an-r-refresher.html#missing-values-infinity-and-non-numbers"><i class="fa fa-check"></i><b>3.5</b> Missing values, infinity and “non-numbers”</a></li>
<li class="chapter" data-level="3.6" data-path="an-r-refresher.html"><a href="an-r-refresher.html#basic-information-about-objects"><i class="fa fa-check"></i><b>3.6</b> Basic information about objects</a></li>
<li class="chapter" data-level="3.7" data-path="an-r-refresher.html"><a href="an-r-refresher.html#data-frames"><i class="fa fa-check"></i><b>3.7</b> Data frames</a></li>
<li class="chapter" data-level="3.8" data-path="an-r-refresher.html"><a href="an-r-refresher.html#organising-your-work"><i class="fa fa-check"></i><b>3.8</b> Organising your work</a></li>
<li class="chapter" data-level="3.9" data-path="an-r-refresher.html"><a href="an-r-refresher.html#inspecting-the-data"><i class="fa fa-check"></i><b>3.9</b> Inspecting the data</a></li>
<li class="chapter" data-level="3.10" data-path="an-r-refresher.html"><a href="an-r-refresher.html#classes-in-r"><i class="fa fa-check"></i><b>3.10</b> “Classes” in R</a></li>
<li class="chapter" data-level="3.11" data-path="an-r-refresher.html"><a href="an-r-refresher.html#tables-and-summary-statistics"><i class="fa fa-check"></i><b>3.11</b> Tables and summary statistics</a></li>
<li class="chapter" data-level="3.12" data-path="an-r-refresher.html"><a href="an-r-refresher.html#plotting-data"><i class="fa fa-check"></i><b>3.12</b> Plotting data</a></li>
<li class="chapter" data-level="3.13" data-path="an-r-refresher.html"><a href="an-r-refresher.html#r-packages"><i class="fa fa-check"></i><b>3.13</b> R Packages</a></li>
<li class="chapter" data-level="3.14" data-path="an-r-refresher.html"><a href="an-r-refresher.html#exercise-californian-bird-diversity"><i class="fa fa-check"></i><b>3.14</b> Exercise: Californian bird diversity</a>
<ul>
<li class="chapter" data-level="3.14.1" data-path="an-r-refresher.html"><a href="an-r-refresher.html#the-data"><i class="fa fa-check"></i><b>3.14.1</b> The data</a></li>
<li class="chapter" data-level="3.14.2" data-path="an-r-refresher.html"><a href="an-r-refresher.html#try-the-following"><i class="fa fa-check"></i><b>3.14.2</b> Try the following</a></li>
</ul></li>
<li class="chapter" data-level="3.15" data-path="an-r-refresher.html"><a href="an-r-refresher.html#exercise-solutions-californian-bird-diversity"><i class="fa fa-check"></i><b>3.15</b> Exercise Solutions: Californian bird diversity</a></li>
</ul></li>
<li class="part"><span><b>I Data Wrangling</b></span></li>
<li class="chapter" data-level="4" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html"><i class="fa fa-check"></i><b>4</b> Data wrangling with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#select"><i class="fa fa-check"></i><b>4.1</b> <code>select</code></a></li>
<li class="chapter" data-level="4.2" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#filter"><i class="fa fa-check"></i><b>4.2</b> <code>filter</code></a></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#arrange"><i class="fa fa-check"></i><b>4.3</b> <code>arrange</code></a></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#summarise-and-group_by"><i class="fa fa-check"></i><b>4.4</b> <code>summarise</code> and <code>group_by</code></a></li>
<li class="chapter" data-level="4.5" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#using-pipes-saving-data."><i class="fa fa-check"></i><b>4.5</b> Using pipes, saving data.</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="exercise-wrangling-the-amniote-life-history-database.html"><a href="exercise-wrangling-the-amniote-life-history-database.html"><i class="fa fa-check"></i><b>5</b> Exercise: Wrangling the Amniote Life History Database</a>
<ul>
<li class="chapter" data-level="5.1" data-path="exercise-wrangling-the-amniote-life-history-database.html"><a href="exercise-wrangling-the-amniote-life-history-database.html#exercise-solutions-wrangling-the-amniote-life-history-database"><i class="fa fa-check"></i><b>5.1</b> Exercise Solutions: Wrangling the Amniote Life History Database</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="combining-data-sets.html"><a href="combining-data-sets.html"><i class="fa fa-check"></i><b>6</b> Combining data sets</a>
<ul>
<li class="chapter" data-level="6.1" data-path="combining-data-sets.html"><a href="combining-data-sets.html#using-join"><i class="fa fa-check"></i><b>6.1</b> Using <code>join</code></a></li>
<li class="chapter" data-level="6.2" data-path="combining-data-sets.html"><a href="combining-data-sets.html#using-pivot_longer"><i class="fa fa-check"></i><b>6.2</b> Using <code>pivot_longer</code></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exercise-temperature-effects-on-egg-laying-dates.html"><a href="exercise-temperature-effects-on-egg-laying-dates.html"><i class="fa fa-check"></i><b>7</b> Exercise: Temperature effects on egg laying dates</a>
<ul>
<li class="chapter" data-level="7.1" data-path="exercise-temperature-effects-on-egg-laying-dates.html"><a href="exercise-temperature-effects-on-egg-laying-dates.html#exercise-solutions-temperature-effects-on-egg-laying-dates"><i class="fa fa-check"></i><b>7.1</b> Exercise Solutions: Temperature effects on egg laying dates</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="exercise-temperature-effects-on-egg-laying-dates.html"><a href="exercise-temperature-effects-on-egg-laying-dates.html#preparing-the-bird-data"><i class="fa fa-check"></i><b>7.1.1</b> Preparing the bird data</a></li>
<li class="chapter" data-level="7.1.2" data-path="exercise-temperature-effects-on-egg-laying-dates.html"><a href="exercise-temperature-effects-on-egg-laying-dates.html#preparing-the-weather-data"><i class="fa fa-check"></i><b>7.1.2</b> Preparing the weather data</a></li>
<li class="chapter" data-level="7.1.3" data-path="exercise-temperature-effects-on-egg-laying-dates.html"><a href="exercise-temperature-effects-on-egg-laying-dates.html#joining-the-two-datasets"><i class="fa fa-check"></i><b>7.1.3</b> Joining the two datasets</a></li>
<li class="chapter" data-level="7.1.4" data-path="exercise-temperature-effects-on-egg-laying-dates.html"><a href="exercise-temperature-effects-on-egg-laying-dates.html#plot-the-data"><i class="fa fa-check"></i><b>7.1.4</b> Plot the data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Data visualisation</b></span></li>
<li class="chapter" data-level="8" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html"><i class="fa fa-check"></i><b>8</b> Visualising data with <code>ggplot</code></a>
<ul>
<li class="chapter" data-level="8.1" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#histograms"><i class="fa fa-check"></i><b>8.1</b> Histograms</a></li>
<li class="chapter" data-level="8.2" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#facets---splitting-data-across-panels"><i class="fa fa-check"></i><b>8.2</b> “Facets” - splitting data across panels</a></li>
<li class="chapter" data-level="8.3" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#box-plots"><i class="fa fa-check"></i><b>8.3</b> Box plots</a></li>
<li class="chapter" data-level="8.4" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#lines-and-points"><i class="fa fa-check"></i><b>8.4</b> Lines and points</a></li>
<li class="chapter" data-level="8.5" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#scatter-plots"><i class="fa fa-check"></i><b>8.5</b> Scatter plots</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html"><i class="fa fa-check"></i><b>9</b> Distributions and summarising data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#distributions"><i class="fa fa-check"></i><b>9.1</b> Distributions</a></li>
<li class="chapter" data-level="9.2" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#normal-distribution"><i class="fa fa-check"></i><b>9.2</b> Normal distribution</a></li>
<li class="chapter" data-level="9.3" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#comparing-normal-distributions"><i class="fa fa-check"></i><b>9.3</b> Comparing normal distributions</a></li>
<li class="chapter" data-level="9.4" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#poisson-distribution"><i class="fa fa-check"></i><b>9.4</b> Poisson distribution</a></li>
<li class="chapter" data-level="9.5" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#comparing-normal-and-poisson-distributions"><i class="fa fa-check"></i><b>9.5</b> Comparing normal and Poisson distributions</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="customising-your-plots.html"><a href="customising-your-plots.html"><i class="fa fa-check"></i><b>10</b> Customising your plots</a>
<ul>
<li class="chapter" data-level="10.1" data-path="customising-your-plots.html"><a href="customising-your-plots.html#a-basic-plot"><i class="fa fa-check"></i><b>10.1</b> A basic plot</a></li>
<li class="chapter" data-level="10.2" data-path="customising-your-plots.html"><a href="customising-your-plots.html#axis-limits"><i class="fa fa-check"></i><b>10.2</b> Axis limits</a></li>
<li class="chapter" data-level="10.3" data-path="customising-your-plots.html"><a href="customising-your-plots.html#transforming-the-axis-log-scale"><i class="fa fa-check"></i><b>10.3</b> Transforming the axis (log scale)</a></li>
<li class="chapter" data-level="10.4" data-path="customising-your-plots.html"><a href="customising-your-plots.html#changing-the-axis-tick-marks"><i class="fa fa-check"></i><b>10.4</b> Changing the axis tick marks</a></li>
<li class="chapter" data-level="10.5" data-path="customising-your-plots.html"><a href="customising-your-plots.html#axis-labels"><i class="fa fa-check"></i><b>10.5</b> Axis labels</a></li>
<li class="chapter" data-level="10.6" data-path="customising-your-plots.html"><a href="customising-your-plots.html#colours"><i class="fa fa-check"></i><b>10.6</b> Colours</a></li>
<li class="chapter" data-level="10.7" data-path="customising-your-plots.html"><a href="customising-your-plots.html#themes"><i class="fa fa-check"></i><b>10.7</b> Themes</a></li>
<li class="chapter" data-level="10.8" data-path="customising-your-plots.html"><a href="customising-your-plots.html#moving-the-legend"><i class="fa fa-check"></i><b>10.8</b> Moving the legend</a></li>
<li class="chapter" data-level="10.9" data-path="customising-your-plots.html"><a href="customising-your-plots.html#combining-multiple-plots"><i class="fa fa-check"></i><b>10.9</b> Combining multiple plots</a></li>
<li class="chapter" data-level="10.10" data-path="customising-your-plots.html"><a href="customising-your-plots.html#saving-your-plot"><i class="fa fa-check"></i><b>10.10</b> Saving your plot</a></li>
<li class="chapter" data-level="10.11" data-path="customising-your-plots.html"><a href="customising-your-plots.html#final-word-on-plots"><i class="fa fa-check"></i><b>10.11</b> Final word on plots</a></li>
</ul></li>
<li class="part"><span><b>III Statistics</b></span></li>
<li class="chapter" data-level="11" data-path="randomisation-tests.html"><a href="randomisation-tests.html"><i class="fa fa-check"></i><b>11</b> Randomisation Tests</a>
<ul>
<li class="chapter" data-level="11.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#randomisation-test-in-r"><i class="fa fa-check"></i><b>11.1</b> Randomisation test in R</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#calculate-the-observed-difference"><i class="fa fa-check"></i><b>11.1.1</b> Calculate the observed difference</a></li>
<li class="chapter" data-level="11.1.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#null-distribution"><i class="fa fa-check"></i><b>11.1.2</b> Null distribution</a></li>
<li class="chapter" data-level="11.1.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-significance"><i class="fa fa-check"></i><b>11.1.3</b> Testing significance</a></li>
<li class="chapter" data-level="11.1.4" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-the-hypothesis"><i class="fa fa-check"></i><b>11.1.4</b> Testing the hypothesis</a></li>
<li class="chapter" data-level="11.1.5" data-path="randomisation-tests.html"><a href="randomisation-tests.html#writing-it-up"><i class="fa fa-check"></i><b>11.1.5</b> Writing it up</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#paired-randomisation-tests"><i class="fa fa-check"></i><b>11.2</b> Paired Randomisation Tests</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-randomisation-test"><i class="fa fa-check"></i><b>11.2.1</b> The randomisation test</a></li>
<li class="chapter" data-level="11.2.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#null-distribution-1"><i class="fa fa-check"></i><b>11.2.2</b> Null distribution</a></li>
<li class="chapter" data-level="11.2.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-formal-hypothesis-test"><i class="fa fa-check"></i><b>11.2.3</b> The formal hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#exercise-sexual-selection-in-hercules-beetles"><i class="fa fa-check"></i><b>11.3</b> Exercise: Sexual selection in Hercules beetles</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html"><i class="fa fa-check"></i><b>12</b> Comparing two means with a t-test</a>
<ul>
<li class="chapter" data-level="12.1" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#some-theory"><i class="fa fa-check"></i><b>12.1</b> Some theory</a></li>
<li class="chapter" data-level="12.2" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#one-sample-t-test"><i class="fa fa-check"></i><b>12.2</b> One sample t-test</a></li>
<li class="chapter" data-level="12.3" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#doing-it-by-hand---where-does-the-t-statistic-come-from"><i class="fa fa-check"></i><b>12.3</b> Doing it “by hand” - where does the t-statistic come from?</a></li>
<li class="chapter" data-level="12.4" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#paired-t-test"><i class="fa fa-check"></i><b>12.4</b> Paired t-test</a></li>
<li class="chapter" data-level="12.5" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#a-paired-t-test-is-a-one-sample-test."><i class="fa fa-check"></i><b>12.5</b> A paired t-test is a one-sample test.</a></li>
<li class="chapter" data-level="12.6" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#two-sample-t-test"><i class="fa fa-check"></i><b>12.6</b> Two sample t-test</a></li>
<li class="chapter" data-level="12.7" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#t-tests-are-linear-models"><i class="fa fa-check"></i><b>12.7</b> t-tests are linear models</a></li>
<li class="chapter" data-level="12.8" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-sex-differences-in-fine-motor-skills"><i class="fa fa-check"></i><b>12.8</b> Exercise: Sex differences in fine motor skills</a></li>
<li class="chapter" data-level="12.9" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-therapy-for-anorexia"><i class="fa fa-check"></i><b>12.9</b> Exercise: Therapy for anorexia</a></li>
<li class="chapter" data-level="12.10" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-compare-t-tests-with-randomisation-tests"><i class="fa fa-check"></i><b>12.10</b> Exercise: Compare t-tests with randomisation tests</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html"><i class="fa fa-check"></i><b>13</b> Linear models with a single categorical explanatory variable</a>
<ul>
<li class="chapter" data-level="13.1" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#one-way-anova"><i class="fa fa-check"></i><b>13.1</b> One-way ANOVA</a></li>
<li class="chapter" data-level="13.2" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#fitting-an-anova-in-r"><i class="fa fa-check"></i><b>13.2</b> Fitting an ANOVA in R</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#where-are-the-differences"><i class="fa fa-check"></i><b>13.2.1</b> Where are the differences?</a></li>
<li class="chapter" data-level="13.2.2" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#tukeys-honestly-significant-difference-hsd"><i class="fa fa-check"></i><b>13.2.2</b> Tukey’s Honestly Significant Difference (HSD)</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#anova-calculation-by-hand."><i class="fa fa-check"></i><b>13.3</b> ANOVA calculation “by hand”.</a></li>
<li class="chapter" data-level="13.4" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#exercise-apple-tree-crop-yield"><i class="fa fa-check"></i><b>13.4</b> Exercise: Apple tree crop yield</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html"><i class="fa fa-check"></i><b>14</b> Linear models with a single continuous explanatory variable</a>
<ul>
<li class="chapter" data-level="14.1" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#some-theory"><i class="fa fa-check"></i><b>14.1</b> Some theory</a></li>
<li class="chapter" data-level="14.2" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#evaluating-a-hypothesis-with-a-linear-regression-model"><i class="fa fa-check"></i><b>14.2</b> Evaluating a hypothesis with a linear regression model</a></li>
<li class="chapter" data-level="14.3" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#assumptions"><i class="fa fa-check"></i><b>14.3</b> Assumptions</a></li>
<li class="chapter" data-level="14.4" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#worked-example-height-hand-width-relationship"><i class="fa fa-check"></i><b>14.4</b> Worked example: height-hand width relationship</a></li>
<li class="chapter" data-level="14.5" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#exercise-chirping-crickets"><i class="fa fa-check"></i><b>14.5</b> Exercise: Chirping crickets</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html"><i class="fa fa-check"></i><b>15</b> Linear models with categorical and continuous explanatory variables</a>
<ul>
<li class="chapter" data-level="15.1" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#the-height-hand-width-example."><i class="fa fa-check"></i><b>15.1</b> The height ~ hand width example.</a></li>
<li class="chapter" data-level="15.2" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#summarising-with-anova"><i class="fa fa-check"></i><b>15.2</b> Summarising with <code>anova</code></a></li>
<li class="chapter" data-level="15.3" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#the-summary-of-coefficients-summary"><i class="fa fa-check"></i><b>15.3</b> The summary of coefficients (<code>summary</code>)</a></li>
<li class="chapter" data-level="15.4" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#simplifying-the-model"><i class="fa fa-check"></i><b>15.4</b> Simplifying the model</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html"><i class="fa fa-check"></i><b>16</b> Linear models with &gt;1 categorical explanatory variables</a>
<ul>
<li class="chapter" data-level="16.1" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#fitting-a-two-way-anova-model"><i class="fa fa-check"></i><b>16.1</b> Fitting a two-way ANOVA model</a></li>
<li class="chapter" data-level="16.2" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#summarising-the-model-anova"><i class="fa fa-check"></i><b>16.2</b> Summarising the model (<code>anova</code>)</a></li>
<li class="chapter" data-level="16.3" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#summarising-the-model-summary"><i class="fa fa-check"></i><b>16.3</b> Summarising the model (<code>summary</code>)</a></li>
<li class="chapter" data-level="16.4" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#exercise-fish-behaviour"><i class="fa fa-check"></i><b>16.4</b> Exercise: Fish behaviour</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html"><i class="fa fa-check"></i><b>17</b> Generalised linear models</a>
<ul>
<li class="chapter" data-level="17.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#count-data-with-poisson-errors."><i class="fa fa-check"></i><b>17.1</b> Count data with Poisson errors.</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-number-of-offspring-in-foxes."><i class="fa fa-check"></i><b>17.1.1</b> Example: Number of offspring in foxes.</a></li>
<li class="chapter" data-level="17.1.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-cancer-clusters"><i class="fa fa-check"></i><b>17.1.2</b> Example: Cancer clusters</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#exercise-maze-runner"><i class="fa fa-check"></i><b>17.2</b> Exercise: Maze runner</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html"><i class="fa fa-check"></i><b>18</b> Extending use cases of GLM</a>
<ul>
<li class="chapter" data-level="18.1" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#binomial-response-data"><i class="fa fa-check"></i><b>18.1</b> Binomial response data</a></li>
<li class="chapter" data-level="18.2" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-nfl-field-goals"><i class="fa fa-check"></i><b>18.2</b> Example: NFL field goals</a></li>
<li class="chapter" data-level="18.3" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-sex-ratio-in-turtles"><i class="fa fa-check"></i><b>18.3</b> Example: Sex ratio in turtles</a></li>
<li class="chapter" data-level="18.4" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-smoking"><i class="fa fa-check"></i><b>18.4</b> Example: Smoking</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html"><i class="fa fa-check"></i><b>19</b> Power analysis by simulation</a>
<ul>
<li class="chapter" data-level="19.1" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#type-i-and-ii-errors-and-statistical-power"><i class="fa fa-check"></i><b>19.1</b> Type I and II errors and statistical power</a></li>
<li class="chapter" data-level="19.2" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#what-determines-statistical-power"><i class="fa fa-check"></i><b>19.2</b> What determines statistical power?</a></li>
<li class="chapter" data-level="19.3" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#an-example-of-calculating-statistical-power."><i class="fa fa-check"></i><b>19.3</b> An example of calculating statistical power.</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#the-simulation"><i class="fa fa-check"></i><b>19.3.1</b> The simulation</a></li>
<li class="chapter" data-level="19.3.2" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#some-questions-for-you-to-address"><i class="fa fa-check"></i><b>19.3.2</b> Some questions for you to address:</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#summary"><i class="fa fa-check"></i><b>19.4</b> Summary</a></li>
<li class="chapter" data-level="19.5" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#extending-the-simulation-optional-advanced"><i class="fa fa-check"></i><b>19.5</b> Extending the simulation (optional, advanced)</a></li>
<li class="chapter" data-level="19.6" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#exercise-1-snails-on-the-move"><i class="fa fa-check"></i><b>19.6</b> Exercise 1: Snails on the move</a></li>
<li class="chapter" data-level="19.7" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#exercise-2-mouse-lemur-strength"><i class="fa fa-check"></i><b>19.7</b> Exercise 2: Mouse lemur strength</a></li>
</ul></li>
<li class="part"><span><b>IV Coming soon(ish)</b></span></li>
<li class="chapter" data-level="20" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html"><i class="fa fa-check"></i><b>20</b> Coming soon (maybe)!</a>
<ul>
<li class="chapter" data-level="20.1" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#multivariate-statistics"><i class="fa fa-check"></i><b>20.1</b> Multivariate statistics</a></li>
<li class="chapter" data-level="20.2" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#transforming-variables"><i class="fa fa-check"></i><b>20.2</b> Transforming variables</a></li>
<li class="chapter" data-level="20.3" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#non-linear-regression"><i class="fa fa-check"></i><b>20.3</b> Non-linear regression</a></li>
<li class="chapter" data-level="20.4" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#nested-or-blocked-study-designs"><i class="fa fa-check"></i><b>20.4</b> Nested or blocked study designs</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BB852 - Data handling, visualisation and statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercise-temperature-effects-on-egg-laying-dates" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> Exercise: Temperature effects on egg laying dates</h1>
<p>Data have been collected on great tits (musvit) at SDU for several years. Your task today is to analyse these data to answer the question: <em>is egg laying date associated with spring temperature?</em> The idea here is that warmer springs will lead to delayed egg laying which could have negative consequences to the population if their caterpillar food source doesn’t keep pace with the change.</p>
<p>You are provided with two data sets: one on the birds and another on weather. You will need to process these using tools in the <code>dplyr</code> package, and combine them (using <code>left_join</code>) for analysis.</p>
<p>The first data set, <code>eggDates.csv</code>, is data from the SDU birds project. The data are arranged in columns where each column is a year and each row is a nest. The data in each column is the day of the year that the first egg in the nest was laid.</p>
<p>These data do NOT fulfill the “tidy data” standard where each variable gets a column. In this case,a single variable (first egg date) gets many columns (one for each year), and column headers are data (the years). The data will need to be processed before you can analyse it.</p>
<p>You will need to use <code>pivot_wider</code> to fix this issue so that you produce a version of the data with three columns - <code>nestNumber</code>, <code>Year</code> and <code>dayNumber</code>.</p>
<p>The second dataset, <code>AarslevTemperature.csv</code>, is a weather dataset from Årslev near Odense. This dataset includes daily temperatures records for several years. You will need to <code>summarise</code> this data to obtain a small dataset that has the weather of interest - average temperature in the months of February to April for each year.</p>
<p>To answer the question, you will need to join these data sets together.</p>
<ol style="list-style-type: decimal">
<li><p>Import the data and take a look at it with <code>head</code> or <code>str</code>.</p></li>
<li><p>Use <code>pivot_wider</code> to reformat the data. This might take a bit of trial and error - don’t give up!</p></li>
</ol>
<p>Maybe this will help: The first argument in the gather command indicates what the columns in the main data represent (i.e. here the column represents “Year”). The second argument is the name you would give to the actual data (i.e. “day”, in this case). The final argument then tells the function which columns of the data are not to be rearranged (i.e. “boxNumber” in this case).</p>
<p>You should end up with a dataset with three columns as described above.</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Ensure that year is coded as numeric variable using <code>mutate</code>. [Hint, you can use the command <code>as.numeric</code>, but first remove the “y” in the name using <code>gsub</code>].</p></li>
<li><p>Calculate the mean egg date per year using <code>summarise</code> (remember to <code>group_by</code> the year first). Take a look at the data.</p></li>
<li><p>Import the weather data and take a look at it with <code>head</code> or <code>str</code>.</p></li>
<li><p>Use <code>filter</code> subset to the months of interest (February-April) and then <code>summarise</code> the data to calculate the mean temperature in this period (remember to <code>group_by</code> year). Look at the data. You should end up with a dataset with two columns - <code>year</code> and <code>meanSpringTemp</code>.</p></li>
<li><p>Join the two datasets together using <code>left_join</code>. You should now have a dataset with columns <code>nestNumber</code>, <code>Year</code>, <code>dayNumber</code> and <code>meanAprilTemp</code></p></li>
<li><p>plot a graph of <code>meanAprilTemp</code> on the x-axis and <code>dayNumber</code> on the y-axis.</p></li>
</ol>
<p>Now you should be able to answer the question we started with: is laying date associated with spring temperatures.</p>

<div id="exercise-solutions-temperature-effects-on-egg-laying-dates" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Exercise Solutions: Temperature effects on egg laying dates</h2>
<div id="preparing-the-bird-data" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Preparing the bird data</h3>
<ol style="list-style-type: decimal">
<li>Import the data and take a look at it with <code>head</code> or <code>str</code>.</li>
</ol>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb213-1" aria-hidden="true"></a>eggDates &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;CourseData/eggDates.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb214-1" aria-hidden="true"></a><span class="kw">head</span>(eggDates)</span></code></pre></div>
<pre><code>##   boxNumber y2013 y2014 y2016 y2017 y2018 y2019
## 1         1   116   103    NA   107   111    NA
## 2         2    NA    NA    NA   114   118    NA
## 3         3    NA   102   108    NA    NA    NA
## 4         4   121   103   121   155   111   110
## 5         5   135   100   108   102   106   108
## 6         6   122   113   122    NA   124   149</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Use <code>pivot_longer</code> to reformat the data. This might take a bit of trial and error - don’t give up!</li>
</ol>
<p>Maybe this will help: The first argument in the gather command indicates what the columns in the main data represent (i.e. here the column represents “Year”). The second argument is the name you would give to the actual data (i.e. “day”, in this case). The final argument then tells the function which columns of the data are not to be rearranged (i.e. “boxNumber” in this case).</p>
<p>You should end up with a dataset with three columns as described above.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb216-1" aria-hidden="true"></a>eggDates <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb216-2"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb216-2" aria-hidden="true"></a><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(y2013,y2014,y2016,y2017,y2018,y2019),<span class="dt">names_to =</span> <span class="kw">c</span>(<span class="st">&quot;Year&quot;</span>),<span class="dt">values_to =</span> <span class="st">&quot;Day&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 600 x 3
##    boxNumber Year    Day
##        &lt;int&gt; &lt;chr&gt; &lt;int&gt;
##  1         1 y2013   116
##  2         1 y2014   103
##  3         1 y2016    NA
##  4         1 y2017   107
##  5         1 y2018   111
##  6         1 y2019    NA
##  7         2 y2013    NA
##  8         2 y2014    NA
##  9         2 y2016    NA
## 10         2 y2017   114
## # … with 590 more rows</code></pre>
<p>There is, in fact, an easier way to do this with a “helper function”, <code>starts_with</code>.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb218-1" aria-hidden="true"></a>eggDates <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb218-2"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb218-2" aria-hidden="true"></a><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">starts_with</span>(<span class="st">&quot;y&quot;</span>),<span class="dt">names_to =</span> <span class="kw">c</span>(<span class="st">&quot;Year&quot;</span>),<span class="dt">values_to =</span> <span class="st">&quot;Day&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 600 x 3
##    boxNumber Year    Day
##        &lt;int&gt; &lt;chr&gt; &lt;int&gt;
##  1         1 y2013   116
##  2         1 y2014   103
##  3         1 y2016    NA
##  4         1 y2017   107
##  5         1 y2018   111
##  6         1 y2019    NA
##  7         2 y2013    NA
##  8         2 y2014    NA
##  9         2 y2016    NA
## 10         2 y2017   114
## # … with 590 more rows</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Ensure that year is coded as numeric variable using <code>mutate</code>. [Hint, you can use the command <code>as.numeric</code>, but first remove the “y” in the name using <code>gsub</code>].</li>
</ol>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb220-1" aria-hidden="true"></a>eggDates <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb220-2"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb220-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">starts_with</span>(<span class="st">&quot;y&quot;</span>),<span class="dt">names_to =</span> <span class="kw">c</span>(<span class="st">&quot;Year&quot;</span>),<span class="dt">values_to =</span> <span class="st">&quot;Day&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb220-3"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb220-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Year =</span> <span class="kw">gsub</span>(<span class="dt">pattern =</span> <span class="st">&quot;y&quot;</span>,<span class="dt">replacement =</span> <span class="st">&quot;&quot;</span>, <span class="dt">x =</span> Year)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb220-4"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb220-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Year =</span> <span class="kw">as.numeric</span>(Year))</span></code></pre></div>
<pre><code>## # A tibble: 600 x 3
##    boxNumber  Year   Day
##        &lt;int&gt; &lt;dbl&gt; &lt;int&gt;
##  1         1  2013   116
##  2         1  2014   103
##  3         1  2016    NA
##  4         1  2017   107
##  5         1  2018   111
##  6         1  2019    NA
##  7         2  2013    NA
##  8         2  2014    NA
##  9         2  2016    NA
## 10         2  2017   114
## # … with 590 more rows</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Calculate the mean egg date per year using <code>summarise</code> (remember to <code>group_by</code> the year first). Take a look at the data.</li>
</ol>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb222-1" aria-hidden="true"></a>eggDates <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb222-2"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb222-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">starts_with</span>(<span class="st">&quot;y&quot;</span>),<span class="dt">names_to =</span> <span class="kw">c</span>(<span class="st">&quot;Year&quot;</span>),<span class="dt">values_to =</span> <span class="st">&quot;Day&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb222-3"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb222-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Year =</span> <span class="kw">gsub</span>(<span class="dt">pattern =</span> <span class="st">&quot;y&quot;</span>,<span class="dt">replacement =</span> <span class="st">&quot;&quot;</span>, <span class="dt">x =</span> Year)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb222-4"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb222-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Year =</span> <span class="kw">as.numeric</span>(Year)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb222-5"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb222-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(Year) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb222-6"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb222-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">meanEggDate =</span> <span class="kw">mean</span>(Day,<span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##    Year meanEggDate
##   &lt;dbl&gt;       &lt;dbl&gt;
## 1  2013        125.
## 2  2014        108.
## 3  2016        115.
## 4  2017        112.
## 5  2018        117.
## 6  2019        111.</code></pre>
<p>You should now remember to create a new object to hold the result of this sequence of pipes.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb224-1" aria-hidden="true"></a>meanEggDates &lt;-<span class="st"> </span>eggDates <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb224-2"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb224-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">starts_with</span>(<span class="st">&quot;y&quot;</span>),<span class="dt">names_to =</span> <span class="kw">c</span>(<span class="st">&quot;Year&quot;</span>),<span class="dt">values_to =</span> <span class="st">&quot;Day&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb224-3"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb224-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Year =</span> <span class="kw">gsub</span>(<span class="dt">pattern =</span> <span class="st">&quot;y&quot;</span>,<span class="dt">replacement =</span> <span class="st">&quot;&quot;</span>, <span class="dt">x =</span> Year)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb224-4"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb224-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Year =</span> <span class="kw">as.numeric</span>(Year)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb224-5"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb224-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(Year) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb224-6"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb224-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">meanEggDate =</span> <span class="kw">mean</span>(Day,<span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
</div>
<div id="preparing-the-weather-data" class="section level3" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Preparing the weather data</h3>
<ol start="5" style="list-style-type: decimal">
<li>Import the weather data and take a look at it with <code>head</code> or <code>str</code>.</li>
</ol>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb225-1" aria-hidden="true"></a>weather &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;CourseData/AarslevTemperature.csv&quot;</span>)</span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Use <code>filter</code> subset to the months of interest (February-April) and then <code>summarise</code> the data to calculate the mean temperature in this period (remember to <code>group_by</code> year). Look at the data. You should end up with a dataset with two columns - <code>year</code> and <code>meanSpringTemp</code>.</li>
</ol>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb226-1" aria-hidden="true"></a>weather &lt;-<span class="st"> </span>weather <span class="op">%&gt;%</span></span>
<span id="cb226-2"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb226-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(MONTH <span class="op">%in%</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">4</span>) <span class="op">%&gt;%</span></span>
<span id="cb226-3"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb226-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(YEAR) <span class="op">%&gt;%</span></span>
<span id="cb226-4"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb226-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">meanAprilTemp =</span> <span class="kw">mean</span>(TEMP))</span>
<span id="cb226-5"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb226-5" aria-hidden="true"></a>weather</span></code></pre></div>
<pre><code>## # A tibble: 8 x 2
##    YEAR meanAprilTemp
##   &lt;int&gt;         &lt;dbl&gt;
## 1  2012          7.86
## 2  2013          1.60
## 3  2014          6.03
## 4  2015          3.53
## 5  2016          4.50
## 6  2017          4.77
## 7  2018          3.07
## 8  2019          6.12</code></pre>
</div>
<div id="joining-the-two-datasets" class="section level3" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> Joining the two datasets</h3>
<ol start="7" style="list-style-type: decimal">
<li>Join the two datasets together using <code>left_join</code>. You should now have a dataset with columns <code>nestNumber</code>, <code>Year</code>, <code>dayNumber</code> and <code>meanAprilTemp</code></li>
</ol>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb228-1" aria-hidden="true"></a>joinedData &lt;-<span class="st"> </span><span class="kw">left_join</span>(meanEggDates,weather,<span class="kw">c</span>(<span class="st">&quot;Year&quot;</span> =<span class="st"> &quot;YEAR&quot;</span>))</span>
<span id="cb228-2"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb228-2" aria-hidden="true"></a><span class="kw">head</span>(joinedData)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##    Year meanEggDate meanAprilTemp
##   &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;
## 1  2013        125.          1.60
## 2  2014        108.          6.03
## 3  2016        115.          4.50
## 4  2017        112.          4.77
## 5  2018        117.          3.07
## 6  2019        111.          6.12</code></pre>
</div>
<div id="plot-the-data" class="section level3" number="7.1.4">
<h3><span class="header-section-number">7.1.4</span> Plot the data</h3>
<ol start="8" style="list-style-type: decimal">
<li>plot a graph of <code>meanAprilTemp</code> on the x-axis and <code>dayNumber</code> on the y-axis.</li>
</ol>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="exercise-temperature-effects-on-egg-laying-dates.html#cb230-1" aria-hidden="true"></a><span class="kw">plot</span>(joinedData<span class="op">$</span>meanAprilTemp,joinedData<span class="op">$</span>meanEggDate)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-121-1.png" width="672" /></p>
<p>Now you should be able to answer the question we started with: is laying date associated with spring temperatures.</p>

</div>
</div>
</div>



</div>
            </section>

          </div>
        </div>
      </div>
<a href="combining-data-sets.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="visualising-data-with-ggplot.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jonesor/BB852_Book/edit/master/1_02-combiningDatasets.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["BB852.pdf"],
"toc": {
"collapse": "section"
},
"split_by": "section"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
