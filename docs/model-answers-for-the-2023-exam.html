<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 28 Model answers for the 2023 exam | BB852 - Data handling, visualisation and statistics</title>
  <meta name="description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 28 Model answers for the 2023 exam | BB852 - Data handling, visualisation and statistics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 28 Model answers for the 2023 exam | BB852 - Data handling, visualisation and statistics" />
  
  <meta name="twitter:description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  

<meta name="author" content="Owen R. Jones" />


<meta name="date" content="2023-12-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exercise-solutions.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.1.3/tabwid.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BB852</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data-wrangling"><i class="fa fa-check"></i><b>1.1</b> Data wrangling</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-visualisation"><i class="fa fa-check"></i><b>1.2</b> Data visualisation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#statistics"><i class="fa fa-check"></i><b>1.3</b> Statistics</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#data-sources"><i class="fa fa-check"></i><b>1.4</b> Data sources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#your-instructors"><i class="fa fa-check"></i><b>1.5</b> Your instructor(s)</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#expectations"><i class="fa fa-check"></i><b>1.6</b> Expectations</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#your-feedback"><i class="fa fa-check"></i><b>1.7</b> Your feedback</a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#assessment"><i class="fa fa-check"></i><b>1.8</b> Assessment</a></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.9</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i><b>2</b> Schedule</a></li>
<li class="chapter" data-level="3" data-path="additional-recommended-reading.html"><a href="additional-recommended-reading.html"><i class="fa fa-check"></i><b>3</b> Additional recommended reading</a></li>
<li class="chapter" data-level="4" data-path="an-r-refresher.html"><a href="an-r-refresher.html"><i class="fa fa-check"></i><b>4</b> An R refresher</a>
<ul>
<li class="chapter" data-level="4.1" data-path="an-r-refresher.html"><a href="an-r-refresher.html#getting-started-with-r"><i class="fa fa-check"></i><b>4.1</b> Getting started with R</a></li>
<li class="chapter" data-level="4.2" data-path="an-r-refresher.html"><a href="an-r-refresher.html#getting-help"><i class="fa fa-check"></i><b>4.2</b> Getting help</a></li>
<li class="chapter" data-level="4.3" data-path="an-r-refresher.html"><a href="an-r-refresher.html#r-as-a-fancy-calculator"><i class="fa fa-check"></i><b>4.3</b> R as a fancy calculator</a></li>
<li class="chapter" data-level="4.4" data-path="an-r-refresher.html"><a href="an-r-refresher.html#objects-in-r"><i class="fa fa-check"></i><b>4.4</b> Objects in R</a></li>
<li class="chapter" data-level="4.5" data-path="an-r-refresher.html"><a href="an-r-refresher.html#manipulating-objects"><i class="fa fa-check"></i><b>4.5</b> Manipulating objects</a></li>
<li class="chapter" data-level="4.6" data-path="an-r-refresher.html"><a href="an-r-refresher.html#missing-values-infinity-and-non-numbers"><i class="fa fa-check"></i><b>4.6</b> Missing values, infinity and “non-numbers”</a></li>
<li class="chapter" data-level="4.7" data-path="an-r-refresher.html"><a href="an-r-refresher.html#basic-information-about-objects"><i class="fa fa-check"></i><b>4.7</b> Basic information about objects</a></li>
<li class="chapter" data-level="4.8" data-path="an-r-refresher.html"><a href="an-r-refresher.html#data-frames"><i class="fa fa-check"></i><b>4.8</b> Data frames</a></li>
<li class="chapter" data-level="4.9" data-path="an-r-refresher.html"><a href="an-r-refresher.html#classes-in-r"><i class="fa fa-check"></i><b>4.9</b> Classes in R</a></li>
<li class="chapter" data-level="4.10" data-path="an-r-refresher.html"><a href="an-r-refresher.html#organising-your-work"><i class="fa fa-check"></i><b>4.10</b> Organising your work</a></li>
<li class="chapter" data-level="4.11" data-path="an-r-refresher.html"><a href="an-r-refresher.html#inspecting-the-data"><i class="fa fa-check"></i><b>4.11</b> Inspecting the data</a></li>
<li class="chapter" data-level="4.12" data-path="an-r-refresher.html"><a href="an-r-refresher.html#classes-in-r-1"><i class="fa fa-check"></i><b>4.12</b> “Classes” in R</a></li>
<li class="chapter" data-level="4.13" data-path="an-r-refresher.html"><a href="an-r-refresher.html#tables-and-summary-statistics"><i class="fa fa-check"></i><b>4.13</b> Tables and summary statistics</a></li>
<li class="chapter" data-level="4.14" data-path="an-r-refresher.html"><a href="an-r-refresher.html#plotting-data"><i class="fa fa-check"></i><b>4.14</b> Plotting data</a></li>
<li class="chapter" data-level="4.15" data-path="an-r-refresher.html"><a href="an-r-refresher.html#r-packages"><i class="fa fa-check"></i><b>4.15</b> R Packages</a></li>
<li class="chapter" data-level="4.16" data-path="an-r-refresher.html"><a href="an-r-refresher.html#exercise-californian-bird-diversity"><i class="fa fa-check"></i><b>4.16</b> Exercise: Californian bird diversity</a>
<ul>
<li class="chapter" data-level="4.16.1" data-path="an-r-refresher.html"><a href="an-r-refresher.html#the-data"><i class="fa fa-check"></i><b>4.16.1</b> The data</a></li>
<li class="chapter" data-level="4.16.2" data-path="an-r-refresher.html"><a href="an-r-refresher.html#try-the-following"><i class="fa fa-check"></i><b>4.16.2</b> Try the following</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html"><i class="fa fa-check"></i><b>5</b> Tips and tricks</a>
<ul>
<li class="chapter" data-level="5.1" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#appearance"><i class="fa fa-check"></i><b>5.1</b> Appearance</a></li>
<li class="chapter" data-level="5.2" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#shortcuts"><i class="fa fa-check"></i><b>5.2</b> Shortcuts</a></li>
<li class="chapter" data-level="5.3" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#code-style"><i class="fa fa-check"></i><b>5.3</b> Code style</a></li>
<li class="chapter" data-level="5.4" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#the-plots-pane"><i class="fa fa-check"></i><b>5.4</b> The plots pane</a></li>
<li class="chapter" data-level="5.5" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#tables"><i class="fa fa-check"></i><b>5.5</b> Tables</a></li>
<li class="chapter" data-level="5.6" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#importing-data-from-text-files"><i class="fa fa-check"></i><b>5.6</b> Importing data from text files</a></li>
<li class="chapter" data-level="5.7" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#importing-data-from-excel"><i class="fa fa-check"></i><b>5.7</b> Importing data from Excel</a></li>
<li class="chapter" data-level="5.8" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#numbers"><i class="fa fa-check"></i><b>5.8</b> Numbers</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="paths-and-projects.html"><a href="paths-and-projects.html"><i class="fa fa-check"></i><b>6</b> Paths and projects</a>
<ul>
<li class="chapter" data-level="6.1" data-path="paths-and-projects.html"><a href="paths-and-projects.html#file-structure"><i class="fa fa-check"></i><b>6.1</b> File structure</a></li>
<li class="chapter" data-level="6.2" data-path="paths-and-projects.html"><a href="paths-and-projects.html#paths-and-the-command-line"><i class="fa fa-check"></i><b>6.2</b> Paths and the command line</a></li>
<li class="chapter" data-level="6.3" data-path="paths-and-projects.html"><a href="paths-and-projects.html#r-and-file-structure"><i class="fa fa-check"></i><b>6.3</b> R and file structure</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="paths-and-projects.html"><a href="paths-and-projects.html#setting-the-working-directory"><i class="fa fa-check"></i><b>6.3.1</b> Setting the working directory</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="paths-and-projects.html"><a href="paths-and-projects.html#projects-in-r"><i class="fa fa-check"></i><b>6.4</b> Projects in R</a></li>
</ul></li>
<li class="part"><span><b>I Data Wrangling</b></span></li>
<li class="chapter" data-level="7" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html"><i class="fa fa-check"></i><b>7</b> Data wrangling with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="7.1" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#select"><i class="fa fa-check"></i><b>7.1</b> <code>select</code></a></li>
<li class="chapter" data-level="7.2" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#filter"><i class="fa fa-check"></i><b>7.2</b> <code>filter</code></a></li>
<li class="chapter" data-level="7.3" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#arrange"><i class="fa fa-check"></i><b>7.3</b> <code>arrange</code></a></li>
<li class="chapter" data-level="7.4" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#summarise-and-group_by"><i class="fa fa-check"></i><b>7.4</b> <code>summarise</code> and <code>group_by</code></a></li>
<li class="chapter" data-level="7.5" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#using-pipes-saving-data."><i class="fa fa-check"></i><b>7.5</b> Using pipes, saving data.</a></li>
<li class="chapter" data-level="7.6" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#exercise-wrangling-the-amniote-life-history-database"><i class="fa fa-check"></i><b>7.6</b> Exercise: Wrangling the Amniote Life History Database</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="combining-data-sets.html"><a href="combining-data-sets.html"><i class="fa fa-check"></i><b>8</b> Combining data sets</a>
<ul>
<li class="chapter" data-level="8.1" data-path="combining-data-sets.html"><a href="combining-data-sets.html#using-join"><i class="fa fa-check"></i><b>8.1</b> Using <code>join</code></a></li>
<li class="chapter" data-level="8.2" data-path="combining-data-sets.html"><a href="combining-data-sets.html#using-pivot_longer"><i class="fa fa-check"></i><b>8.2</b> Using <code>pivot_longer</code></a></li>
<li class="chapter" data-level="8.3" data-path="combining-data-sets.html"><a href="combining-data-sets.html#exercise-temperature-effects-on-egg-laying-dates"><i class="fa fa-check"></i><b>8.3</b> Exercise: Temperature effects on egg laying dates</a></li>
</ul></li>
<li class="part"><span><b>II Data visualisation</b></span></li>
<li class="chapter" data-level="9" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html"><i class="fa fa-check"></i><b>9</b> Visualising data with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="9.1" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html#histograms"><i class="fa fa-check"></i><b>9.1</b> Histograms</a></li>
<li class="chapter" data-level="9.2" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html#facets---splitting-data-across-panels"><i class="fa fa-check"></i><b>9.2</b> “Facets” - splitting data across panels</a></li>
<li class="chapter" data-level="9.3" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html#box-plots"><i class="fa fa-check"></i><b>9.3</b> Box plots</a></li>
<li class="chapter" data-level="9.4" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html#lines-and-points"><i class="fa fa-check"></i><b>9.4</b> Lines and points</a></li>
<li class="chapter" data-level="9.5" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html#scatter-plots"><i class="fa fa-check"></i><b>9.5</b> Scatter plots</a></li>
<li class="chapter" data-level="9.6" data-path="visualising-data-with-ggplot2.html"><a href="visualising-data-with-ggplot2.html#bar-plots"><i class="fa fa-check"></i><b>9.6</b> Bar plots</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html"><i class="fa fa-check"></i><b>10</b> Distributions and summarising data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#distributions"><i class="fa fa-check"></i><b>10.1</b> Distributions</a></li>
<li class="chapter" data-level="10.2" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#normal-distribution"><i class="fa fa-check"></i><b>10.2</b> Normal distribution</a></li>
<li class="chapter" data-level="10.3" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#comparing-normal-distributions"><i class="fa fa-check"></i><b>10.3</b> Comparing normal distributions</a></li>
<li class="chapter" data-level="10.4" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#poisson-distribution"><i class="fa fa-check"></i><b>10.4</b> Poisson distribution</a></li>
<li class="chapter" data-level="10.5" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#comparing-normal-and-poisson-distributions"><i class="fa fa-check"></i><b>10.5</b> Comparing normal and Poisson distributions</a></li>
<li class="chapter" data-level="10.6" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#the-law-of-large-numbers"><i class="fa fa-check"></i><b>10.6</b> The law of large numbers</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#coin-flipping"><i class="fa fa-check"></i><b>10.6.1</b> Coin flipping</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#exercise-virtual-dice"><i class="fa fa-check"></i><b>10.7</b> Exercise: Virtual dice</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html"><i class="fa fa-check"></i><b>11</b> Pimping your plots</a>
<ul>
<li class="chapter" data-level="11.1" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#a-basic-plot"><i class="fa fa-check"></i><b>11.1</b> A basic plot</a></li>
<li class="chapter" data-level="11.2" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#axis-limits"><i class="fa fa-check"></i><b>11.2</b> Axis limits</a></li>
<li class="chapter" data-level="11.3" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#transforming-the-axis-log-scale"><i class="fa fa-check"></i><b>11.3</b> Transforming the axis (log scale)</a></li>
<li class="chapter" data-level="11.4" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#changing-the-axis-tick-marks"><i class="fa fa-check"></i><b>11.4</b> Changing the axis tick marks</a></li>
<li class="chapter" data-level="11.5" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#axis-labels"><i class="fa fa-check"></i><b>11.5</b> Axis labels</a></li>
<li class="chapter" data-level="11.6" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#colours"><i class="fa fa-check"></i><b>11.6</b> Colours</a></li>
<li class="chapter" data-level="11.7" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#themes"><i class="fa fa-check"></i><b>11.7</b> Themes</a></li>
<li class="chapter" data-level="11.8" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#moving-the-legend"><i class="fa fa-check"></i><b>11.8</b> Moving the legend</a></li>
<li class="chapter" data-level="11.9" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#combining-multiple-plots"><i class="fa fa-check"></i><b>11.9</b> Combining multiple plots</a></li>
<li class="chapter" data-level="11.10" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#saving-your-plot"><i class="fa fa-check"></i><b>11.10</b> Saving your plot</a></li>
<li class="chapter" data-level="11.11" data-path="pimping-your-plots.html"><a href="pimping-your-plots.html#final-word-on-plots"><i class="fa fa-check"></i><b>11.11</b> Final word on plots</a></li>
</ul></li>
<li class="part"><span><b>III Statistics</b></span></li>
<li class="chapter" data-level="12" data-path="randomisation-tests.html"><a href="randomisation-tests.html"><i class="fa fa-check"></i><b>12</b> Randomisation Tests</a>
<ul>
<li class="chapter" data-level="12.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#randomisation-test-in-r"><i class="fa fa-check"></i><b>12.1</b> Randomisation test in R</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#calculate-the-observed-difference"><i class="fa fa-check"></i><b>12.1.1</b> Calculate the observed difference</a></li>
<li class="chapter" data-level="12.1.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#null-distribution"><i class="fa fa-check"></i><b>12.1.2</b> Null distribution</a></li>
<li class="chapter" data-level="12.1.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-significance"><i class="fa fa-check"></i><b>12.1.3</b> Testing significance</a></li>
<li class="chapter" data-level="12.1.4" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-the-hypothesis"><i class="fa fa-check"></i><b>12.1.4</b> Testing the hypothesis</a></li>
<li class="chapter" data-level="12.1.5" data-path="randomisation-tests.html"><a href="randomisation-tests.html#writing-it-up"><i class="fa fa-check"></i><b>12.1.5</b> Writing it up</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#paired-randomisation-tests"><i class="fa fa-check"></i><b>12.2</b> Paired Randomisation Tests</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-randomisation-test"><i class="fa fa-check"></i><b>12.2.1</b> The randomisation test</a></li>
<li class="chapter" data-level="12.2.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#null-distribution-1"><i class="fa fa-check"></i><b>12.2.2</b> Null distribution</a></li>
<li class="chapter" data-level="12.2.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-formal-hypothesis-test"><i class="fa fa-check"></i><b>12.2.3</b> The formal hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#exercise-sexual-selection-in-hercules-beetles"><i class="fa fa-check"></i><b>12.3</b> Exercise: Sexual selection in Hercules beetles</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html"><i class="fa fa-check"></i><b>13</b> t-test: Comparing two means</a>
<ul>
<li class="chapter" data-level="13.1" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html#some-theory"><i class="fa fa-check"></i><b>13.1</b> Some theory</a></li>
<li class="chapter" data-level="13.2" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html#one-sample-t-test"><i class="fa fa-check"></i><b>13.2</b> One sample t-test</a></li>
<li class="chapter" data-level="13.3" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html#doing-it-by-hand---where-does-the-t-statistic-come-from"><i class="fa fa-check"></i><b>13.3</b> Doing it “by hand” - where does the t-statistic come from?</a></li>
<li class="chapter" data-level="13.4" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html#paired-t-test"><i class="fa fa-check"></i><b>13.4</b> Paired t-test</a></li>
<li class="chapter" data-level="13.5" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html#a-paired-t-test-is-a-one-sample-test."><i class="fa fa-check"></i><b>13.5</b> A paired t-test is a one-sample test.</a></li>
<li class="chapter" data-level="13.6" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html#two-sample-t-test"><i class="fa fa-check"></i><b>13.6</b> Two sample t-test</a></li>
<li class="chapter" data-level="13.7" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html#t-tests-are-linear-models"><i class="fa fa-check"></i><b>13.7</b> t-tests are linear models</a></li>
<li class="chapter" data-level="13.8" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html#exercise-sex-differences-in-fine-motor-skills"><i class="fa fa-check"></i><b>13.8</b> Exercise: Sex differences in fine motor skills</a></li>
<li class="chapter" data-level="13.9" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html#exercise-therapy-for-anorexia"><i class="fa fa-check"></i><b>13.9</b> Exercise: Therapy for anorexia</a></li>
<li class="chapter" data-level="13.10" data-path="t-test-comparing-two-means.html"><a href="t-test-comparing-two-means.html#exercise-compare-t-tests-with-randomisation-tests-optional"><i class="fa fa-check"></i><b>13.10</b> Exercise: Compare t-tests with randomisation tests (optional)</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="assumptions-in-linear-models.html"><a href="assumptions-in-linear-models.html"><i class="fa fa-check"></i><b>14</b> Assumptions in linear models</a>
<ul>
<li class="chapter" data-level="14.1" data-path="assumptions-in-linear-models.html"><a href="assumptions-in-linear-models.html#the-assumptions"><i class="fa fa-check"></i><b>14.1</b> The assumptions</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="anova-linear-models-with-a-single-categorical-explanatory-variable.html"><a href="anova-linear-models-with-a-single-categorical-explanatory-variable.html"><i class="fa fa-check"></i><b>15</b> ANOVA: Linear models with a single categorical explanatory variable</a>
<ul>
<li class="chapter" data-level="15.1" data-path="anova-linear-models-with-a-single-categorical-explanatory-variable.html"><a href="anova-linear-models-with-a-single-categorical-explanatory-variable.html#one-way-anova"><i class="fa fa-check"></i><b>15.1</b> One-way ANOVA</a></li>
<li class="chapter" data-level="15.2" data-path="anova-linear-models-with-a-single-categorical-explanatory-variable.html"><a href="anova-linear-models-with-a-single-categorical-explanatory-variable.html#fitting-an-anova-in-r"><i class="fa fa-check"></i><b>15.2</b> Fitting an ANOVA in R</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="anova-linear-models-with-a-single-categorical-explanatory-variable.html"><a href="anova-linear-models-with-a-single-categorical-explanatory-variable.html#where-are-the-differences"><i class="fa fa-check"></i><b>15.2.1</b> Where are the differences?</a></li>
<li class="chapter" data-level="15.2.2" data-path="anova-linear-models-with-a-single-categorical-explanatory-variable.html"><a href="anova-linear-models-with-a-single-categorical-explanatory-variable.html#tukeys-honestly-significant-difference-hsd"><i class="fa fa-check"></i><b>15.2.2</b> Tukey’s Honestly Significant Difference (HSD)</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="anova-linear-models-with-a-single-categorical-explanatory-variable.html"><a href="anova-linear-models-with-a-single-categorical-explanatory-variable.html#anova-calculation-by-hand."><i class="fa fa-check"></i><b>15.3</b> ANOVA calculation “by hand”.</a></li>
<li class="chapter" data-level="15.4" data-path="anova-linear-models-with-a-single-categorical-explanatory-variable.html"><a href="anova-linear-models-with-a-single-categorical-explanatory-variable.html#exercise-apple-tree-crop-yield"><i class="fa fa-check"></i><b>15.4</b> Exercise: Apple tree crop yield</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="linear-regression-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-regression-models-with-a-single-continuous-explanatory-variable.html"><i class="fa fa-check"></i><b>16</b> Linear regression: models with a single continuous explanatory variable</a>
<ul>
<li class="chapter" data-level="16.1" data-path="linear-regression-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-regression-models-with-a-single-continuous-explanatory-variable.html#some-theory-1"><i class="fa fa-check"></i><b>16.1</b> Some theory</a></li>
<li class="chapter" data-level="16.2" data-path="linear-regression-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-regression-models-with-a-single-continuous-explanatory-variable.html#evaluating-a-hypothesis-with-a-linear-regression-model"><i class="fa fa-check"></i><b>16.2</b> Evaluating a hypothesis with a linear regression model</a></li>
<li class="chapter" data-level="16.3" data-path="linear-regression-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-regression-models-with-a-single-continuous-explanatory-variable.html#assumptions"><i class="fa fa-check"></i><b>16.3</b> Assumptions</a></li>
<li class="chapter" data-level="16.4" data-path="linear-regression-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-regression-models-with-a-single-continuous-explanatory-variable.html#worked-example-height-hand-width-relationship"><i class="fa fa-check"></i><b>16.4</b> Worked example: height-hand width relationship</a></li>
<li class="chapter" data-level="16.5" data-path="linear-regression-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-regression-models-with-a-single-continuous-explanatory-variable.html#exercise-chirping-crickets"><i class="fa fa-check"></i><b>16.5</b> Exercise: Chirping crickets</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="ancova-linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="ancova-linear-models-with-categorical-and-continuous-explanatory-variables.html"><i class="fa fa-check"></i><b>17</b> ANCOVA: Linear models with categorical and continuous explanatory variables</a>
<ul>
<li class="chapter" data-level="17.1" data-path="ancova-linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="ancova-linear-models-with-categorical-and-continuous-explanatory-variables.html#the-height-hand-width-example."><i class="fa fa-check"></i><b>17.1</b> The height ~ hand width example.</a></li>
<li class="chapter" data-level="17.2" data-path="ancova-linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="ancova-linear-models-with-categorical-and-continuous-explanatory-variables.html#summarising-with-anova"><i class="fa fa-check"></i><b>17.2</b> Summarising with <code>anova</code></a></li>
<li class="chapter" data-level="17.3" data-path="ancova-linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="ancova-linear-models-with-categorical-and-continuous-explanatory-variables.html#the-summary-of-coefficients-summary"><i class="fa fa-check"></i><b>17.3</b> The summary of coefficients (<code>summary</code>)</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="n-way-anova-linear-models-with-1-categorical-explanatory-variables.html"><a href="n-way-anova-linear-models-with-1-categorical-explanatory-variables.html"><i class="fa fa-check"></i><b>18</b> n-way ANOVA: Linear models with &gt;1 categorical explanatory variables</a>
<ul>
<li class="chapter" data-level="18.1" data-path="n-way-anova-linear-models-with-1-categorical-explanatory-variables.html"><a href="n-way-anova-linear-models-with-1-categorical-explanatory-variables.html#fitting-a-two-way-anova-model"><i class="fa fa-check"></i><b>18.1</b> Fitting a two-way ANOVA model</a></li>
<li class="chapter" data-level="18.2" data-path="n-way-anova-linear-models-with-1-categorical-explanatory-variables.html"><a href="n-way-anova-linear-models-with-1-categorical-explanatory-variables.html#summarising-the-model-anova"><i class="fa fa-check"></i><b>18.2</b> Summarising the model (<code>anova</code>)</a></li>
<li class="chapter" data-level="18.3" data-path="n-way-anova-linear-models-with-1-categorical-explanatory-variables.html"><a href="n-way-anova-linear-models-with-1-categorical-explanatory-variables.html#summarising-the-model-summary"><i class="fa fa-check"></i><b>18.3</b> Summarising the model (<code>summary</code>)</a></li>
<li class="chapter" data-level="18.4" data-path="n-way-anova-linear-models-with-1-categorical-explanatory-variables.html"><a href="n-way-anova-linear-models-with-1-categorical-explanatory-variables.html#exercise-fish-behaviour"><i class="fa fa-check"></i><b>18.4</b> Exercise: Fish behaviour</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="evaluating-linear-models.html"><a href="evaluating-linear-models.html"><i class="fa fa-check"></i><b>19</b> Evaluating linear models</a>
<ul>
<li class="chapter" data-level="19.1" data-path="evaluating-linear-models.html"><a href="evaluating-linear-models.html#r-squared-value"><i class="fa fa-check"></i><b>19.1</b> R-squared value</a></li>
<li class="chapter" data-level="19.2" data-path="evaluating-linear-models.html"><a href="evaluating-linear-models.html#akaike-information-criterion-aic"><i class="fa fa-check"></i><b>19.2</b> Akaike Information Criterion (AIC)</a></li>
<li class="chapter" data-level="19.3" data-path="evaluating-linear-models.html"><a href="evaluating-linear-models.html#variance-partitioning"><i class="fa fa-check"></i><b>19.3</b> Variance partitioning</a></li>
<li class="chapter" data-level="19.4" data-path="evaluating-linear-models.html"><a href="evaluating-linear-models.html#conclusion"><i class="fa fa-check"></i><b>19.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html"><i class="fa fa-check"></i><b>20</b> Generalised linear models</a>
<ul>
<li class="chapter" data-level="20.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#count-data-with-poisson-errors."><i class="fa fa-check"></i><b>20.1</b> Count data with Poisson errors.</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-number-of-offspring-in-foxes."><i class="fa fa-check"></i><b>20.1.1</b> Example: Number of offspring in foxes.</a></li>
<li class="chapter" data-level="20.1.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-cancer-clusters"><i class="fa fa-check"></i><b>20.1.2</b> Example: Cancer clusters</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#exercise-maze-runner"><i class="fa fa-check"></i><b>20.2</b> Exercise: Maze runner</a></li>
<li class="chapter" data-level="20.3" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#overdispersion"><i class="fa fa-check"></i><b>20.3</b> Overdispersion</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html"><i class="fa fa-check"></i><b>21</b> Extending use cases of GLM</a>
<ul>
<li class="chapter" data-level="21.1" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#binomial-response-data"><i class="fa fa-check"></i><b>21.1</b> Binomial response data</a></li>
<li class="chapter" data-level="21.2" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-nfl-field-goals"><i class="fa fa-check"></i><b>21.2</b> Example: NFL field goals</a></li>
<li class="chapter" data-level="21.3" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-sex-ratio-in-turtles"><i class="fa fa-check"></i><b>21.3</b> Example: Sex ratio in turtles</a></li>
<li class="chapter" data-level="21.4" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-smoking"><i class="fa fa-check"></i><b>21.4</b> Example: Smoking</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html"><i class="fa fa-check"></i><b>22</b> Power analysis by simulation</a>
<ul>
<li class="chapter" data-level="22.1" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#type-i-and-ii-errors-and-statistical-power"><i class="fa fa-check"></i><b>22.1</b> Type I and II errors and statistical power</a></li>
<li class="chapter" data-level="22.2" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#what-determines-statistical-power"><i class="fa fa-check"></i><b>22.2</b> What determines statistical power?</a></li>
<li class="chapter" data-level="22.3" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#an-example-of-calculating-statistical-power."><i class="fa fa-check"></i><b>22.3</b> An example of calculating statistical power.</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#the-simulation"><i class="fa fa-check"></i><b>22.3.1</b> The simulation</a></li>
<li class="chapter" data-level="22.3.2" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#some-questions-for-you-to-address"><i class="fa fa-check"></i><b>22.3.2</b> Some questions for you to address:</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#summary"><i class="fa fa-check"></i><b>22.4</b> Summary</a></li>
<li class="chapter" data-level="22.5" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#extending-the-simulation-optional-advanced"><i class="fa fa-check"></i><b>22.5</b> Extending the simulation (optional, advanced)</a></li>
<li class="chapter" data-level="22.6" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#exercise-1-snails-on-the-move"><i class="fa fa-check"></i><b>22.6</b> Exercise 1: Snails on the move</a></li>
<li class="chapter" data-level="22.7" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#exercise-2-mouse-lemur-strength"><i class="fa fa-check"></i><b>22.7</b> Exercise 2: Mouse lemur strength</a></li>
</ul></li>
<li class="part"><span><b>IV Appendix</b></span></li>
<li class="chapter" data-level="23" data-path="examples-of-statistics-reporting.html"><a href="examples-of-statistics-reporting.html"><i class="fa fa-check"></i><b>23</b> Examples of statistics reporting</a>
<ul>
<li class="chapter" data-level="23.1" data-path="examples-of-statistics-reporting.html"><a href="examples-of-statistics-reporting.html#t-test"><i class="fa fa-check"></i><b>23.1</b> t-test</a></li>
<li class="chapter" data-level="23.2" data-path="examples-of-statistics-reporting.html"><a href="examples-of-statistics-reporting.html#simple-linear-regression-model"><i class="fa fa-check"></i><b>23.2</b> Simple linear regression model</a></li>
<li class="chapter" data-level="23.3" data-path="examples-of-statistics-reporting.html"><a href="examples-of-statistics-reporting.html#a-generalised-linear-model-glm"><i class="fa fa-check"></i><b>23.3</b> A Generalised linear model (GLM)</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="an-example-of-a-past-exam-2020.html"><a href="an-example-of-a-past-exam-2020.html"><i class="fa fa-check"></i><b>24</b> An example of a past Exam (2020)</a></li>
<li class="chapter" data-level="25" data-path="leveraging-chatgpt-for-r-programming-assistance.html"><a href="leveraging-chatgpt-for-r-programming-assistance.html"><i class="fa fa-check"></i><b>25</b> Leveraging ChatGPT for R Programming Assistance</a>
<ul>
<li class="chapter" data-level="25.1" data-path="leveraging-chatgpt-for-r-programming-assistance.html"><a href="leveraging-chatgpt-for-r-programming-assistance.html#introduction"><i class="fa fa-check"></i><b>25.1</b> Introduction</a></li>
<li class="chapter" data-level="25.2" data-path="leveraging-chatgpt-for-r-programming-assistance.html"><a href="leveraging-chatgpt-for-r-programming-assistance.html#overview"><i class="fa fa-check"></i><b>25.2</b> Overview</a></li>
<li class="chapter" data-level="25.3" data-path="leveraging-chatgpt-for-r-programming-assistance.html"><a href="leveraging-chatgpt-for-r-programming-assistance.html#what-is-a-large-language-model-llm-and-how-do-they-work"><i class="fa fa-check"></i><b>25.3</b> What is a Large Language Model (LLM) and how do they work?</a></li>
<li class="chapter" data-level="25.4" data-path="leveraging-chatgpt-for-r-programming-assistance.html"><a href="leveraging-chatgpt-for-r-programming-assistance.html#limitations"><i class="fa fa-check"></i><b>25.4</b> Limitations</a>
<ul>
<li class="chapter" data-level="25.4.1" data-path="leveraging-chatgpt-for-r-programming-assistance.html"><a href="leveraging-chatgpt-for-r-programming-assistance.html#limited-knowledge"><i class="fa fa-check"></i><b>25.4.1</b> Limited knowledge</a></li>
<li class="chapter" data-level="25.4.2" data-path="leveraging-chatgpt-for-r-programming-assistance.html"><a href="leveraging-chatgpt-for-r-programming-assistance.html#hallucination"><i class="fa fa-check"></i><b>25.4.2</b> Hallucination</a></li>
<li class="chapter" data-level="25.4.3" data-path="leveraging-chatgpt-for-r-programming-assistance.html"><a href="leveraging-chatgpt-for-r-programming-assistance.html#numerical-ability"><i class="fa fa-check"></i><b>25.4.3</b> Numerical ability</a></li>
</ul></li>
<li class="chapter" data-level="25.5" data-path="leveraging-chatgpt-for-r-programming-assistance.html"><a href="leveraging-chatgpt-for-r-programming-assistance.html#ethics-of-using-llms-in-education"><i class="fa fa-check"></i><b>25.5</b> Ethics of using LLMs in education</a></li>
<li class="chapter" data-level="25.6" data-path="leveraging-chatgpt-for-r-programming-assistance.html"><a href="leveraging-chatgpt-for-r-programming-assistance.html#use-cases-in-r"><i class="fa fa-check"></i><b>25.6</b> Use cases in R</a>
<ul>
<li class="chapter" data-level="25.6.1" data-path="leveraging-chatgpt-for-r-programming-assistance.html"><a href="leveraging-chatgpt-for-r-programming-assistance.html#finding-errors."><i class="fa fa-check"></i><b>25.6.1</b> Finding errors.</a></li>
<li class="chapter" data-level="25.6.2" data-path="leveraging-chatgpt-for-r-programming-assistance.html"><a href="leveraging-chatgpt-for-r-programming-assistance.html#explaining-code"><i class="fa fa-check"></i><b>25.6.2</b> Explaining code</a></li>
<li class="chapter" data-level="25.6.3" data-path="leveraging-chatgpt-for-r-programming-assistance.html"><a href="leveraging-chatgpt-for-r-programming-assistance.html#interpreting-output"><i class="fa fa-check"></i><b>25.6.3</b> Interpreting output</a></li>
<li class="chapter" data-level="25.6.4" data-path="leveraging-chatgpt-for-r-programming-assistance.html"><a href="leveraging-chatgpt-for-r-programming-assistance.html#solving-modelling-problems"><i class="fa fa-check"></i><b>25.6.4</b> Solving modelling problems</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Exam</b></span></li>
<li class="chapter" data-level="26" data-path="exam-december-2023.html"><a href="exam-december-2023.html"><i class="fa fa-check"></i><b>26</b> Exam December 2023</a>
<ul>
<li class="chapter" data-level="26.1" data-path="exam-december-2023.html"><a href="exam-december-2023.html#question-1-wine-quality-and-climate-10-points"><i class="fa fa-check"></i><b>26.1</b> Question 1: Wine quality and climate (10 points)</a></li>
<li class="chapter" data-level="26.2" data-path="exam-december-2023.html"><a href="exam-december-2023.html#question-2-foraging-in-blackbird-10-points"><i class="fa fa-check"></i><b>26.2</b> Question 2: Foraging in Blackbird (10 points)</a></li>
<li class="chapter" data-level="26.3" data-path="exam-december-2023.html"><a href="exam-december-2023.html#question-3-habitat-restoration-10-points"><i class="fa fa-check"></i><b>26.3</b> Question 3: Habitat restoration (10 points)</a></li>
<li class="chapter" data-level="26.4" data-path="exam-december-2023.html"><a href="exam-december-2023.html#question-4-nesting-success-in-urban-areas"><i class="fa fa-check"></i><b>26.4</b> Question 4: Nesting success in urban areas</a></li>
</ul></li>
<li class="part"><span><b>VI Solutions</b></span></li>
<li class="chapter" data-level="27" data-path="exercise-solutions.html"><a href="exercise-solutions.html"><i class="fa fa-check"></i><b>27</b> Exercise Solutions</a>
<ul>
<li class="chapter" data-level="27.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#californian-bird-diversity"><i class="fa fa-check"></i><b>27.1</b> Californian bird diversity</a></li>
<li class="chapter" data-level="27.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#wrangling-the-amniote-life-history-database"><i class="fa fa-check"></i><b>27.2</b> Wrangling the Amniote Life History Database</a></li>
<li class="chapter" data-level="27.3" data-path="exercise-solutions.html"><a href="exercise-solutions.html#temperature-effects-on-egg-laying-dates"><i class="fa fa-check"></i><b>27.3</b> Temperature effects on egg laying dates</a></li>
<li class="chapter" data-level="27.4" data-path="exercise-solutions.html"><a href="exercise-solutions.html#virtual-dice"><i class="fa fa-check"></i><b>27.4</b> Virtual dice</a></li>
<li class="chapter" data-level="27.5" data-path="exercise-solutions.html"><a href="exercise-solutions.html#sexual-selection-in-hercules-beetles"><i class="fa fa-check"></i><b>27.5</b> Sexual selection in Hercules beetles</a></li>
<li class="chapter" data-level="27.6" data-path="exercise-solutions.html"><a href="exercise-solutions.html#sex-differences-in-fine-motor-skills"><i class="fa fa-check"></i><b>27.6</b> Sex differences in fine motor skills</a></li>
<li class="chapter" data-level="27.7" data-path="exercise-solutions.html"><a href="exercise-solutions.html#therapy-for-anorexia"><i class="fa fa-check"></i><b>27.7</b> Therapy for anorexia</a></li>
<li class="chapter" data-level="27.8" data-path="exercise-solutions.html"><a href="exercise-solutions.html#compare-t-tests-with-randomisation-tests"><i class="fa fa-check"></i><b>27.8</b> Compare t-tests with randomisation tests</a></li>
<li class="chapter" data-level="27.9" data-path="exercise-solutions.html"><a href="exercise-solutions.html#apple-tree-crop-yield"><i class="fa fa-check"></i><b>27.9</b> Apple tree crop yield</a></li>
<li class="chapter" data-level="27.10" data-path="exercise-solutions.html"><a href="exercise-solutions.html#chirping-crickets"><i class="fa fa-check"></i><b>27.10</b> Chirping crickets</a></li>
<li class="chapter" data-level="27.11" data-path="exercise-solutions.html"><a href="exercise-solutions.html#fish-behaviour"><i class="fa fa-check"></i><b>27.11</b> Fish behaviour</a></li>
<li class="chapter" data-level="27.12" data-path="exercise-solutions.html"><a href="exercise-solutions.html#maze-runner"><i class="fa fa-check"></i><b>27.12</b> Maze runner</a></li>
<li class="chapter" data-level="27.13" data-path="exercise-solutions.html"><a href="exercise-solutions.html#snails-on-the-move"><i class="fa fa-check"></i><b>27.13</b> Snails on the move</a></li>
<li class="chapter" data-level="27.14" data-path="exercise-solutions.html"><a href="exercise-solutions.html#mouse-lemur-strength"><i class="fa fa-check"></i><b>27.14</b> Mouse lemur strength</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="model-answers-for-the-2023-exam.html"><a href="model-answers-for-the-2023-exam.html"><i class="fa fa-check"></i><b>28</b> Model answers for the 2023 exam</a>
<ul>
<li class="chapter" data-level="28.1" data-path="model-answers-for-the-2023-exam.html"><a href="model-answers-for-the-2023-exam.html#question-1-wine-quality-and-climate"><i class="fa fa-check"></i><b>28.1</b> Question 1: Wine quality and climate</a>
<ul>
<li class="chapter" data-level="28.1.1" data-path="model-answers-for-the-2023-exam.html"><a href="model-answers-for-the-2023-exam.html#introduction-1"><i class="fa fa-check"></i><b>28.1.1</b> Introduction</a></li>
</ul></li>
<li class="chapter" data-level="28.2" data-path="model-answers-for-the-2023-exam.html"><a href="model-answers-for-the-2023-exam.html#a"><i class="fa fa-check"></i><b>28.2</b> a)</a></li>
<li class="chapter" data-level="28.3" data-path="model-answers-for-the-2023-exam.html"><a href="model-answers-for-the-2023-exam.html#b"><i class="fa fa-check"></i><b>28.3</b> b)</a>
<ul>
<li class="chapter" data-level="28.3.1" data-path="model-answers-for-the-2023-exam.html"><a href="model-answers-for-the-2023-exam.html#c"><i class="fa fa-check"></i><b>28.3.1</b> c)</a></li>
</ul></li>
<li class="chapter" data-level="28.4" data-path="model-answers-for-the-2023-exam.html"><a href="model-answers-for-the-2023-exam.html#question-2-foraging-in-blackbird"><i class="fa fa-check"></i><b>28.4</b> Question 2: Foraging in Blackbird</a>
<ul>
<li class="chapter" data-level="28.4.1" data-path="model-answers-for-the-2023-exam.html"><a href="model-answers-for-the-2023-exam.html#a-1"><i class="fa fa-check"></i><b>28.4.1</b> a)</a></li>
<li class="chapter" data-level="28.4.2" data-path="model-answers-for-the-2023-exam.html"><a href="model-answers-for-the-2023-exam.html#b-1"><i class="fa fa-check"></i><b>28.4.2</b> b)</a></li>
<li class="chapter" data-level="28.4.3" data-path="model-answers-for-the-2023-exam.html"><a href="model-answers-for-the-2023-exam.html#c-1"><i class="fa fa-check"></i><b>28.4.3</b> c)</a></li>
</ul></li>
<li class="chapter" data-level="28.5" data-path="model-answers-for-the-2023-exam.html"><a href="model-answers-for-the-2023-exam.html#question-3-habitat-restoration"><i class="fa fa-check"></i><b>28.5</b> Question 3: Habitat restoration</a>
<ul>
<li class="chapter" data-level="28.5.1" data-path="model-answers-for-the-2023-exam.html"><a href="model-answers-for-the-2023-exam.html#a-2"><i class="fa fa-check"></i><b>28.5.1</b> a)</a></li>
<li class="chapter" data-level="28.5.2" data-path="model-answers-for-the-2023-exam.html"><a href="model-answers-for-the-2023-exam.html#b-2"><i class="fa fa-check"></i><b>28.5.2</b> b)</a></li>
<li class="chapter" data-level="28.5.3" data-path="model-answers-for-the-2023-exam.html"><a href="model-answers-for-the-2023-exam.html#advanced-level"><i class="fa fa-check"></i><b>28.5.3</b> Advanced level</a></li>
</ul></li>
<li class="chapter" data-level="28.6" data-path="model-answers-for-the-2023-exam.html"><a href="model-answers-for-the-2023-exam.html#question-4"><i class="fa fa-check"></i><b>28.6</b> Question 4:</a>
<ul>
<li class="chapter" data-level="28.6.1" data-path="model-answers-for-the-2023-exam.html"><a href="model-answers-for-the-2023-exam.html#a-3"><i class="fa fa-check"></i><b>28.6.1</b> a)</a></li>
<li class="chapter" data-level="28.6.2" data-path="model-answers-for-the-2023-exam.html"><a href="model-answers-for-the-2023-exam.html#b-and-c"><i class="fa fa-check"></i><b>28.6.2</b> b) and (c)</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BB852 - Data handling, visualisation and statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="model-answers-for-the-2023-exam" class="section level1 hasAnchor" number="28">
<h1><span class="header-section-number">Chapter 28</span> Model answers for the 2023 exam<a href="model-answers-for-the-2023-exam.html#model-answers-for-the-2023-exam" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="question-1-wine-quality-and-climate" class="section level2 hasAnchor" number="28.1">
<h2><span class="header-section-number">28.1</span> Question 1: Wine quality and climate<a href="model-answers-for-the-2023-exam.html#question-1-wine-quality-and-climate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="introduction-1" class="section level3 hasAnchor" number="28.1.1">
<h3><span class="header-section-number">28.1.1</span> Introduction<a href="model-answers-for-the-2023-exam.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This question investigates the relationship between wine ratings and regions in Spain, focusing on data post-1980 and excluding non-vintage wines.</p>
</div>
</div>
<div id="a" class="section level2 hasAnchor" number="28.2">
<h2><span class="header-section-number">28.2</span> a)<a href="model-answers-for-the-2023-exam.html#a" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, I set up we R environment with some useful packages, like <code>dplyr</code> for handling data and <code>ggplot2</code> for making plots.</p>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="model-answers-for-the-2023-exam.html#cb670-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb670-2"><a href="model-answers-for-the-2023-exam.html#cb670-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<p>We then load two datasets: <code>winesSpain.csv</code> for wine ratings and <code>SpainSurfaceTemp.csv</code> for temperature data in Spain. On my computer, these files are in a folder called <code>DataSetLibrary</code>.</p>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="model-answers-for-the-2023-exam.html#cb671-1" tabindex="-1"></a>winesSpain <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;DataSetLibrary/winesSpain.csv&quot;</span>)</span>
<span id="cb671-2"><a href="model-answers-for-the-2023-exam.html#cb671-2" tabindex="-1"></a>SpainSurfaceTemp <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;DataSetLibrary/SpainSurfaceTemp.csv&quot;</span>)</span></code></pre></div>
<p>Next, I clean up the wine data. I get rid of entries where the year is listed as “<code>N.V.</code>” (non-vintage) and keep only the data from 1980 onwards.</p>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb672-1"><a href="model-answers-for-the-2023-exam.html#cb672-1" tabindex="-1"></a>winesSpainCleaned <span class="ot">&lt;-</span> winesSpain <span class="sc">%&gt;%</span></span>
<span id="cb672-2"><a href="model-answers-for-the-2023-exam.html#cb672-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">!=</span> <span class="st">&quot;N.V.&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb672-3"><a href="model-answers-for-the-2023-exam.html#cb672-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.numeric</span>(year)) <span class="sc">%&gt;%</span> </span>
<span id="cb672-4"><a href="model-answers-for-the-2023-exam.html#cb672-4" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1980</span>)</span></code></pre></div>
<p>After cleaning, I analyse the data. I group the wine data by region and calculate three things for each region: the number of wines rated (number of data points), the average rating (mean quality), and how much the ratings vary (standard deviation of quality). I then arrange these groups so that the regions with the most wines come first.</p>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="model-answers-for-the-2023-exam.html#cb673-1" tabindex="-1"></a>summaryTable <span class="ot">&lt;-</span> winesSpainCleaned <span class="sc">%&gt;%</span></span>
<span id="cb673-2"><a href="model-answers-for-the-2023-exam.html#cb673-2" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span></span>
<span id="cb673-3"><a href="model-answers-for-the-2023-exam.html#cb673-3" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb673-4"><a href="model-answers-for-the-2023-exam.html#cb673-4" tabindex="-1"></a>    <span class="at">NumberOfDataPoints =</span> <span class="fu">n</span>(),</span>
<span id="cb673-5"><a href="model-answers-for-the-2023-exam.html#cb673-5" tabindex="-1"></a>    <span class="at">MeanQuality =</span> <span class="fu">mean</span>(rating, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb673-6"><a href="model-answers-for-the-2023-exam.html#cb673-6" tabindex="-1"></a>    <span class="at">StdDevQuality =</span> <span class="fu">sd</span>(rating, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb673-7"><a href="model-answers-for-the-2023-exam.html#cb673-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb673-8"><a href="model-answers-for-the-2023-exam.html#cb673-8" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(NumberOfDataPoints))</span></code></pre></div>
<p>My main focus is on the top 10 regions with the most data. I round the average rating and the variation in ratings to three decimal places to make them easier to read.</p>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb674-1"><a href="model-answers-for-the-2023-exam.html#cb674-1" tabindex="-1"></a>top10Regions <span class="ot">&lt;-</span> <span class="fu">head</span>(summaryTable, <span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb674-2"><a href="model-answers-for-the-2023-exam.html#cb674-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MeanQuality =</span> <span class="fu">round</span>(MeanQuality,<span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb674-3"><a href="model-answers-for-the-2023-exam.html#cb674-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">StdDevQuality =</span> <span class="fu">round</span>(StdDevQuality,<span class="dv">3</span>)) </span></code></pre></div>
<p>I’m not expecting the students to do this, a simpler way is fine.</p>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="model-answers-for-the-2023-exam.html#cb675-1" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb675-2"><a href="model-answers-for-the-2023-exam.html#cb675-2" tabindex="-1"></a><span class="fu">kable</span>(top10Regions, <span class="at">format =</span> <span class="st">&quot;html&quot;</span>, </span>
<span id="cb675-3"><a href="model-answers-for-the-2023-exam.html#cb675-3" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Top 10 Regions by Number of Data Points&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-462">Table 28.1: </span>Top 10 Regions by Number of Data Points
</caption>
<thead>
<tr>
<th style="text-align:left;">
region
</th>
<th style="text-align:right;">
NumberOfDataPoints
</th>
<th style="text-align:right;">
MeanQuality
</th>
<th style="text-align:right;">
StdDevQuality
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Rioja
</td>
<td style="text-align:right;">
2423
</td>
<td style="text-align:right;">
4.232
</td>
<td style="text-align:right;">
0.084
</td>
</tr>
<tr>
<td style="text-align:left;">
Ribera del Duero
</td>
<td style="text-align:right;">
1395
</td>
<td style="text-align:right;">
4.292
</td>
<td style="text-align:right;">
0.157
</td>
</tr>
<tr>
<td style="text-align:left;">
Priorato
</td>
<td style="text-align:right;">
686
</td>
<td style="text-align:right;">
4.273
</td>
<td style="text-align:right;">
0.126
</td>
</tr>
<tr>
<td style="text-align:left;">
Toro
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
4.266
</td>
<td style="text-align:right;">
0.141
</td>
</tr>
<tr>
<td style="text-align:left;">
Vino de Espana
</td>
<td style="text-align:right;">
261
</td>
<td style="text-align:right;">
4.243
</td>
<td style="text-align:right;">
0.113
</td>
</tr>
<tr>
<td style="text-align:left;">
Rias Baixas
</td>
<td style="text-align:right;">
252
</td>
<td style="text-align:right;">
4.215
</td>
<td style="text-align:right;">
0.050
</td>
</tr>
<tr>
<td style="text-align:left;">
Bierzo
</td>
<td style="text-align:right;">
243
</td>
<td style="text-align:right;">
4.218
</td>
<td style="text-align:right;">
0.071
</td>
</tr>
<tr>
<td style="text-align:left;">
Mallorca
</td>
<td style="text-align:right;">
237
</td>
<td style="text-align:right;">
4.215
</td>
<td style="text-align:right;">
0.061
</td>
</tr>
<tr>
<td style="text-align:left;">
Alicante
</td>
<td style="text-align:right;">
232
</td>
<td style="text-align:right;">
4.209
</td>
<td style="text-align:right;">
0.048
</td>
</tr>
<tr>
<td style="text-align:left;">
Costers del Segre
</td>
<td style="text-align:right;">
232
</td>
<td style="text-align:right;">
4.208
</td>
<td style="text-align:right;">
0.044
</td>
</tr>
</tbody>
</table>
</div>
<div id="b" class="section level2 hasAnchor" number="28.3">
<h2><span class="header-section-number">28.3</span> b)<a href="model-answers-for-the-2023-exam.html#b" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this part of our analysis, I focus on the two regions in Spain that have the most data points in our dataset. I’ll create a plot for these regions showing how the average wine rating has changed over time. I will also add trend lines to the plot to help me see the overall trends more clearly.</p>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb676-1"><a href="model-answers-for-the-2023-exam.html#cb676-1" tabindex="-1"></a>topTwoRegions <span class="ot">&lt;-</span> top10Regions<span class="sc">$</span>region[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code></pre></div>
<p>I then filter the wine data to these regions only.</p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="model-answers-for-the-2023-exam.html#cb677-1" tabindex="-1"></a>topRegionsData <span class="ot">&lt;-</span> winesSpainCleaned <span class="sc">%&gt;%</span></span>
<span id="cb677-2"><a href="model-answers-for-the-2023-exam.html#cb677-2" tabindex="-1"></a>  <span class="fu">filter</span>(region <span class="sc">%in%</span> topTwoRegions) <span class="sc">%&gt;%</span></span>
<span id="cb677-3"><a href="model-answers-for-the-2023-exam.html#cb677-3" tabindex="-1"></a>  <span class="fu">group_by</span>(year, region) <span class="sc">%&gt;%</span></span>
<span id="cb677-4"><a href="model-answers-for-the-2023-exam.html#cb677-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">AvgRating =</span> <span class="fu">mean</span>(rating, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p>THe plot is done using <code>ggplot</code> like this:</p>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb678-1"><a href="model-answers-for-the-2023-exam.html#cb678-1" tabindex="-1"></a><span class="fu">ggplot</span>(topRegionsData, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(year), <span class="at">y =</span> AvgRating, <span class="at">color =</span> region)) <span class="sc">+</span></span>
<span id="cb678-2"><a href="model-answers-for-the-2023-exam.html#cb678-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb678-3"><a href="model-answers-for-the-2023-exam.html#cb678-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb678-4"><a href="model-answers-for-the-2023-exam.html#cb678-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Average Wine Rating Over Time in Top Two Regions&quot;</span>,</span>
<span id="cb678-5"><a href="model-answers-for-the-2023-exam.html#cb678-5" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb678-6"><a href="model-answers-for-the-2023-exam.html#cb678-6" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Average Rating&quot;</span>,</span>
<span id="cb678-7"><a href="model-answers-for-the-2023-exam.html#cb678-7" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Region&quot;</span>) <span class="sc">+</span></span>
<span id="cb678-8"><a href="model-answers-for-the-2023-exam.html#cb678-8" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-464-1.png" width="672" /></p>
<div id="c" class="section level3 hasAnchor" number="28.3.1">
<h3><span class="header-section-number">28.3.1</span> c)<a href="model-answers-for-the-2023-exam.html#c" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this section, I’ll investigate how wine quality correlates with the average temperature in Spain. I will select one of the two regions with the most data points and merge the wine data with the temperature data. Then, I’ll create a plot to visualise any potential relationship between wine quality and temperature for this chosen region.</p>
<p>First I pick the first region (I could pick the 2nd region by changing the <code>[1]</code> part to <code>[2]</code>).</p>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="model-answers-for-the-2023-exam.html#cb679-1" tabindex="-1"></a>selectedRegion <span class="ot">&lt;-</span> topTwoRegions[<span class="dv">1</span>]</span></code></pre></div>
<p>Next I filter the data to only include the Merge the wine data with temperature data from the <code>SpainSurfaceTemp</code> data frame.</p>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb680-1"><a href="model-answers-for-the-2023-exam.html#cb680-1" tabindex="-1"></a>mergedData <span class="ot">&lt;-</span> winesSpainCleaned <span class="sc">%&gt;%</span></span>
<span id="cb680-2"><a href="model-answers-for-the-2023-exam.html#cb680-2" tabindex="-1"></a>  <span class="fu">filter</span>(region <span class="sc">==</span> selectedRegion) <span class="sc">%&gt;%</span></span>
<span id="cb680-3"><a href="model-answers-for-the-2023-exam.html#cb680-3" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb680-4"><a href="model-answers-for-the-2023-exam.html#cb680-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">AvgRating =</span> <span class="fu">mean</span>(rating, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb680-5"><a href="model-answers-for-the-2023-exam.html#cb680-5" tabindex="-1"></a>  <span class="fu">left_join</span>(SpainSurfaceTemp, <span class="at">by =</span> <span class="st">&quot;year&quot;</span>)</span></code></pre></div>
<p>Lastly I can make the plot, which shows a negative relationship between wine quality and temperature.</p>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="model-answers-for-the-2023-exam.html#cb681-1" tabindex="-1"></a><span class="fu">ggplot</span>(mergedData, <span class="fu">aes</span>(<span class="at">x =</span> tempC, <span class="at">y =</span> AvgRating)) <span class="sc">+</span></span>
<span id="cb681-2"><a href="model-answers-for-the-2023-exam.html#cb681-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb681-3"><a href="model-answers-for-the-2023-exam.html#cb681-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb681-4"><a href="model-answers-for-the-2023-exam.html#cb681-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Relationship between Wine Quality and Temperature in&quot;</span>, selectedRegion),</span>
<span id="cb681-5"><a href="model-answers-for-the-2023-exam.html#cb681-5" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Average Temperature&quot;</span>,</span>
<span id="cb681-6"><a href="model-answers-for-the-2023-exam.html#cb681-6" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Average Wine Rating&quot;</span>) <span class="sc">+</span></span>
<span id="cb681-7"><a href="model-answers-for-the-2023-exam.html#cb681-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-467-1.png" width="672" /></p>

</div>
</div>
<div id="question-2-foraging-in-blackbird" class="section level2 hasAnchor" number="28.4">
<h2><span class="header-section-number">28.4</span> Question 2: Foraging in Blackbird<a href="model-answers-for-the-2023-exam.html#question-2-foraging-in-blackbird" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This analysis aims to understand the impact of rising winter temperatures, a consequence of climate change, on the foraging behavior of the Eurasian Blackbird (<em>Turdus merula</em>). My hypothesis suggests that warmer temperatures would reduce the time these birds spend foraging due to lower energy demands for thermoregulation.</p>
<div id="a-1" class="section level3 hasAnchor" number="28.4.1">
<h3><span class="header-section-number">28.4.1</span> a)<a href="model-answers-for-the-2023-exam.html#a-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb682-1"><a href="model-answers-for-the-2023-exam.html#cb682-1" tabindex="-1"></a>blackbirdData <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;DataSetLibrary/blackbird_foraging.csv&quot;</span>)</span></code></pre></div>
<p>I examine the data to see if I need to clean it</p>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="model-answers-for-the-2023-exam.html#cb683-1" tabindex="-1"></a><span class="fu">summary</span>(blackbirdData)</span></code></pre></div>
<pre><code>##     group            foragingTime      ringNumber       
##  Length:30          Min.   :-0.1310   Length:30         
##  Class :character   1st Qu.: 0.3430   Class :character  
##  Mode  :character   Median : 0.5720   Mode  :character  
##                     Mean   : 0.4843                     
##                     3rd Qu.: 0.6630                     
##                     Max.   : 0.8290                     
##                     NA&#39;s   :1</code></pre>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="model-answers-for-the-2023-exam.html#cb685-1" tabindex="-1"></a><span class="fu">table</span>(blackbirdData<span class="sc">$</span>group)</span></code></pre></div>
<pre><code>## 
##    contrl   Control Treatment 
##         4        11        15</code></pre>
<p>This shows that there are some negative values for foragingTime. These make no sense, so I will assume they are incorrect and remove these.
I can also see there are errors in the group column. I will correct those.</p>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="model-answers-for-the-2023-exam.html#cb687-1" tabindex="-1"></a>blackbirdData <span class="ot">&lt;-</span> blackbirdData <span class="sc">%&gt;%</span></span>
<span id="cb687-2"><a href="model-answers-for-the-2023-exam.html#cb687-2" tabindex="-1"></a>  <span class="fu">filter</span>(foragingTime <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb687-3"><a href="model-answers-for-the-2023-exam.html#cb687-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="st">&quot;contrl&quot;</span>, <span class="st">&quot;Control&quot;</span>, group))</span></code></pre></div>
<p>Now the data are ready to analyse.</p>
</div>
<div id="b-1" class="section level3 hasAnchor" number="28.4.2">
<h3><span class="header-section-number">28.4.2</span> b)<a href="model-answers-for-the-2023-exam.html#b-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I first want to plot the data:</p>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="model-answers-for-the-2023-exam.html#cb688-1" tabindex="-1"></a><span class="co"># Comparing foraging times between control and treatment groups</span></span>
<span id="cb688-2"><a href="model-answers-for-the-2023-exam.html#cb688-2" tabindex="-1"></a><span class="fu">ggplot</span>(blackbirdData, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> foragingTime)) <span class="sc">+</span></span>
<span id="cb688-3"><a href="model-answers-for-the-2023-exam.html#cb688-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb688-4"><a href="model-answers-for-the-2023-exam.html#cb688-4" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb688-5"><a href="model-answers-for-the-2023-exam.html#cb688-5" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Foraging Times of Eurasian Blackbirds in Different Temperature Conditions&quot;</span>,</span>
<span id="cb688-6"><a href="model-answers-for-the-2023-exam.html#cb688-6" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb688-7"><a href="model-answers-for-the-2023-exam.html#cb688-7" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Foraging Time (Proportion)&quot;</span></span>
<span id="cb688-8"><a href="model-answers-for-the-2023-exam.html#cb688-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb688-9"><a href="model-answers-for-the-2023-exam.html#cb688-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-472-1.png" width="672" />
It looks like there is a difference between groups. But I want to confirm this with a randomisation test.</p>
</div>
<div id="c-1" class="section level3 hasAnchor" number="28.4.3">
<h3><span class="header-section-number">28.4.3</span> c)<a href="model-answers-for-the-2023-exam.html#c-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Method</strong></p>
<p>For a report I would write the method like this:</p>
<p><em>To test whether effect of the heating treatment on time spent foraging is statistically significant I did a 1000 replicate randomisation test with the null hypothesis being that there is no difference between the group means, and the alternative hypothesis that the mean for the heated group is lower than the control group. I compared the observed difference to this null distribution to calculate a p-value in a one-sided test.</em></p>
<p>Or like this :</p>
<p><em>I employ a randomisation test to assess the significance of differences in foraging times between the control and treatment groups. This method involves repeatedly shuffling the group labels and recalculating the difference in mean foraging times across these shuffled samples to generate a null distribution. I did this 1000 times. The p-value is determined by the proportion of shuffled datasets where the observed difference is at least as extreme as in the original data.</em></p>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="model-answers-for-the-2023-exam.html#cb689-1" tabindex="-1"></a>(observedMeans <span class="ot">&lt;-</span> blackbirdData <span class="sc">%&gt;%</span></span>
<span id="cb689-2"><a href="model-answers-for-the-2023-exam.html#cb689-2" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span> <span class="co"># group the data by treatment</span></span>
<span id="cb689-3"><a href="model-answers-for-the-2023-exam.html#cb689-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(foragingTime)) <span class="sc">%&gt;%</span> <span class="co"># calculate means</span></span>
<span id="cb689-4"><a href="model-answers-for-the-2023-exam.html#cb689-4" tabindex="-1"></a>  <span class="fu">pull</span>(mean)) <span class="co"># extract the mean vector</span></span></code></pre></div>
<pre><code>## [1] 0.6490000 0.3983846</code></pre>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="model-answers-for-the-2023-exam.html#cb691-1" tabindex="-1"></a>(observedDiff <span class="ot">&lt;-</span> <span class="fu">diff</span>(observedMeans))</span></code></pre></div>
<pre><code>## [1] -0.2506154</code></pre>
<p>Now I shuffle the data repeatedly…</p>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="model-answers-for-the-2023-exam.html#cb693-1" tabindex="-1"></a>nReps <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb693-2"><a href="model-answers-for-the-2023-exam.html#cb693-2" tabindex="-1"></a>shuffledData <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span>nReps) <span class="sc">%&gt;%</span></span>
<span id="cb693-3"><a href="model-answers-for-the-2023-exam.html#cb693-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">shuffledDiffs =</span> <span class="fu">replicate</span>(</span>
<span id="cb693-4"><a href="model-answers-for-the-2023-exam.html#cb693-4" tabindex="-1"></a>    nReps,</span>
<span id="cb693-5"><a href="model-answers-for-the-2023-exam.html#cb693-5" tabindex="-1"></a>    blackbirdData <span class="sc">%&gt;%</span></span>
<span id="cb693-6"><a href="model-answers-for-the-2023-exam.html#cb693-6" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">sample</span>(group)) <span class="sc">%&gt;%</span></span>
<span id="cb693-7"><a href="model-answers-for-the-2023-exam.html#cb693-7" tabindex="-1"></a>      <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span></span>
<span id="cb693-8"><a href="model-answers-for-the-2023-exam.html#cb693-8" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(foragingTime)) <span class="sc">%&gt;%</span></span>
<span id="cb693-9"><a href="model-answers-for-the-2023-exam.html#cb693-9" tabindex="-1"></a>      <span class="fu">pull</span>(mean) <span class="sc">%&gt;%</span></span>
<span id="cb693-10"><a href="model-answers-for-the-2023-exam.html#cb693-10" tabindex="-1"></a>      <span class="fu">diff</span>()</span>
<span id="cb693-11"><a href="model-answers-for-the-2023-exam.html#cb693-11" tabindex="-1"></a>  ))</span></code></pre></div>
<p>I can look at how this distribution of differences is compared to the observed difference like this:</p>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="model-answers-for-the-2023-exam.html#cb694-1" tabindex="-1"></a>(p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(shuffledData, <span class="fu">aes</span>(<span class="at">x =</span> shuffledDiffs)) <span class="sc">+</span></span>
<span id="cb694-2"><a href="model-answers-for-the-2023-exam.html#cb694-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb694-3"><a href="model-answers-for-the-2023-exam.html#cb694-3" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb694-4"><a href="model-answers-for-the-2023-exam.html#cb694-4" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Null distribution of differences&quot;</span>) <span class="sc">+</span></span>
<span id="cb694-5"><a href="model-answers-for-the-2023-exam.html#cb694-5" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> observedDiff)</span>
<span id="cb694-6"><a href="model-answers-for-the-2023-exam.html#cb694-6" tabindex="-1"></a> )</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-477-1.png" width="672" /></p>
<p>There is clearly a very significant difference.</p>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb695-1"><a href="model-answers-for-the-2023-exam.html#cb695-1" tabindex="-1"></a><span class="fu">table</span>(shuffledData<span class="sc">$</span>shuffledDiffs <span class="sc">&lt;=</span> observedDiff)</span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##   998     2</code></pre>
<p>The p-value is 0.002 (calculated as 2/ 1000)</p>
<p>I would write this up for a <strong>results</strong> section like this:</p>
<p><em>The observed mean values of the control and treatment groups 0.649 and 0.398 respectively and the difference between them is therefore -0.251 (treatment mean - control mean). Only 2 of the 1000 null distribution replicates were as low or lower than my observed difference value. I conclude that the observed difference between the means of the two treatment groups is statistically significant (p = 0.002)</em>.</p>

</div>
</div>
<div id="question-3-habitat-restoration" class="section level2 hasAnchor" number="28.5">
<h2><span class="header-section-number">28.5</span> Question 3: Habitat restoration<a href="model-answers-for-the-2023-exam.html#question-3-habitat-restoration" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The aim of this question was to test the hypothesis that habitat restoration leads to an increase in the average body mass of a specific bird species. I hypothesize that restored habitats may support healthier bird populations, reflected in larger body mass.</p>
<p>The form of the expected data lends itself to a t-test. So I will use that method.</p>
<div id="a-2" class="section level3 hasAnchor" number="28.5.1">
<h3><span class="header-section-number">28.5.1</span> a)<a href="model-answers-for-the-2023-exam.html#a-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First I will import the data to examine it.</p>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb697-1"><a href="model-answers-for-the-2023-exam.html#cb697-1" tabindex="-1"></a>restoration <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;DataSetLibrary/habitat_restoration.csv&quot;</span>)</span>
<span id="cb697-2"><a href="model-answers-for-the-2023-exam.html#cb697-2" tabindex="-1"></a><span class="fu">summary</span>(restoration)</span></code></pre></div>
<pre><code>##     BodySize    
##  Min.   : 88.0  
##  1st Qu.:135.8  
##  Median :146.0  
##  Mean   :146.0  
##  3rd Qu.:160.2  
##  Max.   :185.0</code></pre>
<p>I can see that the data set is just one column of data called <code>BodySize</code>.
I can get the mean and standard deviation in a couple of ways. For example like this:</p>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb699-1"><a href="model-answers-for-the-2023-exam.html#cb699-1" tabindex="-1"></a><span class="fu">mean</span>(restoration<span class="sc">$</span>BodySize)</span></code></pre></div>
<pre><code>## [1] 146.0319</code></pre>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="model-answers-for-the-2023-exam.html#cb701-1" tabindex="-1"></a><span class="fu">sd</span>(restoration<span class="sc">$</span>BodySize)</span></code></pre></div>
<pre><code>## [1] 18.42358</code></pre>
<p>Or using <code>dplyr</code> like this:</p>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="model-answers-for-the-2023-exam.html#cb703-1" tabindex="-1"></a>(dataSummary <span class="ot">&lt;-</span> restoration <span class="sc">%&gt;%</span> </span>
<span id="cb703-2"><a href="model-answers-for-the-2023-exam.html#cb703-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanVal =</span> <span class="fu">mean</span>(BodySize), <span class="at">sdVal =</span> <span class="fu">sd</span>(BodySize)))</span></code></pre></div>
<pre><code>##    meanVal    sdVal
## 1 146.0319 18.42358</code></pre>
</div>
<div id="b-2" class="section level3 hasAnchor" number="28.5.2">
<h3><span class="header-section-number">28.5.2</span> b)<a href="model-answers-for-the-2023-exam.html#b-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I now conduct a power analysis to get the required sample size for 80% power.</p>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="model-answers-for-the-2023-exam.html#cb705-1" tabindex="-1"></a>controlMean <span class="ot">&lt;-</span> dataSummary<span class="sc">$</span>meanVal</span>
<span id="cb705-2"><a href="model-answers-for-the-2023-exam.html#cb705-2" tabindex="-1"></a>treatmentMean <span class="ot">&lt;-</span> controlMean <span class="sc">*</span> <span class="fl">1.2</span> <span class="co"># A 20% increase compared to the control</span></span>
<span id="cb705-3"><a href="model-answers-for-the-2023-exam.html#cb705-3" tabindex="-1"></a>sdValue <span class="ot">&lt;-</span> dataSummary<span class="sc">$</span>sdVal</span>
<span id="cb705-4"><a href="model-answers-for-the-2023-exam.html#cb705-4" tabindex="-1"></a>sampleSize <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># I&#39;ll start with a small sample size and see what happens!</span></span></code></pre></div>
<p>I can then simulate a t-test using <code>t.test</code> and use <code>replicate</code> to repeat the simulation any number of times.</p>
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb706-1"><a href="model-answers-for-the-2023-exam.html#cb706-1" tabindex="-1"></a>nReps <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb706-2"><a href="model-answers-for-the-2023-exam.html#cb706-2" tabindex="-1"></a></span>
<span id="cb706-3"><a href="model-answers-for-the-2023-exam.html#cb706-3" tabindex="-1"></a>powerResults <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb706-4"><a href="model-answers-for-the-2023-exam.html#cb706-4" tabindex="-1"></a>  nReps,</span>
<span id="cb706-5"><a href="model-answers-for-the-2023-exam.html#cb706-5" tabindex="-1"></a>  <span class="fu">t.test</span>(</span>
<span id="cb706-6"><a href="model-answers-for-the-2023-exam.html#cb706-6" tabindex="-1"></a>    <span class="fu">rnorm</span>(sampleSize, controlMean, sdValue),</span>
<span id="cb706-7"><a href="model-answers-for-the-2023-exam.html#cb706-7" tabindex="-1"></a>    <span class="fu">rnorm</span>(sampleSize, treatmentMean, sdValue)</span>
<span id="cb706-8"><a href="model-answers-for-the-2023-exam.html#cb706-8" tabindex="-1"></a>  )<span class="sc">$</span>p.value</span>
<span id="cb706-9"><a href="model-answers-for-the-2023-exam.html#cb706-9" tabindex="-1"></a>)</span></code></pre></div>
<p>I then can ask how many of the 1000 replicates produced statistically significant p-values (i.e. &lt; 0.05).</p>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="model-answers-for-the-2023-exam.html#cb707-1" tabindex="-1"></a><span class="fu">sum</span>(powerResults <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 909</code></pre>
<p>The power is given as a percentage like this:</p>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="model-answers-for-the-2023-exam.html#cb709-1" tabindex="-1"></a>(<span class="fu">sum</span>(powerResults <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">/</span> nReps) <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 90.9</code></pre>
<p>Therefore, in this case, it looks like I can get away with a smaller sample size.</p>
</div>
<div id="advanced-level" class="section level3 hasAnchor" number="28.5.3">
<h3><span class="header-section-number">28.5.3</span> Advanced level<a href="model-answers-for-the-2023-exam.html#advanced-level" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Rather than looking individually at different sample size, I could look systematically at how power changes with sample size like this:</p>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb711-1"><a href="model-answers-for-the-2023-exam.html#cb711-1" tabindex="-1"></a><span class="co"># Set up a data frame for the simulation results</span></span>
<span id="cb711-2"><a href="model-answers-for-the-2023-exam.html#cb711-2" tabindex="-1"></a>simulData <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">sampleSize =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>)</span>
<span id="cb711-3"><a href="model-answers-for-the-2023-exam.html#cb711-3" tabindex="-1"></a></span>
<span id="cb711-4"><a href="model-answers-for-the-2023-exam.html#cb711-4" tabindex="-1"></a><span class="co"># Set basic values</span></span>
<span id="cb711-5"><a href="model-answers-for-the-2023-exam.html#cb711-5" tabindex="-1"></a>controlMean <span class="ot">&lt;-</span> dataSummary<span class="sc">$</span>meanVal</span>
<span id="cb711-6"><a href="model-answers-for-the-2023-exam.html#cb711-6" tabindex="-1"></a>treatmentMean <span class="ot">&lt;-</span> controlMean <span class="sc">*</span> <span class="fl">1.2</span> <span class="co"># A 20% increase compared to the control</span></span>
<span id="cb711-7"><a href="model-answers-for-the-2023-exam.html#cb711-7" tabindex="-1"></a>sdValue <span class="ot">&lt;-</span> dataSummary<span class="sc">$</span>sdVal</span>
<span id="cb711-8"><a href="model-answers-for-the-2023-exam.html#cb711-8" tabindex="-1"></a></span>
<span id="cb711-9"><a href="model-answers-for-the-2023-exam.html#cb711-9" tabindex="-1"></a><span class="co"># Function to do the t-test</span></span>
<span id="cb711-10"><a href="model-answers-for-the-2023-exam.html#cb711-10" tabindex="-1"></a>pwr <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb711-11"><a href="model-answers-for-the-2023-exam.html#cb711-11" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">replicate</span>(</span>
<span id="cb711-12"><a href="model-answers-for-the-2023-exam.html#cb711-12" tabindex="-1"></a>    <span class="dv">1000</span>,</span>
<span id="cb711-13"><a href="model-answers-for-the-2023-exam.html#cb711-13" tabindex="-1"></a>    <span class="fu">t.test</span>(</span>
<span id="cb711-14"><a href="model-answers-for-the-2023-exam.html#cb711-14" tabindex="-1"></a>      <span class="fu">rnorm</span>(n, controlMean, sdValue),</span>
<span id="cb711-15"><a href="model-answers-for-the-2023-exam.html#cb711-15" tabindex="-1"></a>      <span class="fu">rnorm</span>(n, treatmentMean, sdValue)</span>
<span id="cb711-16"><a href="model-answers-for-the-2023-exam.html#cb711-16" tabindex="-1"></a>    )<span class="sc">$</span>p.value</span>
<span id="cb711-17"><a href="model-answers-for-the-2023-exam.html#cb711-17" tabindex="-1"></a>  ) <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb711-18"><a href="model-answers-for-the-2023-exam.html#cb711-18" tabindex="-1"></a>}</span>
<span id="cb711-19"><a href="model-answers-for-the-2023-exam.html#cb711-19" tabindex="-1"></a></span>
<span id="cb711-20"><a href="model-answers-for-the-2023-exam.html#cb711-20" tabindex="-1"></a><span class="co"># map_dbl applying the function for every value of</span></span>
<span id="cb711-21"><a href="model-answers-for-the-2023-exam.html#cb711-21" tabindex="-1"></a><span class="co"># simulData$sampleSize</span></span>
<span id="cb711-22"><a href="model-answers-for-the-2023-exam.html#cb711-22" tabindex="-1"></a>simulData<span class="sc">$</span>Power <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_dbl</span>(simulData<span class="sc">$</span>sampleSize, pwr)</span></code></pre></div>
<p>Then plot the results…</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="model-answers-for-the-2023-exam.html#cb712-1" tabindex="-1"></a><span class="co"># Plot the output</span></span>
<span id="cb712-2"><a href="model-answers-for-the-2023-exam.html#cb712-2" tabindex="-1"></a><span class="fu">ggplot</span>(simulData, <span class="fu">aes</span>(<span class="at">x =</span> sampleSize, <span class="at">y =</span> Power)) <span class="sc">+</span></span>
<span id="cb712-3"><a href="model-answers-for-the-2023-exam.html#cb712-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb712-4"><a href="model-answers-for-the-2023-exam.html#cb712-4" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb712-5"><a href="model-answers-for-the-2023-exam.html#cb712-5" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-489-1.png" width="672" />
I could then read of the graph, the best sample size for any desired power level. I could also adjust the “alpha value”, i.e. the significance threshold, so that it is more strict. For example I could change from 0.05 to 0.01 for a more convincing study.</p>

</div>
</div>
<div id="question-4" class="section level2 hasAnchor" number="28.6">
<h2><span class="header-section-number">28.6</span> Question 4:<a href="model-answers-for-the-2023-exam.html#question-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This question examines the relationship between habitat characteristics, specifically habitat type and food availability, and bird nesting success in urban and suburban settings. Understanding this interplay is key to grasping ecological dynamics like resource availability and habitat suitability in increasingly urbanized landscapes.</p>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="model-answers-for-the-2023-exam.html#cb713-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb713-2"><a href="model-answers-for-the-2023-exam.html#cb713-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<p>First I import the data and take a quick look at it:</p>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb714-1"><a href="model-answers-for-the-2023-exam.html#cb714-1" tabindex="-1"></a>nesting <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;DataSetLibrary/bird_nesting_success.csv&quot;</span>)</span>
<span id="cb714-2"><a href="model-answers-for-the-2023-exam.html#cb714-2" tabindex="-1"></a><span class="fu">summary</span>(nesting)</span></code></pre></div>
<pre><code>##  foodAvailability  nestSuccess     habitatType       
##  Min.   :20.05    Min.   :0.0000   Length:300        
##  1st Qu.:39.64    1st Qu.:0.0000   Class :character  
##  Median :57.31    Median :1.0000   Mode  :character  
##  Mean   :59.88    Mean   :0.6567                     
##  3rd Qu.:80.44    3rd Qu.:1.0000                     
##  Max.   :99.54    Max.   :1.0000</code></pre>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb716-1"><a href="model-answers-for-the-2023-exam.html#cb716-1" tabindex="-1"></a><span class="fu">table</span>(nesting<span class="sc">$</span>habitat)</span></code></pre></div>
<pre><code>## 
##         park  urbanForest urbanGardens 
##          100          100          100</code></pre>
<div id="a-3" class="section level3 hasAnchor" number="28.6.1">
<h3><span class="header-section-number">28.6.1</span> a)<a href="model-answers-for-the-2023-exam.html#a-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For this part, I make a plot showing the relationship between nesting success and food availability. There is more than one approach to this.</p>
<p>Here are a couple of examples:</p>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb718-1"><a href="model-answers-for-the-2023-exam.html#cb718-1" tabindex="-1"></a><span class="fu">ggplot</span>(nesting,<span class="fu">aes</span>(<span class="at">x =</span> foodAvailability,<span class="at">y =</span> nestSuccess, <span class="at">color =</span>  habitatType)) <span class="sc">+</span> </span>
<span id="cb718-2"><a href="model-answers-for-the-2023-exam.html#cb718-2" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb718-3"><a href="model-answers-for-the-2023-exam.html#cb718-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Relationship Between Nesting Success and</span><span class="sc">\n</span><span class="st"> Food Availability Across Habitat Types&quot;</span>,</span>
<span id="cb718-4"><a href="model-answers-for-the-2023-exam.html#cb718-4" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Food Availability (grams of insects)&quot;</span>,</span>
<span id="cb718-5"><a href="model-answers-for-the-2023-exam.html#cb718-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Nesting Success (1 = Successful, 0 = Unsuccessful)&quot;</span>,</span>
<span id="cb718-6"><a href="model-answers-for-the-2023-exam.html#cb718-6" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Habitat Type&quot;</span>) <span class="sc">+</span></span>
<span id="cb718-7"><a href="model-answers-for-the-2023-exam.html#cb718-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-493-1.png" width="672" />
Another example:</p>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="model-answers-for-the-2023-exam.html#cb719-1" tabindex="-1"></a><span class="fu">ggplot</span>(nesting,<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(nestSuccess),<span class="at">y =</span> foodAvailability, <span class="at">color =</span>  habitatType)) <span class="sc">+</span> </span>
<span id="cb719-2"><a href="model-answers-for-the-2023-exam.html#cb719-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb719-3"><a href="model-answers-for-the-2023-exam.html#cb719-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Relationship Between Nesting Success and</span><span class="sc">\n</span><span class="st"> Food Availability Across Habitat Types&quot;</span>,</span>
<span id="cb719-4"><a href="model-answers-for-the-2023-exam.html#cb719-4" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Food Availability (grams of insects)&quot;</span>,</span>
<span id="cb719-5"><a href="model-answers-for-the-2023-exam.html#cb719-5" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Nesting Success (1 = Successful, 0 = Unsuccessful)&quot;</span>,</span>
<span id="cb719-6"><a href="model-answers-for-the-2023-exam.html#cb719-6" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Habitat Type&quot;</span>) <span class="sc">+</span></span>
<span id="cb719-7"><a href="model-answers-for-the-2023-exam.html#cb719-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-494-1.png" width="672" /></p>
<p>There seems to be a variation in food availability across different habitat types.</p>
<p>For each habitat type, there is a comparison of food availability between nests that were successful and those that were not. Successful nests tend to have more food availability. This difference is quite small in parks though.</p>
</div>
<div id="b-and-c" class="section level3 hasAnchor" number="28.6.2">
<h3><span class="header-section-number">28.6.2</span> b) and (c)<a href="model-answers-for-the-2023-exam.html#b-and-c" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="methods" class="section level4 hasAnchor" number="28.6.2.1">
<h4><span class="header-section-number">28.6.2.1</span> Methods<a href="model-answers-for-the-2023-exam.html#methods" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In a report, I’d write this for the methods:</p>
<p><strong>Methodology</strong></p>
<p><em>In this study, I used a GLM to fit a logistic regression to evaluate the impact of habitat type and food availability on nesting success probabilities among urban bird populations. A logistic GLM is particularly suitable for models where the dependent variable is binary. Here, the response variable, ‘nestSuccess’, is defined as binary: ‘1’ denoting a successful nest and ‘0’ denoting an unsuccessful one. The explanatory variables in this model were ‘habitatType’ and ‘foodAvailability’. ‘HabitatType’ is a categorical variable categorizing urban habitats into distinct types: urban forest, park, and urban garden. ‘FoodAvailability’, a continuous variable, quantifies the biomass of insects in grams, serving as an indicator of resource abundance. I included an interaction term between ‘habitatType’ and ‘foodAvailability’. This term is needed to assessing whether habitat type influences the effect of food availability on nesting success. This interaction potentially reveals whether certain urban habitats provide a buffering effect or exacerbate the influence of resource availability on nesting success.</em></p>
</div>
<div id="fitting-the-model" class="section level4 hasAnchor" number="28.6.2.2">
<h4><span class="header-section-number">28.6.2.2</span> Fitting the model<a href="model-answers-for-the-2023-exam.html#fitting-the-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Here’s how I fit this model:</p>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb720-1"><a href="model-answers-for-the-2023-exam.html#cb720-1" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(nestSuccess <span class="sc">~</span> habitatType <span class="sc">*</span> foodAvailability, </span>
<span id="cb720-2"><a href="model-answers-for-the-2023-exam.html#cb720-2" tabindex="-1"></a>             <span class="at">data =</span> nesting, </span>
<span id="cb720-3"><a href="model-answers-for-the-2023-exam.html#cb720-3" tabindex="-1"></a>             <span class="at">family =</span> binomial)</span></code></pre></div>
<p>I can first look at some diagnostic plots to check that it is OK. It is hard to really see whether this is a good model from the diagnostic plots (indeed there are many that say these plots are useless for binomial models), but based on the response variable being 0-1, it is probable that the binomial GLM is appropriate.</p>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="model-answers-for-the-2023-exam.html#cb721-1" tabindex="-1"></a>  <span class="fu">library</span>(ggfortify)</span>
<span id="cb721-2"><a href="model-answers-for-the-2023-exam.html#cb721-2" tabindex="-1"></a>  <span class="fu">autoplot</span>(mod1)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-496-1.png" width="672" /></p>
</div>
<div id="summmarising-the-model" class="section level4 hasAnchor" number="28.6.2.3">
<h4><span class="header-section-number">28.6.2.3</span> Summmarising the model<a href="model-answers-for-the-2023-exam.html#summmarising-the-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Then I can summarise the model to see what it tells us about nesting success.</p>
<p>The anova summary tells us whether the terms in the model (habitat and food availability) are important predictors of nesting success.</p>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb722-1"><a href="model-answers-for-the-2023-exam.html#cb722-1" tabindex="-1"></a><span class="fu">anova</span>(mod1, <span class="at">test =</span> <span class="st">&quot;Chi&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model: binomial, link: logit
## 
## Response: nestSuccess
## 
## Terms added sequentially (first to last)
## 
## 
##                              Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    
## NULL                                           299     385.93              
## habitatType                   2   67.001       297     318.93 2.825e-15 ***
## foodAvailability              1   14.998       296     303.93 0.0001076 ***
## habitatType:foodAvailability  2    6.636       294     297.30 0.0362179 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>It appears that both habitat type and food availability both explain a very significant amount of variation in nesting success. There is also a significant interaction, meaning that the effect of food availablity on success depends on the habitat.</p>
<p>We can look at the variance explained by comparing the Deviances of each term with the NULL deviance of 385.93.</p>
<p><code>(67.001 + 14.998 + 6.636)/385.93 =  0.229666</code></p>
<p>In other words, the model explains 22.97% of the variation in nesting success.
Of the variance explained, 76% is explained by habitat type and 17% is explained by food availability, while 7% is explained by the interaction between them.</p>
<p>The latter part is calculated like this:</p>
<pre><code>&gt; x &lt;- c(67.001, 14.998, 6.636)
&gt; x/sum(x)
[1] 0.75592035 0.16921081 0.07486884</code></pre>
<p>I’d write that part of the results like this:</p>
<p><strong>Results</strong></p>
<p><em>The deviance analysis of our logistic regression model demonstrated significant influences of both habitat type and food availability on nesting success in urban birds (Binomial GLM: Null Deviance = 385.93, residual df = 299). The inclusion of habitat type accounted for a substantial reduction in deviance (Deviance = 67.001, df = 2, p &lt; 0.0001), and the addition of food availability further reduced the deviance (Deviance = 14.998, df = 1, p &lt; 0.0001). This suggests that both habitat characteristics and available food resources play crucial roles in determining the probability of nesting success. The model explained 22.97% of the variance in nest success, with habitat type being the major contributor, accounting for 76% of the explained variance.</em></p>
<p>There are certainly other ways to write this, including adding a table of results. This way is probably the most succinct though.</p>
<p>The other summary tells us what those effects are: it gives us the coefficients of the model.</p>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="model-answers-for-the-2023-exam.html#cb725-1" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = nestSuccess ~ habitatType * foodAvailability, family = binomial, 
##     data = nesting)
## 
## Coefficients:
##                                           Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)                              -1.081094   0.608535  -1.777   0.0756
## habitatTypeurbanForest                   -0.009808   0.935117  -0.010   0.9916
## habitatTypeurbanGardens                   0.812687   0.960792   0.846   0.3976
## foodAvailability                          0.006911   0.009350   0.739   0.4598
## habitatTypeurbanForest:foodAvailability   0.038182   0.016610   2.299   0.0215
## habitatTypeurbanGardens:foodAvailability  0.028817   0.016981   1.697   0.0897
##                                           
## (Intercept)                              .
## habitatTypeurbanForest                    
## habitatTypeurbanGardens                   
## foodAvailability                          
## habitatTypeurbanForest:foodAvailability  *
## habitatTypeurbanGardens:foodAvailability .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 385.93  on 299  degrees of freedom
## Residual deviance: 297.30  on 294  degrees of freedom
## AIC: 309.3
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>These are hard to interpret, so I’ll use the help of lines on a plot (this also contributes to answering <strong>question 4c</strong>).</p>
<p>This is how I do that. First I set up a data frame containing data to predict <strong>from</strong>.</p>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb727-1"><a href="model-answers-for-the-2023-exam.html#cb727-1" tabindex="-1"></a><span class="co"># Create a new data frame for predictions</span></span>
<span id="cb727-2"><a href="model-answers-for-the-2023-exam.html#cb727-2" tabindex="-1"></a>foodAvailabilityRange <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(nesting<span class="sc">$</span>foodAvailability), <span class="fu">max</span>(nesting<span class="sc">$</span>foodAvailability), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb727-3"><a href="model-answers-for-the-2023-exam.html#cb727-3" tabindex="-1"></a>habitatLevels <span class="ot">&lt;-</span> <span class="fu">unique</span>(nesting<span class="sc">$</span>habitatType)</span>
<span id="cb727-4"><a href="model-answers-for-the-2023-exam.html#cb727-4" tabindex="-1"></a>predictionsData <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">foodAvailability =</span> foodAvailabilityRange, <span class="at">habitatType =</span> habitatLevels)</span></code></pre></div>
<p>Next, I use the model (<code>mod1</code>) to <code>predict</code> the probability of nest success from these data. I set the argument <code>se.fit = TRUE</code> so that the model gives me the standard error of the fit.</p>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb728-1"><a href="model-answers-for-the-2023-exam.html#cb728-1" tabindex="-1"></a><span class="co"># Obtain predicted probabilities and standard errors</span></span>
<span id="cb728-2"><a href="model-answers-for-the-2023-exam.html#cb728-2" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod1, <span class="at">newdata =</span> predictionsData, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>I can then add those predictions to the <code>predictionsData</code> data frame. Here I use the suffix “<code>..._LP</code>” to signify that these values are on the scale of the linear predictor (logit), not the natural (probability) scale.</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="model-answers-for-the-2023-exam.html#cb729-1" tabindex="-1"></a>predictionsData<span class="sc">$</span>fit_LP <span class="ot">&lt;-</span> predictions<span class="sc">$</span>fit</span>
<span id="cb729-2"><a href="model-answers-for-the-2023-exam.html#cb729-2" tabindex="-1"></a>predictionsData<span class="sc">$</span>se_LP <span class="ot">&lt;-</span> predictions<span class="sc">$</span>se.fit</span></code></pre></div>
<p>Furthermore, I calculate the 95% confidence intervals (95% CI) for the fitted values as 1.96 times the standard error. It is important that I do this <em>before</em> I backtransform the values to the probablity scale.</p>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="model-answers-for-the-2023-exam.html#cb730-1" tabindex="-1"></a>predictionsData<span class="sc">$</span>lowerCI_LP <span class="ot">&lt;-</span> predictions<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> predictions<span class="sc">$</span>se.fit</span>
<span id="cb730-2"><a href="model-answers-for-the-2023-exam.html#cb730-2" tabindex="-1"></a>predictionsData<span class="sc">$</span>upperCI_LP <span class="ot">&lt;-</span> predictions<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> predictions<span class="sc">$</span>se.fit</span></code></pre></div>
<p>After doing all that I can <em>backtransform</em> these predicted values on to the natural (probability) scale and add those points into the <code>predictionsData</code> data frame. To do that, I use the inverse logit function, which I can get from the model like this:</p>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb731-1"><a href="model-answers-for-the-2023-exam.html#cb731-1" tabindex="-1"></a>inverseFunction <span class="ot">&lt;-</span> <span class="fu">family</span>(mod1)<span class="sc">$</span>linkinv</span>
<span id="cb731-2"><a href="model-answers-for-the-2023-exam.html#cb731-2" tabindex="-1"></a></span>
<span id="cb731-3"><a href="model-answers-for-the-2023-exam.html#cb731-3" tabindex="-1"></a>predictionsData <span class="ot">&lt;-</span> predictionsData <span class="sc">%&gt;%</span></span>
<span id="cb731-4"><a href="model-answers-for-the-2023-exam.html#cb731-4" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb731-5"><a href="model-answers-for-the-2023-exam.html#cb731-5" tabindex="-1"></a>    <span class="at">fit =</span> <span class="fu">inverseFunction</span>(fit_LP),</span>
<span id="cb731-6"><a href="model-answers-for-the-2023-exam.html#cb731-6" tabindex="-1"></a>    <span class="at">lowerCI =</span> <span class="fu">inverseFunction</span>(lowerCI_LP),</span>
<span id="cb731-7"><a href="model-answers-for-the-2023-exam.html#cb731-7" tabindex="-1"></a>    <span class="at">upperCI =</span> <span class="fu">inverseFunction</span>(upperCI_LP)</span>
<span id="cb731-8"><a href="model-answers-for-the-2023-exam.html#cb731-8" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="model-answers-for-the-2023-exam.html#cb732-1" tabindex="-1"></a><span class="co"># Plotting the observed data and adding the prediction lines with standard error ribbons</span></span>
<span id="cb732-2"><a href="model-answers-for-the-2023-exam.html#cb732-2" tabindex="-1"></a><span class="fu">ggplot</span>(nesting, <span class="fu">aes</span>(<span class="at">x =</span> foodAvailability, <span class="at">y =</span> nestSuccess, <span class="at">color =</span> habitatType)) <span class="sc">+</span></span>
<span id="cb732-3"><a href="model-answers-for-the-2023-exam.html#cb732-3" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="fl">0.02</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb732-4"><a href="model-answers-for-the-2023-exam.html#cb732-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> predictionsData, <span class="fu">aes</span>(<span class="at">x =</span> foodAvailability, <span class="at">y =</span> fit, <span class="at">color =</span> habitatType), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb732-5"><a href="model-answers-for-the-2023-exam.html#cb732-5" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> predictionsData, <span class="fu">aes</span>(<span class="at">x =</span> foodAvailability, <span class="at">ymin =</span> lowerCI, <span class="at">ymax =</span> upperCI, <span class="at">fill =</span> habitatType), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb732-6"><a href="model-answers-for-the-2023-exam.html#cb732-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Predicted Nesting Success Probability Across Food Availability&quot;</span>,</span>
<span id="cb732-7"><a href="model-answers-for-the-2023-exam.html#cb732-7" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Food Availability (grams of insects)&quot;</span>,</span>
<span id="cb732-8"><a href="model-answers-for-the-2023-exam.html#cb732-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Predicted Nesting Success Probability&quot;</span>) <span class="sc">+</span></span>
<span id="cb732-9"><a href="model-answers-for-the-2023-exam.html#cb732-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-504-1.png" width="672" /></p>
<p>A suitable caption for the figure would be:</p>
<p><em>Figure X: Probability of nesting success in relation to food availability, differentiated by habitat type. Points indicate the raw data, with each point representing a single nest, colour coded by habitat type. The lines represent the predicted probabilities from a binomial GLM, while the shaded areas show 95% confidence intervals around these predictions.</em></p>
<p>And for this part of the results I would write something like this:</p>
<p><em>It is evident from the Figure that as food availability increases, the predicted probability of nesting success also increases for all habitat types. The shaded areas around each line represent 95% confidence intervals, indicating the degree of uncertainty around the predictions. These intervals appear to be wider for parks and narrower for urban forests and gardens, suggesting that there is greater variation in survival in park areas.</em></p>
<p><em>Urban forests and gardens show a relatively high and quite similar probability of nesting success even at lower levels of food availability, which remains consistently high across the range of food availability. In contrast, parks show a lower probability of nesting success at low food availability levels, with the probability increasing at a slower rate as food availability rises. Overall, is clear shows that both habitat type and food availability are influential factors in nesting success, but that the impact of food is much lower in park areas.</em></p>

</div>
</div>
</div>
</div>



























            </section>

          </div>
        </div>
      </div>
<a href="exercise-solutions.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jonesor/BB852_Book/edit/master/7_1_Exam2023_Q1.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["BB852.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"split_by": "section"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
