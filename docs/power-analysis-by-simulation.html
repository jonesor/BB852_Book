<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 Power analysis by simulation | BB852 - Data handling, visualisation and statistics</title>
  <meta name="description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 Power analysis by simulation | BB852 - Data handling, visualisation and statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 Power analysis by simulation | BB852 - Data handling, visualisation and statistics" />
  
  <meta name="twitter:description" content="Course book for BB852 at the Biology Department, University of Southern Denmark" />
  

<meta name="author" content="Owen R. Jones" />


<meta name="date" content="2020-09-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="extending-use-cases-of-glm.html"/>
<link rel="next" href="coming-soon-maybe.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.0.0/tabwid.js"></script>
<style type="text/css">

.warning-box {
  border: 3px solid #e60000;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

.advanced-box {
  border: 3px solid #268bd2;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

.do-something {
  border: 3px solid #803e00;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

</style>





<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BB852</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data-wrangling"><i class="fa fa-check"></i><b>1.1</b> Data wrangling</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-visualisation"><i class="fa fa-check"></i><b>1.2</b> Data visualisation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#statistics"><i class="fa fa-check"></i><b>1.3</b> Statistics</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#data-sources"><i class="fa fa-check"></i><b>1.4</b> Data sources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.5</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i><b>1.6</b> Schedule</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#additional-recommended-reading"><i class="fa fa-check"></i><b>1.7</b> Additional recommended reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html"><i class="fa fa-check"></i><b>2</b> Getting acquainted with R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#getting-started-with-r"><i class="fa fa-check"></i><b>2.1</b> Getting started with R</a></li>
<li class="chapter" data-level="2.2" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#getting-help"><i class="fa fa-check"></i><b>2.2</b> Getting help</a></li>
<li class="chapter" data-level="2.3" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#r-as-a-fancy-calculator"><i class="fa fa-check"></i><b>2.3</b> R as a fancy calculator</a></li>
<li class="chapter" data-level="2.4" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#objects-in-r"><i class="fa fa-check"></i><b>2.4</b> Objects in R</a></li>
<li class="chapter" data-level="2.5" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#missing-values-infinity-and-non-numbers"><i class="fa fa-check"></i><b>2.5</b> Missing values, infinity and “non-numbers”</a></li>
<li class="chapter" data-level="2.6" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#basic-information-about-objects"><i class="fa fa-check"></i><b>2.6</b> Basic information about objects</a></li>
<li class="chapter" data-level="2.7" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#data-frames"><i class="fa fa-check"></i><b>2.7</b> Data frames</a></li>
<li class="chapter" data-level="2.8" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#organising-your-work"><i class="fa fa-check"></i><b>2.8</b> Organising your work</a></li>
<li class="chapter" data-level="2.9" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#inspecting-the-data"><i class="fa fa-check"></i><b>2.9</b> Inspecting the data</a></li>
<li class="chapter" data-level="2.10" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#classes-in-r"><i class="fa fa-check"></i><b>2.10</b> “Classes” in R</a></li>
<li class="chapter" data-level="2.11" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#tables-and-summary-statistics"><i class="fa fa-check"></i><b>2.11</b> Tables and summary statistics</a></li>
<li class="chapter" data-level="2.12" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#plotting-data"><i class="fa fa-check"></i><b>2.12</b> Plotting data</a></li>
<li class="chapter" data-level="2.13" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#r-packages"><i class="fa fa-check"></i><b>2.13</b> R Packages</a></li>
<li class="chapter" data-level="2.14" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#exercise-californian-bird-diversity"><i class="fa fa-check"></i><b>2.14</b> Exercise: Californian bird diversity</a>
<ul>
<li class="chapter" data-level="2.14.1" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#the-data"><i class="fa fa-check"></i><b>2.14.1</b> The data</a></li>
<li class="chapter" data-level="2.14.2" data-path="getting-acquainted-with-r.html"><a href="getting-acquainted-with-r.html#try-the-following"><i class="fa fa-check"></i><b>2.14.2</b> Try the following</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Wrangling</b></span></li>
<li class="chapter" data-level="3" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html"><i class="fa fa-check"></i><b>3</b> Data wrangling with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#select"><i class="fa fa-check"></i><b>3.1</b> <code>select</code></a></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#filter"><i class="fa fa-check"></i><b>3.2</b> <code>filter</code></a></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#arrange"><i class="fa fa-check"></i><b>3.3</b> <code>arrange</code></a></li>
<li class="chapter" data-level="3.4" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#summarise-and-group_by"><i class="fa fa-check"></i><b>3.4</b> <code>summarise</code> and <code>group_by</code></a></li>
<li class="chapter" data-level="3.5" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#using-pipes-saving-data."><i class="fa fa-check"></i><b>3.5</b> Using pipes, saving data.</a></li>
<li class="chapter" data-level="3.6" data-path="data-wrangling-with-dplyr.html"><a href="data-wrangling-with-dplyr.html#exercise-wrangling-the-amniote-life-history-database"><i class="fa fa-check"></i><b>3.6</b> Exercise: Wrangling the Amniote Life History Database</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="combining-data-sets.html"><a href="combining-data-sets.html"><i class="fa fa-check"></i><b>4</b> Combining data sets</a>
<ul>
<li class="chapter" data-level="4.1" data-path="combining-data-sets.html"><a href="combining-data-sets.html#using-join"><i class="fa fa-check"></i><b>4.1</b> Using <code>join</code></a></li>
<li class="chapter" data-level="4.2" data-path="combining-data-sets.html"><a href="combining-data-sets.html#exercise-temperature-effects-on-egg-laying-dates"><i class="fa fa-check"></i><b>4.2</b> Exercise: Temperature effects on egg laying dates</a></li>
</ul></li>
<li class="part"><span><b>II Data visualisation</b></span></li>
<li class="chapter" data-level="5" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html"><i class="fa fa-check"></i><b>5</b> Visualising data with <code>ggplot</code></a>
<ul>
<li class="chapter" data-level="5.1" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#histograms"><i class="fa fa-check"></i><b>5.1</b> Histograms</a></li>
<li class="chapter" data-level="5.2" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#facets---splitting-data-across-panels"><i class="fa fa-check"></i><b>5.2</b> “Facets” - splitting data across panels</a></li>
<li class="chapter" data-level="5.3" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#box-plots"><i class="fa fa-check"></i><b>5.3</b> Box plots</a></li>
<li class="chapter" data-level="5.4" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#lines-and-points"><i class="fa fa-check"></i><b>5.4</b> Lines and points</a></li>
<li class="chapter" data-level="5.5" data-path="visualising-data-with-ggplot.html"><a href="visualising-data-with-ggplot.html#scatter-plots"><i class="fa fa-check"></i><b>5.5</b> Scatter plots</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html"><i class="fa fa-check"></i><b>6</b> Distributions and summarising data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#distributions"><i class="fa fa-check"></i><b>6.1</b> Distributions</a></li>
<li class="chapter" data-level="6.2" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#normal-distribution"><i class="fa fa-check"></i><b>6.2</b> Normal distribution</a></li>
<li class="chapter" data-level="6.3" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#comparing-normal-distributions"><i class="fa fa-check"></i><b>6.3</b> Comparing normal distributions</a></li>
<li class="chapter" data-level="6.4" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#poisson-distribution"><i class="fa fa-check"></i><b>6.4</b> Poisson distribution</a></li>
<li class="chapter" data-level="6.5" data-path="distributions-and-summarising-data.html"><a href="distributions-and-summarising-data.html#comparing-normal-and-poisson-distributions"><i class="fa fa-check"></i><b>6.5</b> Comparing normal and Poisson distributions</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="customising-your-plots.html"><a href="customising-your-plots.html"><i class="fa fa-check"></i><b>7</b> Customising your plots</a>
<ul>
<li class="chapter" data-level="7.1" data-path="customising-your-plots.html"><a href="customising-your-plots.html#a-basic-plot"><i class="fa fa-check"></i><b>7.1</b> A basic plot</a></li>
<li class="chapter" data-level="7.2" data-path="customising-your-plots.html"><a href="customising-your-plots.html#axis-limits"><i class="fa fa-check"></i><b>7.2</b> Axis limits</a></li>
<li class="chapter" data-level="7.3" data-path="customising-your-plots.html"><a href="customising-your-plots.html#transforming-the-axis-log-scale"><i class="fa fa-check"></i><b>7.3</b> Transforming the axis (log scale)</a></li>
<li class="chapter" data-level="7.4" data-path="customising-your-plots.html"><a href="customising-your-plots.html#changing-the-axis-tick-marks"><i class="fa fa-check"></i><b>7.4</b> Changing the axis tick marks</a></li>
<li class="chapter" data-level="7.5" data-path="customising-your-plots.html"><a href="customising-your-plots.html#axis-labels"><i class="fa fa-check"></i><b>7.5</b> Axis labels</a></li>
<li class="chapter" data-level="7.6" data-path="customising-your-plots.html"><a href="customising-your-plots.html#colours"><i class="fa fa-check"></i><b>7.6</b> Colours</a></li>
<li class="chapter" data-level="7.7" data-path="customising-your-plots.html"><a href="customising-your-plots.html#themes"><i class="fa fa-check"></i><b>7.7</b> Themes</a></li>
<li class="chapter" data-level="7.8" data-path="customising-your-plots.html"><a href="customising-your-plots.html#moving-the-legend"><i class="fa fa-check"></i><b>7.8</b> Moving the legend</a></li>
<li class="chapter" data-level="7.9" data-path="customising-your-plots.html"><a href="customising-your-plots.html#combining-multiple-plots"><i class="fa fa-check"></i><b>7.9</b> Combining multiple plots</a></li>
<li class="chapter" data-level="7.10" data-path="customising-your-plots.html"><a href="customising-your-plots.html#saving-your-plot"><i class="fa fa-check"></i><b>7.10</b> Saving your plot</a></li>
<li class="chapter" data-level="7.11" data-path="customising-your-plots.html"><a href="customising-your-plots.html#final-word-on-plots"><i class="fa fa-check"></i><b>7.11</b> Final word on plots</a></li>
</ul></li>
<li class="part"><span><b>III Statistics</b></span></li>
<li class="chapter" data-level="8" data-path="randomisation-tests.html"><a href="randomisation-tests.html"><i class="fa fa-check"></i><b>8</b> Randomisation Tests</a>
<ul>
<li class="chapter" data-level="8.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#randomisation-test-in-r"><i class="fa fa-check"></i><b>8.1</b> Randomisation test in R</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#calculate-the-observed-difference"><i class="fa fa-check"></i><b>8.1.1</b> Calculate the observed difference</a></li>
<li class="chapter" data-level="8.1.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#null-distribution"><i class="fa fa-check"></i><b>8.1.2</b> Null distribution</a></li>
<li class="chapter" data-level="8.1.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-significance"><i class="fa fa-check"></i><b>8.1.3</b> Testing significance</a></li>
<li class="chapter" data-level="8.1.4" data-path="randomisation-tests.html"><a href="randomisation-tests.html#testing-the-hypothesis"><i class="fa fa-check"></i><b>8.1.4</b> Testing the hypothesis</a></li>
<li class="chapter" data-level="8.1.5" data-path="randomisation-tests.html"><a href="randomisation-tests.html#writing-it-up"><i class="fa fa-check"></i><b>8.1.5</b> Writing it up</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#paired-randomisation-tests"><i class="fa fa-check"></i><b>8.2</b> Paired Randomisation Tests</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-randomisation-test"><i class="fa fa-check"></i><b>8.2.1</b> The randomisation test</a></li>
<li class="chapter" data-level="8.2.2" data-path="randomisation-tests.html"><a href="randomisation-tests.html#null-distribution-1"><i class="fa fa-check"></i><b>8.2.2</b> Null distribution</a></li>
<li class="chapter" data-level="8.2.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#the-formal-hypothesis-test"><i class="fa fa-check"></i><b>8.2.3</b> The formal hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="randomisation-tests.html"><a href="randomisation-tests.html#exercise-sexual-selection-in-hercules-beetles"><i class="fa fa-check"></i><b>8.3</b> Exercise: Sexual selection in Hercules beetles</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html"><i class="fa fa-check"></i><b>9</b> Comparing two means with a t-test</a>
<ul>
<li class="chapter" data-level="9.1" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#some-theory"><i class="fa fa-check"></i><b>9.1</b> Some theory</a></li>
<li class="chapter" data-level="9.2" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#one-sample-t-test"><i class="fa fa-check"></i><b>9.2</b> One sample t-test</a></li>
<li class="chapter" data-level="9.3" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#doing-it-by-hand---where-does-the-t-statistic-come-from"><i class="fa fa-check"></i><b>9.3</b> Doing it “by hand” - where does the t-statistic come from?</a></li>
<li class="chapter" data-level="9.4" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#paired-t-test"><i class="fa fa-check"></i><b>9.4</b> Paired t-test</a></li>
<li class="chapter" data-level="9.5" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#a-paired-t-test-is-a-one-sample-test."><i class="fa fa-check"></i><b>9.5</b> A paired t-test is a one-sample test.</a></li>
<li class="chapter" data-level="9.6" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#two-sample-t-test"><i class="fa fa-check"></i><b>9.6</b> Two sample t-test</a></li>
<li class="chapter" data-level="9.7" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#t-tests-are-linear-models"><i class="fa fa-check"></i><b>9.7</b> t-tests are linear models</a></li>
<li class="chapter" data-level="9.8" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-sex-differences-in-fine-motor-skills"><i class="fa fa-check"></i><b>9.8</b> Exercise: Sex differences in fine motor skills</a></li>
<li class="chapter" data-level="9.9" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-therapy-for-anorexia"><i class="fa fa-check"></i><b>9.9</b> Exercise: Therapy for anorexia</a></li>
<li class="chapter" data-level="9.10" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#exercise-compare-t-tests-with-randomisation-tests"><i class="fa fa-check"></i><b>9.10</b> Exercise: Compare t-tests with randomisation tests</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html"><i class="fa fa-check"></i><b>10</b> Linear models with a single categorical explanatory variable</a>
<ul>
<li class="chapter" data-level="10.1" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#one-way-anova"><i class="fa fa-check"></i><b>10.1</b> One-way ANOVA</a></li>
<li class="chapter" data-level="10.2" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#fitting-an-anova-in-r"><i class="fa fa-check"></i><b>10.2</b> Fitting an ANOVA in R</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#where-are-the-differences"><i class="fa fa-check"></i><b>10.2.1</b> Where are the differences?</a></li>
<li class="chapter" data-level="10.2.2" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#tukeys-honestly-significant-difference-hsd"><i class="fa fa-check"></i><b>10.2.2</b> Tukey’s Honestly Significant Difference (HSD)</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#anova-calculation-by-hand."><i class="fa fa-check"></i><b>10.3</b> ANOVA calculation “by hand”.</a></li>
<li class="chapter" data-level="10.4" data-path="linear-models-with-a-single-categorical-explanatory-variable.html"><a href="linear-models-with-a-single-categorical-explanatory-variable.html#exercise-apple-tree-crop-yield"><i class="fa fa-check"></i><b>10.4</b> Exercise: Apple tree crop yield</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html"><i class="fa fa-check"></i><b>11</b> Linear models with a single continuous explanatory variable</a>
<ul>
<li class="chapter" data-level="11.1" data-path="comparing-two-means-with-a-t-test.html"><a href="comparing-two-means-with-a-t-test.html#some-theory"><i class="fa fa-check"></i><b>11.1</b> Some theory</a></li>
<li class="chapter" data-level="11.2" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#evaluating-a-hypothesis-with-a-linear-regression-model"><i class="fa fa-check"></i><b>11.2</b> Evaluating a hypothesis with a linear regression model</a></li>
<li class="chapter" data-level="11.3" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#assumptions"><i class="fa fa-check"></i><b>11.3</b> Assumptions</a></li>
<li class="chapter" data-level="11.4" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#worked-example-height-hand-width-relationship"><i class="fa fa-check"></i><b>11.4</b> Worked example: height-hand width relationship</a></li>
<li class="chapter" data-level="11.5" data-path="linear-models-with-a-single-continuous-explanatory-variable.html"><a href="linear-models-with-a-single-continuous-explanatory-variable.html#exercise-chirping-crickets"><i class="fa fa-check"></i><b>11.5</b> Exercise: Chirping crickets</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html"><i class="fa fa-check"></i><b>12</b> Linear models with categorical and continuous explanatory variables</a>
<ul>
<li class="chapter" data-level="12.1" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#the-height-hand-width-example."><i class="fa fa-check"></i><b>12.1</b> The height ~ hand width example.</a></li>
<li class="chapter" data-level="12.2" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#summarising-with-anova"><i class="fa fa-check"></i><b>12.2</b> Summarising with <code>anova</code></a></li>
<li class="chapter" data-level="12.3" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#the-summary-of-coefficients-summary"><i class="fa fa-check"></i><b>12.3</b> The summary of coefficients (<code>summary</code>)</a></li>
<li class="chapter" data-level="12.4" data-path="linear-models-with-categorical-and-continuous-explanatory-variables.html"><a href="linear-models-with-categorical-and-continuous-explanatory-variables.html#simplifying-the-model"><i class="fa fa-check"></i><b>12.4</b> Simplifying the model</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html"><i class="fa fa-check"></i><b>13</b> Linear models with &gt;1 categorical explanatory variables</a>
<ul>
<li class="chapter" data-level="13.1" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#fitting-a-two-way-anova-model"><i class="fa fa-check"></i><b>13.1</b> Fitting a two-way ANOVA model</a></li>
<li class="chapter" data-level="13.2" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#summarising-the-model-anova"><i class="fa fa-check"></i><b>13.2</b> Summarising the model (<code>anova</code>)</a></li>
<li class="chapter" data-level="13.3" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#summarising-the-model-summary"><i class="fa fa-check"></i><b>13.3</b> Summarising the model (<code>summary</code>)</a></li>
<li class="chapter" data-level="13.4" data-path="linear-models-with-1-categorical-explanatory-variables.html"><a href="linear-models-with-1-categorical-explanatory-variables.html#exercise-fish-behaviour"><i class="fa fa-check"></i><b>13.4</b> Exercise: Fish behaviour</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html"><i class="fa fa-check"></i><b>14</b> Generalised linear models</a>
<ul>
<li class="chapter" data-level="14.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#count-data-with-poisson-errors."><i class="fa fa-check"></i><b>14.1</b> Count data with Poisson errors.</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-number-of-offspring-in-foxes."><i class="fa fa-check"></i><b>14.1.1</b> Example: Number of offspring in foxes.</a></li>
<li class="chapter" data-level="14.1.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#example-cancer-clusters"><i class="fa fa-check"></i><b>14.1.2</b> Example: Cancer clusters</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="generalised-linear-models.html"><a href="generalised-linear-models.html#exercise-maze-runner"><i class="fa fa-check"></i><b>14.2</b> Exercise: Maze runner</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html"><i class="fa fa-check"></i><b>15</b> Extending use cases of GLM</a>
<ul>
<li class="chapter" data-level="15.1" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#binomial-response-data"><i class="fa fa-check"></i><b>15.1</b> Binomial response data</a></li>
<li class="chapter" data-level="15.2" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-nfl-field-goals"><i class="fa fa-check"></i><b>15.2</b> Example: NFL field goals</a></li>
<li class="chapter" data-level="15.3" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-sex-ratio-in-turtles"><i class="fa fa-check"></i><b>15.3</b> Example: Sex ratio in turtles</a></li>
<li class="chapter" data-level="15.4" data-path="extending-use-cases-of-glm.html"><a href="extending-use-cases-of-glm.html#example-smoking"><i class="fa fa-check"></i><b>15.4</b> Example: Smoking</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html"><i class="fa fa-check"></i><b>16</b> Power analysis by simulation</a>
<ul>
<li class="chapter" data-level="16.1" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#type-i-and-ii-errors-and-statistical-power"><i class="fa fa-check"></i><b>16.1</b> Type I and II errors and statistical power</a></li>
<li class="chapter" data-level="16.2" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#what-determines-statistical-power"><i class="fa fa-check"></i><b>16.2</b> What determines statistical power?</a></li>
<li class="chapter" data-level="16.3" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#an-example-of-calculating-statistical-power."><i class="fa fa-check"></i><b>16.3</b> An example of calculating statistical power.</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#the-simulation"><i class="fa fa-check"></i><b>16.3.1</b> The simulation</a></li>
<li class="chapter" data-level="16.3.2" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#some-questions-for-you-to-address"><i class="fa fa-check"></i><b>16.3.2</b> Some questions for you to address:</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#summary"><i class="fa fa-check"></i><b>16.4</b> Summary</a></li>
<li class="chapter" data-level="16.5" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#extending-the-simulation-optional-advanced"><i class="fa fa-check"></i><b>16.5</b> Extending the simulation (optional, advanced)</a></li>
<li class="chapter" data-level="16.6" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#exercise-1-snails-on-the-move"><i class="fa fa-check"></i><b>16.6</b> Exercise 1: Snails on the move</a></li>
<li class="chapter" data-level="16.7" data-path="power-analysis-by-simulation.html"><a href="power-analysis-by-simulation.html#exercise-2-mouse-lemur-strength"><i class="fa fa-check"></i><b>16.7</b> Exercise 2: Mouse lemur strength</a></li>
</ul></li>
<li class="part"><span><b>IV Coming soon(ish)</b></span></li>
<li class="chapter" data-level="17" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html"><i class="fa fa-check"></i><b>17</b> Coming soon (maybe)!</a>
<ul>
<li class="chapter" data-level="17.1" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#multivariate-statistics"><i class="fa fa-check"></i><b>17.1</b> Multivariate statistics</a></li>
<li class="chapter" data-level="17.2" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#transforming-variables"><i class="fa fa-check"></i><b>17.2</b> Transforming variables</a></li>
<li class="chapter" data-level="17.3" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#non-linear-regression"><i class="fa fa-check"></i><b>17.3</b> Non-linear regression</a></li>
<li class="chapter" data-level="17.4" data-path="coming-soon-maybe.html"><a href="coming-soon-maybe.html#nested-or-blocked-study-designs"><i class="fa fa-check"></i><b>17.4</b> Nested or blocked study designs</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BB852 - Data handling, visualisation and statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="power-analysis-by-simulation" class="section level1" number="16">
<h1><span class="header-section-number">Chapter 16</span> Power analysis by simulation</h1>
<p>This chapter will first focus on how we can answer questions like “<em>what sample size should I use in my experiment?</em>” and “<em>with this sample size, what difference could I detect?</em>”</p>
<p>As you learned in the chapters on t-tests and ANOVA, the detection of a significant difference between treatment groups (if there is one) depends on two things: (1) the <em>actual</em> difference between mean values for the groups (the “<em>signal</em>”) and (2) the amount of variation there is in the groups (the “<em>noise</em>”). When there is a lot of noise it is hard to detect the signal.</p>
<p>In most cases we will already have some idea about what to expect when doing a study. Previous work on similar topics, or pilot studies, will have given us an idea of typical values for the response variable, and will give us a ballpark estimate of how much variation to expect. This information can be used to conduct a <strong>power analysis by simulation</strong>.</p>
<p>The basic idea of this approach is to simulate the experiment, by drawing random numbers from appropriate distributions, before actually carrying out the experiment.</p>
<div id="type-i-and-ii-errors-and-statistical-power" class="section level2" number="16.1">
<h2><span class="header-section-number">16.1</span> Type I and II errors and statistical power</h2>
<p>Before setting out to run an experiment or an observational study is is natural to wonder “<em>how much work do I really need to do here?</em>” In other words, "<em>what sample size do I need in order to address the hypothesis?</em></p>
<p>Similar questions are also relevant <strong>after</strong> running an experiment. For example, imagine you have run an experiment that failed to find a significant effect of your treatment. There are two explanations for this finding (i) there really is no efffect of your treatment; (ii) there <strong>is</strong> an effect of your treatment but you did not have enough power to detect it. So the question arising is: “what difference <strong>could</strong> you have detected, based on the results you have?” The answer could be “<em>Based on my experiment I can see that if there <strong>is</strong> really a difference it must be smaller than <span class="math inline">\(X\)</span></em>” and/or “I would need to increase my sample size to X to detect a difference if the difference is <span class="math inline">\(Y\)</span>”</p>
<p>These type of questions are closely related to the two types of error that one can make when testing hypotheses:</p>
<ul>
<li>A <strong>Type I</strong> error is the rejection of a true null hypothesis. For example, when there truly is no effect of an experimental treatment, but you detect one in error.</li>
<li>A <strong>Type II</strong> error is the failure to reject a false null hypothesis. For example, when there truly is an effect of an experimental treatment, but you fail to detect it.<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a></li>
</ul>
<p>The probability of making these errors depends on the <strong>statistical power</strong> of your study. Statistical power ranges between 0 and 1 and, for a simple hypothesis test, it is defined as <strong>the probability that the test rejects the null hypothesis (<span class="math inline">\(H_0\)</span>) when the alternative hypothesis (<span class="math inline">\(H_1\)</span>) is true</strong>. In other words it is the probability of NOT making a Type II error.</p>
<p>For example, a power of 0.80 means that you have an 80% chance of correctly detecting that <span class="math inline">\(H_1\)</span> is true and a 20% chance (1.0-0.8 = 0.2) of making a Type II error. As power decreases, the probability of making a Type II error increases.</p>
</div>
<div id="what-determines-statistical-power" class="section level2" number="16.2">
<h2><span class="header-section-number">16.2</span> What determines statistical power?</h2>
<p>Statistical power is determined by several factors including the actual effect size, the natural variation in the effect size, the sample size in the study, and the (arbitrary) criterion you have chosen for significance:</p>
<ol style="list-style-type: decimal">
<li>The <strong>magnitude of the actual effect</strong> of interest. If the effect under investigation is very small then it will be harder to detect (i.e. the power to detect it will be small).</li>
<li><strong>Variation</strong>. Variation in the data introduces noise into the statistical test. Where there is large amounts of natural variation it is harder to detect significant effects (i.e. the power to detect it will be reduced).</li>
<li>The <strong>sample size</strong>. Larger sample sizes reduce the amount of <em>sampling error</em> and therefore reduce the amount of “noise” in the data. Therefore large sample sizes increase power to detect a difference between groups.</li>
<li>Sampling error can be reduced by improving the precision of measurements. Therefore power can also be increased by improving measurement precision.</li>
<li>The <strong>significance criterion</strong>. We normally use p = 0.05, but this is arbitrary. We could increase the power of the statistical test by using a more relaxed criterion e.g. p = 0.10.</li>
</ol>
<p>There are several ways to estimate statistical power, required sample sizes etc. In this chapter we will look at one of them – power analysis by simulation. This is best communicated using a simple example.</p>
</div>
<div id="an-example-of-calculating-statistical-power." class="section level2" number="16.3">
<h2><span class="header-section-number">16.3</span> An example of calculating statistical power.</h2>
<p>In an experiment, researchers would like to test a hypothesis that a high protein diet increases the size of adult insects from a pest species. Previous work has shown that the average size on a normal diet is 12mm with a standard deviation of 4mm.</p>
<div class="do-something">
<p>
Remember to load the <code>dplyr</code>, <code>magrittr</code> and <code>ggplot</code> packages, and to set your working directory correctly.
</p>
</div>
<p>We can simulate a distribution of measurements from this distribution using the <code>rnorm</code> function. This draws <code>n</code> numbers from a theoretical normal distribution with a particular <code>mean</code> and standard deviation (<code>sd</code>). For example:</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="power-analysis-by-simulation.html#cb455-1" aria-hidden="true"></a>(control &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">mean =</span> <span class="dv">12</span>, <span class="dt">sd =</span> <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##  [1]  8.378803 12.832288 15.253324  4.962907 13.287374 13.518168 10.275780 10.360104 10.306644  9.329887</code></pre>
<p>Because this is a random process your results will be different (and they will be different each time you run the code).</p>
<p>Suppose that other studies on a different species has shown that a high protein diet leads to a 20% increase in size. This means that we expect our treatment group to have a body length of 12 <span class="math inline">\(\times\)</span> 1.2 = 14.4mm. If we assume the standard deviation will be the same, we can simulate a distribution for a high protein treatment group in the same way as for the control group:</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="power-analysis-by-simulation.html#cb457-1" aria-hidden="true"></a>(treatment &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">10</span>,<span class="dt">mean =</span><span class="fl">14.4</span>,<span class="dt">sd =</span> <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##  [1] 12.96842 11.40484 12.07124 14.59338 17.27848 14.06914 12.86697 11.66641 11.88848 21.64751</code></pre>
<p>Now we have two simulated samples, and we can conduct a t-test on those samples and store the result:</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="power-analysis-by-simulation.html#cb459-1" aria-hidden="true"></a>res &lt;-<span class="st"> </span><span class="kw">t.test</span>(control,treatment)</span></code></pre></div>
<p>We can print this result to the screen like this:</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="power-analysis-by-simulation.html#cb460-1" aria-hidden="true"></a>res</span></code></pre></div>
<pre><code>## 
## 	Welch Two Sample t-test
## 
## data:  control and treatment
## t = -2.3071, df = 17.914, p-value = 0.03321
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -6.1053569 -0.2845633
## sample estimates:
## mean of x mean of y 
##  10.85053  14.04549</code></pre>
<p>Or just get the p-value like this:</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="power-analysis-by-simulation.html#cb462-1" aria-hidden="true"></a>res<span class="op">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.03320735</code></pre>
<div id="the-simulation" class="section level3" number="16.3.1">
<h3><span class="header-section-number">16.3.1</span> The simulation</h3>
<p>The idea with power analysis by simulation is to repeat this procedure many times (at least 1000) to estimate the probability that you get it right (that you detect a significant difference between groups when you know there is a difference<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a>).</p>
<p>You have come across this sort of simulation approach before when we talked about randomisation tests. As before we will use the <code>replicate</code> function to repeatedly do t-tests on randomly generated data with the characteristics you select (i.e. sample size, mean, and standard deviation).</p>
<p>We first set up our simulation by defining the mean, standard deviation, and sample size of our simulated experiment.</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="power-analysis-by-simulation.html#cb464-1" aria-hidden="true"></a>controlMean &lt;-<span class="st"> </span><span class="dv">12</span></span>
<span id="cb464-2"><a href="power-analysis-by-simulation.html#cb464-2" aria-hidden="true"></a>treatmentMean &lt;-<span class="st"> </span><span class="fl">14.4</span></span>
<span id="cb464-3"><a href="power-analysis-by-simulation.html#cb464-3" aria-hidden="true"></a>sdValue &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb464-4"><a href="power-analysis-by-simulation.html#cb464-4" aria-hidden="true"></a>sampleSize &lt;-<span class="st"> </span><span class="dv">10</span></span></code></pre></div>
<p>Now we can “wrap” a <code>t.test</code> on simulated control and treatment data sets within a <code>replicate</code> function like this. Take some time to study this part of the script - it is important that you understand what it is doing. In this case the replicate command is telling R to repeat the t-test 5 times.</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="power-analysis-by-simulation.html#cb465-1" aria-hidden="true"></a><span class="kw">replicate</span>(<span class="dv">5</span>,</span>
<span id="cb465-2"><a href="power-analysis-by-simulation.html#cb465-2" aria-hidden="true"></a>  <span class="kw">t.test</span>(<span class="kw">rnorm</span>(sampleSize,controlMean,sdValue),</span>
<span id="cb465-3"><a href="power-analysis-by-simulation.html#cb465-3" aria-hidden="true"></a>         <span class="kw">rnorm</span>(sampleSize,treatmentMean,sdValue))<span class="op">$</span>p.value</span>
<span id="cb465-4"><a href="power-analysis-by-simulation.html#cb465-4" aria-hidden="true"></a>)</span></code></pre></div>
<pre><code>## [1] 0.248412775 0.023369962 0.765183387 0.001161126 0.006412789</code></pre>
<p>Let’s repeat the t-test 1000 times so we can get a good idea of the number of times that the test correctly detects that there is a difference between the two groups.</p>
<p>I don’t want to print 1000 p-values to the screen so I will collect them in a vector called <code>powerResults</code>.</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="power-analysis-by-simulation.html#cb467-1" aria-hidden="true"></a>powerResults &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>,</span>
<span id="cb467-2"><a href="power-analysis-by-simulation.html#cb467-2" aria-hidden="true"></a>                          <span class="kw">t.test</span>(<span class="kw">rnorm</span>(sampleSize,controlMean,sdValue),</span>
<span id="cb467-3"><a href="power-analysis-by-simulation.html#cb467-3" aria-hidden="true"></a>                                 <span class="kw">rnorm</span>(sampleSize,treatmentMean,sdValue))<span class="op">$</span>p.value)</span></code></pre></div>
<p>I can now ask how many of the p-values stored in <code>powerResults</code> were less than 0.05.</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="power-analysis-by-simulation.html#cb468-1" aria-hidden="true"></a><span class="kw">sum</span>(powerResults<span class="op">&lt;</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 399</code></pre>
<p>So in this case, 399 of the 1000 tests were correct. The statistical power can be calculated by turning this into a percentage - i.e. Power = 39.9%.</p>
<p>We can ask what sample size do we need to get a better power, e.g. 90%, by increasing sample size incrementally. For example, here I increase sample size to 15:</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="power-analysis-by-simulation.html#cb470-1" aria-hidden="true"></a>controlMean &lt;-<span class="st"> </span><span class="dv">12</span></span>
<span id="cb470-2"><a href="power-analysis-by-simulation.html#cb470-2" aria-hidden="true"></a>treatmentMean &lt;-<span class="st"> </span><span class="fl">14.4</span></span>
<span id="cb470-3"><a href="power-analysis-by-simulation.html#cb470-3" aria-hidden="true"></a>sdValue &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb470-4"><a href="power-analysis-by-simulation.html#cb470-4" aria-hidden="true"></a>sampleSize &lt;-<span class="st"> </span><span class="dv">15</span> <span class="co">#Increased</span></span>
<span id="cb470-5"><a href="power-analysis-by-simulation.html#cb470-5" aria-hidden="true"></a></span>
<span id="cb470-6"><a href="power-analysis-by-simulation.html#cb470-6" aria-hidden="true"></a>powerResults &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>,</span>
<span id="cb470-7"><a href="power-analysis-by-simulation.html#cb470-7" aria-hidden="true"></a>                          <span class="kw">t.test</span>(<span class="kw">rnorm</span>(sampleSize,controlMean,sdValue),</span>
<span id="cb470-8"><a href="power-analysis-by-simulation.html#cb470-8" aria-hidden="true"></a>                                 <span class="kw">rnorm</span>(sampleSize,treatmentMean,sdValue))<span class="op">$</span>p.value)</span>
<span id="cb470-9"><a href="power-analysis-by-simulation.html#cb470-9" aria-hidden="true"></a></span>
<span id="cb470-10"><a href="power-analysis-by-simulation.html#cb470-10" aria-hidden="true"></a>(<span class="kw">sum</span>(powerResults<span class="op">&lt;</span><span class="fl">0.05</span>)<span class="op">/</span><span class="dv">1000</span>)<span class="op">*</span><span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 54.3</code></pre>
<p>The power has increased to 54.3%.</p>
</div>
<div id="some-questions-for-you-to-address" class="section level3" number="16.3.2">
<h3><span class="header-section-number">16.3.2</span> Some questions for you to address:</h3>
<ol style="list-style-type: decimal">
<li><p>What sample size would give you 80% power?</p></li>
<li><p>What power would you have if the variation was larger (e.g. sd = 4)?</p></li>
<li><p>What power would you have if the difference between groups was only 10% instead of 20%?</p></li>
</ol>
</div>
</div>
<div id="summary" class="section level2" number="16.4">
<h2><span class="header-section-number">16.4</span> Summary</h2>
<p>Simulation can be a powerful tool to help design and understand the results of hypothesis-based studies. The example above focuses on data that are normally distributed and where the test involved is a t-test. However, the same principles apply for other types of data. One can adapt the approach to use different distributions e.g. <code>rpois</code> for Poisson or <code>rbinom</code> for binomial. One can also alter the tests being done. This case study used a <code>t.test</code> but one could alternatively simulate the results of other ordinary linear models with <code>lm</code> or GLMs with <code>glm</code>.</p>
</div>
<div id="extending-the-simulation-optional-advanced" class="section level2" number="16.5">
<h2><span class="header-section-number">16.5</span> Extending the simulation (optional, advanced)</h2>
<div class="do-something">
<p>
This section is for illustration only. It is intended to show the utility of using R to quickly address experimental design questions but it goes beyond what you are expected to learn.I hope you find it interesting nevertheless. To this you will need to add the <code>purrr</code> library (using <code>install.packages(“purrr”)</code>). This package includes a useful function, <code>map_dbl</code>, which allows you to repeatedly apply functions over many different input values. I use the double colon (<code>::</code>) notation like this <code>purrr::map_dbl</code> to use this function without the need to load the whole package.
</p>
</div>
<p>One can extend the simulation to cover a range of sample sizes (or differences between treatments, or standard deviations etc.) using by turning the calculations of the t-test into a function, and then applying that function over a range of values.</p>
<p>I illustrate this below by varying sample size between 5 and 40.</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="power-analysis-by-simulation.html#cb472-1" aria-hidden="true"></a><span class="co"># Set up a data frame for the simulation results</span></span>
<span id="cb472-2"><a href="power-analysis-by-simulation.html#cb472-2" aria-hidden="true"></a>simulData &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sampleSize =</span> <span class="dv">5</span><span class="op">:</span><span class="dv">40</span>)</span>
<span id="cb472-3"><a href="power-analysis-by-simulation.html#cb472-3" aria-hidden="true"></a></span>
<span id="cb472-4"><a href="power-analysis-by-simulation.html#cb472-4" aria-hidden="true"></a><span class="co"># Set basic values</span></span>
<span id="cb472-5"><a href="power-analysis-by-simulation.html#cb472-5" aria-hidden="true"></a>controlMean &lt;-<span class="st"> </span><span class="dv">12</span></span>
<span id="cb472-6"><a href="power-analysis-by-simulation.html#cb472-6" aria-hidden="true"></a>treatmentMean &lt;-<span class="st"> </span><span class="fl">14.4</span></span>
<span id="cb472-7"><a href="power-analysis-by-simulation.html#cb472-7" aria-hidden="true"></a>sdValue &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb472-8"><a href="power-analysis-by-simulation.html#cb472-8" aria-hidden="true"></a></span>
<span id="cb472-9"><a href="power-analysis-by-simulation.html#cb472-9" aria-hidden="true"></a><span class="co"># Function to do the t-test</span></span>
<span id="cb472-10"><a href="power-analysis-by-simulation.html#cb472-10" aria-hidden="true"></a>pwr &lt;-<span class="st"> </span><span class="cf">function</span>(n){<span class="kw">sum</span>(<span class="kw">replicate</span>(<span class="dv">1000</span>,</span>
<span id="cb472-11"><a href="power-analysis-by-simulation.html#cb472-11" aria-hidden="true"></a>                            <span class="kw">t.test</span>(<span class="kw">rnorm</span>(n,controlMean,sdValue),</span>
<span id="cb472-12"><a href="power-analysis-by-simulation.html#cb472-12" aria-hidden="true"></a>                                   <span class="kw">rnorm</span>(n,treatmentMean,sdValue))<span class="op">$</span>p.value)<span class="op">&lt;</span><span class="fl">0.05</span>)<span class="op">/</span><span class="dv">1000</span>}</span>
<span id="cb472-13"><a href="power-analysis-by-simulation.html#cb472-13" aria-hidden="true"></a></span>
<span id="cb472-14"><a href="power-analysis-by-simulation.html#cb472-14" aria-hidden="true"></a><span class="co"># map_dbl applying the function for every value of simulData$sampleSize</span></span>
<span id="cb472-15"><a href="power-analysis-by-simulation.html#cb472-15" aria-hidden="true"></a>simulData<span class="op">$</span>Power &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw">map_dbl</span>(simulData<span class="op">$</span>sampleSize,pwr)</span></code></pre></div>
<p>These results can then be graphed with <code>ggplot</code>.</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="power-analysis-by-simulation.html#cb473-1" aria-hidden="true"></a><span class="co">#Plot the output</span></span>
<span id="cb473-2"><a href="power-analysis-by-simulation.html#cb473-2" aria-hidden="true"></a><span class="kw">ggplot</span>(simulData,<span class="kw">aes</span>(<span class="dt">x =</span> sampleSize,<span class="dt">y =</span> Power)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb473-3"><a href="power-analysis-by-simulation.html#cb473-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb473-4"><a href="power-analysis-by-simulation.html#cb473-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb473-5"><a href="power-analysis-by-simulation.html#cb473-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">0.8</span>,<span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<p><img src="BB852_files/figure-html/unnamed-chunk-375-1.png" width="672" /></p>
</div>
<div id="exercise-1-snails-on-the-move" class="section level2" number="16.6">
<h2><span class="header-section-number">16.6</span> Exercise 1: Snails on the move</h2>
<p>Your supervisor has collected pilot study data on the distance travelled by a particular snail species during one day. In this study the mean distance travelled was 7.4m and there was a standard deviation of 2.76m. There are two colour morphs of the snails: One is bright and colourful with a striking black spiral while the other is drab and kinda boring-looking. Your supervisor focused on the colourful snails, but assume that standard deviation is the same for both morphs.</p>
<p>For your masters project you hypothesise that the boring snail will cover more distance because it is less scared of visual predators and willing to expose itself to more risk while foraging. You don’t have a good feel for the difference, but you decide that a 25% difference between the morphs would be biologically interesting.</p>
<p><strong>Simulate a t-test-based analysis in R to figure out what sample size would result in 80% power.</strong></p>
<!--

```r
sampleSize <- 40 #vary this until power > 0.8
result <- replicate(1000,
          t.test(rnorm(sampleSize,mean  = 7.4,sd = 2.76), 
                 rnorm(sampleSize,mean  = 7.4*1.25,sd = 2.76))$p.value)
sum(result<0.05)/1000
```

```
## [1] 0.838
```

```r
# You should find that you need a sample size of about 40 per group
```
-->
</div>
<div id="exercise-2-mouse-lemur-strength" class="section level2" number="16.7">
<h2><span class="header-section-number">16.7</span> Exercise 2: Mouse lemur strength</h2>
<p>Previous work on grey mouse lemurs (<em>Microcebus murinus</em>) has found that they are quite strong. They can lift and hold 10 times their own body weight!<a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a></p>
<p>This work was done on prime-age animals. Researchers believe that older individuals will have experienced physiological senescence and that their strength will have deteriorated. The body weight of these lemurs is about 60grams. The prime-age animals could lift and hold 600grams with a standard deviation of 145grams.</p>
<p>A research institute has agreed to you carrying out this study for your masters project. They have 25 young age lemurs, but only have 8 old aged animals. You can assume the standard deviation is the same in both age classes.</p>
<p><strong>What difference in strength could you reliably detect (with power &gt;80%) with these sample sizes?</strong></p>
<!--


```r
diff <- 185 #Vary this to give a difference to the 2nd group in the t-test
result <- replicate(1000,
          t.test(rnorm(25,mean  = 600,sd = 145), 
                 rnorm(8,mean  = 600-diff,sd = 145))$p.value)
sum(result<0.05)/1000
```

```
## [1] 0.817
```

```r
# You should find that you could detect a difference of about 185g
# or a mean for old animals of 415g which is 70% of the young animals
# i.e. a 30% reduction.
```

-->

</div>
</div>



</div>
<div class="footnotes">
<hr />
<ol start="14">
<li id="fn14"><p>To remember this, think of the story about “<em>the boy who cried wolf</em>”. First the villagers believe the boy when there was no wolf (Type I error). Second, the villagers don’t believe the boy but there IS a wolf (Type II error).<a href="power-analysis-by-simulation.html#fnref14" class="footnote-back">↩︎</a></p></li>
<li id="fn15"><p>You know there is a difference because you have set this difference!<a href="power-analysis-by-simulation.html#fnref15" class="footnote-back">↩︎</a></p></li>
<li id="fn16"><p>Thomas, P., Pouydebat, E., Brazidec, M., Aujard, F., &amp; Herrel, A. (2015). Determinants of pull strength in captive grey mouse lemurs Journal of Zoology DOI: 10.1111/jzo.12292<a href="power-analysis-by-simulation.html#fnref16" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="extending-use-cases-of-glm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="coming-soon-maybe.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jonesor/BB852_Book/edit/master/3_09-StudyDesignAndPower.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["BB852.pdf"],
"toc": {
"collapse": "section"
},
"split_by": "section"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
