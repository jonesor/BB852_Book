## Schedule

This is the schedule for the course. 
Please note that it is liable to change (possibly at short notice). 
If you find a mismatch between this schedule and the official one^[https://mitsdu.sdu.dk/skema/activity/N110040101/e20], then it is the official one that is correct.

The columns, GSWR and Course Book, refer to the relevant chapters in the recommended text book ("*Getting Started With R*") and this course book, respectively. You should aim to read and work through these chapters as the course proceeds.

```{r, echo = FALSE, include=knitr::is_latex_output()}
plot(1,1,type = "n",axes = FALSE,xlab="",ylab="")
text(1,1,labels = "The schedule is only available on the HTML version of this document")
```


```{r, echo = FALSE, message=FALSE,warning=FALSE,eval=knitr::is_html_output()}
library(flextable)
library(readxl)

system("cp -r ~/Dropbox/_SDU_Teaching/BB852/'Course Documents'/BB852_Schedule.xlsx ~/Dropbox/_SDU_Teaching/BB852/BB852_Book/BB852_Schedule.xlsx")
schedule <- readxl::read_excel("BB852_Schedule.xlsx")
```

```{r, echo = FALSE, message=FALSE,eval=knitr::is_html_output()}
library(lubridate)
library(officer)

schedule2 <- schedule %>% 
  mutate(doy = paste(Day,Month,Year,sep="-")) %>% 
  mutate(Date = lubridate::dmy(doy)) %>% 
  mutate(wd = lubridate::wday(Date,label= TRUE)) %>% 
  mutate(Date = paste0( month(Date,label = TRUE)," ",Day,", ",wd)) %>% 
  select(Part, Date, Session, Type, Topic, GSWR, CourseBook = `Course Book`)


big_b <- fp_border(color="gray70", width = 3)
std_b <- fp_border(color="gray70", style = "dashed")
big_b_end <- fp_border(color="white", width = 3)

ft <- flextable(schedule2, cwidth = c(2,2,.5,1,4,.75,.75)) %>% 
  bold(part = "header") %>% 
  bold(j = 1) %>% 
  color(i = ~ Type == "Lecture",
         j = ~  Session  + Type + Topic,
        color="red") %>% 
  merge_v(j = ~ Date + Part ) %>% 
  fontsize(part = "all", size = 14) %>% 
  vline(border = std_b, j = 1:4) %>% 
  rotate(j = ~ Part, align = 'top', rotation = 'tblr') %>% 
  hline(border = std_b ,i = seq(2,nrow(schedule2),2)) %>% 
  hline(border = big_b_end ,i =nrow(schedule2))

  
ft
```

